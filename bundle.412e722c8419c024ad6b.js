/*! For license information please see bundle.412e722c8419c024ad6b.js.LICENSE.txt */
(self.webpackChunkpapelaria_sis=self.webpackChunkpapelaria_sis||[]).push([[96],{620:t=>{window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=73)}([function(t,e,n){var i=n(61);t.exports=function(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(61);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return s}));var i={};n.r(i),n.d(i,"EPSILON",(function(){return o})),n.d(i,"ARRAY_TYPE",(function(){return c})),n.d(i,"RANDOM",(function(){return l})),n.d(i,"setMatrixArrayType",(function(){return h})),n.d(i,"toRadian",(function(){return f})),n.d(i,"equals",(function(){return d}));var r={};n.r(r),n.d(r,"create",(function(){return p})),n.d(r,"clone",(function(){return g})),n.d(r,"copy",(function(){return m})),n.d(r,"identity",(function(){return v})),n.d(r,"fromValues",(function(){return y})),n.d(r,"set",(function(){return b})),n.d(r,"transpose",(function(){return w})),n.d(r,"invert",(function(){return _})),n.d(r,"adjoint",(function(){return A})),n.d(r,"determinant",(function(){return x})),n.d(r,"multiply",(function(){return E})),n.d(r,"rotate",(function(){return T})),n.d(r,"scale",(function(){return S})),n.d(r,"fromRotation",(function(){return C})),n.d(r,"fromScaling",(function(){return k})),n.d(r,"str",(function(){return I})),n.d(r,"frob",(function(){return R})),n.d(r,"LDU",(function(){return M})),n.d(r,"add",(function(){return P})),n.d(r,"subtract",(function(){return D})),n.d(r,"exactEquals",(function(){return O})),n.d(r,"equals",(function(){return N})),n.d(r,"multiplyScalar",(function(){return L})),n.d(r,"multiplyScalarAndAdd",(function(){return F})),n.d(r,"mul",(function(){return U})),n.d(r,"sub",(function(){return j}));var a={};n.r(a),n.d(a,"create",(function(){return B})),n.d(a,"clone",(function(){return V})),n.d(a,"fromValues",(function(){return z})),n.d(a,"copy",(function(){return q})),n.d(a,"set",(function(){return H})),n.d(a,"add",(function(){return $})),n.d(a,"subtract",(function(){return G})),n.d(a,"multiply",(function(){return W})),n.d(a,"divide",(function(){return K})),n.d(a,"ceil",(function(){return X})),n.d(a,"floor",(function(){return Y})),n.d(a,"min",(function(){return Q})),n.d(a,"max",(function(){return J})),n.d(a,"round",(function(){return Z})),n.d(a,"scale",(function(){return tt})),n.d(a,"scaleAndAdd",(function(){return et})),n.d(a,"distance",(function(){return nt})),n.d(a,"squaredDistance",(function(){return it})),n.d(a,"length",(function(){return rt})),n.d(a,"squaredLength",(function(){return at})),n.d(a,"negate",(function(){return st})),n.d(a,"inverse",(function(){return ot})),n.d(a,"normalize",(function(){return ct})),n.d(a,"dot",(function(){return lt})),n.d(a,"cross",(function(){return ht})),n.d(a,"lerp",(function(){return ut})),n.d(a,"random",(function(){return ft})),n.d(a,"transformMat2",(function(){return dt})),n.d(a,"transformMat2d",(function(){return pt})),n.d(a,"transformMat3",(function(){return gt})),n.d(a,"transformMat4",(function(){return mt})),n.d(a,"rotate",(function(){return vt})),n.d(a,"angle",(function(){return yt})),n.d(a,"zero",(function(){return bt})),n.d(a,"str",(function(){return wt})),n.d(a,"exactEquals",(function(){return _t})),n.d(a,"equals",(function(){return At})),n.d(a,"len",(function(){return Et})),n.d(a,"sub",(function(){return Tt})),n.d(a,"mul",(function(){return St})),n.d(a,"div",(function(){return Ct})),n.d(a,"dist",(function(){return kt})),n.d(a,"sqrDist",(function(){return It})),n.d(a,"sqrLen",(function(){return Rt})),n.d(a,"forEach",(function(){return Mt}));var s={};n.r(s),n.d(s,"create",(function(){return Pt})),n.d(s,"clone",(function(){return Dt})),n.d(s,"length",(function(){return Ot})),n.d(s,"fromValues",(function(){return Nt})),n.d(s,"copy",(function(){return Lt})),n.d(s,"set",(function(){return Ft})),n.d(s,"add",(function(){return Ut})),n.d(s,"subtract",(function(){return jt})),n.d(s,"multiply",(function(){return Bt})),n.d(s,"divide",(function(){return Vt})),n.d(s,"ceil",(function(){return zt})),n.d(s,"floor",(function(){return qt})),n.d(s,"min",(function(){return Ht})),n.d(s,"max",(function(){return $t})),n.d(s,"round",(function(){return Gt})),n.d(s,"scale",(function(){return Wt})),n.d(s,"scaleAndAdd",(function(){return Kt})),n.d(s,"distance",(function(){return Xt})),n.d(s,"squaredDistance",(function(){return Yt})),n.d(s,"squaredLength",(function(){return Qt})),n.d(s,"negate",(function(){return Jt})),n.d(s,"inverse",(function(){return Zt})),n.d(s,"normalize",(function(){return te})),n.d(s,"dot",(function(){return ee})),n.d(s,"cross",(function(){return ne})),n.d(s,"lerp",(function(){return ie})),n.d(s,"hermite",(function(){return re})),n.d(s,"bezier",(function(){return ae})),n.d(s,"random",(function(){return se})),n.d(s,"transformMat4",(function(){return oe})),n.d(s,"transformMat3",(function(){return ce})),n.d(s,"transformQuat",(function(){return le})),n.d(s,"rotateX",(function(){return he})),n.d(s,"rotateY",(function(){return ue})),n.d(s,"rotateZ",(function(){return fe})),n.d(s,"angle",(function(){return de})),n.d(s,"zero",(function(){return pe})),n.d(s,"str",(function(){return ge})),n.d(s,"exactEquals",(function(){return me})),n.d(s,"equals",(function(){return ve})),n.d(s,"sub",(function(){return ye})),n.d(s,"mul",(function(){return be})),n.d(s,"div",(function(){return we})),n.d(s,"dist",(function(){return _e})),n.d(s,"sqrDist",(function(){return Ae})),n.d(s,"len",(function(){return xe})),n.d(s,"sqrLen",(function(){return Ee})),n.d(s,"forEach",(function(){return Te}));var o=1e-6,c="undefined"!=typeof Float32Array?Float32Array:Array,l=Math.random;function h(t){c=t}var u=Math.PI/180;function f(t){return t*u}function d(t,e){return Math.abs(t-e)<=o*Math.max(1,Math.abs(t),Math.abs(e))}function p(){var t=new c(4);return c!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function g(t){var e=new c(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function m(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function v(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function y(t,e,n,i){var r=new c(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function b(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function w(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function _(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],s=n*a-r*i;return s?(s=1/s,t[0]=a*s,t[1]=-i*s,t[2]=-r*s,t[3]=n*s,t):null}function A(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function x(t){return t[0]*t[3]-t[2]*t[1]}function E(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3],o=n[0],c=n[1],l=n[2],h=n[3];return t[0]=i*o+a*c,t[1]=r*o+s*c,t[2]=i*l+a*h,t[3]=r*l+s*h,t}function T(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3],o=Math.sin(n),c=Math.cos(n);return t[0]=i*c+a*o,t[1]=r*c+s*o,t[2]=i*-o+a*c,t[3]=r*-o+s*c,t}function S(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3],o=n[0],c=n[1];return t[0]=i*o,t[1]=r*o,t[2]=a*c,t[3]=s*c,t}function C(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t}function k(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function I(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function R(t){return Math.hypot(t[0],t[1],t[2],t[3])}function M(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]}function P(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function D(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function O(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function N(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],s=e[0],c=e[1],l=e[2],h=e[3];return Math.abs(n-s)<=o*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=o*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-l)<=o*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-h)<=o*Math.max(1,Math.abs(a),Math.abs(h))}function L(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function F(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var U=E,j=D;function B(){var t=new c(2);return c!=Float32Array&&(t[0]=0,t[1]=0),t}function V(t){var e=new c(2);return e[0]=t[0],e[1]=t[1],e}function z(t,e){var n=new c(2);return n[0]=t,n[1]=e,n}function q(t,e){return t[0]=e[0],t[1]=e[1],t}function H(t,e,n){return t[0]=e,t[1]=n,t}function $(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function G(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function W(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function K(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function X(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Y(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Q(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function J(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function Z(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function tt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function et(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function nt(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}function it(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function rt(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function at(t){var e=t[0],n=t[1];return e*e+n*n}function st(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ot(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ct(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}function lt(t,e){return t[0]*e[0]+t[1]*e[1]}function ht(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t}function ut(t,e,n,i){var r=e[0],a=e[1];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t}function ft(t,e){e=e||1;var n=2*l()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function dt(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function pt(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function gt(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function mt(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}function vt(t,e,n,i){var r=e[0]-n[0],a=e[1]-n[1],s=Math.sin(i),o=Math.cos(i);return t[0]=r*o-a*s+n[0],t[1]=r*s+a*o+n[1],t}function yt(t,e){var n=t[0],i=t[1],r=e[0],a=e[1],s=Math.sqrt(n*n+i*i)*Math.sqrt(r*r+a*a),o=s&&(n*r+i*a)/s;return Math.acos(Math.min(Math.max(o,-1),1))}function bt(t){return t[0]=0,t[1]=0,t}function wt(t){return"vec2("+t[0]+", "+t[1]+")"}function _t(t,e){return t[0]===e[0]&&t[1]===e[1]}function At(t,e){var n=t[0],i=t[1],r=e[0],a=e[1];return Math.abs(n-r)<=o*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-a)<=o*Math.max(1,Math.abs(i),Math.abs(a))}var xt,Et=rt,Tt=G,St=W,Ct=K,kt=nt,It=it,Rt=at,Mt=(xt=B(),function(t,e,n,i,r,a){var s,o;for(e||(e=2),n||(n=0),o=i?Math.min(i*e+n,t.length):t.length,s=n;s<o;s+=e)xt[0]=t[s],xt[1]=t[s+1],r(xt,xt,a),t[s]=xt[0],t[s+1]=xt[1];return t});function Pt(){var t=new c(3);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Dt(t){var e=new c(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ot(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function Nt(t,e,n){var i=new c(3);return i[0]=t,i[1]=e,i[2]=n,i}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ft(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function jt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Bt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Vt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function zt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function qt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Ht(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function $t(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Gt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Wt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Kt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function Xt(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function Yt(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function Qt(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function Jt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Zt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function te(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ne(t,e,n){var i=e[0],r=e[1],a=e[2],s=n[0],o=n[1],c=n[2];return t[0]=r*c-a*o,t[1]=a*s-i*c,t[2]=i*o-r*s,t}function ie(t,e,n,i){var r=e[0],a=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=s+i*(n[2]-s),t}function re(t,e,n,i,r,a){var s=a*a,o=s*(2*a-3)+1,c=s*(a-2)+a,l=s*(a-1),h=s*(3-2*a);return t[0]=e[0]*o+n[0]*c+i[0]*l+r[0]*h,t[1]=e[1]*o+n[1]*c+i[1]*l+r[1]*h,t[2]=e[2]*o+n[2]*c+i[2]*l+r[2]*h,t}function ae(t,e,n,i,r,a){var s=1-a,o=s*s,c=a*a,l=o*s,h=3*a*o,u=3*c*s,f=c*a;return t[0]=e[0]*l+n[0]*h+i[0]*u+r[0]*f,t[1]=e[1]*l+n[1]*h+i[1]*u+r[1]*f,t[2]=e[2]*l+n[2]*h+i[2]*u+r[2]*f,t}function se(t,e){e=e||1;var n=2*l()*Math.PI,i=2*l()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function oe(t,e,n){var i=e[0],r=e[1],a=e[2],s=n[3]*i+n[7]*r+n[11]*a+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/s,t}function ce(t,e,n){var i=e[0],r=e[1],a=e[2];return t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8],t}function le(t,e,n){var i=n[0],r=n[1],a=n[2],s=n[3],o=e[0],c=e[1],l=e[2],h=r*l-a*c,u=a*o-i*l,f=i*c-r*o,d=r*f-a*u,p=a*h-i*f,g=i*u-r*h,m=2*s;return h*=m,u*=m,f*=m,d*=2,p*=2,g*=2,t[0]=o+h+d,t[1]=c+u+p,t[2]=l+f+g,t}function he(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0],a[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),a[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ue(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),a[1]=r[1],a[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function fe(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),a[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),a[2]=r[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function de(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],s=e[1],o=e[2],c=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(a*a+s*s+o*o),l=c&&ee(t,e)/c;return Math.acos(Math.min(Math.max(l,-1),1))}function pe(t){return t[0]=0,t[1]=0,t[2]=0,t}function ge(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function me(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function ve(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],s=e[1],c=e[2];return Math.abs(n-a)<=o*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-c)<=o*Math.max(1,Math.abs(r),Math.abs(c))}var ye=jt,be=Bt,we=Vt,_e=Xt,Ae=Yt,xe=Ot,Ee=Qt,Te=function(){var t=Pt();return function(e,n,i,r,a,s){var o,c;for(n||(n=3),i||(i=0),c=r?Math.min(r*n+i,e.length):e.length,o=i;o<c;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}()},function(t,e,n){var i=n(13).default,r=n(1);t.exports=function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(40);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(141)();t.exports=i;try{regeneratorRuntime=i}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},function(t,e,n){"use strict";e.a={init:function(t,e){t.fill(e)},shuffle:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}return t},toPointList:function(t){var e=t.reduce((function(t,e){var n="[".concat(e.join(","),"]");return t.push(n),t}),[]);return"[".concat(e.join(",\r\n"),"]")},threshold:function(t,e,n){return t.reduce((function(i,r){return n.apply(t,[r])>=e&&i.push(r),i}),[])},maxIndex:function(t){for(var e=0,n=0;n<t.length;n++)t[n]>t[e]&&(e=n);return e},max:function(t){for(var e=0,n=0;n<t.length;n++)t[n]>e&&(e=t[n]);return e},sum:function(t){for(var e=t.length,n=0;e--;)n+=t[e];return n}}},function(t,e,n){"use strict";n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"j",(function(){return h})),n.d(e,"e",(function(){return u})),n.d(e,"c",(function(){return f})),n.d(e,"f",(function(){return d})),n.d(e,"g",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return y}));var i=n(5),r=n(9);i.a.setMatrixArrayType(Array);var a=function(t,e){var n=[],r={rad:0,vec:i.c.clone([0,0])},a={};function s(t){a[t.id]=t,n.push(t)}function o(){var t,e=0;for(t=0;t<n.length;t++)e+=n[t].rad;r.rad=e/n.length,r.vec=i.c.clone([Math.cos(r.rad),Math.sin(r.rad)])}return s(t),o(),{add:function(t){a[t.id]||(s(t),o())},fits:function(t){return Math.abs(i.c.dot(t.point.vec,r.vec))>e},getPoints:function(){return n},getCenter:function(){return r}}},s=function(t,e,n){return{rad:t[n],point:t,id:e}};function o(t,e){return{x:t,y:e,toVec2:function(){return i.c.clone([this.x,this.y])},toVec3:function(){return i.d.clone([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}}}function c(t,e){var n=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=8-n;function a(t,n){for(var i=0,r=t;r<=n;r++)i+=e[r];return i}function s(t,n){for(var i=0,r=t;r<=n;r++)i+=r*e[r];return i}return function(){var i,o,c,l,h=[0],u=(1<<n)-1;e=function(t,e){e||(e=8);for(var n=t.data,i=n.length,r=8-e,a=new Int32Array(1<<e);i--;)a[n[i]>>r]++;return a}(t,n);for(var f=1;f<u;f++)0==(c=(i=a(0,f))*(o=a(f+1,u)))&&(c=1),l=s(0,f)*o-s(f+1,u)*i,h[f]=l*l/c;return r.a.maxIndex(h)}()<<i}(t);return function(t,e,n){n||(n=t);for(var i=t.data,r=i.length,a=n.data;r--;)a[r]=i[r]<e?1:0}(t,n,e),n}function l(t,e,n){var i,r,o,c,l=[];function h(t){var e=!1;for(r=0;r<l.length;r++)(o=l[r]).fits(t)&&(o.add(t),e=!0);return e}for(n||(n="rad"),i=0;i<t.length;i++)h(c=s(t[i],i,n))||l.push(a(c,e));return l}function h(t,e,n){var i,r,a,s,o=0,c=0,l=[];for(i=0;i<e;i++)l[i]={score:0,item:null};for(i=0;i<t.length;i++)if((r=n.apply(this,[t[i]]))>c)for((a=l[o]).score=r,a.item=t[i],c=Number.MAX_VALUE,s=0;s<e;s++)l[s].score<c&&(c=l[s].score,o=s);return l}function u(t,e,n){for(var i,r=0,a=e.x,s=Math.floor(t.length/4),o=e.x/2,c=0,l=e.x;a<s;){for(i=0;i<o;i++)n[c]=(.299*t[4*r+0]+.587*t[4*r+1]+.114*t[4*r+2]+(.299*t[4*(r+1)+0]+.587*t[4*(r+1)+1]+.114*t[4*(r+1)+2])+(.299*t[4*a+0]+.587*t[4*a+1]+.114*t[4*a+2])+(.299*t[4*(a+1)+0]+.587*t[4*(a+1)+1]+.114*t[4*(a+1)+2]))/4,c++,r+=2,a+=2;r+=l,a+=l}}function f(t,e,n){var i=t.length/4|0;if(n&&!0===n.singleChannel)for(var r=0;r<i;r++)e[r]=t[4*r+0];else for(var a=0;a<i;a++)e[a]=.299*t[4*a+0]+.587*t[4*a+1]+.114*t[4*a+2]}function d(t,e){for(var n=t.data,i=t.size.x,r=e.data,a=0,s=i,o=n.length,c=i/2,l=0;s<o;){for(var h=0;h<c;h++)r[l]=Math.floor((n[a]+n[a+1]+n[s]+n[s+1])/4),l++,a+=2,s+=2;a+=i,s+=i}}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=t[0],i=t[1],r=t[2],a=r*i,s=a*(1-Math.abs(n/60%2-1)),o=r-a,c=0,l=0,h=0;return n<60?(c=a,l=s):n<120?(c=s,l=a):n<180?(l=a,h=s):n<240?(l=s,h=a):n<300?(c=s,h=a):n<360&&(c=a,h=s),e[0]=255*(c+o)|0,e[1]=255*(l+o)|0,e[2]=255*(h+o)|0,e}function g(t){for(var e=[],n=[],i=1;i<Math.sqrt(t)+1;i++)t%i==0&&(n.push(i),i!==t/i&&e.unshift(Math.floor(t/i)));return n.concat(e)}function m(t,e){var n,i=g(e.x),r=g(e.y),a=Math.max(e.x,e.y),s=function(t,e){for(var n=0,i=0,r=[];n<t.length&&i<e.length;)t[n]===e[i]?(r.push(t[n]),n++,i++):t[n]>e[i]?i++:n++;return r}(i,r),o=[8,10,15,20,32,60,80],c={"x-small":5,small:4,medium:3,large:2,"x-large":1},l=c[t]||c.medium,h=o[l],u=Math.floor(a/h);function f(t){for(var e=0,n=t[Math.floor(t.length/2)];e<t.length-1&&t[e]<u;)e++;return e>0&&(n=Math.abs(t[e]-u)>Math.abs(t[e-1]-u)?t[e-1]:t[e]),u/n<o[l+1]/o[l]&&u/n>o[l-1]/o[l]?{x:n,y:n}:null}return(n=f(s))||(n=f(g(a)))||(n=f(g(u*h))),n}i.a.setMatrixArrayType(Array);var v={top:function(t,e){return"%"===t.unit?Math.floor(e.height*(t.value/100)):null},right:function(t,e){return"%"===t.unit?Math.floor(e.width-e.width*(t.value/100)):null},bottom:function(t,e){return"%"===t.unit?Math.floor(e.height-e.height*(t.value/100)):null},left:function(t,e){return"%"===t.unit?Math.floor(e.width*(t.value/100)):null}};function y(t,e,n){var i={width:t,height:e},r=Object.keys(n).reduce((function(t,e){var r=function(t){return{value:parseFloat(t),unit:(t.indexOf("%"),t.length,"%")}}(n[e]),a=v[e](r,i);return t[e]=a,t}),{});return{sx:r.left,sy:r.top,sw:r.right-r.left,sh:r.bottom-r.top}}},function(t,e,n){"use strict";var i=n(62),r=n.n(i),a=n(3),s=n.n(a),o=n(4),c=n.n(o),l=n(0),h=n.n(l),u=n(5),f=n(9),d=n(10);function p(t){if(t<0)throw new Error("expected positive number, received ".concat(t))}u.a.setMatrixArrayType(Array);var g=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,r=arguments.length>3?arguments[3]:void 0;s()(this,t),h()(this,"data",void 0),h()(this,"size",void 0),h()(this,"indexMapping",void 0),n?this.data=n:(this.data=new i(e.x*e.y),r&&f.a.init(this.data,0)),this.size=e}return c()(t,[{key:"inImageWithBorder",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return p(e),t.x>=0&&t.y>=0&&t.x<this.size.x+2*e&&t.y<this.size.y+2*e}},{key:"subImageAsCopy",value:function(t,e){p(e.x),p(e.y);for(var n=t.size,i=n.x,r=n.y,a=0;a<i;a++)for(var s=0;s<r;s++)t.data[s*i+a]=this.data[(e.y+s)*this.size.x+e.x+a];return t}},{key:"get",value:function(t,e){return this.data[e*this.size.x+t]}},{key:"getSafe",value:function(t,e){if(!this.indexMapping){this.indexMapping={x:[],y:[]};for(var n=0;n<this.size.x;n++)this.indexMapping.x[n]=n,this.indexMapping.x[n+this.size.x]=n;for(var i=0;i<this.size.y;i++)this.indexMapping.y[i]=i,this.indexMapping.y[i+this.size.y]=i}return this.data[this.indexMapping.y[e+this.size.y]*this.size.x+this.indexMapping.x[t+this.size.x]]}},{key:"set",value:function(t,e,n){return this.data[e*this.size.x+t]=n,delete this.indexMapping,this}},{key:"zeroBorder",value:function(){for(var t=this.size,e=t.x,n=t.y,i=0;i<e;i++)this.data[i]=this.data[(n-1)*e+i]=0;for(var r=1;r<n-1;r++)this.data[r*e]=this.data[r*e+(e-1)]=0;return delete this.indexMapping,this}},{key:"moments",value:function(t){var e,n,i,r,a,s,o,c,l,h,f=this.data,d=this.size.y,p=this.size.x,g=[],m=[],v=Math.PI,y=v/4;if(t<=0)return m;for(a=0;a<t;a++)g[a]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(n=0;n<d;n++)for(r=n*n,e=0;e<p;e++)(i=f[n*p+e])>0&&((s=g[i-1]).m00+=1,s.m01+=n,s.m10+=e,s.m11+=e*n,s.m02+=r,s.m20+=e*e);for(a=0;a<t;a++)s=g[a],isNaN(s.m00)||0===s.m00||(c=s.m10/s.m00,l=s.m01/s.m00,o=s.m11/s.m00-c*l,h=(s.m02/s.m00-l*l-(s.m20/s.m00-c*c))/(2*o),h=.5*Math.atan(h)+(o>=0?y:-y)+v,s.theta=(180*h/v+90)%180-90,s.theta<0&&(s.theta+=180),s.rad=h>v?h-v:h,s.vec=u.c.clone([Math.cos(h),Math.sin(h)]),m.push(s));return m}},{key:"getAsRGBA",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new Uint8ClampedArray(4*this.size.x*this.size.y),n=0;n<this.size.y;n++)for(var i=0;i<this.size.x;i++){var r=n*this.size.x+i,a=this.get(i,n)*t;e[4*r+0]=a,e[4*r+1]=a,e[4*r+2]=a,e[4*r+3]=255}return e}},{key:"show",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;console.warn("* imagewrapper show getcontext 2d");var n=t.getContext("2d");if(!n)throw new Error("Unable to get canvas context");var i=n.getImageData(0,0,t.width,t.height),r=this.getAsRGBA(e);t.width=this.size.x,t.height=this.size.y;var a=new ImageData(r,i.width,i.height);n.putImageData(a,0,0)}},{key:"overlay",value:function(t,e,n){var i=e<0||e>360?360:e,a=[0,1,1],s=[0,0,0],o=[255,255,255],c=[0,0,0];console.warn("* imagewrapper overlay getcontext 2d");var l=t.getContext("2d");if(!l)throw new Error("Unable to get canvas context");for(var h=l.getImageData(n.x,n.y,this.size.x,this.size.y),u=h.data,f=this.data.length;f--;){a[0]=this.data[f]*i;var p=4*f,g=a[0]<=0?o:a[0]>=360?c:Object(d.g)(a,s),m=r()(g,3);u[p]=m[0],u[p+1]=m[1],u[p+2]=m[2],u[p+3]=255}l.putImageData(h,n.x,n.y)}}]),t}();e.a=g},function(t,e){function n(t,e,n,i,r,a,s){try{var o=t[a](s),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(i,r)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,c,"next",t)}function c(t){n(s,r,a,o,c,"throw",t)}o(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(142);function r(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=r=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=r=function(t,e,n){var r=i(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports),r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){"use strict";e.a={drawRect:function(t,e,n,i){n.strokeStyle=i.color,n.fillStyle=i.color,n.lineWidth=i.lineWidth||1,n.beginPath(),n.strokeRect(t.x,t.y,e.x,e.y)},drawPath:function(t,e,n,i){n.strokeStyle=i.color,n.fillStyle=i.color,n.lineWidth=i.lineWidth,n.beginPath(),n.moveTo(t[0][e.x],t[0][e.y]);for(var r=1;r<t.length;r++)n.lineTo(t[r][e.x],t[r][e.y]);n.closePath(),n.stroke()},drawImage:function(t,e,n){var i=n.getImageData(0,0,e.x,e.y),r=i.data,a=r.length,s=t.length;if(a/s!=4)return!1;for(;s--;){var o=t[s];r[--a]=255,r[--a]=o,r[--a]=o,r[--a]=o}return n.putImageData(i,0,0),!0}}},function(t,e,n){var i=n(74),r=n(129)((function(t,e,n){i(t,e,n)}));t.exports=r},function(t,e,n){var i=n(44),r="object"==typeof self&&self&&self.Object===Object&&self,a=i||r||Function("return this")();t.exports=a},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){"use strict";e.a={searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(t,e){var n,i=t.data,r=e.data,a=this.searchDirections,s=t.size.x;function o(t,e,o,c){var l,h,u;for(l=0;l<a.length;l++){if(h=t.cy+a[t.dir][0],u=t.cx+a[t.dir][1],i[n=h*s+u]===e&&(0===r[n]||r[n]===o))return r[n]=o,t.cy=h,t.cx=u,!0;0===r[n]&&(r[n]=c),t.dir=(t.dir+1)%8}return!1}function c(t,e,n){return{dir:n,x:t,y:e,next:null,prev:null}}return{trace:function(t,e,n,i){return o(t,e,n,i)},contourTracing:function(e,n,i,r,a){return function(e,n,i,r,a){var s,l,h,u=null,f={cx:n,cy:e,dir:0};if(o(f,r,i,a)){s=u=c(n,e,f.dir),h=f.dir,(l=c(f.cx,f.cy,0)).prev=s,s.next=l,l.next=null,s=l;var d=t.size.x*t.size.y,p=0;do{f.dir=(f.dir+6)%8,o(f,r,i,a),h!==f.dir?(s.dir=f.dir,(l=c(f.cx,f.cy,0)).prev=s,s.next=l,l.next=null,s=l):(s.dir=h,s.x=f.cx,s.y=f.cy),h=f.dir}while((f.cx!==n||f.cy!==e)&&++p<d);u.prev=s.prev,s.prev.next=u}return u}(e,n,i,r,a)}}}}},function(t,e,n){var i=n(27),r=n(87),a=n(88),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?r(t):a(t)}},function(t,e,n){"use strict";(function(t){var i,r,a,s,o,c,l,h,u,f,d=n(5),p=n(11),g=n(10),m=n(9),v=(n(17),n(65)),y=n(21),b=n(66);d.a.setMatrixArrayType(Array);var w,_,A={ctx:{binary:null},dom:{binary:null}},x={x:0,y:0};function E(t){var e,n,r,a,s,o,c,l=u.size.x,h=u.size.y,f=-u.size.x,p=-u.size.y;for(e=0,n=0;n<t.length;n++)e+=(a=t[n]).rad;for((e=(180*(e/=t.length)/Math.PI+90)%180-90)<0&&(e+=180),e=(180-e)*Math.PI/180,s=d.b.copy(d.b.create(),[Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e)]),n=0;n<t.length;n++)for(a=t[n],r=0;r<4;r++)d.c.transformMat2(a.box[r],a.box[r],s);for(n=0;n<t.length;n++)for(a=t[n],r=0;r<4;r++)a.box[r][0]<l&&(l=a.box[r][0]),a.box[r][0]>f&&(f=a.box[r][0]),a.box[r][1]<h&&(h=a.box[r][1]),a.box[r][1]>p&&(p=a.box[r][1]);for(o=[[l,h],[f,h],[f,p],[l,p]],c=i.halfSample?2:1,s=d.b.invert(s,s),r=0;r<4;r++)d.c.transformMat2(o[r],o[r],s);for(r=0;r<4;r++)d.c.scale(o[r],o[r],c);return o}function T(t,e){u.subImageAsCopy(s,Object(g.h)(t,e)),_.skeletonize()}function S(t,e,n,i){var r,a,o,c,l=[],h=[],u=Math.ceil(f.x/3);if(t.length>=2){for(r=0;r<t.length;r++)t[r].m00>u&&l.push(t[r]);if(l.length>=2){for(o=function(t){var e=Object(g.b)(t,.9),n=Object(g.j)(e,1,(function(t){return t.getPoints().length})),i=[],r=[];if(1===n.length){i=n[0].item.getPoints();for(var a=0;a<i.length;a++)r.push(i[a].point)}return r}(l),a=0,r=0;r<o.length;r++){var p,m;a+=null!==(p=null===(m=o[r])||void 0===m?void 0:m.rad)&&void 0!==p?p:0}o.length>1&&o.length>=l.length/4*3&&o.length>t.length/4&&(a/=o.length,c={index:e[1]*x.x+e[0],pos:{x:n,y:i},box:[d.c.clone([n,i]),d.c.clone([n+s.size.x,i]),d.c.clone([n+s.size.x,i+s.size.y]),d.c.clone([n,i+s.size.y])],moments:o,rad:a,vec:d.c.clone([Math.cos(a),Math.sin(a)])},h.push(c))}}return h}e.a={init:function(e,n){i=n,w=e,function(){r=i.halfSample?new p.a({x:w.size.x/2|0,y:w.size.y/2|0}):w,f=Object(g.a)(i.patchSize,r.size),x.x=r.size.x/f.x|0,x.y=r.size.y/f.y|0,u=new p.a(r.size,void 0,Uint8Array,!1),o=new p.a(f,void 0,Array,!0);var e=new ArrayBuffer(65536);s=new p.a(f,new Uint8Array(e,0,f.x*f.y)),a=new p.a(f,new Uint8Array(e,f.x*f.y*3,f.x*f.y),void 0,!0),_=Object(b.a)("undefined"!=typeof window?window:"undefined"!=typeof self?self:t,{size:f.x},e),h=new p.a({x:r.size.x/s.size.x|0,y:r.size.y/s.size.y|0},void 0,Array,!0),c=new p.a(h.size,void 0,void 0,!0),l=new p.a(h.size,void 0,Int32Array,!0)}(),function(){if(!i.useWorker&&"undefined"!=typeof document){A.dom.binary=document.createElement("canvas"),A.dom.binary.className="binaryBuffer";var t=!!i.willReadFrequently;console.warn("* initCanvas willReadFrequently",t,i),A.ctx.binary=A.dom.binary.getContext("2d",{willReadFrequently:t}),A.dom.binary.width=u.size.x,A.dom.binary.height=u.size.y}}()},locate:function(){i.halfSample&&Object(g.f)(w,r),Object(g.i)(r,u),u.zeroBorder();var t=function(){var t,e,n,i,r,c,l=[];for(t=0;t<x.x;t++)for(e=0;e<x.y;e++)T(n=s.size.x*t,i=s.size.y*e),a.zeroBorder(),m.a.init(o.data,0),c=v.a.create(a,o).rasterize(0),r=o.moments(c.count),l=l.concat(S(r,[t,e],n,i));return l}();if(t.length<x.x*x.y*.05)return null;var e=function(t){var e,n,i=0,r=0;function a(){var t;for(t=0;t<l.data.length;t++)if(0===l.data[t]&&1===c.data[t])return t;return l.data.length}function s(t){var e,n,r,a,o,u=t%l.size.x,f=t/l.size.x|0;if(t<l.data.length)for(r=h.data[t],l.data[t]=i,o=0;o<y.a.searchDirections.length;o++)n=f+y.a.searchDirections[o][0],e=u+y.a.searchDirections[o][1],a=n*l.size.x+e,0!==c.data[a]?0===l.data[a]&&Math.abs(d.c.dot(h.data[a].vec,r.vec))>.95&&s(a):l.data[a]=Number.MAX_VALUE}for(m.a.init(c.data,0),m.a.init(l.data,0),m.a.init(h.data,null),e=0;e<t.length;e++)n=t[e],h.data[n.index]=n,c.data[n.index]=1;for(c.zeroBorder();(r=a())<l.data.length;)i++,s(r);return i}(t);if(e<1)return null;var n=function(t){var e,n,i=[];for(e=0;e<t;e++)i.push(0);for(n=l.data.length;n--;)l.data[n]>0&&i[l.data[n]-1]++;return(i=i.map((function(t,e){return{val:t,label:e+1}}))).sort((function(t,e){return e.val-t.val})),i.filter((function(t){return t.val>=5}))}(e);return 0===n.length?null:function(t){var e,n,i,r,a=[],s=[];for(e=0;e<t.length;e++){for(n=l.data.length,a.length=0;n--;)l.data[n]===t[e].label&&(i=h.data[n],a.push(i));(r=E(a))&&s.push(r)}return s}(n)},checkImageConstraints:function(t,e){var n,i,r=t.getWidth(),a=t.getHeight(),s=e.halfSample?.5:1;t.getConfig().area&&(i=Object(g.d)(r,a,t.getConfig().area),t.setTopRight({x:i.sx,y:i.sy}),t.setCanvasSize({x:r,y:a}),r=i.sw,a=i.sh);var o={x:Math.floor(r*s),y:Math.floor(a*s)};if(n=Object(g.a)(e.patchSize,o),t.setWidth(Math.max(Math.floor(Math.floor(o.x/n.x)*(1/s)*n.x),n.x)),t.setHeight(Math.max(Math.floor(Math.floor(o.y/n.y)*(1/s)*n.y),n.y)),t.getWidth()%n.x==0&&t.getHeight()%n.y==0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width (".concat(r," )and height (").concat(a,") must a multiple of ").concat(n.x))}}}).call(this,n(45))},function(t,e,n){var i=n(76),r=n(77),a=n(78),s=n(79),o=n(80);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=r,c.prototype.get=a,c.prototype.has=s,c.prototype.set=o,t.exports=c},function(t,e,n){var i=n(26);t.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var i=n(19).Symbol;t.exports=i},function(t,e,n){var i=n(34)(Object,"create");t.exports=i},function(t,e,n){var i=n(101);t.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var i=n(116),r=n(20),a=Object.prototype,s=a.hasOwnProperty,o=a.propertyIsEnumerable,c=i(function(){return arguments}())?i:function(t){return r(t)&&s.call(t,"callee")&&!o.call(t,"callee")};t.exports=c},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var i=n(16),r=n(149),a=n(150),s=n(153);t.exports=function(t,e){return i(t)?t:r(t,e)?[t]:a(s(t))}},function(t,e,n){var i=n(143),r=n(144),a=n(59),s=n(145);t.exports=function(t){return i(t)||r(t)||a(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(86),r=n(92);t.exports=function(t,e){var n=r(t,e);return i(n)?n:void 0}},function(t,e,n){var i=n(22),r=n(15);t.exports=function(t){if(!r(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var i=n(48);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var i=n(35),r=n(39);t.exports=function(t){return null!=t&&r(t.length)&&!i(t)}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,n(e,i)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(22),r=n(20);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}},function(t,e,n){var i=n(41);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,n){var i=n(34)(n(19),"Map");t.exports=i},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(45))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(93),r=n(100),a=n(102),s=n(103),o=n(104);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=r,c.prototype.get=a,c.prototype.has=s,c.prototype.set=o,t.exports=c},function(t,e,n){var i=n(36),r=n(26);t.exports=function(t,e,n){(void 0!==n&&!r(t[e],n)||void 0===n&&!(e in t))&&i(t,e,n)}},function(t,e,n){var i=n(34),r=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},function(t,e,n){var i=n(115)(Object.getPrototypeOf,Object);t.exports=i},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){(function(t){var i=n(19),r=n(118),a=e&&!e.nodeType&&e,s=a&&"object"==typeof t&&t&&!t.nodeType&&t,o=s&&s.exports===a?i.Buffer:void 0,c=(o?o.isBuffer:void 0)||r;t.exports=c}).call(this,n(37)(t))},function(t,e,n){var i=n(120),r=n(121),a=n(122),s=a&&a.isTypedArray,o=s?r(s):i;t.exports=o},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var i=n(36),r=n(26),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var s=t[e];a.call(t,e)&&r(s,n)&&(void 0!==n||e in t)||i(t,e,n)}},function(t,e,n){var i=n(125),r=n(127),a=n(38);t.exports=function(t){return a(t)?i(t,!0):r(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var i=n(131),r=Math.max;t.exports=function(t,e,n){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,s=-1,o=r(a.length-e,0),c=Array(o);++s<o;)c[s]=a[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=a[s];return l[e]=n(c),i(t,this,l)}}},function(t,e,n){var i=n(132),r=n(134)(i);t.exports=r},function(t,e,n){var i=n(60);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(13).default,r=n(140);t.exports=function(t){var e=r(t,"string");return"symbol"===i(e)?e:String(e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(137),r=n(138),a=n(59),s=n(139);t.exports=function(t,e){return i(t)||r(t,e)||a(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(146),r=n(160)((function(t,e){return null==t?{}:i(t,e)}));t.exports=r},function(t,e,n){var i=n(2),r=n(40),a=n(165),s=n(166);function o(e){var n="function"==typeof Map?new Map:void 0;return t.exports=o=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return s(t,arguments,i(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports,o(e)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";var i=n(21),r={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(t,e){var n=t.data,a=e.data,s=t.size.x,o=t.size.y,c=i.a.create(t,e);return{rasterize:function(t){var e,i,l,h,u,f,d,p,g,m,v,y,b=[],w=0;for(y=0;y<400;y++)b[y]=0;for(b[0]=n[0],g=null,f=1;f<o-1;f++)for(h=0,i=b[0],u=1;u<s-1;u++)if(0===a[v=f*s+u])if((e=n[v])!==i){if(0===h)b[l=w+1]=e,i=e,null!==(d=c.contourTracing(f,u,l,e,r.DIR.OUTSIDE_EDGE))&&(w++,h=l,(p=r.createContour2D()).dir=r.CONTOUR_DIR.CW_DIR,p.index=h,p.firstVertex=d,p.nextpeer=g,p.insideContours=null,null!==g&&(g.prevpeer=p),g=p);else if(null!==(d=c.contourTracing(f,u,r.DIR.INSIDE_EDGE,e,h))){for((p=r.createContour2D()).firstVertex=d,p.insideContours=null,p.dir=0===t?r.CONTOUR_DIR.CCW_DIR:r.CONTOUR_DIR.CW_DIR,p.index=t,m=g;null!==m&&m.index!==h;)m=m.nextpeer;null!==m&&(p.nextpeer=m.insideContours,null!==m.insideContours&&(m.insideContours.prevpeer=p),m.insideContours=p)}}else a[v]=h;else a[v]===r.DIR.OUTSIDE_EDGE||a[v]===r.DIR.INSIDE_EDGE?(h=0,i=a[v]===r.DIR.INSIDE_EDGE?n[v]:b[0]):i=b[h=a[v]];for(m=g;null!==m;)m.index=t,m=m.nextpeer;return{cc:g,count:w}},debug:{drawContour:function(t,e){var n,i,a,s=t.getContext("2d"),o=e;for(s.strokeStyle="red",s.fillStyle="red",s.lineWidth=1,n=null!==o?o.insideContours:null;null!==o;){switch(null!==n?(i=n,n=n.nextpeer):(i=o,n=null!==(o=o.nextpeer)?o.insideContours:null),i.dir){case r.CONTOUR_DIR.CW_DIR:s.strokeStyle="red";break;case r.CONTOUR_DIR.CCW_DIR:s.strokeStyle="blue";break;case r.CONTOUR_DIR.UNKNOWN_DIR:s.strokeStyle="green"}a=i.firstVertex,s.beginPath(),s.moveTo(a.x,a.y);do{a=a.next,s.lineTo(a.x,a.y)}while(a!==i.firstVertex);s.stroke()}}}}}};e.a=r},function(t,e,n){"use strict";e.a=function(t,e,n){"use asm";var i=new t.Uint8Array(n),r=e.size|0,a=t.Math.imul;function s(t,e){t|=0;e|=0;var n=0;var a=0;var s=0;var o=0;var c=0;var l=0;var h=0;var u=0;for(n=1;(n|0)<(r-1|0);n=n+1|0){u=u+r|0;for(a=1;(a|0)<(r-1|0);a=a+1|0){o=u-r|0;c=u+r|0;l=a-1|0;h=a+1|0;s=(i[t+o+l|0]|0)+(i[t+o+h|0]|0)+(i[t+u+a|0]|0)+(i[t+c+l|0]|0)+(i[t+c+h|0]|0)|0;if((s|0)==(5|0)){i[e+u+a|0]=1}else{i[e+u+a|0]=0}}}}function o(t,e,n){t|=0;e|=0;n|=0;var s=0;s=a(r,r)|0;while((s|0)>0){s=s-1|0;i[n+s|0]=(i[t+s|0]|0)-(i[e+s|0]|0)|0}}function c(t,e,n){t|=0;e|=0;n|=0;var s=0;s=a(r,r)|0;while((s|0)>0){s=s-1|0;i[n+s|0]=i[t+s|0]|0|(i[e+s|0]|0)|0}}function l(t){t|=0;var e=0;var n=0;n=a(r,r)|0;while((n|0)>0){n=n-1|0;e=(e|0)+(i[t+n|0]|0)|0}return e|0}function h(t,e){t|=0;e|=0;var n=0;n=a(r,r)|0;while((n|0)>0){n=n-1|0;i[t+n|0]=e}}function u(t,e){t|=0;e|=0;var n=0;var a=0;var s=0;var o=0;var c=0;var l=0;var h=0;var u=0;for(n=1;(n|0)<(r-1|0);n=n+1|0){u=u+r|0;for(a=1;(a|0)<(r-1|0);a=a+1|0){o=u-r|0;c=u+r|0;l=a-1|0;h=a+1|0;s=(i[t+o+l|0]|0)+(i[t+o+h|0]|0)+(i[t+u+a|0]|0)+(i[t+c+l|0]|0)+(i[t+c+h|0]|0)|0;if((s|0)>(0|0)){i[e+u+a|0]=1}else{i[e+u+a|0]=0}}}}function f(t,e){t|=0;e|=0;var n=0;n=a(r,r)|0;while((n|0)>0){n=n-1|0;i[e+n|0]=i[t+n|0]|0}}function d(t){t|=0;var e=0;var n=0;for(e=0;(e|0)<(r-1|0);e=e+1|0){i[t+e|0]=0;i[t+n|0]=0;n=n+r-1|0;i[t+n|0]=0;n=n+1|0}for(e=0;(e|0)<(r|0);e=e+1|0){i[t+n|0]=0;n=n+1|0}}function p(){var t=0;var e=0;var n=0;var i=0;var p=0;var g=0;e=a(r,r)|0;n=e+e|0;i=n+e|0;h(i,0);d(t);do{s(t,e);u(e,n);o(t,n,n);c(i,n,i);f(e,t);p=l(t)|0;g=(p|0)==0|0}while(!g)}return{skeletonize:p}}},,,,,,,function(t,e,n){t.exports=n(168)},function(t,e,n){var i=n(75),r=n(47),a=n(105),s=n(107),o=n(15),c=n(55),l=n(53);t.exports=function t(e,n,h,u,f){e!==n&&a(n,(function(a,c){if(f||(f=new i),o(a))s(e,n,c,h,t,u,f);else{var d=u?u(l(e,c),a,c+"",e,n,f):void 0;void 0===d&&(d=a),r(e,c,d)}}),c)}},function(t,e,n){var i=n(24),r=n(81),a=n(82),s=n(83),o=n(84),c=n(85);function l(t){var e=this.__data__=new i(t);this.size=e.size}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=o,l.prototype.set=c,t.exports=l},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var i=n(25),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0||(n==e.length-1?e.pop():r.call(e,n,1),--this.size,0))}},function(t,e,n){var i=n(25);t.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var i=n(25);t.exports=function(t){return i(this.__data__,t)>-1}},function(t,e,n){var i=n(25);t.exports=function(t,e){var n=this.__data__,r=i(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},function(t,e,n){var i=n(24);t.exports=function(){this.__data__=new i,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var i=n(24),r=n(43),a=n(46);t.exports=function(t,e){var n=this.__data__;if(n instanceof i){var s=n.__data__;if(!r||s.length<199)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(s)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var i=n(35),r=n(89),a=n(15),s=n(91),o=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,h=c.toString,u=l.hasOwnProperty,f=RegExp("^"+h.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||r(t))&&(i(t)?f:o).test(s(t))}},function(t,e,n){var i=n(27),r=Object.prototype,a=r.hasOwnProperty,s=r.toString,o=i?i.toStringTag:void 0;t.exports=function(t){var e=a.call(t,o),n=t[o];try{t[o]=void 0;var i=!0}catch(t){}var r=s.call(t);return i&&(e?t[o]=n:delete t[o]),r}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var i,r=n(90),a=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!a&&a in t}},function(t,e,n){var i=n(19)["__core-js_shared__"];t.exports=i},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var i=n(94),r=n(24),a=n(43);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||r),string:new i}}},function(t,e,n){var i=n(95),r=n(96),a=n(97),s=n(98),o=n(99);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=r,c.prototype.get=a,c.prototype.has=s,c.prototype.set=o,t.exports=c},function(t,e,n){var i=n(28);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var i=n(28),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(e,t)?e[t]:void 0}},function(t,e,n){var i=n(28),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:r.call(e,t)}},function(t,e,n){var i=n(28);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var i=n(29);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var i=n(29);t.exports=function(t){return i(this,t).get(t)}},function(t,e,n){var i=n(29);t.exports=function(t){return i(this,t).has(t)}},function(t,e,n){var i=n(29);t.exports=function(t,e){var n=i(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},function(t,e,n){var i=n(106)();t.exports=i},function(t,e){t.exports=function(t){return function(e,n,i){for(var r=-1,a=Object(e),s=i(e),o=s.length;o--;){var c=s[t?o:++r];if(!1===n(a[c],c,a))break}return e}}},function(t,e,n){var i=n(47),r=n(108),a=n(109),s=n(112),o=n(113),c=n(30),l=n(16),h=n(117),u=n(51),f=n(35),d=n(15),p=n(119),g=n(52),m=n(53),v=n(123);t.exports=function(t,e,n,y,b,w,_){var A=m(t,n),x=m(e,n),E=_.get(x);if(E)i(t,n,E);else{var T=w?w(A,x,n+"",t,e,_):void 0,S=void 0===T;if(S){var C=l(x),k=!C&&u(x),I=!C&&!k&&g(x);T=x,C||k||I?l(A)?T=A:h(A)?T=s(A):k?(S=!1,T=r(x,!0)):I?(S=!1,T=a(x,!0)):T=[]:p(x)||c(x)?(T=A,c(A)?T=v(A):d(A)&&!f(A)||(T=o(x))):S=!1}S&&(_.set(x,T),b(T,x,y,w,_),_.delete(x)),i(t,n,T)}}},function(t,e,n){(function(t){var i=n(19),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r?i.Buffer:void 0,o=s?s.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=o?o(n):new t.constructor(n);return t.copy(i),i}}).call(this,n(37)(t))},function(t,e,n){var i=n(110);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var i=n(111);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},function(t,e,n){var i=n(19).Uint8Array;t.exports=i},function(t,e){t.exports=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}},function(t,e,n){var i=n(114),r=n(49),a=n(50);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:i(r(t))}},function(t,e,n){var i=n(15),r=Object.create,a=function(){function t(){}return function(e){if(!i(e))return{};if(r)return r(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=a},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var i=n(22),r=n(20);t.exports=function(t){return r(t)&&"[object Arguments]"==i(t)}},function(t,e,n){var i=n(38),r=n(20);t.exports=function(t){return r(t)&&i(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var i=n(22),r=n(49),a=n(20),s=Function.prototype,o=Object.prototype,c=s.toString,l=o.hasOwnProperty,h=c.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=i(t))return!1;var e=r(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==h}},function(t,e,n){var i=n(22),r=n(39),a=n(20),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&r(t.length)&&!!s[i(t)]}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var i=n(44),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r&&i.process,o=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=o}).call(this,n(37)(t))},function(t,e,n){var i=n(124),r=n(55);t.exports=function(t){return i(t,r(t))}},function(t,e,n){var i=n(54),r=n(36);t.exports=function(t,e,n,a){var s=!n;n||(n={});for(var o=-1,c=e.length;++o<c;){var l=e[o],h=a?a(n[l],t[l],l,n,t):void 0;void 0===h&&(h=t[l]),s?r(n,l,h):i(n,l,h)}return n}},function(t,e,n){var i=n(126),r=n(30),a=n(16),s=n(51),o=n(31),c=n(52),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=a(t),h=!n&&r(t),u=!n&&!h&&s(t),f=!n&&!h&&!u&&c(t),d=n||h||u||f,p=d?i(t.length,String):[],g=p.length;for(var m in t)!e&&!l.call(t,m)||d&&("length"==m||u&&("offset"==m||"parent"==m)||f&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||o(m,g))||p.push(m);return p}},function(t,e){t.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},function(t,e,n){var i=n(15),r=n(50),a=n(128),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return a(t);var e=r(t),n=[];for(var o in t)("constructor"!=o||!e&&s.call(t,o))&&n.push(o);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var i=n(130),r=n(135);t.exports=function(t){return i((function(e,n){var i=-1,a=n.length,s=a>1?n[a-1]:void 0,o=a>2?n[2]:void 0;for(s=t.length>3&&"function"==typeof s?(a--,s):void 0,o&&r(n[0],n[1],o)&&(s=a<3?void 0:s,a=1),e=Object(e);++i<a;){var c=n[i];c&&t(e,c,i,s)}return e}))}},function(t,e,n){var i=n(56),r=n(57),a=n(58);t.exports=function(t,e){return a(r(t,e,i),t+"")}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var i=n(133),r=n(48),a=n(56),s=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;t.exports=s},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,i=0;return function(){var r=n(),a=16-(r-i);if(i=r,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var i=n(26),r=n(38),a=n(31),s=n(15);t.exports=function(t,e,n){if(!s(n))return!1;var o=typeof e;return!!("number"==o?r(n)&&a(e,n.length):"string"==o&&e in n)&&i(n[e],t)}},function(t,e){"undefined"!=typeof window&&(window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})),"function"!=typeof Math.imul&&(Math.imul=function(t,e){var n=65535&t,i=65535&e;return n*i+((t>>>16&65535)*i+n*(e>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e})},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],c=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);c=!0);}catch(t){l=!0,r=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(13).default;t.exports=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(13).default;function r(){"use strict";t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},a=Object.prototype,s=a.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),s=new P(i||[]);return o(a,"_invoke",{value:k(t,n,s)}),a}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var g="suspendedStart",m="executing",v="completed",y={};function b(){}function w(){}function _(){}var A={};f(A,l,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(D([])));E&&E!==a&&s.call(E,l)&&(A=E);var T=_.prototype=b.prototype=Object.create(A);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,a,o,c){var l=p(t[r],t,a);if("throw"!==l.type){var h=l.arg,u=h.value;return u&&"object"==i(u)&&s.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,o,c)}),(function(t){n("throw",t,o,c)})):e.resolve(u).then((function(t){h.value=t,o(h)}),(function(t){return n("throw",t,o,c)}))}c(l.arg)}var r;o(this,"_invoke",{value:function(t,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}})}function k(t,n,i){var r=g;return function(a,s){if(r===m)throw new Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var c=I(o,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===g)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var l=p(t,n,i);if("normal"===l.type){if(r=i.done?v:"suspendedYield",l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r=v,i.method="throw",i.arg=l.arg)}}}function I(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=p(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(s.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(i(t)+" is not iterable")}return w.prototype=_,o(T,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:w,configurable:!0}),w.displayName=f(_,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,u,"GeneratorFunction")),t.prototype=Object.create(T),t},n.awrap=function(t){return{__await:t}},S(C.prototype),f(C.prototype,h,(function(){return this})),n.AsyncIterator=C,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new C(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(T),f(T,u,"Generator"),f(T,l,(function(){return this})),f(T,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=D,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=s.call(a,"catchLoc"),l=s.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&s.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;M(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:D(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(60);t.exports=function(t){if(Array.isArray(t))return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(147),r=n(157);t.exports=function(t,e){return i(t,e,(function(e,n){return r(t,n)}))}},function(t,e,n){var i=n(148),r=n(156),a=n(32);t.exports=function(t,e,n){for(var s=-1,o=e.length,c={};++s<o;){var l=e[s],h=i(t,l);n(h,l)&&r(c,a(l,t),h)}return c}},function(t,e,n){var i=n(32),r=n(42);t.exports=function(t,e){for(var n=0,a=(e=i(e,t)).length;null!=t&&n<a;)t=t[r(e[n++])];return n&&n==a?t:void 0}},function(t,e,n){var i=n(16),r=n(41),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!r(t))||s.test(t)||!a.test(t)||null!=e&&t in Object(e)}},function(t,e,n){var i=n(151),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,(function(t,n,i,r){e.push(i?r.replace(a,"$1"):n||t)})),e}));t.exports=s},function(t,e,n){var i=n(152);t.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var i=n(46);function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var s=t.apply(this,i);return n.cache=a.set(r,s)||a,s};return n.cache=new(r.Cache||i),n}r.Cache=i,t.exports=r},function(t,e,n){var i=n(154);t.exports=function(t){return null==t?"":i(t)}},function(t,e,n){var i=n(27),r=n(155),a=n(16),s=n(41),o=i?i.prototype:void 0,c=o?o.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return r(e,t)+"";if(s(e))return c?c.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}},function(t,e,n){var i=n(54),r=n(32),a=n(31),s=n(15),o=n(42);t.exports=function(t,e,n,c){if(!s(t))return t;for(var l=-1,h=(e=r(e,t)).length,u=h-1,f=t;null!=f&&++l<h;){var d=o(e[l]),p=n;if("__proto__"===d||"constructor"===d||"prototype"===d)return t;if(l!=u){var g=f[d];void 0===(p=c?c(g,d,f):void 0)&&(p=s(g)?g:a(e[l+1])?[]:{})}i(f,d,p),f=f[d]}return t}},function(t,e,n){var i=n(158),r=n(159);t.exports=function(t,e){return null!=t&&r(t,e,i)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var i=n(32),r=n(30),a=n(16),s=n(31),o=n(39),c=n(42);t.exports=function(t,e,n){for(var l=-1,h=(e=i(e,t)).length,u=!1;++l<h;){var f=c(e[l]);if(!(u=null!=t&&n(t,f)))break;t=t[f]}return u||++l!=h?u:!!(h=null==t?0:t.length)&&o(h)&&s(f,h)&&(a(t)||r(t))}},function(t,e,n){var i=n(161),r=n(57),a=n(58);t.exports=function(t){return a(r(t,void 0,i),t+"")}},function(t,e,n){var i=n(162);t.exports=function(t){return null!=t&&t.length?i(t,1):[]}},function(t,e,n){var i=n(163),r=n(164);t.exports=function t(e,n,a,s,o){var c=-1,l=e.length;for(a||(a=r),o||(o=[]);++c<l;){var h=e[c];n>0&&a(h)?n>1?t(h,n-1,a,s,o):i(o,h):s||(o[o.length]=h)}return o}},function(t,e){t.exports=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}},function(t,e,n){var i=n(27),r=n(30),a=n(16),s=i?i.isConcatSpreadable:void 0;t.exports=function(t){return a(t)||r(t)||!!(s&&t&&t[s])}},function(t,e){t.exports=function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var i=n(40),r=n(167);function a(e,n,s){return r()?(t.exports=a=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=a=function(t,e,n){var r=[null];r.push.apply(r,e);var a=new(Function.bind.apply(t,r));return n&&i(a,n.prototype),a},t.exports.__esModule=!0,t.exports.default=t.exports),a.apply(null,arguments)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";n.r(e),n.d(e,"BarcodeDecoder",(function(){return Tt})),n.d(e,"Readers",(function(){return i})),n.d(e,"CameraAccess",(function(){return zt})),n.d(e,"ImageDebug",(function(){return d.a})),n.d(e,"ImageWrapper",(function(){return c.a})),n.d(e,"ResultCollector",(function(){return qt}));var i={};n.r(i),n.d(i,"BarcodeReader",(function(){return R})),n.d(i,"TwoOfFiveReader",(function(){return N})),n.d(i,"NewCodabarReader",(function(){return j})),n.d(i,"Code128Reader",(function(){return B})),n.d(i,"Code32Reader",(function(){return X})),n.d(i,"Code39Reader",(function(){return W})),n.d(i,"Code39VINReader",(function(){return J})),n.d(i,"Code93Reader",(function(){return et})),n.d(i,"EAN2Reader",(function(){return ht})),n.d(i,"EAN5Reader",(function(){return ft})),n.d(i,"EAN8Reader",(function(){return dt})),n.d(i,"EANReader",(function(){return lt})),n.d(i,"I2of5Reader",(function(){return pt})),n.d(i,"UPCEReader",(function(){return mt})),n.d(i,"UPCReader",(function(){return vt}));var r=n(13),a=n.n(r),s=n(18),o=n.n(s),c=(n(136),n(11)),l=n(12),h=n.n(l),u=n(8),f=n.n(u),d=n(17),p=n(3),g=n.n(p),m=n(4),v=n.n(m),y=n(1),b=n.n(y),w=n(7),_=n.n(w),A=n(6),x=n.n(A),E=n(2),T=n.n(E),S=n(0),C=n.n(S),k=n(9),I=function(t){return t[t.Forward=1]="Forward",t[t.Reverse=-1]="Reverse",t}({}),R=function(){function t(e,n){g()(this,t),C()(this,"_row",[]),C()(this,"config",{}),C()(this,"supplements",[]),C()(this,"SINGLE_CODE_ERROR",0),C()(this,"FORMAT","unknown"),C()(this,"CONFIG_KEYS",{}),this._row=[],this.config=e||{},n&&(this.supplements=n)}return v()(t,[{key:"_nextUnset",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e<t.length;e++)if(!t[e])return e;return t.length}},{key:"_matchPattern",value:function(t,e){for(var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.SINGLE_CODE_ERROR||1,r=0,a=0,s=0,o=0,c=0,l=0,h=0;h<t.length;h++)s+=t[h],o+=e[h];if(s<o)return Number.MAX_VALUE;i*=n=s/o;for(var u=0;u<t.length;u++){if(c=t[u],l=e[u]*n,(a=Math.abs(c-l)/l)>i)return Number.MAX_VALUE;r+=a}return r/o}},{key:"_nextSet",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e<t.length;e++)if(t[e])return e;return t.length}},{key:"_correctBars",value:function(t,e,n){for(var i=n.length,r=0;i--;)(r=t[n[i]]*(1-(1-e)/2))>1&&(t[n[i]]=r)}},{key:"decodePattern",value:function(t){this._row=t;var e=this.decode();return null===e?(this._row.reverse(),(e=this.decode())&&(e.direction=I.Reverse,e.start=this._row.length-e.start,e.end=this._row.length-e.end)):e.direction=I.Forward,e&&(e.format=this.FORMAT),e}},{key:"_matchRange",value:function(t,e,n){var i;for(i=t=t<0?0:t;i<e;i++)if(this._row[i]!==n)return!1;return!0}},{key:"_fillCounters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._nextUnset(this._row),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._row.length,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[],r=0;i[r]=0;for(var a=t;a<e;a++)this._row[a]^(n?1:0)?i[r]++:(i[++r]=1,n=!n);return i}},{key:"_toCounters",value:function(t,e){var n=e.length,i=this._row.length,r=!this._row[t],a=0;k.a.init(e,0);for(var s=t;s<i;s++)if(this._row[s]^(r?1:0))e[a]++;else{if(++a===n)break;e[a]=1,r=!r}return e}},{key:"decodeImage",value:function(t){return null}}],[{key:"Exception",get:function(){return{StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"}}}]),t}();var M=[3,1,3,1,1,1],P=[3,1,1,1,3],D=[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],O=M.reduce((function(t,e){return t+e}),0),N=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"barSpaceRatio",[1,1]),C()(b()(t),"FORMAT","2of5"),C()(b()(t),"SINGLE_CODE_ERROR",.78),C()(b()(t),"AVG_CODE_ERROR",.3),t}return v()(n,[{key:"_findPattern",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[],a=0,s={error:Number.MAX_VALUE,code:-1,start:0,end:0},o=0,c=0,l=this.AVG_CODE_ERROR;e||(e=this._nextSet(this._row));for(var h=0;h<t.length;h++)r[h]=0;for(var u=e;u<this._row.length;u++)if(this._row[u]^(n?1:0))r[a]++;else{if(a===r.length-1){o=0;for(var f=0;f<r.length;f++)o+=r[f];if((c=this._matchPattern(r,t))<l)return s.error=c,s.start=u-o,s.end=u,s;if(!i)return null;for(var d=0;d<r.length-2;d++)r[d]=r[d+2];r[r.length-2]=0,r[r.length-1]=0,a--}else a++;r[a]=1,n=!n}return null}},{key:"_findStart",value:function(){for(var t=null,e=this._nextSet(this._row),n=1,i=0;!t;){if(!(t=this._findPattern(M,e,!1,!0)))return null;if(n=Math.floor((t.end-t.start)/O),(i=t.start-5*n)>=0&&this._matchRange(i,t.start,0))return t;e=t.end,t=null}return t}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(){this._row.reverse();var t=this._nextSet(this._row),e=this._findPattern(P,t,!1,!0);if(this._row.reverse(),null===e)return null;var n=e.start;return e.start=this._row.length-e.end,e.end=this._row.length-n,null!==e?this._verifyTrailingWhitespace(e):null}},{key:"_verifyCounterLength",value:function(t){return t.length%10==0}},{key:"_decodeCode",value:function(t){for(var e=this.AVG_CODE_ERROR,n={error:Number.MAX_VALUE,code:-1,start:0,end:0},i=0;i<D.length;i++){var r=this._matchPattern(t,D[i]);r<n.error&&(n.code=i,n.error=r)}return n.error<e?n:null}},{key:"_decodePayload",value:function(t,e,n){for(var i=0,r=t.length,a=[0,0,0,0,0],s=null;i<r;){for(var o=0;o<5;o++)a[o]=t[i]*this.barSpaceRatio[0],i+=2;if(!(s=this._decodeCode(a)))return null;e.push("".concat(s.code)),n.push(s)}return s}},{key:"decode",value:function(t,e){var n=this._findStart();if(!n)return null;var i=this._findEnd();if(!i)return null;var r=this._fillCounters(n.end,i.start,!1);if(!this._verifyCounterLength(r))return null;var a=[];a.push(n);var s=[];return this._decodePayload(r,s,a)?s.length<5?null:(a.push(i),{code:s.join(""),start:n.start,end:i.end,startInfo:n,decodedCodes:a,format:this.FORMAT}):null}}]),n}(R);var L=[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68],F=[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14],U=[26,41,11,14],j=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"_counters",[]),C()(b()(t),"FORMAT","codabar"),t}return v()(n,[{key:"_computeAlternatingThreshold",value:function(t,e){for(var n=Number.MAX_VALUE,i=0,r=0,a=t;a<e;a+=2)(r=this._counters[a])>i&&(i=r),r<n&&(n=r);return(n+i)/2|0}},{key:"_toPattern",value:function(t){var e=t+7;if(e>this._counters.length)return-1;for(var n=this._computeAlternatingThreshold(t,e),i=this._computeAlternatingThreshold(t+1,e),r=64,a=0,s=0,o=0;o<7;o++)a=1&o?i:n,this._counters[t+o]>a&&(s|=r),r>>=1;return s}},{key:"_isStartEnd",value:function(t){for(var e=0;e<U.length;e++)if(U[e]===t)return!0;return!1}},{key:"_sumCounters",value:function(t,e){for(var n=0,i=t;i<e;i++)n+=this._counters[i];return n}},{key:"_findStart",value:function(){for(var t=this._nextUnset(this._row),e=1;e<this._counters.length;e++){var n=this._toPattern(e);if(-1!==n&&this._isStartEnd(n))return{start:t+=this._sumCounters(0,e),end:t+this._sumCounters(e,e+8),startCounter:e,endCounter:e+8}}return null}},{key:"_patternToChar",value:function(t){for(var e=0;e<F.length;e++)if(F[e]===t)return String.fromCharCode(L[e]);return null}},{key:"_calculatePatternLength",value:function(t){for(var e=0,n=t;n<t+7;n++)e+=this._counters[n];return e}},{key:"_verifyWhitespace",value:function(t,e){return(t-1<=0||this._counters[t-1]>=this._calculatePatternLength(t)/2)&&(e+8>=this._counters.length||this._counters[e+7]>=this._calculatePatternLength(e)/2)}},{key:"_charToPattern",value:function(t){for(var e=t.charCodeAt(0),n=0;n<L.length;n++)if(L[n]===e)return F[n];return 0}},{key:"_thresholdResultPattern",value:function(t,e){for(var n,i={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},r=e,a=0;a<t.length;a++){n=this._charToPattern(t[a]);for(var s=6;s>=0;s--){var o=2==(1&s)?i.bar:i.space,c=1&~n?o.narrow:o.wide;c.size+=this._counters[r+s],c.counts++,n>>=1}r+=8}return["space","bar"].forEach((function(t){var e=i[t];e.wide.min=Math.floor((e.narrow.size/e.narrow.counts+e.wide.size/e.wide.counts)/2),e.narrow.max=Math.ceil(e.wide.min),e.wide.max=Math.ceil((2*e.wide.size+1.5)/e.wide.counts)})),i}},{key:"_validateResult",value:function(t,e){for(var n,i=this._thresholdResultPattern(t,e),r=e,a=0;a<t.length;a++){n=this._charToPattern(t[a]);for(var s=6;s>=0;s--){var o=1&s?i.space:i.bar,c=1&~n?o.narrow:o.wide,l=this._counters[r+s];if(l<c.min||l>c.max)return!1;n>>=1}r+=8}return!0}},{key:"decode",value:function(t,e){if(this._counters=this._fillCounters(),!(e=this._findStart()))return null;var n,i=e.startCounter,r=[];do{if((n=this._toPattern(i))<0)return null;var a=this._patternToChar(n);if(null===a)return null;if(r.push(a),i+=8,r.length>1&&this._isStartEnd(n))break}while(i<this._counters.length);if(r.length-2<4||!this._isStartEnd(n))return null;if(!this._verifyWhitespace(e.startCounter,i-8))return null;if(!this._validateResult(r,e.startCounter))return null;i=i>this._counters.length?this._counters.length:i;var s=e.start+this._sumCounters(e.startCounter,i-8);return{code:r.join(""),start:e.start,end:s,startInfo:e,decodedCodes:r,format:this.FORMAT}}}]),n}(R);var B=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"CODE_SHIFT",98),C()(b()(t),"CODE_C",99),C()(b()(t),"CODE_B",100),C()(b()(t),"CODE_A",101),C()(b()(t),"START_CODE_A",103),C()(b()(t),"START_CODE_B",104),C()(b()(t),"START_CODE_C",105),C()(b()(t),"STOP_CODE",106),C()(b()(t),"CODE_PATTERN",[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]),C()(b()(t),"SINGLE_CODE_ERROR",.64),C()(b()(t),"AVG_CODE_ERROR",.3),C()(b()(t),"FORMAT","code_128"),C()(b()(t),"MODULE_INDICES",{bar:[0,2,4],space:[1,3,5]}),t}return v()(n,[{key:"_decodeCode",value:function(t,e){for(var n={error:Number.MAX_VALUE,code:-1,start:t,end:t,correction:{bar:1,space:1}},i=[0,0,0,0,0,0],r=t,a=!this._row[r],s=0,o=r;o<this._row.length;o++)if(this._row[o]^(a?1:0))i[s]++;else{if(s===i.length-1){e&&this._correct(i,e);for(var c=0;c<this.CODE_PATTERN.length;c++){var l=this._matchPattern(i,this.CODE_PATTERN[c]);l<n.error&&(n.code=c,n.error=l)}return n.end=o,-1===n.code||n.error>this.AVG_CODE_ERROR?null:(this.CODE_PATTERN[n.code]&&(n.correction.bar=this.calculateCorrection(this.CODE_PATTERN[n.code],i,this.MODULE_INDICES.bar),n.correction.space=this.calculateCorrection(this.CODE_PATTERN[n.code],i,this.MODULE_INDICES.space)),n)}i[++s]=1,a=!a}return null}},{key:"_correct",value:function(t,e){this._correctBars(t,e.bar,this.MODULE_INDICES.bar),this._correctBars(t,e.space,this.MODULE_INDICES.space)}},{key:"_findStart",value:function(){for(var t=[0,0,0,0,0,0],e=this._nextSet(this._row),n={error:Number.MAX_VALUE,code:-1,start:0,end:0,correction:{bar:1,space:1}},i=!1,r=0,a=e;a<this._row.length;a++)if(this._row[a]^(i?1:0))t[r]++;else{if(r===t.length-1){for(var s=t.reduce((function(t,e){return t+e}),0),o=this.START_CODE_A;o<=this.START_CODE_C;o++){var c=this._matchPattern(t,this.CODE_PATTERN[o]);c<n.error&&(n.code=o,n.error=c)}if(n.error<this.AVG_CODE_ERROR)return n.start=a-s,n.end=a,n.correction.bar=this.calculateCorrection(this.CODE_PATTERN[n.code],t,this.MODULE_INDICES.bar),n.correction.space=this.calculateCorrection(this.CODE_PATTERN[n.code],t,this.MODULE_INDICES.space),n;for(var l=0;l<4;l++)t[l]=t[l+2];t[4]=0,t[5]=0,r--}else r++;t[r]=1,i=!i}return null}},{key:"decode",value:function(t,e){var n=this,i=this._findStart();if(null===i)return null;var r={code:i.code,start:i.start,end:i.end,correction:{bar:i.correction.bar,space:i.correction.space}},a=[];a.push(r);for(var s=r.code,o=function(t){switch(t){case n.START_CODE_A:return n.CODE_A;case n.START_CODE_B:return n.CODE_B;case n.START_CODE_C:return n.CODE_C;default:return null}}(r.code),c=!1,l=!1,h=l,u=!0,f=0,d=[],p=[];!c;){if(h=l,l=!1,null!==(r=this._decodeCode(r.end,r.correction)))switch(r.code!==this.STOP_CODE&&(u=!0),r.code!==this.STOP_CODE&&(d.push(r.code),s+=++f*r.code),a.push(r),o){case this.CODE_A:if(r.code<64)p.push(String.fromCharCode(32+r.code));else if(r.code<96)p.push(String.fromCharCode(r.code-64));else switch(r.code!==this.STOP_CODE&&(u=!1),r.code){case this.CODE_SHIFT:l=!0,o=this.CODE_B;break;case this.CODE_B:o=this.CODE_B;break;case this.CODE_C:o=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_B:if(r.code<96)p.push(String.fromCharCode(32+r.code));else switch(r.code!==this.STOP_CODE&&(u=!1),r.code){case this.CODE_SHIFT:l=!0,o=this.CODE_A;break;case this.CODE_A:o=this.CODE_A;break;case this.CODE_C:o=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_C:if(r.code<100)p.push(r.code<10?"0"+r.code:r.code);else switch(r.code!==this.STOP_CODE&&(u=!1),r.code){case this.CODE_A:o=this.CODE_A;break;case this.CODE_B:o=this.CODE_B;break;case this.STOP_CODE:c=!0}}else c=!0;h&&(o=o===this.CODE_A?this.CODE_B:this.CODE_A)}return null===r?null:(r.end=this._nextUnset(this._row,r.end),this._verifyTrailingWhitespace(r)?(s-=f*d[d.length-1])%103!==d[d.length-1]?null:p.length?(u&&p.splice(p.length-1,1),{code:p.join(""),start:i.start,end:r.end,codeset:o,startInfo:i,decodedCodes:a,endInfo:r,format:this.FORMAT}):null:null)}},{key:"_verifyTrailingWhitespace",value:function(t){var e;return(e=t.end+(t.end-t.start)/2)<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"calculateCorrection",value:function(t,e,n){for(var i=n.length,r=0,a=0;i--;)a+=t[n[i]],r+=e[n[i]];return a/r}}]),n}(R),V=n(14),z=n.n(V),q=n(33),H=n.n(q);var $=new Uint16Array(H()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%").map((function(t){return t.charCodeAt(0)}))),G=new Uint16Array([52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]),W=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","code_39"),t}return v()(n,[{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=t,n=new Uint16Array([0,0,0,0,0,0,0,0,0]),i=0,r=!1,a=t;a<this._row.length;a++)if(this._row[a]^(r?1:0))n[i]++;else{if(i===n.length-1){if(148===this._toPattern(n)){var s=Math.floor(Math.max(0,e-(a-e)/4));if(this._matchRange(s,e,0))return{start:e,end:a}}e+=n[0]+n[1];for(var o=0;o<7;o++)n[o]=n[o+2];n[7]=0,n[8]=0,i--}else i++;n[i]=1,r=!r}return null}},{key:"_toPattern",value:function(t){for(var e=t.length,n=0,i=e,r=0;i>3;){n=this._findNextWidth(t,n),i=0;for(var a=0,s=0;s<e;s++)t[s]>n&&(a|=1<<e-1-s,i++,r+=t[s]);if(3===i){for(var o=0;o<e&&i>0;o++)if(t[o]>n&&(i--,2*t[o]>=r))return-1;return a}}return-1}},{key:"_findNextWidth",value:function(t,e){for(var n=Number.MAX_VALUE,i=0;i<t.length;i++)t[i]<n&&t[i]>e&&(n=t[i]);return n}},{key:"_patternToChar",value:function(t){for(var e=0;e<G.length;e++)if(G[e]===t)return String.fromCharCode($[e]);return null}},{key:"_verifyTrailingWhitespace",value:function(t,e,n){var i=k.a.sum(n);return 3*(e-t-i)>=i}},{key:"decode",value:function(){var t=new Uint16Array([0,0,0,0,0,0,0,0,0]),e=[],n=this._findStart();if(!n)return null;var i,r,a=this._nextSet(this._row,n.end);do{t=this._toCounters(a,t);var s=this._toPattern(t);if(s<0)return null;if(null===(i=this._patternToChar(s)))return null;e.push(i),r=a,a+=k.a.sum(t),a=this._nextSet(this._row,a)}while("*"!==i);return e.pop(),e.length&&this._verifyTrailingWhitespace(r,a,t)?{code:e.join(""),start:n.start,end:a,startInfo:n,decodedCodes:e,format:this.FORMAT}:null}}]),n}(R);var K=/[AEIO]/g,X=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","code_32_reader"),t}return v()(n,[{key:"_decodeCode32",value:function(t){if(/[^0-9BCDFGHJKLMNPQRSTUVWXYZ]/.test(t))return null;for(var e=0,n=0;n<t.length;n++)e=32*e+"0123456789BCDFGHJKLMNPQRSTUVWXYZ".indexOf(t[n]);var i="".concat(e);return i.length<9&&(i=("000000000"+i).slice(-9)),"A"+i}},{key:"_checkChecksum",value:function(t){return!!t}},{key:"decode",value:function(){var t=z()(T()(n.prototype),"decode",this).call(this);if(!t)return null;var e=t.code;if(!e)return null;if(e=e.replace(K,""),!this._checkChecksum(e))return null;var i=this._decodeCode32(e);return i?(t.code=i,t):null}}]),n}(W);var Y=/[IOQ]/g,Q=/[A-Z0-9]{17}/,J=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","code_39_vin"),t}return v()(n,[{key:"_checkChecksum",value:function(t){return!!t}},{key:"decode",value:function(){var t=z()(T()(n.prototype),"decode",this).call(this);if(!t)return null;var e=t.code;return e&&(e=e.replace(Y,"")).match(Q)&&this._checkChecksum(e)?(t.code=e,t):null}}]),n}(W);var Z=new Uint16Array(H()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*").map((function(t){return t.charCodeAt(0)}))),tt=new Uint16Array([276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350]),et=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","code_93"),t}return v()(n,[{key:"_patternToChar",value:function(t){for(var e=0;e<tt.length;e++)if(tt[e]===t)return String.fromCharCode(Z[e]);return null}},{key:"_toPattern",value:function(t){for(var e=t.length,n=t.reduce((function(t,e){return t+e}),0),i=0,r=0;r<e;r++){var a=Math.round(9*t[r]/n);if(a<1||a>4)return-1;if(1&r)i<<=a;else for(var s=0;s<a;s++)i=i<<1|1}return i}},{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=t,n=new Uint16Array([0,0,0,0,0,0]),i=0,r=!1,a=t;a<this._row.length;a++)if(this._row[a]^(r?1:0))n[i]++;else{if(i===n.length-1){if(350===this._toPattern(n)){var s=Math.floor(Math.max(0,e-(a-e)/4));if(this._matchRange(s,e,0))return{start:e,end:a}}e+=n[0]+n[1];for(var o=0;o<4;o++)n[o]=n[o+2];n[4]=0,n[5]=0,i--}else i++;n[i]=1,r=!r}return null}},{key:"_verifyEnd",value:function(t,e){return!(t===e||!this._row[e])}},{key:"_decodeExtended",value:function(t){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];if(r>="a"&&r<="d"){if(i>e-2)return null;var a=t[++i],s=a.charCodeAt(0),o=void 0;switch(r){case"a":if(!(a>="A"&&a<="Z"))return null;o=String.fromCharCode(s-64);break;case"b":if(a>="A"&&a<="E")o=String.fromCharCode(s-38);else if(a>="F"&&a<="J")o=String.fromCharCode(s-11);else if(a>="K"&&a<="O")o=String.fromCharCode(s+16);else if(a>="P"&&a<="S")o=String.fromCharCode(s+43);else{if(!(a>="T"&&a<="Z"))return null;o=String.fromCharCode(127)}break;case"c":if(a>="A"&&a<="O")o=String.fromCharCode(s-32);else{if("Z"!==a)return null;o=":"}break;case"d":if(!(a>="A"&&a<="Z"))return null;o=String.fromCharCode(s+32);break;default:return console.warn("* code_93_reader _decodeExtended hit default case, this may be an error",o),null}n.push(o)}else n.push(r)}return n}},{key:"_matchCheckChar",value:function(t,e,n){var i=t.slice(0,e),r=i.length,a=i.reduce((function(t,e,i){return t+((-1*i+(r-1))%n+1)*Z.indexOf(e.charCodeAt(0))}),0);return Z[a%47]===t[e].charCodeAt(0)}},{key:"_verifyChecksums",value:function(t){return this._matchCheckChar(t,t.length-2,20)&&this._matchCheckChar(t,t.length-1,15)}},{key:"decode",value:function(t,e){if(!(e=this._findStart()))return null;var n,i,r=new Uint16Array([0,0,0,0,0,0]),a=[],s=this._nextSet(this._row,e.end);do{r=this._toCounters(s,r);var o=this._toPattern(r);if(o<0)return null;if(null===(i=this._patternToChar(o)))return null;a.push(i),n=s,s+=k.a.sum(r),s=this._nextSet(this._row,s)}while("*"!==i);return a.pop(),a.length&&this._verifyEnd(n,s)&&this._verifyChecksums(a)?(a=a.slice(0,a.length-2),null===(a=this._decodeExtended(a))?null:{code:a.join(""),start:e.start,end:s,startInfo:e,decodedCodes:a,format:this.FORMAT}):null}}]),n}(R);function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rt=[1,1,1],at=[1,1,1,1,1],st=[1,1,2],ot=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]],ct=[0,11,13,14,19,25,28,21,22,26],lt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(t,i){var r;return g()(this,n),r=e.call(this,o()({supplements:[]},t),i),C()(b()(r),"FORMAT","ean_13"),C()(b()(r),"SINGLE_CODE_ERROR",.7),C()(b()(r),"STOP_PATTERN",[1,1,1]),r}return v()(n,[{key:"_findPattern",value:function(t,e,n,i){var r=new Array(t.length).fill(0),a={error:Number.MAX_VALUE,start:0,end:0},s=0;e||(e=this._nextSet(this._row));for(var o=!1,c=e;c<this._row.length;c++)if(this._row[c]^(n?1:0))r[s]+=1;else{if(s===r.length-1){var l=this._matchPattern(r,t);if(l<.48&&a.error&&l<a.error)return o=!0,a.error=l,a.start=c-r.reduce((function(t,e){return t+e}),0),a.end=c,a;if(i){for(var h=0;h<r.length-2;h++)r[h]=r[h+2];r[r.length-2]=0,r[r.length-1]=0,s--}}else s++;r[s]=1,n=!n}return o?a:null}},{key:"_decodeCode",value:function(t,e){var n=[0,0,0,0],i=t,r={error:Number.MAX_VALUE,code:-1,start:t,end:t},a=!this._row[i],s=0;e||(e=ot.length);for(var o=i;o<this._row.length;o++)if(this._row[o]^(a?1:0))n[s]++;else{if(s===n.length-1){for(var c=0;c<e;c++){var l=this._matchPattern(n,ot[c]);r.end=o,l<r.error&&(r.code=c,r.error=l)}return r.error>.48?null:r}n[++s]=1,a=!a}return null}},{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=null;!e;){if(!(e=this._findPattern(rt,t,!1,!0)))return null;var n=e.start-(e.end-e.start);if(n>=0&&this._matchRange(n,e.start,0))return e;t=e.end,e=null}return null}},{key:"_calculateFirstDigit",value:function(t){for(var e=0;e<ct.length;e++)if(t===ct[e])return e;return null}},{key:"_decodePayload",value:function(t,e,n){for(var i=it({},t),r=0,a=0;a<6;a++){if(!(i=this._decodeCode(i.end)))return null;i.code>=10?(i.code-=10,r|=1<<5-a):r|=0<<5-a,e.push(i.code),n.push(i)}var s=this._calculateFirstDigit(r);if(null===s)return null;e.unshift(s);var o=this._findPattern(at,i.end,!0,!1);if(null===o||!o.end)return null;n.push(o);for(var c=0;c<6;c++){if(!(o=this._decodeCode(o.end,10)))return null;n.push(o),e.push(o.code)}return o}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start);return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(t,e){var n=this._findPattern(this.STOP_PATTERN,t,e,!1);return null!==n?this._verifyTrailingWhitespace(n):null}},{key:"_checksum",value:function(t){for(var e=0,n=t.length-2;n>=0;n-=2)e+=t[n];e*=3;for(var i=t.length-1;i>=0;i-=2)e+=t[i];return e%10==0}},{key:"_decodeExtensions",value:function(t){var e=this._nextSet(this._row,t),n=this._findPattern(st,e,!1,!1);if(null===n)return null;for(var i=0;i<this.supplements.length;i++)try{var r=this.supplements[i].decode(this._row,n.end);if(null!==r)return{code:r.code,start:e,startInfo:n,end:r.end,decodedCodes:r.decodedCodes,format:this.supplements[i].FORMAT}}catch(t){console.error("* decodeExtensions error in ",this.supplements[i],": ",t)}return null}},{key:"decode",value:function(t,e){var n=new Array,i=new Array,r={},a=this._findStart();if(!a)return null;var s={start:a.start,end:a.end};if(i.push(s),!(s=this._decodePayload(s,n,i)))return null;if(!(s=this._findEnd(s.end,!1)))return null;if(i.push(s),!this._checksum(n))return null;if(this.supplements.length>0){var o=this._decodeExtensions(s.end);if(!o)return null;if(!o.decodedCodes)return null;var c=o.decodedCodes[o.decodedCodes.length-1],l={start:c.start+((c.end-c.start)/2|0),end:c.end};if(!this._verifyTrailingWhitespace(l))return null;r={supplement:o,code:n.join("")+o.code}}return it(it({code:n.join(""),start:a.start,end:s.end,startInfo:a,decodedCodes:i},r),{},{format:this.FORMAT})}}]),n}(R);var ht=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","ean_2"),t}return v()(n,[{key:"decode",value:function(t,e){t&&(this._row=t);var n=0,i=e,r=this._row.length,a=[],s=[],o=null;if(void 0===i)return null;for(var c=0;c<2&&i<r;c++){if(!(o=this._decodeCode(i)))return null;s.push(o),a.push(o.code%10),o.code>=10&&(n|=1<<1-c),1!==c&&(i=this._nextSet(this._row,o.end),i=this._nextUnset(this._row,i))}if(2!==a.length||parseInt(a.join(""))%4!==n)return null;var l=this._findStart();return{code:a.join(""),decodedCodes:s,end:o.end,format:this.FORMAT,startInfo:l,start:l.start}}}]),n}(lt);var ut=[24,20,18,17,12,6,3,10,9,5],ft=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","ean_5"),t}return v()(n,[{key:"decode",value:function(t,e){if(void 0===e)return null;t&&(this._row=t);for(var n=0,i=e,r=this._row.length,a=null,s=[],o=[],c=0;c<5&&i<r;c++){if(!(a=this._decodeCode(i)))return null;o.push(a),s.push(a.code%10),a.code>=10&&(n|=1<<4-c),4!==c&&(i=this._nextSet(this._row,a.end),i=this._nextUnset(this._row,i))}if(5!==s.length)return null;if(function(t){for(var e=t.length,n=0,i=e-2;i>=0;i-=2)n+=t[i];n*=3;for(var r=e-1;r>=0;r-=2)n+=t[r];return(n*=3)%10}(s)!==function(t){for(var e=0;e<10;e++)if(t===ut[e])return e;return null}(n))return null;var l=this._findStart();return{code:s.join(""),decodedCodes:o,end:a.end,format:this.FORMAT,startInfo:l,start:l.start}}}]),n}(lt);var dt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","ean_8"),t}return v()(n,[{key:"_decodePayload",value:function(t,e,n){for(var i=t,r=0;r<4;r++){if(!(i=this._decodeCode(i.end,10)))return null;e.push(i.code),n.push(i)}if(null===(i=this._findPattern(at,i.end,!0,!1)))return null;n.push(i);for(var a=0;a<4;a++){if(!(i=this._decodeCode(i.end,10)))return null;n.push(i),e.push(i.code)}return i}}]),n}(lt);var pt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(t){var i;return g()(this,n),i=e.call(this,o()({normalizeBarSpaceWidth:!1},t)),C()(b()(i),"barSpaceRatio",[1,1]),C()(b()(i),"SINGLE_CODE_ERROR",.78),C()(b()(i),"AVG_CODE_ERROR",.38),C()(b()(i),"START_PATTERN",[1,1,1,1]),C()(b()(i),"STOP_PATTERN",[1,1,3]),C()(b()(i),"CODE_PATTERN",[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]]),C()(b()(i),"MAX_CORRECTION_FACTOR",5),C()(b()(i),"FORMAT","i2of5"),t.normalizeBarSpaceWidth&&(i.SINGLE_CODE_ERROR=.38,i.AVG_CODE_ERROR=.09),i.config=t,x()(i,b()(i))}return v()(n,[{key:"_matchPattern",value:function(t,e){if(this.config.normalizeBarSpaceWidth){for(var i=[0,0],r=[0,0],a=[0,0],s=this.MAX_CORRECTION_FACTOR,o=1/s,c=0;c<t.length;c++)i[c%2]+=t[c],r[c%2]+=e[c];a[0]=r[0]/i[0],a[1]=r[1]/i[1],a[0]=Math.max(Math.min(a[0],s),o),a[1]=Math.max(Math.min(a[1],s),o),this.barSpaceRatio=a;for(var l=0;l<t.length;l++)t[l]*=this.barSpaceRatio[l%2]}return z()(T()(n.prototype),"_matchPattern",this).call(this,t,e)}},{key:"_findPattern",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Array(t.length).fill(0),a=0,s={error:Number.MAX_VALUE,start:0,end:0},o=this.AVG_CODE_ERROR;n=n||!1,i=i||!1,e||(e=this._nextSet(this._row));for(var c=e;c<this._row.length;c++)if(this._row[c]^(n?1:0))r[a]++;else{if(a===r.length-1){var l=r.reduce((function(t,e){return t+e}),0),h=this._matchPattern(r,t);if(h<o)return s.error=h,s.start=c-l,s.end=c,s;if(!i)return null;for(var u=0;u<r.length-2;u++)r[u]=r[u+2];r[r.length-2]=0,r[r.length-1]=0,a--}else a++;r[a]=1,n=!n}return null}},{key:"_findStart",value:function(){for(var t=0,e=this._nextSet(this._row),n=null,i=1;!n;){if(!(n=this._findPattern(this.START_PATTERN,e,!1,!0)))return null;if(i=Math.floor((n.end-n.start)/4),(t=n.start-10*i)>=0&&this._matchRange(t,n.start,0))return n;e=n.end,n=null}return null}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(){this._row.reverse();var t=this._findPattern(this.STOP_PATTERN);if(this._row.reverse(),null===t)return null;var e=t.start;return t.start=this._row.length-t.end,t.end=this._row.length-e,null!==t?this._verifyTrailingWhitespace(t):null}},{key:"_decodePair",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=this._decodeCode(t[n]);if(!i)return null;e.push(i)}return e}},{key:"_decodeCode",value:function(t){for(var e=this.AVG_CODE_ERROR,n={error:Number.MAX_VALUE,code:-1,start:0,end:0},i=0;i<this.CODE_PATTERN.length;i++){var r=this._matchPattern(t,this.CODE_PATTERN[i]);r<n.error&&(n.code=i,n.error=r)}return n.error<e?n:null}},{key:"_decodePayload",value:function(t,e,n){for(var i=0,r=t.length,a=[[0,0,0,0,0],[0,0,0,0,0]],s=null;i<r;){for(var o=0;o<5;o++)a[0][o]=t[i]*this.barSpaceRatio[0],a[1][o]=t[i+1]*this.barSpaceRatio[1],i+=2;if(!(s=this._decodePair(a)))return null;for(var c=0;c<s.length;c++)e.push(s[c].code+""),n.push(s[c])}return s}},{key:"_verifyCounterLength",value:function(t){return t.length%10==0}},{key:"decode",value:function(t,e){var n=new Array,i=new Array,r=this._findStart();if(!r)return null;i.push(r);var a=this._findEnd();if(!a)return null;var s=this._fillCounters(r.end,a.start,!1);return this._verifyCounterLength(s)&&this._decodePayload(s,n,i)?n.length%2!=0||n.length<6?null:(i.push(a),{code:n.join(""),start:r.start,end:a.end,startInfo:r,decodedCodes:i,format:this.FORMAT}):null}}]),n}(R);function gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var mt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"CODE_FREQUENCY",[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]),C()(b()(t),"STOP_PATTERN",[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]),C()(b()(t),"FORMAT","upc_e"),t}return v()(n,[{key:"_decodePayload",value:function(t,e,n){for(var i=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t),r=0,a=0;a<6;a++){if(!(i=this._decodeCode(i.end)))return null;i.code>=10&&(i.code=i.code-10,r|=1<<5-a),e.push(i.code),n.push(i)}return this._determineParity(r,e)?i:null}},{key:"_determineParity",value:function(t,e){for(var n=0;n<this.CODE_FREQUENCY.length;n++)for(var i=0;i<this.CODE_FREQUENCY[n].length;i++)if(t===this.CODE_FREQUENCY[n][i])return e.unshift(n),e.push(i),!0;return!1}},{key:"_convertToUPCA",value:function(t){var e=[t[0]],n=t[t.length-2];return(e=n<=2?e.concat(t.slice(1,3)).concat([n,0,0,0,0]).concat(t.slice(3,6)):3===n?e.concat(t.slice(1,4)).concat([0,0,0,0,0]).concat(t.slice(4,6)):4===n?e.concat(t.slice(1,5)).concat([0,0,0,0,0,t[5]]):e.concat(t.slice(1,6)).concat([0,0,0,0,n])).push(t[t.length-1]),e}},{key:"_checksum",value:function(t){return z()(T()(n.prototype),"_checksum",this).call(this,this._convertToUPCA(t))}},{key:"_findEnd",value:function(t,e){return z()(T()(n.prototype),"_findEnd",this).call(this,t,!0)}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}}]),n}(lt);var vt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(){var t;g()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r)),C()(b()(t),"FORMAT","upc_a"),t}return v()(n,[{key:"decode",value:function(t,e){var n=lt.prototype.decode.call(this);return n&&n.code&&13===n.code.length&&"0"===n.code.charAt(0)?(n.code=n.code.substring(1),n):null}}]),n}(lt),yt={},bt=1,wt=-1;yt.getBarcodeLine=function(t,e,n){var i,r,a,s,o,c=0|e.x,l=0|e.y,h=0|n.x,u=0|n.y,f=Math.abs(u-l)>Math.abs(h-c),d=[],p=t.data,g=t.size.x,m=255,v=0;function y(t,e){o=p[e*g+t],m=o<m?o:m,v=o>v?o:v,d.push(o)}f&&(a=c,c=l,l=a,a=h,h=u,u=a),c>h&&(a=c,c=h,h=a,a=l,l=u,u=a);var b=h-c,w=Math.abs(u-l);i=b/2|0,r=l;var _=l<u?1:-1;for(s=c;s<h;s++)f?y(r,s):y(s,r),(i-=w)<0&&(r+=_,i+=b);return{line:d,min:m,max:v}},yt.toBinaryLine=function(t){var e,n,i,r,a,s,o=t.min,c=t.max,l=t.line,h=o+(c-o)/2,u=[],f=(c-o)/12,d=-f;for(i=l[0]>h?bt:wt,u.push({pos:0,val:l[0]}),a=0;a<l.length-2;a++)i!==(r=(e=l[a+1]-l[a])+(n=l[a+2]-l[a+1])<d&&l[a+1]<1.5*h?wt:e+n>f&&l[a+1]>.5*h?bt:i)&&(u.push({pos:a,val:l[a]}),i=r);for(u.push({pos:l.length,val:l[l.length-1]}),s=u[0].pos;s<u[1].pos;s++)l[s]=l[s]>h?0:1;for(a=1;a<u.length-1;a++)for(f=u[a+1].val>u[a].val?u[a].val+(u[a+1].val-u[a].val)/3*2|0:u[a+1].val+(u[a].val-u[a+1].val)/3|0,s=u[a].pos;s<u[a+1].pos;s++)l[s]=l[s]>f?0:1;return{line:l,threshold:f}},yt.debug={printFrequency:function(t,e){var n,i=e.getContext("2d");for(e.width=t.length,e.height=256,i.beginPath(),i.strokeStyle="blue",n=0;n<t.length;n++)i.moveTo(n,255),i.lineTo(n,255-t[n]);i.stroke(),i.closePath()},printPattern:function(t,e){var n,i=e.getContext("2d");for(e.width=t.length,i.fillColor="black",n=0;n<t.length;n++)1===t[n]&&i.fillRect(n,0,1,100)}};var _t=yt;function At(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Et={code_128_reader:B,ean_reader:lt,ean_5_reader:ft,ean_2_reader:ht,ean_8_reader:dt,code_39_reader:W,code_39_vin_reader:J,codabar_reader:j,upc_reader:vt,upc_e_reader:mt,i2of5_reader:pt,"2of5_reader":N,code_93_reader:et,code_32_reader:X},Tt={registerReader:function(t,e){Et[t]=e},create:function(t,e){var n=[];function i(){t.readers.forEach((function(t){var e,i={},r=[];"object"===a()(t)?(e=t.format,i=t.config):"string"==typeof t&&(e=t),i.supplements&&(r=i.supplements.map((function(t){return new Et[t]})));try{var s=new Et[e](i,r);n.push(s)}catch(t){throw console.error("* Error constructing reader ",e,t),t}}))}function r(t){var i,r=null,a=_t.getBarcodeLine(e,t[0],t[1]);for(_t.toBinaryLine(a),i=0;i<n.length&&null===r;i++)r=n[i].decodePattern(a.line);return null===r?null:{codeResult:r,barcodeLine:a}}function s(t){return o.apply(this,arguments)}function o(){return(o=h()(f.a.mark((function t(e){var i,r,a,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=null,r=At(n),t.prev=2,r.s();case 4:if((a=r.n()).done){t.next=14;break}if(!(s=a.value).decodeImage){t.next=12;break}return t.next=9,s.decodeImage(e);case 9:if(!(i=t.sent)){t.next=12;break}return t.abrupt("break",14);case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(2),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:return t.abrupt("return",i);case 23:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})))).apply(this,arguments)}function c(t){var n,i,a=function(t){return Math.sqrt(Math.pow(Math.abs(t[1].y-t[0].y),2)+Math.pow(Math.abs(t[1].x-t[0].x),2))}(n=function(t){return[{x:(t[1][0]-t[0][0])/2+t[0][0],y:(t[1][1]-t[0][1])/2+t[0][1]},{x:(t[3][0]-t[2][0])/2+t[2][0],y:(t[3][1]-t[2][1])/2+t[2][1]}]}(t)),s=Math.atan2(n[1].y-n[0].y,n[1].x-n[0].x);return null===(n=function(t,n,i){function r(e){var i=e*Math.sin(n),r=e*Math.cos(n);t[0].y-=i,t[0].x-=r,t[1].y+=i,t[1].x+=r}for(r(i);i>1&&(!e.inImageWithBorder(t[0])||!e.inImageWithBorder(t[1]));)r(-(i-=Math.ceil(i/2)));return t}(n,s,Math.floor(.1*a)))?null:(null===(i=r(n))&&(i=function(t,e,n){var i,a,s,o=Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2)),c=null,l=Math.sin(n),h=Math.cos(n);for(i=1;i<16&&null===c;i++)s={y:(a=o/16*i*(i%2==0?-1:1))*l,x:a*h},e[0].y+=s.x,e[0].x-=s.y,e[1].y+=s.x,e[1].x-=s.y,c=r(e);return c}(t,n,s)),null===i?null:{codeResult:i.codeResult,line:n,angle:s,pattern:i.barcodeLine.line,threshold:i.barcodeLine.threshold})}return i(),{decodeFromBoundingBox:function(t){return c(t)},decodeFromBoundingBoxes:function(e){var n,i,r=[],a=t.multiple;for(n=0;n<e.length;n++){var s=e[n];if((i=c(s)||{}).box=s,a)r.push(i);else if(i.codeResult)return i}return{barcodes:r}},decodeFromImage:function(t){return h()(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))()},registerReader:function(t,e){if(Et[t])throw new Error("cannot register existing reader",t);Et[t]=e},setReaders:function(e){t.readers=e,n.length=0,i()}}}},St=function(){var t={};function e(e){return t[e]||(t[e]={subscribers:[]}),t[e]}function n(t,e){t.async?setTimeout((function(){t.callback(e)}),4):t.callback(e)}function i(t,n,i){var r;if("function"==typeof n)r={callback:n,async:i};else if(!(r=n).callback)throw new Error("Callback was not specified on options");e(t).subscribers.push(r)}return{subscribe:function(t,e,n){return i(t,e,n)},publish:function(t,i){var r=e(t),a=r.subscribers;a.filter((function(t){return!!t.once})).forEach((function(t){n(t,i)})),r.subscribers=a.filter((function(t){return!t.once})),r.subscribers.forEach((function(t){n(t,i)}))},once:function(t,e){i(t,{callback:e,async:arguments.length>2&&void 0!==arguments[2]&&arguments[2],once:!0})},unsubscribe:function(n,i){if(n){var r=e(n);r.subscribers=r&&i?r.subscribers.filter((function(t){return t.callback!==i})):[]}else t={}}}}(),Ct=n(63),kt=n.n(Ct),It=n(64);var Rt,Mt=function(t){_()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=T()(t);if(e){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x()(this,n)}}(n);function n(t,i){var r;return g()(this,n),r=e.call(this,t),C()(b()(r),"code",void 0),r.code=i,Object.setPrototypeOf(b()(r),n.prototype),r}return v()(n)}(n.n(It)()(Error)),Pt="This may mean that the user has declined camera access, or the browser does not support media APIs. If you are running in iOS, you must use Safari.";function Dt(){try{return navigator.mediaDevices.enumerateDevices()}catch(e){var t=new Mt("enumerateDevices is not defined. ".concat(Pt),-1);return Promise.reject(t)}}function Ot(t){try{return navigator.mediaDevices.getUserMedia(t)}catch(t){var e=new Mt("getUserMedia is not defined. ".concat(Pt),-1);return Promise.reject(e)}}function Nt(t){return new Promise((function(e,n){var i=10;!function r(){i>0?t.videoWidth>10&&t.videoHeight>10?e():window.setTimeout(r,500):n(new Mt("Unable to play video stream. Is webcam working?",-1)),i--}()}))}function Lt(t,e){return Ft.apply(this,arguments)}function Ft(){return(Ft=h()(f.a.mark((function t(e,n){var i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ot(n);case 2:if(i=t.sent,Rt=i,!e){t.next=11;break}return e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e.srcObject=i,e.addEventListener("loadedmetadata",(function(){e.play().catch((function(t){console.warn("* Error while trying to play video stream:",t)}))})),t.abrupt("return",Nt(e));case 11:return t.abrupt("return",Promise.resolve());case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ut(){var t=function(t){var e=kt()(t,["width","height","facingMode","aspectRatio","deviceId"]);return void 0!==t.minAspectRatio&&t.minAspectRatio>0&&(e.aspectRatio=t.minAspectRatio,console.log("WARNING: Constraint 'minAspectRatio' is deprecated; Use 'aspectRatio' instead")),void 0!==t.facing&&(e.facingMode=t.facing,console.log("WARNING: Constraint 'facing' is deprecated. Use 'facingMode' instead'")),e}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return t&&t.deviceId&&t.facingMode&&delete t.facingMode,Promise.resolve({audio:!1,video:t})}function jt(){return(jt=h()(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Dt();case 2:return e=t.sent,t.abrupt("return",e.filter((function(t){return"videoinput"===t.kind})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Bt(){if(!Rt)return null;var t=Rt.getVideoTracks();return t&&null!=t&&t.length?t[0]:null}var Vt={requestedVideoElement:null,request:function(t,e){return h()(f.a.mark((function n(){var i;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Vt.requestedVideoElement=t,n.next=3,Ut(e);case 3:return i=n.sent,n.abrupt("return",Lt(t,i));case 5:case"end":return n.stop()}}),n)})))()},release:function(){var t=Rt&&Rt.getVideoTracks();return null!==Vt.requestedVideoElement&&Vt.requestedVideoElement.pause(),new Promise((function(e){setTimeout((function(){t&&t.length&&t.forEach((function(t){return t.stop()})),Rt=null,Vt.requestedVideoElement=null,e()}),0)}))},enumerateVideoDevices:function(){return jt.apply(this,arguments)},getActiveStreamLabel:function(){var t=Bt();return t?t.label:""},getActiveTrack:Bt,disableTorch:function(){return h()(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=Bt())){t.next=11;break}return t.prev=2,t.next=5,e.applyConstraints({advanced:[{torch:!1}]});case 5:t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(2),t.t0 instanceof OverconstrainedError&&console.warn("quagga2/CameraAccess: Torch not supported on this device"),t.t0;case 11:case"end":return t.stop()}}),t,null,[[2,7]])})))()},enableTorch:function(){return h()(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=Bt())){t.next=11;break}return t.prev=2,t.next=5,e.applyConstraints({advanced:[{torch:!0}]});case 5:t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(2),t.t0 instanceof OverconstrainedError&&console.warn("quagga2/CameraAccess: Torch not supported on this device"),t.t0;case 11:case"end":return t.stop()}}),t,null,[[2,7]])})))()}},zt=Vt,qt={create:function(t){var e,n=document.createElement("canvas"),i=n.getContext("2d",{willReadFrequently:!!t.willReadFrequently}),r=[],a=null!==(e=t.capacity)&&void 0!==e?e:20,s=!0===t.capture;function o(e){return!!a&&e&&!function(t,e){return e&&e.some((function(e){return Object.keys(e).every((function(n){return e[n]===t[n]}))}))}(e,t.blacklist)&&function(t,e){return"function"!=typeof e||e(t)}(e,t.filter)}return{addResult:function(t,e,c){var l={};o(c)&&(a--,l.codeResult=c,s&&(n.width=e.x,n.height=e.y,d.a.drawImage(t,e,i),l.frame=n.toDataURL()),r.push(l))},getResults:function(){return r}}}},Ht={inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,facingMode:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},locate:!0,numOfWorkers:4,decoder:{readers:["code_128_reader"]},locator:{halfSample:!0,patchSize:"medium"}},$t=n(5),Gt=n(10),Wt=Math.PI/180,Kt={create:function(t,e){var n,i={},r=t.getConfig(),a=(Object(Gt.h)(t.getRealWidth(),t.getRealHeight()),t.getCanvasSize()),s=Object(Gt.h)(t.getWidth(),t.getHeight()),o=t.getTopRight(),c=o.x,l=o.y,h=null,u=null,f=r.willReadFrequently;return(n=e||document.createElement("canvas")).width=a.x,n.height=a.y,console.warn("*** frame_grabber_browser: willReadFrequently=",f,"canvas=",n),h=n.getContext("2d",{willReadFrequently:!!f}),u=new Uint8Array(s.x*s.y),i.attachData=function(t){u=t},i.getData=function(){return u},i.grab=function(){var e,i=r.halfSample,o=t.getFrame(),f=o,d=0;if(f){if(function(t,e){t.width!==e.x&&(t.width=e.x),t.height!==e.y&&(t.height=e.y)}(n,a),"ImageStream"===r.type&&(f=o.img,o.tags&&o.tags.orientation))switch(o.tags.orientation){case 6:d=90*Wt;break;case 8:d=-90*Wt}return 0!==d?(h.translate(a.x/2,a.y/2),h.rotate(d),h.drawImage(f,-a.y/2,-a.x/2,a.y,a.x),h.rotate(-d),h.translate(-a.x/2,-a.y/2)):h.drawImage(f,0,0,a.x,a.y),e=h.getImageData(c,l,s.x,s.y).data,i?Object(Gt.e)(e,s,u):Object(Gt.c)(e,u,r),!0}return!1},i.getSize=function(){return s},i}},Xt=Kt,Yt={274:"orientation"},Qt=Object.keys(Yt).map((function(t){return Yt[t]}));function Jt(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){return e(t.target.result)},n.readAsArrayBuffer(t)}))}function Zt(t,e,n){if("Exif"!==function(t,e){for(var n="",i=e;i<e+4;i++)n+=String.fromCharCode(t.getUint8(i));return n}(t,e))return!1;var i,r=e+6;if(18761===t.getUint16(r))i=!1;else{if(19789!==t.getUint16(r))return!1;i=!0}if(42!==t.getUint16(r+2,!i))return!1;var a=t.getUint32(r+4,!i);return!(a<8)&&function(t,e,n,i,r){for(var a=t.getUint16(n,!r),s={},o=0;o<a;o++){var c=n+12*o+2,l=i[t.getUint16(c,!r)];l&&(s[l]=te(t,c,0,0,r))}return s}(t,0,r+a,n,i)}function te(t,e,n,i,r){var a=t.getUint16(e+2,!r),s=t.getUint32(e+4,!r);return 3===a&&1===s?t.getUint16(e+8,!r):null}var ee={};function ne(t,e){t.onload=function(){e.loaded(this)}}ee.load=function(t,e,n,i,r){var a,s,o,c=new Array(i),l=new Array(c.length);if(!1===r)c[0]=t;else for(a=0;a<c.length;a++)o=n+a,c[a]="".concat(t,"image-").concat("00".concat(o).slice(-3),".jpg");for(l.notLoaded=[],l.addImage=function(t){l.notLoaded.push(t)},l.loaded=function(n){for(var i=l.notLoaded,a=0;a<i.length;a++)if(i[a]===n){i.splice(a,1);for(var s=0;s<c.length;s++){var o=c[s].substr(c[s].lastIndexOf("/"));if(-1!==n.src.lastIndexOf(o)){l[s]={img:n};break}}break}0===i.length&&(!1===r?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt;return/^blob:/i.test(t)?function(t){return new Promise((function(e,n){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onreadystatechange=function(){i.readyState!==XMLHttpRequest.DONE||200!==i.status&&0!==i.status||e(this.response)},i.onerror=n,i.send()}))}(t).then(Jt).then((function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt,n=new DataView(t),i=t.byteLength,r=e.reduce((function(t,e){var n=Object.keys(Yt).filter((function(t){return Yt[t]===e}))[0];return n&&(t[n]=e),t}),{}),a=2;if(255!==n.getUint8(0)||216!==n.getUint8(1))return!1;for(;a<i;){if(255!==n.getUint8(a))return!1;if(225===n.getUint8(a+1))return Zt(n,a+4,r);a+=2+n.getUint16(a+2)}return!1}(t,e)})):Promise.resolve(null)}(t,["orientation"]).then((function(t){l[0].tags=t,e(l)})).catch((function(t){console.log(t),e(l)})):e(l))},a=0;a<c.length;a++)s=new Image,l.addImage(s),ne(s,l),s.src=c[a]};var ie=ee,re={createVideoStream:function(t){console.warn("**** InputStreamBrowser createVideoStream");var e,n,i=null,r=["canrecord","ended"],a={},s={x:0,y:0,type:"Point"},o={x:0,y:0,type:"XYSize"},c={getRealWidth:function(){return t.videoWidth},getRealHeight:function(){return t.videoHeight},getWidth:function(){return e},getHeight:function(){return n},setWidth:function(t){e=t},setHeight:function(t){n=t},setInputStream:function(t){i=t,this.setAttribute("src",void 0!==t.src?t.src:"")},ended:function(){return t.ended},getConfig:function(){return i},setAttribute:function(e,n){t&&t.setAttribute(e,n)},pause:function(){t.pause()},play:function(){t.play()},setCurrentTime:function(t){var e;"LiveStream"!==(null===(e=i)||void 0===e?void 0:e.type)&&this.setAttribute("currentTime",t.toString())},addEventListener:function(e,n,i){-1!==r.indexOf(e)?(a[e]||(a[e]=[]),a[e].push(n)):t.addEventListener(e,n,i)},clearEventHandlers:function(){r.forEach((function(e){var n=a[e];n&&n.length>0&&n.forEach((function(n){t.removeEventListener(e,n)}))}))},trigger:function(r,s){var l,h,u,f,d,p=a[r];if("canrecord"===r&&(f=t.videoWidth,d=t.videoHeight,e=null!==(h=i)&&void 0!==h&&h.size?f/d>1?i.size:Math.floor(f/d*i.size):f,n=null!==(u=i)&&void 0!==u&&u.size?f/d>1?Math.floor(d/f*i.size):i.size:d,o.x=e,o.y=n),p&&p.length>0)for(l=0;l<p.length;l++)p[l].apply(c,s)},setTopRight:function(t){s.x=t.x,s.y=t.y},getTopRight:function(){return s},setCanvasSize:function(t){o.x=t.x,o.y=t.y},getCanvasSize:function(){return o},getFrame:function(){return t}};return c},createLiveStream:function(t){console.warn("**** InputStreamBrowser createLiveStream"),t&&t.setAttribute("autoplay","true");var e=re.createVideoStream(t);return e.ended=function(){return!1},e},createImageStream:function(){var t,e,n=null,i=0,r=0,a=0,s=!0,o=!1,c=null,l=0,h=null,u=!1,f=["canrecord","ended"],d={},p={x:0,y:0,type:"Point"},g={x:0,y:0,type:"XYSize"};function m(t,e){var n,i=d[t];if(i&&i.length>0)for(n=0;n<i.length;n++)i[n].apply(v,e)}var v={trigger:m,getWidth:function(){return t},getHeight:function(){return e},setWidth:function(e){t=e},setHeight:function(t){e=t},getRealWidth:function(){return i},getRealHeight:function(){return r},setInputStream:function(s){var u;n=s,!1===s.sequence?(h=s.src,l=1):(h=s.src,l=s.length),o=!1,ie.load(h,(function(s){var l,h;if(c=s,s[0].tags&&s[0].tags.orientation)switch(s[0].tags.orientation){case 6:case 8:i=s[0].img.height,r=s[0].img.width;break;default:i=s[0].img.width,r=s[0].img.height}else i=s[0].img.width,r=s[0].img.height;t=null!==(l=n)&&void 0!==l&&l.size?i/r>1?n.size:Math.floor(i/r*n.size):i,e=null!==(h=n)&&void 0!==h&&h.size?i/r>1?Math.floor(r/i*n.size):n.size:r,g.x=t,g.y=e,o=!0,a=0,setTimeout((function(){m("canrecord",[])}),0)}),1,l,null===(u=n)||void 0===u?void 0:u.sequence)},ended:function(){return u},setAttribute:function(){},getConfig:function(){return n},pause:function(){s=!0},play:function(){s=!1},setCurrentTime:function(t){a=t},addEventListener:function(t,e){-1!==f.indexOf(t)&&(d[t]||(d[t]=[]),d[t].push(e))},clearEventHandlers:function(){Object.keys(d).forEach((function(t){return delete d[t]}))},setTopRight:function(t){p.x=t.x,p.y=t.y},getTopRight:function(){return p},setCanvasSize:function(t){g.x=t.x,g.y=t.y},getCanvasSize:function(){return g},getFrame:function(){var t,e;return o?(s||(t=null===(e=c)||void 0===e?void 0:e[a],a<l-1?a++:setTimeout((function(){u=!0,m("ended",[])}),0)),t):null}};return v}},ae=re,se=n(23),oe=v()((function t(){g()(this,t),C()(this,"config",void 0),C()(this,"inputStream",void 0),C()(this,"framegrabber",void 0),C()(this,"inputImageWrapper",void 0),C()(this,"stopped",!1),C()(this,"boxSize",void 0),C()(this,"resultCollector",void 0),C()(this,"decoder",void 0),C()(this,"workerPool",[]),C()(this,"onUIThread",!0),C()(this,"canvasContainer",new le)})),ce=v()((function t(){g()(this,t),C()(this,"image",void 0),C()(this,"overlay",void 0)})),le=v()((function t(){g()(this,t),C()(this,"ctx",void 0),C()(this,"dom",void 0),this.ctx=new ce,this.dom=new ce}));function he(t){if("undefined"==typeof document)return null;if(t instanceof HTMLElement&&t.nodeName&&1===t.nodeType)return t;var e="string"==typeof t?t:"#interactive.viewport";return document.querySelector(e)}function ue(t,e,n){var i=function(t,e){var n=document.querySelector(t);return n||((n=document.createElement("canvas")).className=e),n}(t,e);console.warn("* initCanvas getCanvasAndContext");var r=i.getContext("2d",{willReadFrequently:n.willReadFrequently});return{canvas:i,context:r}}function fe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fe(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}$t.a.setMatrixArrayType(Array);var pe=[];function ge(t){return de(de({},t),{},{inputStream:de(de({},t.inputStream),{},{target:null})})}function me(t){if(t){var e=t().default;if(!e)return void self.postMessage({event:"error",message:"Quagga could not be created"})}var n;function i(t){self.postMessage({event:"processed",imageData:n.data,result:t},[n.data.buffer])}function r(){self.postMessage({event:"initialized",imageData:n.data},[n.data.buffer])}self.onmessage=function(t){if("init"===t.data.cmd){var a=t.data.config;a.numOfWorkers=0,n=new e.ImageWrapper({x:t.data.size.x,y:t.data.size.y},new Uint8Array(t.data.imageData)),e.init(a,r,n),e.onProcessed(i)}else"process"===t.data.cmd?(n.data=new Uint8Array(t.data.imageData),e.start()):"setReaders"===t.data.cmd?e.setReaders(t.data.readers):"registerReader"===t.data.cmd&&e.registerReader(t.data.name,t.data.reader)}}function ve(t,e,n){var i,r,a=("undefined"!=typeof __factorySource__&&(r=__factorySource__),i=new Blob(["("+me.toString()+")("+r+");"],{type:"text/javascript"}),window.URL.createObjectURL(i)),s={worker:new Worker(a),imageData:new Uint8Array(e.getWidth()*e.getHeight()),busy:!0};s.worker.onmessage=function(t){"initialized"===t.data.event?(URL.revokeObjectURL(a),s.busy=!1,s.imageData=new Uint8Array(t.data.imageData),n(s)):"processed"===t.data.event?(s.imageData=new Uint8Array(t.data.imageData),s.busy=!1,"undefined"!=typeof publishResult&&publishResult(t.data.result,s.imageData)):t.data.event},s.worker.postMessage({cmd:"init",size:{x:e.getWidth(),y:e.getHeight()},imageData:s.imageData,config:ge(t)},[s.imageData.buffer])}function ye(t,e,n,i){var r=t-pe.length;if(0===r&&i)i();else if(r<0)pe.slice(r).forEach((function(t){t.worker.terminate()})),pe=pe.slice(0,r),i&&i();else{var a=function(e){pe.push(e),pe.length>=t&&i&&i()};if(e)for(var s=0;s<r;s++)ve(e,n,a)}}function be(t,e,n){for(var i=t.length;i--;)t[i][0]+=e,t[i][1]+=n}$t.a.setMatrixArrayType(Array);var we=function(){function t(){var e=this;g()(this,t),C()(this,"context",new oe),C()(this,"canRecord",(function(t){var n;e.context.config&&(se.a.checkImageConstraints(e.context.inputStream,null===(n=e.context.config)||void 0===n?void 0:n.locator),e.initCanvas(),e.context.framegrabber=Xt.create(e.context.inputStream,e.context.canvasContainer.dom.image),void 0===e.context.config.numOfWorkers&&(e.context.config.numOfWorkers=0),ye(e.context.config.numOfWorkers,e.context.config,e.context.inputStream,(function(){var n;0===(null===(n=e.context.config)||void 0===n?void 0:n.numOfWorkers)&&e.initializeData(),e.ready(t)})))})),C()(this,"update",(function(){if(e.context.onUIThread){var t,n=(r=e.context.framegrabber,pe.length?!!(a=pe.filter((function(t){return!t.busy}))[0])&&(r.attachData(a.imageData),r.grab()&&(a.busy=!0,a.worker.postMessage({cmd:"process",imageData:a.imageData},[a.imageData.buffer])),!0):null);n||(e.context.framegrabber.attachData(null===(t=e.context.inputImageWrapper)||void 0===t?void 0:t.data),e.context.framegrabber.grab()&&(n||e.locateAndDecode()))}else{var i;e.context.framegrabber.attachData(null===(i=e.context.inputImageWrapper)||void 0===i?void 0:i.data),e.context.framegrabber.grab(),e.locateAndDecode()}var r,a}))}var e,n;return v()(t,[{key:"initBuffers",value:function(t){if(this.context.config){var e=function(t,e,n){var i=e||new c.a({x:t.getWidth(),y:t.getHeight(),type:"XYSize"}),r=[$t.c.clone([0,0]),$t.c.clone([0,i.size.y]),$t.c.clone([i.size.x,i.size.y]),$t.c.clone([i.size.x,0])];return se.a.init(i,n),{inputImageWrapper:i,boxSize:r}}(this.context.inputStream,t,this.context.config.locator),n=e.inputImageWrapper,i=e.boxSize;this.context.inputImageWrapper=n,this.context.boxSize=i}}},{key:"initializeData",value:function(t){this.context.config&&(this.initBuffers(t),this.context.decoder=Tt.create(this.context.config.decoder,this.context.inputImageWrapper))}},{key:"getViewPort",value:function(){return this.context.config&&this.context.config.inputStream?he(this.context.config.inputStream.target):null}},{key:"ready",value:function(t){this.context.inputStream.play(),t()}},{key:"initCanvas",value:function(){var t=function(t){var e,n,i,r,a,s,o=he(null==t||null===(e=t.config)||void 0===e||null===(n=e.inputStream)||void 0===n?void 0:n.target),c=null==t||null===(i=t.config)||void 0===i||null===(r=i.inputStream)||void 0===r?void 0:r.type;if(!c)return null;var l=function(t,e){var n=e.willReadFrequently;if("undefined"!=typeof document){var i=ue("canvas.imgBuffer","imgBuffer",{willReadFrequently:n}),r=ue("canvas.drawingBuffer","drawingBuffer",{willReadFrequently:n});return i.canvas.width=r.canvas.width=t.x,i.canvas.height=r.canvas.height=t.y,{dom:{image:i.canvas,overlay:r.canvas},ctx:{image:i.context,overlay:r.context}}}return null}(t.inputStream.getCanvasSize(),{willReadFrequently:!(null==t||null===(a=t.config)||void 0===a||null===(s=a.inputStream)||void 0===s||!s.willReadFrequently)});if(!l)return{dom:{image:null,overlay:null},ctx:{image:null,overlay:null}};var h=l.dom;return"undefined"!=typeof document&&o&&("ImageStream"!==c||o.contains(h.image)||o.appendChild(h.image),o.contains(h.overlay)||o.appendChild(h.overlay)),l}(this.context);if(t){var e=t.ctx,n=t.dom;this.context.canvasContainer.dom.image=n.image,this.context.canvasContainer.dom.overlay=n.overlay,this.context.canvasContainer.ctx.image=e.image,this.context.canvasContainer.ctx.overlay=e.overlay}}},{key:"initInputStream",value:function(t){if(this.context.config&&this.context.config.inputStream){var e=this.context.config.inputStream,n=e.type,i=e.constraints,r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LiveStream",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;switch(t){case"VideoStream":var i=document.createElement("video");return{video:i,inputStream:n.createVideoStream(i)};case"ImageStream":return{inputStream:n.createImageStream()};case"LiveStream":var r=null;return e&&((r=e.querySelector("video"))||(r=document.createElement("video"),e.appendChild(r))),{video:r,inputStream:n.createLiveStream(r)};default:return console.error("* setupInputStream invalid type ".concat(t)),{video:null,inputStream:null}}}(n,this.getViewPort(),ae),a=r.video,s=r.inputStream;"LiveStream"===n&&a&&zt.request(a,i).then((function(){return s.trigger("canrecord")})).catch((function(e){return t(e)})),s&&(s.setAttribute("preload","auto"),s.setInputStream(this.context.config.inputStream),s.addEventListener("canrecord",this.canRecord.bind(void 0,t))),this.context.inputStream=s}}},{key:"getBoundingBoxes",value:function(){var t;return null!==(t=this.context.config)&&void 0!==t&&t.locate?se.a.locate():[[$t.c.clone(this.context.boxSize[0]),$t.c.clone(this.context.boxSize[1]),$t.c.clone(this.context.boxSize[2]),$t.c.clone(this.context.boxSize[3])]]}},{key:"transformResult",value:function(t){var e=this,n=this.context.inputStream.getTopRight(),i=n.x,r=n.y;if((0!==i||0!==r)&&(t.barcodes&&t.barcodes.forEach((function(t){return e.transformResult(t)})),t.line&&2===t.line.length&&function(t,e,n){t[0].x+=e,t[0].y+=n,t[1].x+=e,t[1].y+=n}(t.line,i,r),t.box&&be(t.box,i,r),t.boxes&&t.boxes.length>0))for(var a=0;a<t.boxes.length;a++)be(t.boxes[a],i,r)}},{key:"addResult",value:function(t,e){var n=this;e&&this.context.resultCollector&&(t.barcodes?t.barcodes.filter((function(t){return t.codeResult})).forEach((function(t){return n.addResult(t,e)})):t.codeResult&&this.context.resultCollector.addResult(e,this.context.inputStream.getCanvasSize(),t.codeResult))}},{key:"hasCodeResult",value:function(t){return!(!t||!(t.barcodes?t.barcodes.some((function(t){return t.codeResult})):t.codeResult))}},{key:"publishResult",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=e;e&&this.context.onUIThread&&(this.transformResult(e),this.addResult(e,n),i=(null==e||null===(t=e.barcodes)||void 0===t?void 0:t.length)>0?e.barcodes:e),St.publish("processed",i),this.hasCodeResult(e)&&St.publish("detected",i)}},{key:"locateAndDecode",value:(n=h()(f.a.mark((function t(){var e,n,i,r,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.getBoundingBoxes())){t.next=12;break}return t.next=4,this.context.decoder.decodeFromBoundingBoxes(e);case 4:if(t.t0=t.sent,t.t0){t.next=7;break}t.t0={};case 7:(i=t.t0).boxes=e,this.publishResult(i,null===(n=this.context.inputImageWrapper)||void 0===n?void 0:n.data),t.next=16;break;case 12:return t.next=14,this.context.decoder.decodeFromImage(this.context.inputImageWrapper);case 14:(r=t.sent)?this.publishResult(r,null===(a=this.context.inputImageWrapper)||void 0===a?void 0:a.data):this.publishResult();case 16:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"startContinuousUpdate",value:function(){var t,e=this,n=null,i=1e3/((null===(t=this.context.config)||void 0===t?void 0:t.frequency)||60);this.context.stopped=!1;var r=this.context;!function t(a){n=n||a,r.stopped||(a>=n&&(n+=i,e.update()),window.requestAnimationFrame(t))}(performance.now())}},{key:"start",value:function(){var t,e;this.context.onUIThread&&"LiveStream"===(null===(t=this.context.config)||void 0===t||null===(e=t.inputStream)||void 0===e?void 0:e.type)?this.startContinuousUpdate():this.update()}},{key:"stop",value:(e=h()(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.context.stopped=!0,ye(0),null===(e=this.context.config)||void 0===e||!e.inputStream||"LiveStream"!==this.context.config.inputStream.type){t.next=6;break}return t.next=5,zt.release();case 5:this.context.inputStream.clearEventHandlers();case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"setReaders",value:function(t){this.context.decoder&&this.context.decoder.setReaders(t),function(t){pe.forEach((function(e){return e.worker.postMessage({cmd:"setReaders",readers:t})}))}(t)}},{key:"registerReader",value:function(t,e){Tt.registerReader(t,e),this.context.decoder&&this.context.decoder.registerReader(t,e),function(t,e){pe.forEach((function(n){return n.worker.postMessage({cmd:"registerReader",name:t,reader:e})}))}(t,e)}}]),t}(),_e=new we,Ae=_e.context,xe={init:function(t,e,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_e;return e||(i=new Promise((function(t,n){e=function(e){e?n(e):t()}}))),r.context.config=o()({},Ht,t),r.context.config.numOfWorkers>0&&(r.context.config.numOfWorkers=0),n?(r.context.onUIThread=!1,r.initializeData(n),e&&e()):r.initInputStream(e),i},start:function(){return _e.start()},stop:function(){return _e.stop()},pause:function(){Ae.stopped=!0},onDetected:function(t){t&&("function"==typeof t||"object"===a()(t)&&t.callback)?St.subscribe("detected",t):console.trace("* warning: Quagga.onDetected called with invalid callback, ignoring")},offDetected:function(t){St.unsubscribe("detected",t)},onProcessed:function(t){t&&("function"==typeof t||"object"===a()(t)&&t.callback)?St.subscribe("processed",t):console.trace("* warning: Quagga.onProcessed called with invalid callback, ignoring")},offProcessed:function(t){St.unsubscribe("processed",t)},setReaders:function(t){t?_e.setReaders(t):console.trace("* warning: Quagga.setReaders called with no readers, ignoring")},registerReader:function(t,e){t?e?_e.registerReader(t,e):console.trace("* warning: Quagga.registerReader called with no reader, ignoring"):console.trace("* warning: Quagga.registerReader called with no name, ignoring")},registerResultCollector:function(t){t&&"function"==typeof t.addResult&&(Ae.resultCollector=t)},get canvas(){return Ae.canvasContainer},decodeSingle:function(t,e){var n=this,i=new we;return(t=o()({inputStream:{type:"ImageStream",sequence:!1,size:800,src:t.src},numOfWorkers:1,locator:{halfSample:!1}},t)).numOfWorkers>0&&(t.numOfWorkers=0),t.numOfWorkers>0&&("undefined"==typeof Blob||"undefined"==typeof Worker)&&(console.warn("* no Worker and/or Blob support - forcing numOfWorkers to 0"),t.numOfWorkers=0),new Promise((function(r,a){try{n.init(t,(function(){St.once("processed",(function(t){i.stop(),e&&e.call(null,t),r(t)}),!0),i.start()}),null,i)}catch(t){a(t)}}))},get default(){return xe},Readers:i,CameraAccess:zt,ImageDebug:d.a,ImageWrapper:c.a,ResultCollector:qt};e.default=xe}]).default},6743:(t,e,n)=>{"use strict";n.d(e,{Am:()=>R,FA:()=>T,Fy:()=>p,I9:()=>M,Im:()=>C,Ku:()=>L,T9:()=>u,Tj:()=>l,Uj:()=>s,XA:()=>f,ZQ:()=>g,bD:()=>k,c1:()=>v,cY:()=>d,eX:()=>x,g:()=>E,hp:()=>P,jZ:()=>m,lT:()=>w,lV:()=>b,nr:()=>_,sr:()=>y,tD:()=>D,u:()=>o,yU:()=>h,zW:()=>A});const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],a=e+1<t.length,s=a?t[e+1]:0,o=e+2<t.length,c=o?t[e+2]:0,l=r>>2,h=(3&r)<<4|s>>4;let u=(15&s)<<2|c>>6,f=63&c;o||(f=64,a||(u=64)),i.push(n[l],n[h],n[u],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const a=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&a)}else if(r>239&&r<365){const a=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(1023&a))}else{const a=t[n++],s=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&a)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==c)throw new a;const l=r<<2|s>>4;if(i.push(l),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==c){const t=o<<6&192|c;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class a extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(t){return function(t){const e=i(t);return r.encodeByteArray(e,!0)}(t).replace(/\./g,"")},o=function(t){try{return r.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},c=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&o(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},l=t=>{var e,n;return null===(n=null===(e=c())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},h=t=>{const e=l(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},u=()=>{var t;return null===(t=c())||void 0===t?void 0:t.config},f=t=>{var e;return null===(e=c())||void 0===e?void 0:e[`_${t}`]};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(a)),""].join(".")}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function m(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function v(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function y(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function b(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){const t=g();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _(){return!function(){var t;const e=null===(t=c())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function A(){try{return"object"==typeof indexedDB}catch(t){return!1}}function x(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class E extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],a=r?function(t,e){return t.replace(S,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",s=`${this.serviceName}: ${a} (${i}).`;return new E(i,s,n)}}const S=/\{\$([^}]+)}/g;function C(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function k(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],a=e[r];if(I(n)&&I(a)){if(!k(n,a))return!1}else if(n!==a)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function I(t){return null!==t&&"object"==typeof t}function R(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function M(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function P(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function D(t,e){const n=new O(t,e);return n.subscribe.bind(n)}class O{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=N),void 0===i.error&&(i.error=N),void 0===i.complete&&(i.complete=N);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function N(){}function L(t){return t&&t._delegate?t._delegate:t}},8758:(t,e,n)=>{"use strict";n.d(e,{A:()=>S});var i=n(1601),r=n.n(i),a=n(6314),s=n.n(a),o=n(4417),c=n.n(o),l=new URL(n(2459),n.b),h=new URL(n(4189),n.b),u=new URL(n(3321),n.b),f=new URL(n(2539),n.b),d=new URL(n(3369),n.b),p=new URL(n(651),n.b),g=new URL(n(720),n.b),m=new URL(n(8326),n.b),v=s()(r()),y=c()(l),b=c()(h),w=c()(u),_=c()(f),A=c()(d),x=c()(p),E=c()(g),T=c()(m);v.push([t.id,`/*!\n * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com\n * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)\n * Copyright 2024 Fonticons, Inc.\n */\n.fa{font-family:var(--fa-style-family,"Font Awesome 6 Free");font-weight:var(--fa-style,900)}.fa,.fa-brands,.fa-regular,.fa-solid,.fab,.far,.fas{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:var(--fa-display,inline-block);font-style:normal;font-variant:normal;line-height:1;text-rendering:auto}.fa-brands:before,.fa-regular:before,.fa-solid:before,.fa:before,.fab:before,.far:before,.fas:before{content:var(--fa)}.fa-classic,.fa-regular,.fa-solid,.far,.fas{font-family:"Font Awesome 6 Free"}.fa-brands,.fab{font-family:"Font Awesome 6 Brands"}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-2xs{font-size:.625em;line-height:.1em;vertical-align:.225em}.fa-xs{font-size:.75em;line-height:.08333em;vertical-align:.125em}.fa-sm{font-size:.875em;line-height:.07143em;vertical-align:.05357em}.fa-lg{font-size:1.25em;line-height:.05em;vertical-align:-.075em}.fa-xl{font-size:1.5em;line-height:.04167em;vertical-align:-.125em}.fa-2xl{font-size:2em;line-height:.03125em;vertical-align:-.1875em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:var(--fa-li-margin,2.5em);padding-left:0}.fa-ul>li{position:relative}.fa-li{left:calc(var(--fa-li-width, 2em)*-1);position:absolute;text-align:center;width:var(--fa-li-width,2em);line-height:inherit}.fa-border{border-radius:var(--fa-border-radius,.1em);border:var(--fa-border-width,.08em) var(--fa-border-style,solid) var(--fa-border-color,#eee);padding:var(--fa-border-padding,.2em .25em .15em)}.fa-pull-left{float:left;margin-right:var(--fa-pull-margin,.3em)}.fa-pull-right{float:right;margin-left:var(--fa-pull-margin,.3em)}.fa-beat{animation-name:fa-beat;animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-bounce{animation-name:fa-bounce;animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,cubic-bezier(.28,.84,.42,1))}.fa-fade{animation-name:fa-fade;animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-beat-fade,.fa-fade{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s)}.fa-beat-fade{animation-name:fa-beat-fade;animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-flip{animation-name:fa-flip;animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-shake{animation-name:fa-shake;animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,linear)}.fa-shake,.fa-spin{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal)}.fa-spin{animation-name:fa-spin;animation-duration:var(--fa-animation-duration,2s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,linear)}.fa-spin-reverse{--fa-animation-direction:reverse}.fa-pulse,.fa-spin-pulse{animation-name:fa-spin;animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-timing-function:var(--fa-animation-timing,steps(8))}@media (prefers-reduced-motion:reduce){.fa-beat,.fa-beat-fade,.fa-bounce,.fa-fade,.fa-flip,.fa-pulse,.fa-shake,.fa-spin,.fa-spin-pulse{animation-delay:-1ms;animation-duration:1ms;animation-iteration-count:1;transition-delay:0s;transition-duration:0s}}@keyframes fa-beat{0%,90%{transform:scale(1)}45%{transform:scale(var(--fa-beat-scale,1.25))}}@keyframes fa-bounce{0%{transform:scale(1) translateY(0)}10%{transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0)}30%{transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em))}50%{transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0)}57%{transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em))}64%{transform:scale(1) translateY(0)}to{transform:scale(1) translateY(0)}}@keyframes fa-fade{50%{opacity:var(--fa-fade-opacity,.4)}}@keyframes fa-beat-fade{0%,to{opacity:var(--fa-beat-fade-opacity,.4);transform:scale(1)}50%{opacity:1;transform:scale(var(--fa-beat-fade-scale,1.125))}}@keyframes fa-flip{50%{transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg))}}@keyframes fa-shake{0%{transform:rotate(-15deg)}4%{transform:rotate(15deg)}8%,24%{transform:rotate(-18deg)}12%,28%{transform:rotate(18deg)}16%{transform:rotate(-22deg)}20%{transform:rotate(22deg)}32%{transform:rotate(-12deg)}36%{transform:rotate(12deg)}40%,to{transform:rotate(0deg)}}@keyframes fa-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.fa-rotate-90{transform:rotate(90deg)}.fa-rotate-180{transform:rotate(180deg)}.fa-rotate-270{transform:rotate(270deg)}.fa-flip-horizontal{transform:scaleX(-1)}.fa-flip-vertical{transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{transform:scale(-1)}.fa-rotate-by{transform:rotate(var(--fa-rotate-angle,0))}.fa-stack{display:inline-block;height:2em;line-height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{left:0;position:absolute;text-align:center;width:100%;z-index:var(--fa-stack-z-index,auto)}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:var(--fa-inverse,#fff)}\n\n.fa-0{--fa:"\\30"}.fa-1{--fa:"\\31"}.fa-2{--fa:"\\32"}.fa-3{--fa:"\\33"}.fa-4{--fa:"\\34"}.fa-5{--fa:"\\35"}.fa-6{--fa:"\\36"}.fa-7{--fa:"\\37"}.fa-8{--fa:"\\38"}.fa-9{--fa:"\\39"}.fa-fill-drip{--fa:"\\f576"}.fa-arrows-to-circle{--fa:"\\e4bd"}.fa-chevron-circle-right,.fa-circle-chevron-right{--fa:"\\f138"}.fa-at{--fa:"\\40"}.fa-trash-alt,.fa-trash-can{--fa:"\\f2ed"}.fa-text-height{--fa:"\\f034"}.fa-user-times,.fa-user-xmark{--fa:"\\f235"}.fa-stethoscope{--fa:"\\f0f1"}.fa-comment-alt,.fa-message{--fa:"\\f27a"}.fa-info{--fa:"\\f129"}.fa-compress-alt,.fa-down-left-and-up-right-to-center{--fa:"\\f422"}.fa-explosion{--fa:"\\e4e9"}.fa-file-alt,.fa-file-lines,.fa-file-text{--fa:"\\f15c"}.fa-wave-square{--fa:"\\f83e"}.fa-ring{--fa:"\\f70b"}.fa-building-un{--fa:"\\e4d9"}.fa-dice-three{--fa:"\\f527"}.fa-calendar-alt,.fa-calendar-days{--fa:"\\f073"}.fa-anchor-circle-check{--fa:"\\e4aa"}.fa-building-circle-arrow-right{--fa:"\\e4d1"}.fa-volleyball,.fa-volleyball-ball{--fa:"\\f45f"}.fa-arrows-up-to-line{--fa:"\\e4c2"}.fa-sort-desc,.fa-sort-down{--fa:"\\f0dd"}.fa-circle-minus,.fa-minus-circle{--fa:"\\f056"}.fa-door-open{--fa:"\\f52b"}.fa-right-from-bracket,.fa-sign-out-alt{--fa:"\\f2f5"}.fa-atom{--fa:"\\f5d2"}.fa-soap{--fa:"\\e06e"}.fa-heart-music-camera-bolt,.fa-icons{--fa:"\\f86d"}.fa-microphone-alt-slash,.fa-microphone-lines-slash{--fa:"\\f539"}.fa-bridge-circle-check{--fa:"\\e4c9"}.fa-pump-medical{--fa:"\\e06a"}.fa-fingerprint{--fa:"\\f577"}.fa-hand-point-right{--fa:"\\f0a4"}.fa-magnifying-glass-location,.fa-search-location{--fa:"\\f689"}.fa-forward-step,.fa-step-forward{--fa:"\\f051"}.fa-face-smile-beam,.fa-smile-beam{--fa:"\\f5b8"}.fa-flag-checkered{--fa:"\\f11e"}.fa-football,.fa-football-ball{--fa:"\\f44e"}.fa-school-circle-exclamation{--fa:"\\e56c"}.fa-crop{--fa:"\\f125"}.fa-angle-double-down,.fa-angles-down{--fa:"\\f103"}.fa-users-rectangle{--fa:"\\e594"}.fa-people-roof{--fa:"\\e537"}.fa-people-line{--fa:"\\e534"}.fa-beer,.fa-beer-mug-empty{--fa:"\\f0fc"}.fa-diagram-predecessor{--fa:"\\e477"}.fa-arrow-up-long,.fa-long-arrow-up{--fa:"\\f176"}.fa-burn,.fa-fire-flame-simple{--fa:"\\f46a"}.fa-male,.fa-person{--fa:"\\f183"}.fa-laptop{--fa:"\\f109"}.fa-file-csv{--fa:"\\f6dd"}.fa-menorah{--fa:"\\f676"}.fa-truck-plane{--fa:"\\e58f"}.fa-record-vinyl{--fa:"\\f8d9"}.fa-face-grin-stars,.fa-grin-stars{--fa:"\\f587"}.fa-bong{--fa:"\\f55c"}.fa-pastafarianism,.fa-spaghetti-monster-flying{--fa:"\\f67b"}.fa-arrow-down-up-across-line{--fa:"\\e4af"}.fa-spoon,.fa-utensil-spoon{--fa:"\\f2e5"}.fa-jar-wheat{--fa:"\\e517"}.fa-envelopes-bulk,.fa-mail-bulk{--fa:"\\f674"}.fa-file-circle-exclamation{--fa:"\\e4eb"}.fa-circle-h,.fa-hospital-symbol{--fa:"\\f47e"}.fa-pager{--fa:"\\f815"}.fa-address-book,.fa-contact-book{--fa:"\\f2b9"}.fa-strikethrough{--fa:"\\f0cc"}.fa-k{--fa:"\\4b"}.fa-landmark-flag{--fa:"\\e51c"}.fa-pencil,.fa-pencil-alt{--fa:"\\f303"}.fa-backward{--fa:"\\f04a"}.fa-caret-right{--fa:"\\f0da"}.fa-comments{--fa:"\\f086"}.fa-file-clipboard,.fa-paste{--fa:"\\f0ea"}.fa-code-pull-request{--fa:"\\e13c"}.fa-clipboard-list{--fa:"\\f46d"}.fa-truck-loading,.fa-truck-ramp-box{--fa:"\\f4de"}.fa-user-check{--fa:"\\f4fc"}.fa-vial-virus{--fa:"\\e597"}.fa-sheet-plastic{--fa:"\\e571"}.fa-blog{--fa:"\\f781"}.fa-user-ninja{--fa:"\\f504"}.fa-person-arrow-up-from-line{--fa:"\\e539"}.fa-scroll-torah,.fa-torah{--fa:"\\f6a0"}.fa-broom-ball,.fa-quidditch,.fa-quidditch-broom-ball{--fa:"\\f458"}.fa-toggle-off{--fa:"\\f204"}.fa-archive,.fa-box-archive{--fa:"\\f187"}.fa-person-drowning{--fa:"\\e545"}.fa-arrow-down-9-1,.fa-sort-numeric-desc,.fa-sort-numeric-down-alt{--fa:"\\f886"}.fa-face-grin-tongue-squint,.fa-grin-tongue-squint{--fa:"\\f58a"}.fa-spray-can{--fa:"\\f5bd"}.fa-truck-monster{--fa:"\\f63b"}.fa-w{--fa:"\\57"}.fa-earth-africa,.fa-globe-africa{--fa:"\\f57c"}.fa-rainbow{--fa:"\\f75b"}.fa-circle-notch{--fa:"\\f1ce"}.fa-tablet-alt,.fa-tablet-screen-button{--fa:"\\f3fa"}.fa-paw{--fa:"\\f1b0"}.fa-cloud{--fa:"\\f0c2"}.fa-trowel-bricks{--fa:"\\e58a"}.fa-face-flushed,.fa-flushed{--fa:"\\f579"}.fa-hospital-user{--fa:"\\f80d"}.fa-tent-arrow-left-right{--fa:"\\e57f"}.fa-gavel,.fa-legal{--fa:"\\f0e3"}.fa-binoculars{--fa:"\\f1e5"}.fa-microphone-slash{--fa:"\\f131"}.fa-box-tissue{--fa:"\\e05b"}.fa-motorcycle{--fa:"\\f21c"}.fa-bell-concierge,.fa-concierge-bell{--fa:"\\f562"}.fa-pen-ruler,.fa-pencil-ruler{--fa:"\\f5ae"}.fa-people-arrows,.fa-people-arrows-left-right{--fa:"\\e068"}.fa-mars-and-venus-burst{--fa:"\\e523"}.fa-caret-square-right,.fa-square-caret-right{--fa:"\\f152"}.fa-cut,.fa-scissors{--fa:"\\f0c4"}.fa-sun-plant-wilt{--fa:"\\e57a"}.fa-toilets-portable{--fa:"\\e584"}.fa-hockey-puck{--fa:"\\f453"}.fa-table{--fa:"\\f0ce"}.fa-magnifying-glass-arrow-right{--fa:"\\e521"}.fa-digital-tachograph,.fa-tachograph-digital{--fa:"\\f566"}.fa-users-slash{--fa:"\\e073"}.fa-clover{--fa:"\\e139"}.fa-mail-reply,.fa-reply{--fa:"\\f3e5"}.fa-star-and-crescent{--fa:"\\f699"}.fa-house-fire{--fa:"\\e50c"}.fa-minus-square,.fa-square-minus{--fa:"\\f146"}.fa-helicopter{--fa:"\\f533"}.fa-compass{--fa:"\\f14e"}.fa-caret-square-down,.fa-square-caret-down{--fa:"\\f150"}.fa-file-circle-question{--fa:"\\e4ef"}.fa-laptop-code{--fa:"\\f5fc"}.fa-swatchbook{--fa:"\\f5c3"}.fa-prescription-bottle{--fa:"\\f485"}.fa-bars,.fa-navicon{--fa:"\\f0c9"}.fa-people-group{--fa:"\\e533"}.fa-hourglass-3,.fa-hourglass-end{--fa:"\\f253"}.fa-heart-broken,.fa-heart-crack{--fa:"\\f7a9"}.fa-external-link-square-alt,.fa-square-up-right{--fa:"\\f360"}.fa-face-kiss-beam,.fa-kiss-beam{--fa:"\\f597"}.fa-film{--fa:"\\f008"}.fa-ruler-horizontal{--fa:"\\f547"}.fa-people-robbery{--fa:"\\e536"}.fa-lightbulb{--fa:"\\f0eb"}.fa-caret-left{--fa:"\\f0d9"}.fa-circle-exclamation,.fa-exclamation-circle{--fa:"\\f06a"}.fa-school-circle-xmark{--fa:"\\e56d"}.fa-arrow-right-from-bracket,.fa-sign-out{--fa:"\\f08b"}.fa-chevron-circle-down,.fa-circle-chevron-down{--fa:"\\f13a"}.fa-unlock-alt,.fa-unlock-keyhole{--fa:"\\f13e"}.fa-cloud-showers-heavy{--fa:"\\f740"}.fa-headphones-alt,.fa-headphones-simple{--fa:"\\f58f"}.fa-sitemap{--fa:"\\f0e8"}.fa-circle-dollar-to-slot,.fa-donate{--fa:"\\f4b9"}.fa-memory{--fa:"\\f538"}.fa-road-spikes{--fa:"\\e568"}.fa-fire-burner{--fa:"\\e4f1"}.fa-flag{--fa:"\\f024"}.fa-hanukiah{--fa:"\\f6e6"}.fa-feather{--fa:"\\f52d"}.fa-volume-down,.fa-volume-low{--fa:"\\f027"}.fa-comment-slash{--fa:"\\f4b3"}.fa-cloud-sun-rain{--fa:"\\f743"}.fa-compress{--fa:"\\f066"}.fa-wheat-alt,.fa-wheat-awn{--fa:"\\e2cd"}.fa-ankh{--fa:"\\f644"}.fa-hands-holding-child{--fa:"\\e4fa"}.fa-asterisk{--fa:"\\2a"}.fa-check-square,.fa-square-check{--fa:"\\f14a"}.fa-peseta-sign{--fa:"\\e221"}.fa-header,.fa-heading{--fa:"\\f1dc"}.fa-ghost{--fa:"\\f6e2"}.fa-list,.fa-list-squares{--fa:"\\f03a"}.fa-phone-square-alt,.fa-square-phone-flip{--fa:"\\f87b"}.fa-cart-plus{--fa:"\\f217"}.fa-gamepad{--fa:"\\f11b"}.fa-circle-dot,.fa-dot-circle{--fa:"\\f192"}.fa-dizzy,.fa-face-dizzy{--fa:"\\f567"}.fa-egg{--fa:"\\f7fb"}.fa-house-medical-circle-xmark{--fa:"\\e513"}.fa-campground{--fa:"\\f6bb"}.fa-folder-plus{--fa:"\\f65e"}.fa-futbol,.fa-futbol-ball,.fa-soccer-ball{--fa:"\\f1e3"}.fa-paint-brush,.fa-paintbrush{--fa:"\\f1fc"}.fa-lock{--fa:"\\f023"}.fa-gas-pump{--fa:"\\f52f"}.fa-hot-tub,.fa-hot-tub-person{--fa:"\\f593"}.fa-map-location,.fa-map-marked{--fa:"\\f59f"}.fa-house-flood-water{--fa:"\\e50e"}.fa-tree{--fa:"\\f1bb"}.fa-bridge-lock{--fa:"\\e4cc"}.fa-sack-dollar{--fa:"\\f81d"}.fa-edit,.fa-pen-to-square{--fa:"\\f044"}.fa-car-side{--fa:"\\f5e4"}.fa-share-alt,.fa-share-nodes{--fa:"\\f1e0"}.fa-heart-circle-minus{--fa:"\\e4ff"}.fa-hourglass-2,.fa-hourglass-half{--fa:"\\f252"}.fa-microscope{--fa:"\\f610"}.fa-sink{--fa:"\\e06d"}.fa-bag-shopping,.fa-shopping-bag{--fa:"\\f290"}.fa-arrow-down-z-a,.fa-sort-alpha-desc,.fa-sort-alpha-down-alt{--fa:"\\f881"}.fa-mitten{--fa:"\\f7b5"}.fa-person-rays{--fa:"\\e54d"}.fa-users{--fa:"\\f0c0"}.fa-eye-slash{--fa:"\\f070"}.fa-flask-vial{--fa:"\\e4f3"}.fa-hand,.fa-hand-paper{--fa:"\\f256"}.fa-om{--fa:"\\f679"}.fa-worm{--fa:"\\e599"}.fa-house-circle-xmark{--fa:"\\e50b"}.fa-plug{--fa:"\\f1e6"}.fa-chevron-up{--fa:"\\f077"}.fa-hand-spock{--fa:"\\f259"}.fa-stopwatch{--fa:"\\f2f2"}.fa-face-kiss,.fa-kiss{--fa:"\\f596"}.fa-bridge-circle-xmark{--fa:"\\e4cb"}.fa-face-grin-tongue,.fa-grin-tongue{--fa:"\\f589"}.fa-chess-bishop{--fa:"\\f43a"}.fa-face-grin-wink,.fa-grin-wink{--fa:"\\f58c"}.fa-deaf,.fa-deafness,.fa-ear-deaf,.fa-hard-of-hearing{--fa:"\\f2a4"}.fa-road-circle-check{--fa:"\\e564"}.fa-dice-five{--fa:"\\f523"}.fa-rss-square,.fa-square-rss{--fa:"\\f143"}.fa-land-mine-on{--fa:"\\e51b"}.fa-i-cursor{--fa:"\\f246"}.fa-stamp{--fa:"\\f5bf"}.fa-stairs{--fa:"\\e289"}.fa-i{--fa:"\\49"}.fa-hryvnia,.fa-hryvnia-sign{--fa:"\\f6f2"}.fa-pills{--fa:"\\f484"}.fa-face-grin-wide,.fa-grin-alt{--fa:"\\f581"}.fa-tooth{--fa:"\\f5c9"}.fa-v{--fa:"\\56"}.fa-bangladeshi-taka-sign{--fa:"\\e2e6"}.fa-bicycle{--fa:"\\f206"}.fa-rod-asclepius,.fa-rod-snake,.fa-staff-aesculapius,.fa-staff-snake{--fa:"\\e579"}.fa-head-side-cough-slash{--fa:"\\e062"}.fa-ambulance,.fa-truck-medical{--fa:"\\f0f9"}.fa-wheat-awn-circle-exclamation{--fa:"\\e598"}.fa-snowman{--fa:"\\f7d0"}.fa-mortar-pestle{--fa:"\\f5a7"}.fa-road-barrier{--fa:"\\e562"}.fa-school{--fa:"\\f549"}.fa-igloo{--fa:"\\f7ae"}.fa-joint{--fa:"\\f595"}.fa-angle-right{--fa:"\\f105"}.fa-horse{--fa:"\\f6f0"}.fa-q{--fa:"\\51"}.fa-g{--fa:"\\47"}.fa-notes-medical{--fa:"\\f481"}.fa-temperature-2,.fa-temperature-half,.fa-thermometer-2,.fa-thermometer-half{--fa:"\\f2c9"}.fa-dong-sign{--fa:"\\e169"}.fa-capsules{--fa:"\\f46b"}.fa-poo-bolt,.fa-poo-storm{--fa:"\\f75a"}.fa-face-frown-open,.fa-frown-open{--fa:"\\f57a"}.fa-hand-point-up{--fa:"\\f0a6"}.fa-money-bill{--fa:"\\f0d6"}.fa-bookmark{--fa:"\\f02e"}.fa-align-justify{--fa:"\\f039"}.fa-umbrella-beach{--fa:"\\f5ca"}.fa-helmet-un{--fa:"\\e503"}.fa-bullseye{--fa:"\\f140"}.fa-bacon{--fa:"\\f7e5"}.fa-hand-point-down{--fa:"\\f0a7"}.fa-arrow-up-from-bracket{--fa:"\\e09a"}.fa-folder,.fa-folder-blank{--fa:"\\f07b"}.fa-file-medical-alt,.fa-file-waveform{--fa:"\\f478"}.fa-radiation{--fa:"\\f7b9"}.fa-chart-simple{--fa:"\\e473"}.fa-mars-stroke{--fa:"\\f229"}.fa-vial{--fa:"\\f492"}.fa-dashboard,.fa-gauge,.fa-gauge-med,.fa-tachometer-alt-average{--fa:"\\f624"}.fa-magic-wand-sparkles,.fa-wand-magic-sparkles{--fa:"\\e2ca"}.fa-e{--fa:"\\45"}.fa-pen-alt,.fa-pen-clip{--fa:"\\f305"}.fa-bridge-circle-exclamation{--fa:"\\e4ca"}.fa-user{--fa:"\\f007"}.fa-school-circle-check{--fa:"\\e56b"}.fa-dumpster{--fa:"\\f793"}.fa-shuttle-van,.fa-van-shuttle{--fa:"\\f5b6"}.fa-building-user{--fa:"\\e4da"}.fa-caret-square-left,.fa-square-caret-left{--fa:"\\f191"}.fa-highlighter{--fa:"\\f591"}.fa-key{--fa:"\\f084"}.fa-bullhorn{--fa:"\\f0a1"}.fa-globe{--fa:"\\f0ac"}.fa-synagogue{--fa:"\\f69b"}.fa-person-half-dress{--fa:"\\e548"}.fa-road-bridge{--fa:"\\e563"}.fa-location-arrow{--fa:"\\f124"}.fa-c{--fa:"\\43"}.fa-tablet-button{--fa:"\\f10a"}.fa-building-lock{--fa:"\\e4d6"}.fa-pizza-slice{--fa:"\\f818"}.fa-money-bill-wave{--fa:"\\f53a"}.fa-area-chart,.fa-chart-area{--fa:"\\f1fe"}.fa-house-flag{--fa:"\\e50d"}.fa-person-circle-minus{--fa:"\\e540"}.fa-ban,.fa-cancel{--fa:"\\f05e"}.fa-camera-rotate{--fa:"\\e0d8"}.fa-air-freshener,.fa-spray-can-sparkles{--fa:"\\f5d0"}.fa-star{--fa:"\\f005"}.fa-repeat{--fa:"\\f363"}.fa-cross{--fa:"\\f654"}.fa-box{--fa:"\\f466"}.fa-venus-mars{--fa:"\\f228"}.fa-arrow-pointer,.fa-mouse-pointer{--fa:"\\f245"}.fa-expand-arrows-alt,.fa-maximize{--fa:"\\f31e"}.fa-charging-station{--fa:"\\f5e7"}.fa-shapes,.fa-triangle-circle-square{--fa:"\\f61f"}.fa-random,.fa-shuffle{--fa:"\\f074"}.fa-person-running,.fa-running{--fa:"\\f70c"}.fa-mobile-retro{--fa:"\\e527"}.fa-grip-lines-vertical{--fa:"\\f7a5"}.fa-spider{--fa:"\\f717"}.fa-hands-bound{--fa:"\\e4f9"}.fa-file-invoice-dollar{--fa:"\\f571"}.fa-plane-circle-exclamation{--fa:"\\e556"}.fa-x-ray{--fa:"\\f497"}.fa-spell-check{--fa:"\\f891"}.fa-slash{--fa:"\\f715"}.fa-computer-mouse,.fa-mouse{--fa:"\\f8cc"}.fa-arrow-right-to-bracket,.fa-sign-in{--fa:"\\f090"}.fa-shop-slash,.fa-store-alt-slash{--fa:"\\e070"}.fa-server{--fa:"\\f233"}.fa-virus-covid-slash{--fa:"\\e4a9"}.fa-shop-lock{--fa:"\\e4a5"}.fa-hourglass-1,.fa-hourglass-start{--fa:"\\f251"}.fa-blender-phone{--fa:"\\f6b6"}.fa-building-wheat{--fa:"\\e4db"}.fa-person-breastfeeding{--fa:"\\e53a"}.fa-right-to-bracket,.fa-sign-in-alt{--fa:"\\f2f6"}.fa-venus{--fa:"\\f221"}.fa-passport{--fa:"\\f5ab"}.fa-thumb-tack-slash,.fa-thumbtack-slash{--fa:"\\e68f"}.fa-heart-pulse,.fa-heartbeat{--fa:"\\f21e"}.fa-people-carry,.fa-people-carry-box{--fa:"\\f4ce"}.fa-temperature-high{--fa:"\\f769"}.fa-microchip{--fa:"\\f2db"}.fa-crown{--fa:"\\f521"}.fa-weight-hanging{--fa:"\\f5cd"}.fa-xmarks-lines{--fa:"\\e59a"}.fa-file-prescription{--fa:"\\f572"}.fa-weight,.fa-weight-scale{--fa:"\\f496"}.fa-user-friends,.fa-user-group{--fa:"\\f500"}.fa-arrow-up-a-z,.fa-sort-alpha-up{--fa:"\\f15e"}.fa-chess-knight{--fa:"\\f441"}.fa-face-laugh-squint,.fa-laugh-squint{--fa:"\\f59b"}.fa-wheelchair{--fa:"\\f193"}.fa-arrow-circle-up,.fa-circle-arrow-up{--fa:"\\f0aa"}.fa-toggle-on{--fa:"\\f205"}.fa-person-walking,.fa-walking{--fa:"\\f554"}.fa-l{--fa:"\\4c"}.fa-fire{--fa:"\\f06d"}.fa-bed-pulse,.fa-procedures{--fa:"\\f487"}.fa-shuttle-space,.fa-space-shuttle{--fa:"\\f197"}.fa-face-laugh,.fa-laugh{--fa:"\\f599"}.fa-folder-open{--fa:"\\f07c"}.fa-heart-circle-plus{--fa:"\\e500"}.fa-code-fork{--fa:"\\e13b"}.fa-city{--fa:"\\f64f"}.fa-microphone-alt,.fa-microphone-lines{--fa:"\\f3c9"}.fa-pepper-hot{--fa:"\\f816"}.fa-unlock{--fa:"\\f09c"}.fa-colon-sign{--fa:"\\e140"}.fa-headset{--fa:"\\f590"}.fa-store-slash{--fa:"\\e071"}.fa-road-circle-xmark{--fa:"\\e566"}.fa-user-minus{--fa:"\\f503"}.fa-mars-stroke-up,.fa-mars-stroke-v{--fa:"\\f22a"}.fa-champagne-glasses,.fa-glass-cheers{--fa:"\\f79f"}.fa-clipboard{--fa:"\\f328"}.fa-house-circle-exclamation{--fa:"\\e50a"}.fa-file-arrow-up,.fa-file-upload{--fa:"\\f574"}.fa-wifi,.fa-wifi-3,.fa-wifi-strong{--fa:"\\f1eb"}.fa-bath,.fa-bathtub{--fa:"\\f2cd"}.fa-underline{--fa:"\\f0cd"}.fa-user-edit,.fa-user-pen{--fa:"\\f4ff"}.fa-signature{--fa:"\\f5b7"}.fa-stroopwafel{--fa:"\\f551"}.fa-bold{--fa:"\\f032"}.fa-anchor-lock{--fa:"\\e4ad"}.fa-building-ngo{--fa:"\\e4d7"}.fa-manat-sign{--fa:"\\e1d5"}.fa-not-equal{--fa:"\\f53e"}.fa-border-style,.fa-border-top-left{--fa:"\\f853"}.fa-map-location-dot,.fa-map-marked-alt{--fa:"\\f5a0"}.fa-jedi{--fa:"\\f669"}.fa-poll,.fa-square-poll-vertical{--fa:"\\f681"}.fa-mug-hot{--fa:"\\f7b6"}.fa-battery-car,.fa-car-battery{--fa:"\\f5df"}.fa-gift{--fa:"\\f06b"}.fa-dice-two{--fa:"\\f528"}.fa-chess-queen{--fa:"\\f445"}.fa-glasses{--fa:"\\f530"}.fa-chess-board{--fa:"\\f43c"}.fa-building-circle-check{--fa:"\\e4d2"}.fa-person-chalkboard{--fa:"\\e53d"}.fa-mars-stroke-h,.fa-mars-stroke-right{--fa:"\\f22b"}.fa-hand-back-fist,.fa-hand-rock{--fa:"\\f255"}.fa-caret-square-up,.fa-square-caret-up{--fa:"\\f151"}.fa-cloud-showers-water{--fa:"\\e4e4"}.fa-bar-chart,.fa-chart-bar{--fa:"\\f080"}.fa-hands-bubbles,.fa-hands-wash{--fa:"\\e05e"}.fa-less-than-equal{--fa:"\\f537"}.fa-train{--fa:"\\f238"}.fa-eye-low-vision,.fa-low-vision{--fa:"\\f2a8"}.fa-crow{--fa:"\\f520"}.fa-sailboat{--fa:"\\e445"}.fa-window-restore{--fa:"\\f2d2"}.fa-plus-square,.fa-square-plus{--fa:"\\f0fe"}.fa-torii-gate{--fa:"\\f6a1"}.fa-frog{--fa:"\\f52e"}.fa-bucket{--fa:"\\e4cf"}.fa-image{--fa:"\\f03e"}.fa-microphone{--fa:"\\f130"}.fa-cow{--fa:"\\f6c8"}.fa-caret-up{--fa:"\\f0d8"}.fa-screwdriver{--fa:"\\f54a"}.fa-folder-closed{--fa:"\\e185"}.fa-house-tsunami{--fa:"\\e515"}.fa-square-nfi{--fa:"\\e576"}.fa-arrow-up-from-ground-water{--fa:"\\e4b5"}.fa-glass-martini-alt,.fa-martini-glass{--fa:"\\f57b"}.fa-square-binary{--fa:"\\e69b"}.fa-rotate-back,.fa-rotate-backward,.fa-rotate-left,.fa-undo-alt{--fa:"\\f2ea"}.fa-columns,.fa-table-columns{--fa:"\\f0db"}.fa-lemon{--fa:"\\f094"}.fa-head-side-mask{--fa:"\\e063"}.fa-handshake{--fa:"\\f2b5"}.fa-gem{--fa:"\\f3a5"}.fa-dolly,.fa-dolly-box{--fa:"\\f472"}.fa-smoking{--fa:"\\f48d"}.fa-compress-arrows-alt,.fa-minimize{--fa:"\\f78c"}.fa-monument{--fa:"\\f5a6"}.fa-snowplow{--fa:"\\f7d2"}.fa-angle-double-right,.fa-angles-right{--fa:"\\f101"}.fa-cannabis{--fa:"\\f55f"}.fa-circle-play,.fa-play-circle{--fa:"\\f144"}.fa-tablets{--fa:"\\f490"}.fa-ethernet{--fa:"\\f796"}.fa-eur,.fa-euro,.fa-euro-sign{--fa:"\\f153"}.fa-chair{--fa:"\\f6c0"}.fa-check-circle,.fa-circle-check{--fa:"\\f058"}.fa-circle-stop,.fa-stop-circle{--fa:"\\f28d"}.fa-compass-drafting,.fa-drafting-compass{--fa:"\\f568"}.fa-plate-wheat{--fa:"\\e55a"}.fa-icicles{--fa:"\\f7ad"}.fa-person-shelter{--fa:"\\e54f"}.fa-neuter{--fa:"\\f22c"}.fa-id-badge{--fa:"\\f2c1"}.fa-marker{--fa:"\\f5a1"}.fa-face-laugh-beam,.fa-laugh-beam{--fa:"\\f59a"}.fa-helicopter-symbol{--fa:"\\e502"}.fa-universal-access{--fa:"\\f29a"}.fa-chevron-circle-up,.fa-circle-chevron-up{--fa:"\\f139"}.fa-lari-sign{--fa:"\\e1c8"}.fa-volcano{--fa:"\\f770"}.fa-person-walking-dashed-line-arrow-right{--fa:"\\e553"}.fa-gbp,.fa-pound-sign,.fa-sterling-sign{--fa:"\\f154"}.fa-viruses{--fa:"\\e076"}.fa-square-person-confined{--fa:"\\e577"}.fa-user-tie{--fa:"\\f508"}.fa-arrow-down-long,.fa-long-arrow-down{--fa:"\\f175"}.fa-tent-arrow-down-to-line{--fa:"\\e57e"}.fa-certificate{--fa:"\\f0a3"}.fa-mail-reply-all,.fa-reply-all{--fa:"\\f122"}.fa-suitcase{--fa:"\\f0f2"}.fa-person-skating,.fa-skating{--fa:"\\f7c5"}.fa-filter-circle-dollar,.fa-funnel-dollar{--fa:"\\f662"}.fa-camera-retro{--fa:"\\f083"}.fa-arrow-circle-down,.fa-circle-arrow-down{--fa:"\\f0ab"}.fa-arrow-right-to-file,.fa-file-import{--fa:"\\f56f"}.fa-external-link-square,.fa-square-arrow-up-right{--fa:"\\f14c"}.fa-box-open{--fa:"\\f49e"}.fa-scroll{--fa:"\\f70e"}.fa-spa{--fa:"\\f5bb"}.fa-location-pin-lock{--fa:"\\e51f"}.fa-pause{--fa:"\\f04c"}.fa-hill-avalanche{--fa:"\\e507"}.fa-temperature-0,.fa-temperature-empty,.fa-thermometer-0,.fa-thermometer-empty{--fa:"\\f2cb"}.fa-bomb{--fa:"\\f1e2"}.fa-registered{--fa:"\\f25d"}.fa-address-card,.fa-contact-card,.fa-vcard{--fa:"\\f2bb"}.fa-balance-scale-right,.fa-scale-unbalanced-flip{--fa:"\\f516"}.fa-subscript{--fa:"\\f12c"}.fa-diamond-turn-right,.fa-directions{--fa:"\\f5eb"}.fa-burst{--fa:"\\e4dc"}.fa-house-laptop,.fa-laptop-house{--fa:"\\e066"}.fa-face-tired,.fa-tired{--fa:"\\f5c8"}.fa-money-bills{--fa:"\\e1f3"}.fa-smog{--fa:"\\f75f"}.fa-crutch{--fa:"\\f7f7"}.fa-cloud-arrow-up,.fa-cloud-upload,.fa-cloud-upload-alt{--fa:"\\f0ee"}.fa-palette{--fa:"\\f53f"}.fa-arrows-turn-right{--fa:"\\e4c0"}.fa-vest{--fa:"\\e085"}.fa-ferry{--fa:"\\e4ea"}.fa-arrows-down-to-people{--fa:"\\e4b9"}.fa-seedling,.fa-sprout{--fa:"\\f4d8"}.fa-arrows-alt-h,.fa-left-right{--fa:"\\f337"}.fa-boxes-packing{--fa:"\\e4c7"}.fa-arrow-circle-left,.fa-circle-arrow-left{--fa:"\\f0a8"}.fa-group-arrows-rotate{--fa:"\\e4f6"}.fa-bowl-food{--fa:"\\e4c6"}.fa-candy-cane{--fa:"\\f786"}.fa-arrow-down-wide-short,.fa-sort-amount-asc,.fa-sort-amount-down{--fa:"\\f160"}.fa-cloud-bolt,.fa-thunderstorm{--fa:"\\f76c"}.fa-remove-format,.fa-text-slash{--fa:"\\f87d"}.fa-face-smile-wink,.fa-smile-wink{--fa:"\\f4da"}.fa-file-word{--fa:"\\f1c2"}.fa-file-powerpoint{--fa:"\\f1c4"}.fa-arrows-h,.fa-arrows-left-right{--fa:"\\f07e"}.fa-house-lock{--fa:"\\e510"}.fa-cloud-arrow-down,.fa-cloud-download,.fa-cloud-download-alt{--fa:"\\f0ed"}.fa-children{--fa:"\\e4e1"}.fa-blackboard,.fa-chalkboard{--fa:"\\f51b"}.fa-user-alt-slash,.fa-user-large-slash{--fa:"\\f4fa"}.fa-envelope-open{--fa:"\\f2b6"}.fa-handshake-alt-slash,.fa-handshake-simple-slash{--fa:"\\e05f"}.fa-mattress-pillow{--fa:"\\e525"}.fa-guarani-sign{--fa:"\\e19a"}.fa-arrows-rotate,.fa-refresh,.fa-sync{--fa:"\\f021"}.fa-fire-extinguisher{--fa:"\\f134"}.fa-cruzeiro-sign{--fa:"\\e152"}.fa-greater-than-equal{--fa:"\\f532"}.fa-shield-alt,.fa-shield-halved{--fa:"\\f3ed"}.fa-atlas,.fa-book-atlas{--fa:"\\f558"}.fa-virus{--fa:"\\e074"}.fa-envelope-circle-check{--fa:"\\e4e8"}.fa-layer-group{--fa:"\\f5fd"}.fa-arrows-to-dot{--fa:"\\e4be"}.fa-archway{--fa:"\\f557"}.fa-heart-circle-check{--fa:"\\e4fd"}.fa-house-chimney-crack,.fa-house-damage{--fa:"\\f6f1"}.fa-file-archive,.fa-file-zipper{--fa:"\\f1c6"}.fa-square{--fa:"\\f0c8"}.fa-glass-martini,.fa-martini-glass-empty{--fa:"\\f000"}.fa-couch{--fa:"\\f4b8"}.fa-cedi-sign{--fa:"\\e0df"}.fa-italic{--fa:"\\f033"}.fa-table-cells-column-lock{--fa:"\\e678"}.fa-church{--fa:"\\f51d"}.fa-comments-dollar{--fa:"\\f653"}.fa-democrat{--fa:"\\f747"}.fa-z{--fa:"\\5a"}.fa-person-skiing,.fa-skiing{--fa:"\\f7c9"}.fa-road-lock{--fa:"\\e567"}.fa-a{--fa:"\\41"}.fa-temperature-arrow-down,.fa-temperature-down{--fa:"\\e03f"}.fa-feather-alt,.fa-feather-pointed{--fa:"\\f56b"}.fa-p{--fa:"\\50"}.fa-snowflake{--fa:"\\f2dc"}.fa-newspaper{--fa:"\\f1ea"}.fa-ad,.fa-rectangle-ad{--fa:"\\f641"}.fa-arrow-circle-right,.fa-circle-arrow-right{--fa:"\\f0a9"}.fa-filter-circle-xmark{--fa:"\\e17b"}.fa-locust{--fa:"\\e520"}.fa-sort,.fa-unsorted{--fa:"\\f0dc"}.fa-list-1-2,.fa-list-numeric,.fa-list-ol{--fa:"\\f0cb"}.fa-person-dress-burst{--fa:"\\e544"}.fa-money-check-alt,.fa-money-check-dollar{--fa:"\\f53d"}.fa-vector-square{--fa:"\\f5cb"}.fa-bread-slice{--fa:"\\f7ec"}.fa-language{--fa:"\\f1ab"}.fa-face-kiss-wink-heart,.fa-kiss-wink-heart{--fa:"\\f598"}.fa-filter{--fa:"\\f0b0"}.fa-question{--fa:"\\3f"}.fa-file-signature{--fa:"\\f573"}.fa-arrows-alt,.fa-up-down-left-right{--fa:"\\f0b2"}.fa-house-chimney-user{--fa:"\\e065"}.fa-hand-holding-heart{--fa:"\\f4be"}.fa-puzzle-piece{--fa:"\\f12e"}.fa-money-check{--fa:"\\f53c"}.fa-star-half-alt,.fa-star-half-stroke{--fa:"\\f5c0"}.fa-code{--fa:"\\f121"}.fa-glass-whiskey,.fa-whiskey-glass{--fa:"\\f7a0"}.fa-building-circle-exclamation{--fa:"\\e4d3"}.fa-magnifying-glass-chart{--fa:"\\e522"}.fa-arrow-up-right-from-square,.fa-external-link{--fa:"\\f08e"}.fa-cubes-stacked{--fa:"\\e4e6"}.fa-krw,.fa-won,.fa-won-sign{--fa:"\\f159"}.fa-virus-covid{--fa:"\\e4a8"}.fa-austral-sign{--fa:"\\e0a9"}.fa-f{--fa:"\\46"}.fa-leaf{--fa:"\\f06c"}.fa-road{--fa:"\\f018"}.fa-cab,.fa-taxi{--fa:"\\f1ba"}.fa-person-circle-plus{--fa:"\\e541"}.fa-chart-pie,.fa-pie-chart{--fa:"\\f200"}.fa-bolt-lightning{--fa:"\\e0b7"}.fa-sack-xmark{--fa:"\\e56a"}.fa-file-excel{--fa:"\\f1c3"}.fa-file-contract{--fa:"\\f56c"}.fa-fish-fins{--fa:"\\e4f2"}.fa-building-flag{--fa:"\\e4d5"}.fa-face-grin-beam,.fa-grin-beam{--fa:"\\f582"}.fa-object-ungroup{--fa:"\\f248"}.fa-poop{--fa:"\\f619"}.fa-location-pin,.fa-map-marker{--fa:"\\f041"}.fa-kaaba{--fa:"\\f66b"}.fa-toilet-paper{--fa:"\\f71e"}.fa-hard-hat,.fa-hat-hard,.fa-helmet-safety{--fa:"\\f807"}.fa-eject{--fa:"\\f052"}.fa-arrow-alt-circle-right,.fa-circle-right{--fa:"\\f35a"}.fa-plane-circle-check{--fa:"\\e555"}.fa-face-rolling-eyes,.fa-meh-rolling-eyes{--fa:"\\f5a5"}.fa-object-group{--fa:"\\f247"}.fa-chart-line,.fa-line-chart{--fa:"\\f201"}.fa-mask-ventilator{--fa:"\\e524"}.fa-arrow-right{--fa:"\\f061"}.fa-map-signs,.fa-signs-post{--fa:"\\f277"}.fa-cash-register{--fa:"\\f788"}.fa-person-circle-question{--fa:"\\e542"}.fa-h{--fa:"\\48"}.fa-tarp{--fa:"\\e57b"}.fa-screwdriver-wrench,.fa-tools{--fa:"\\f7d9"}.fa-arrows-to-eye{--fa:"\\e4bf"}.fa-plug-circle-bolt{--fa:"\\e55b"}.fa-heart{--fa:"\\f004"}.fa-mars-and-venus{--fa:"\\f224"}.fa-home-user,.fa-house-user{--fa:"\\e1b0"}.fa-dumpster-fire{--fa:"\\f794"}.fa-house-crack{--fa:"\\e3b1"}.fa-cocktail,.fa-martini-glass-citrus{--fa:"\\f561"}.fa-face-surprise,.fa-surprise{--fa:"\\f5c2"}.fa-bottle-water{--fa:"\\e4c5"}.fa-circle-pause,.fa-pause-circle{--fa:"\\f28b"}.fa-toilet-paper-slash{--fa:"\\e072"}.fa-apple-alt,.fa-apple-whole{--fa:"\\f5d1"}.fa-kitchen-set{--fa:"\\e51a"}.fa-r{--fa:"\\52"}.fa-temperature-1,.fa-temperature-quarter,.fa-thermometer-1,.fa-thermometer-quarter{--fa:"\\f2ca"}.fa-cube{--fa:"\\f1b2"}.fa-bitcoin-sign{--fa:"\\e0b4"}.fa-shield-dog{--fa:"\\e573"}.fa-solar-panel{--fa:"\\f5ba"}.fa-lock-open{--fa:"\\f3c1"}.fa-elevator{--fa:"\\e16d"}.fa-money-bill-transfer{--fa:"\\e528"}.fa-money-bill-trend-up{--fa:"\\e529"}.fa-house-flood-water-circle-arrow-right{--fa:"\\e50f"}.fa-poll-h,.fa-square-poll-horizontal{--fa:"\\f682"}.fa-circle{--fa:"\\f111"}.fa-backward-fast,.fa-fast-backward{--fa:"\\f049"}.fa-recycle{--fa:"\\f1b8"}.fa-user-astronaut{--fa:"\\f4fb"}.fa-plane-slash{--fa:"\\e069"}.fa-trademark{--fa:"\\f25c"}.fa-basketball,.fa-basketball-ball{--fa:"\\f434"}.fa-satellite-dish{--fa:"\\f7c0"}.fa-arrow-alt-circle-up,.fa-circle-up{--fa:"\\f35b"}.fa-mobile-alt,.fa-mobile-screen-button{--fa:"\\f3cd"}.fa-volume-high,.fa-volume-up{--fa:"\\f028"}.fa-users-rays{--fa:"\\e593"}.fa-wallet{--fa:"\\f555"}.fa-clipboard-check{--fa:"\\f46c"}.fa-file-audio{--fa:"\\f1c7"}.fa-burger,.fa-hamburger{--fa:"\\f805"}.fa-wrench{--fa:"\\f0ad"}.fa-bugs{--fa:"\\e4d0"}.fa-rupee,.fa-rupee-sign{--fa:"\\f156"}.fa-file-image{--fa:"\\f1c5"}.fa-circle-question,.fa-question-circle{--fa:"\\f059"}.fa-plane-departure{--fa:"\\f5b0"}.fa-handshake-slash{--fa:"\\e060"}.fa-book-bookmark{--fa:"\\e0bb"}.fa-code-branch{--fa:"\\f126"}.fa-hat-cowboy{--fa:"\\f8c0"}.fa-bridge{--fa:"\\e4c8"}.fa-phone-alt,.fa-phone-flip{--fa:"\\f879"}.fa-truck-front{--fa:"\\e2b7"}.fa-cat{--fa:"\\f6be"}.fa-anchor-circle-exclamation{--fa:"\\e4ab"}.fa-truck-field{--fa:"\\e58d"}.fa-route{--fa:"\\f4d7"}.fa-clipboard-question{--fa:"\\e4e3"}.fa-panorama{--fa:"\\e209"}.fa-comment-medical{--fa:"\\f7f5"}.fa-teeth-open{--fa:"\\f62f"}.fa-file-circle-minus{--fa:"\\e4ed"}.fa-tags{--fa:"\\f02c"}.fa-wine-glass{--fa:"\\f4e3"}.fa-fast-forward,.fa-forward-fast{--fa:"\\f050"}.fa-face-meh-blank,.fa-meh-blank{--fa:"\\f5a4"}.fa-parking,.fa-square-parking{--fa:"\\f540"}.fa-house-signal{--fa:"\\e012"}.fa-bars-progress,.fa-tasks-alt{--fa:"\\f828"}.fa-faucet-drip{--fa:"\\e006"}.fa-cart-flatbed,.fa-dolly-flatbed{--fa:"\\f474"}.fa-ban-smoking,.fa-smoking-ban{--fa:"\\f54d"}.fa-terminal{--fa:"\\f120"}.fa-mobile-button{--fa:"\\f10b"}.fa-house-medical-flag{--fa:"\\e514"}.fa-basket-shopping,.fa-shopping-basket{--fa:"\\f291"}.fa-tape{--fa:"\\f4db"}.fa-bus-alt,.fa-bus-simple{--fa:"\\f55e"}.fa-eye{--fa:"\\f06e"}.fa-face-sad-cry,.fa-sad-cry{--fa:"\\f5b3"}.fa-audio-description{--fa:"\\f29e"}.fa-person-military-to-person{--fa:"\\e54c"}.fa-file-shield{--fa:"\\e4f0"}.fa-user-slash{--fa:"\\f506"}.fa-pen{--fa:"\\f304"}.fa-tower-observation{--fa:"\\e586"}.fa-file-code{--fa:"\\f1c9"}.fa-signal,.fa-signal-5,.fa-signal-perfect{--fa:"\\f012"}.fa-bus{--fa:"\\f207"}.fa-heart-circle-xmark{--fa:"\\e501"}.fa-home-lg,.fa-house-chimney{--fa:"\\e3af"}.fa-window-maximize{--fa:"\\f2d0"}.fa-face-frown,.fa-frown{--fa:"\\f119"}.fa-prescription{--fa:"\\f5b1"}.fa-shop,.fa-store-alt{--fa:"\\f54f"}.fa-floppy-disk,.fa-save{--fa:"\\f0c7"}.fa-vihara{--fa:"\\f6a7"}.fa-balance-scale-left,.fa-scale-unbalanced{--fa:"\\f515"}.fa-sort-asc,.fa-sort-up{--fa:"\\f0de"}.fa-comment-dots,.fa-commenting{--fa:"\\f4ad"}.fa-plant-wilt{--fa:"\\e5aa"}.fa-diamond{--fa:"\\f219"}.fa-face-grin-squint,.fa-grin-squint{--fa:"\\f585"}.fa-hand-holding-dollar,.fa-hand-holding-usd{--fa:"\\f4c0"}.fa-chart-diagram{--fa:"\\e695"}.fa-bacterium{--fa:"\\e05a"}.fa-hand-pointer{--fa:"\\f25a"}.fa-drum-steelpan{--fa:"\\f56a"}.fa-hand-scissors{--fa:"\\f257"}.fa-hands-praying,.fa-praying-hands{--fa:"\\f684"}.fa-arrow-right-rotate,.fa-arrow-rotate-forward,.fa-arrow-rotate-right,.fa-redo{--fa:"\\f01e"}.fa-biohazard{--fa:"\\f780"}.fa-location,.fa-location-crosshairs{--fa:"\\f601"}.fa-mars-double{--fa:"\\f227"}.fa-child-dress{--fa:"\\e59c"}.fa-users-between-lines{--fa:"\\e591"}.fa-lungs-virus{--fa:"\\e067"}.fa-face-grin-tears,.fa-grin-tears{--fa:"\\f588"}.fa-phone{--fa:"\\f095"}.fa-calendar-times,.fa-calendar-xmark{--fa:"\\f273"}.fa-child-reaching{--fa:"\\e59d"}.fa-head-side-virus{--fa:"\\e064"}.fa-user-cog,.fa-user-gear{--fa:"\\f4fe"}.fa-arrow-up-1-9,.fa-sort-numeric-up{--fa:"\\f163"}.fa-door-closed{--fa:"\\f52a"}.fa-shield-virus{--fa:"\\e06c"}.fa-dice-six{--fa:"\\f526"}.fa-mosquito-net{--fa:"\\e52c"}.fa-file-fragment{--fa:"\\e697"}.fa-bridge-water{--fa:"\\e4ce"}.fa-person-booth{--fa:"\\f756"}.fa-text-width{--fa:"\\f035"}.fa-hat-wizard{--fa:"\\f6e8"}.fa-pen-fancy{--fa:"\\f5ac"}.fa-digging,.fa-person-digging{--fa:"\\f85e"}.fa-trash{--fa:"\\f1f8"}.fa-gauge-simple,.fa-gauge-simple-med,.fa-tachometer-average{--fa:"\\f629"}.fa-book-medical{--fa:"\\f7e6"}.fa-poo{--fa:"\\f2fe"}.fa-quote-right,.fa-quote-right-alt{--fa:"\\f10e"}.fa-shirt,.fa-t-shirt,.fa-tshirt{--fa:"\\f553"}.fa-cubes{--fa:"\\f1b3"}.fa-divide{--fa:"\\f529"}.fa-tenge,.fa-tenge-sign{--fa:"\\f7d7"}.fa-headphones{--fa:"\\f025"}.fa-hands-holding{--fa:"\\f4c2"}.fa-hands-clapping{--fa:"\\e1a8"}.fa-republican{--fa:"\\f75e"}.fa-arrow-left{--fa:"\\f060"}.fa-person-circle-xmark{--fa:"\\e543"}.fa-ruler{--fa:"\\f545"}.fa-align-left{--fa:"\\f036"}.fa-dice-d6{--fa:"\\f6d1"}.fa-restroom{--fa:"\\f7bd"}.fa-j{--fa:"\\4a"}.fa-users-viewfinder{--fa:"\\e595"}.fa-file-video{--fa:"\\f1c8"}.fa-external-link-alt,.fa-up-right-from-square{--fa:"\\f35d"}.fa-table-cells,.fa-th{--fa:"\\f00a"}.fa-file-pdf{--fa:"\\f1c1"}.fa-bible,.fa-book-bible{--fa:"\\f647"}.fa-o{--fa:"\\4f"}.fa-medkit,.fa-suitcase-medical{--fa:"\\f0fa"}.fa-user-secret{--fa:"\\f21b"}.fa-otter{--fa:"\\f700"}.fa-female,.fa-person-dress{--fa:"\\f182"}.fa-comment-dollar{--fa:"\\f651"}.fa-briefcase-clock,.fa-business-time{--fa:"\\f64a"}.fa-table-cells-large,.fa-th-large{--fa:"\\f009"}.fa-book-tanakh,.fa-tanakh{--fa:"\\f827"}.fa-phone-volume,.fa-volume-control-phone{--fa:"\\f2a0"}.fa-hat-cowboy-side{--fa:"\\f8c1"}.fa-clipboard-user{--fa:"\\f7f3"}.fa-child{--fa:"\\f1ae"}.fa-lira-sign{--fa:"\\f195"}.fa-satellite{--fa:"\\f7bf"}.fa-plane-lock{--fa:"\\e558"}.fa-tag{--fa:"\\f02b"}.fa-comment{--fa:"\\f075"}.fa-birthday-cake,.fa-cake,.fa-cake-candles{--fa:"\\f1fd"}.fa-envelope{--fa:"\\f0e0"}.fa-angle-double-up,.fa-angles-up{--fa:"\\f102"}.fa-paperclip{--fa:"\\f0c6"}.fa-arrow-right-to-city{--fa:"\\e4b3"}.fa-ribbon{--fa:"\\f4d6"}.fa-lungs{--fa:"\\f604"}.fa-arrow-up-9-1,.fa-sort-numeric-up-alt{--fa:"\\f887"}.fa-litecoin-sign{--fa:"\\e1d3"}.fa-border-none{--fa:"\\f850"}.fa-circle-nodes{--fa:"\\e4e2"}.fa-parachute-box{--fa:"\\f4cd"}.fa-indent{--fa:"\\f03c"}.fa-truck-field-un{--fa:"\\e58e"}.fa-hourglass,.fa-hourglass-empty{--fa:"\\f254"}.fa-mountain{--fa:"\\f6fc"}.fa-user-doctor,.fa-user-md{--fa:"\\f0f0"}.fa-circle-info,.fa-info-circle{--fa:"\\f05a"}.fa-cloud-meatball{--fa:"\\f73b"}.fa-camera,.fa-camera-alt{--fa:"\\f030"}.fa-square-virus{--fa:"\\e578"}.fa-meteor{--fa:"\\f753"}.fa-car-on{--fa:"\\e4dd"}.fa-sleigh{--fa:"\\f7cc"}.fa-arrow-down-1-9,.fa-sort-numeric-asc,.fa-sort-numeric-down{--fa:"\\f162"}.fa-hand-holding-droplet,.fa-hand-holding-water{--fa:"\\f4c1"}.fa-water{--fa:"\\f773"}.fa-calendar-check{--fa:"\\f274"}.fa-braille{--fa:"\\f2a1"}.fa-prescription-bottle-alt,.fa-prescription-bottle-medical{--fa:"\\f486"}.fa-landmark{--fa:"\\f66f"}.fa-truck{--fa:"\\f0d1"}.fa-crosshairs{--fa:"\\f05b"}.fa-person-cane{--fa:"\\e53c"}.fa-tent{--fa:"\\e57d"}.fa-vest-patches{--fa:"\\e086"}.fa-check-double{--fa:"\\f560"}.fa-arrow-down-a-z,.fa-sort-alpha-asc,.fa-sort-alpha-down{--fa:"\\f15d"}.fa-money-bill-wheat{--fa:"\\e52a"}.fa-cookie{--fa:"\\f563"}.fa-arrow-left-rotate,.fa-arrow-rotate-back,.fa-arrow-rotate-backward,.fa-arrow-rotate-left,.fa-undo{--fa:"\\f0e2"}.fa-hard-drive,.fa-hdd{--fa:"\\f0a0"}.fa-face-grin-squint-tears,.fa-grin-squint-tears{--fa:"\\f586"}.fa-dumbbell{--fa:"\\f44b"}.fa-list-alt,.fa-rectangle-list{--fa:"\\f022"}.fa-tarp-droplet{--fa:"\\e57c"}.fa-house-medical-circle-check{--fa:"\\e511"}.fa-person-skiing-nordic,.fa-skiing-nordic{--fa:"\\f7ca"}.fa-calendar-plus{--fa:"\\f271"}.fa-plane-arrival{--fa:"\\f5af"}.fa-arrow-alt-circle-left,.fa-circle-left{--fa:"\\f359"}.fa-subway,.fa-train-subway{--fa:"\\f239"}.fa-chart-gantt{--fa:"\\e0e4"}.fa-indian-rupee,.fa-indian-rupee-sign,.fa-inr{--fa:"\\e1bc"}.fa-crop-alt,.fa-crop-simple{--fa:"\\f565"}.fa-money-bill-1,.fa-money-bill-alt{--fa:"\\f3d1"}.fa-left-long,.fa-long-arrow-alt-left{--fa:"\\f30a"}.fa-dna{--fa:"\\f471"}.fa-virus-slash{--fa:"\\e075"}.fa-minus,.fa-subtract{--fa:"\\f068"}.fa-chess{--fa:"\\f439"}.fa-arrow-left-long,.fa-long-arrow-left{--fa:"\\f177"}.fa-plug-circle-check{--fa:"\\e55c"}.fa-street-view{--fa:"\\f21d"}.fa-franc-sign{--fa:"\\e18f"}.fa-volume-off{--fa:"\\f026"}.fa-american-sign-language-interpreting,.fa-asl-interpreting,.fa-hands-american-sign-language-interpreting,.fa-hands-asl-interpreting{--fa:"\\f2a3"}.fa-cog,.fa-gear{--fa:"\\f013"}.fa-droplet-slash,.fa-tint-slash{--fa:"\\f5c7"}.fa-mosque{--fa:"\\f678"}.fa-mosquito{--fa:"\\e52b"}.fa-star-of-david{--fa:"\\f69a"}.fa-person-military-rifle{--fa:"\\e54b"}.fa-cart-shopping,.fa-shopping-cart{--fa:"\\f07a"}.fa-vials{--fa:"\\f493"}.fa-plug-circle-plus{--fa:"\\e55f"}.fa-place-of-worship{--fa:"\\f67f"}.fa-grip-vertical{--fa:"\\f58e"}.fa-hexagon-nodes{--fa:"\\e699"}.fa-arrow-turn-up,.fa-level-up{--fa:"\\f148"}.fa-u{--fa:"\\55"}.fa-square-root-alt,.fa-square-root-variable{--fa:"\\f698"}.fa-clock,.fa-clock-four{--fa:"\\f017"}.fa-backward-step,.fa-step-backward{--fa:"\\f048"}.fa-pallet{--fa:"\\f482"}.fa-faucet{--fa:"\\e005"}.fa-baseball-bat-ball{--fa:"\\f432"}.fa-s{--fa:"\\53"}.fa-timeline{--fa:"\\e29c"}.fa-keyboard{--fa:"\\f11c"}.fa-caret-down{--fa:"\\f0d7"}.fa-clinic-medical,.fa-house-chimney-medical{--fa:"\\f7f2"}.fa-temperature-3,.fa-temperature-three-quarters,.fa-thermometer-3,.fa-thermometer-three-quarters{--fa:"\\f2c8"}.fa-mobile-android-alt,.fa-mobile-screen{--fa:"\\f3cf"}.fa-plane-up{--fa:"\\e22d"}.fa-piggy-bank{--fa:"\\f4d3"}.fa-battery-3,.fa-battery-half{--fa:"\\f242"}.fa-mountain-city{--fa:"\\e52e"}.fa-coins{--fa:"\\f51e"}.fa-khanda{--fa:"\\f66d"}.fa-sliders,.fa-sliders-h{--fa:"\\f1de"}.fa-folder-tree{--fa:"\\f802"}.fa-network-wired{--fa:"\\f6ff"}.fa-map-pin{--fa:"\\f276"}.fa-hamsa{--fa:"\\f665"}.fa-cent-sign{--fa:"\\e3f5"}.fa-flask{--fa:"\\f0c3"}.fa-person-pregnant{--fa:"\\e31e"}.fa-wand-sparkles{--fa:"\\f72b"}.fa-ellipsis-v,.fa-ellipsis-vertical{--fa:"\\f142"}.fa-ticket{--fa:"\\f145"}.fa-power-off{--fa:"\\f011"}.fa-long-arrow-alt-right,.fa-right-long{--fa:"\\f30b"}.fa-flag-usa{--fa:"\\f74d"}.fa-laptop-file{--fa:"\\e51d"}.fa-teletype,.fa-tty{--fa:"\\f1e4"}.fa-diagram-next{--fa:"\\e476"}.fa-person-rifle{--fa:"\\e54e"}.fa-house-medical-circle-exclamation{--fa:"\\e512"}.fa-closed-captioning{--fa:"\\f20a"}.fa-hiking,.fa-person-hiking{--fa:"\\f6ec"}.fa-venus-double{--fa:"\\f226"}.fa-images{--fa:"\\f302"}.fa-calculator{--fa:"\\f1ec"}.fa-people-pulling{--fa:"\\e535"}.fa-n{--fa:"\\4e"}.fa-cable-car,.fa-tram{--fa:"\\f7da"}.fa-cloud-rain{--fa:"\\f73d"}.fa-building-circle-xmark{--fa:"\\e4d4"}.fa-ship{--fa:"\\f21a"}.fa-arrows-down-to-line{--fa:"\\e4b8"}.fa-download{--fa:"\\f019"}.fa-face-grin,.fa-grin{--fa:"\\f580"}.fa-backspace,.fa-delete-left{--fa:"\\f55a"}.fa-eye-dropper,.fa-eye-dropper-empty,.fa-eyedropper{--fa:"\\f1fb"}.fa-file-circle-check{--fa:"\\e5a0"}.fa-forward{--fa:"\\f04e"}.fa-mobile,.fa-mobile-android,.fa-mobile-phone{--fa:"\\f3ce"}.fa-face-meh,.fa-meh{--fa:"\\f11a"}.fa-align-center{--fa:"\\f037"}.fa-book-dead,.fa-book-skull{--fa:"\\f6b7"}.fa-drivers-license,.fa-id-card{--fa:"\\f2c2"}.fa-dedent,.fa-outdent{--fa:"\\f03b"}.fa-heart-circle-exclamation{--fa:"\\e4fe"}.fa-home,.fa-home-alt,.fa-home-lg-alt,.fa-house{--fa:"\\f015"}.fa-calendar-week{--fa:"\\f784"}.fa-laptop-medical{--fa:"\\f812"}.fa-b{--fa:"\\42"}.fa-file-medical{--fa:"\\f477"}.fa-dice-one{--fa:"\\f525"}.fa-kiwi-bird{--fa:"\\f535"}.fa-arrow-right-arrow-left,.fa-exchange{--fa:"\\f0ec"}.fa-redo-alt,.fa-rotate-forward,.fa-rotate-right{--fa:"\\f2f9"}.fa-cutlery,.fa-utensils{--fa:"\\f2e7"}.fa-arrow-up-wide-short,.fa-sort-amount-up{--fa:"\\f161"}.fa-mill-sign{--fa:"\\e1ed"}.fa-bowl-rice{--fa:"\\e2eb"}.fa-skull{--fa:"\\f54c"}.fa-broadcast-tower,.fa-tower-broadcast{--fa:"\\f519"}.fa-truck-pickup{--fa:"\\f63c"}.fa-long-arrow-alt-up,.fa-up-long{--fa:"\\f30c"}.fa-stop{--fa:"\\f04d"}.fa-code-merge{--fa:"\\f387"}.fa-upload{--fa:"\\f093"}.fa-hurricane{--fa:"\\f751"}.fa-mound{--fa:"\\e52d"}.fa-toilet-portable{--fa:"\\e583"}.fa-compact-disc{--fa:"\\f51f"}.fa-file-arrow-down,.fa-file-download{--fa:"\\f56d"}.fa-caravan{--fa:"\\f8ff"}.fa-shield-cat{--fa:"\\e572"}.fa-bolt,.fa-zap{--fa:"\\f0e7"}.fa-glass-water{--fa:"\\e4f4"}.fa-oil-well{--fa:"\\e532"}.fa-vault{--fa:"\\e2c5"}.fa-mars{--fa:"\\f222"}.fa-toilet{--fa:"\\f7d8"}.fa-plane-circle-xmark{--fa:"\\e557"}.fa-cny,.fa-jpy,.fa-rmb,.fa-yen,.fa-yen-sign{--fa:"\\f157"}.fa-rouble,.fa-rub,.fa-ruble,.fa-ruble-sign{--fa:"\\f158"}.fa-sun{--fa:"\\f185"}.fa-guitar{--fa:"\\f7a6"}.fa-face-laugh-wink,.fa-laugh-wink{--fa:"\\f59c"}.fa-horse-head{--fa:"\\f7ab"}.fa-bore-hole{--fa:"\\e4c3"}.fa-industry{--fa:"\\f275"}.fa-arrow-alt-circle-down,.fa-circle-down{--fa:"\\f358"}.fa-arrows-turn-to-dots{--fa:"\\e4c1"}.fa-florin-sign{--fa:"\\e184"}.fa-arrow-down-short-wide,.fa-sort-amount-desc,.fa-sort-amount-down-alt{--fa:"\\f884"}.fa-less-than{--fa:"\\3c"}.fa-angle-down{--fa:"\\f107"}.fa-car-tunnel{--fa:"\\e4de"}.fa-head-side-cough{--fa:"\\e061"}.fa-grip-lines{--fa:"\\f7a4"}.fa-thumbs-down{--fa:"\\f165"}.fa-user-lock{--fa:"\\f502"}.fa-arrow-right-long,.fa-long-arrow-right{--fa:"\\f178"}.fa-anchor-circle-xmark{--fa:"\\e4ac"}.fa-ellipsis,.fa-ellipsis-h{--fa:"\\f141"}.fa-chess-pawn{--fa:"\\f443"}.fa-first-aid,.fa-kit-medical{--fa:"\\f479"}.fa-person-through-window{--fa:"\\e5a9"}.fa-toolbox{--fa:"\\f552"}.fa-hands-holding-circle{--fa:"\\e4fb"}.fa-bug{--fa:"\\f188"}.fa-credit-card,.fa-credit-card-alt{--fa:"\\f09d"}.fa-automobile,.fa-car{--fa:"\\f1b9"}.fa-hand-holding-hand{--fa:"\\e4f7"}.fa-book-open-reader,.fa-book-reader{--fa:"\\f5da"}.fa-mountain-sun{--fa:"\\e52f"}.fa-arrows-left-right-to-line{--fa:"\\e4ba"}.fa-dice-d20{--fa:"\\f6cf"}.fa-truck-droplet{--fa:"\\e58c"}.fa-file-circle-xmark{--fa:"\\e5a1"}.fa-temperature-arrow-up,.fa-temperature-up{--fa:"\\e040"}.fa-medal{--fa:"\\f5a2"}.fa-bed{--fa:"\\f236"}.fa-h-square,.fa-square-h{--fa:"\\f0fd"}.fa-podcast{--fa:"\\f2ce"}.fa-temperature-4,.fa-temperature-full,.fa-thermometer-4,.fa-thermometer-full{--fa:"\\f2c7"}.fa-bell{--fa:"\\f0f3"}.fa-superscript{--fa:"\\f12b"}.fa-plug-circle-xmark{--fa:"\\e560"}.fa-star-of-life{--fa:"\\f621"}.fa-phone-slash{--fa:"\\f3dd"}.fa-paint-roller{--fa:"\\f5aa"}.fa-hands-helping,.fa-handshake-angle{--fa:"\\f4c4"}.fa-location-dot,.fa-map-marker-alt{--fa:"\\f3c5"}.fa-file{--fa:"\\f15b"}.fa-greater-than{--fa:"\\3e"}.fa-person-swimming,.fa-swimmer{--fa:"\\f5c4"}.fa-arrow-down{--fa:"\\f063"}.fa-droplet,.fa-tint{--fa:"\\f043"}.fa-eraser{--fa:"\\f12d"}.fa-earth,.fa-earth-america,.fa-earth-americas,.fa-globe-americas{--fa:"\\f57d"}.fa-person-burst{--fa:"\\e53b"}.fa-dove{--fa:"\\f4ba"}.fa-battery-0,.fa-battery-empty{--fa:"\\f244"}.fa-socks{--fa:"\\f696"}.fa-inbox{--fa:"\\f01c"}.fa-section{--fa:"\\e447"}.fa-gauge-high,.fa-tachometer-alt,.fa-tachometer-alt-fast{--fa:"\\f625"}.fa-envelope-open-text{--fa:"\\f658"}.fa-hospital,.fa-hospital-alt,.fa-hospital-wide{--fa:"\\f0f8"}.fa-wine-bottle{--fa:"\\f72f"}.fa-chess-rook{--fa:"\\f447"}.fa-bars-staggered,.fa-reorder,.fa-stream{--fa:"\\f550"}.fa-dharmachakra{--fa:"\\f655"}.fa-hotdog{--fa:"\\f80f"}.fa-blind,.fa-person-walking-with-cane{--fa:"\\f29d"}.fa-drum{--fa:"\\f569"}.fa-ice-cream{--fa:"\\f810"}.fa-heart-circle-bolt{--fa:"\\e4fc"}.fa-fax{--fa:"\\f1ac"}.fa-paragraph{--fa:"\\f1dd"}.fa-check-to-slot,.fa-vote-yea{--fa:"\\f772"}.fa-star-half{--fa:"\\f089"}.fa-boxes,.fa-boxes-alt,.fa-boxes-stacked{--fa:"\\f468"}.fa-chain,.fa-link{--fa:"\\f0c1"}.fa-assistive-listening-systems,.fa-ear-listen{--fa:"\\f2a2"}.fa-tree-city{--fa:"\\e587"}.fa-play{--fa:"\\f04b"}.fa-font{--fa:"\\f031"}.fa-table-cells-row-lock{--fa:"\\e67a"}.fa-rupiah-sign{--fa:"\\e23d"}.fa-magnifying-glass,.fa-search{--fa:"\\f002"}.fa-ping-pong-paddle-ball,.fa-table-tennis,.fa-table-tennis-paddle-ball{--fa:"\\f45d"}.fa-diagnoses,.fa-person-dots-from-line{--fa:"\\f470"}.fa-trash-can-arrow-up,.fa-trash-restore-alt{--fa:"\\f82a"}.fa-naira-sign{--fa:"\\e1f6"}.fa-cart-arrow-down{--fa:"\\f218"}.fa-walkie-talkie{--fa:"\\f8ef"}.fa-file-edit,.fa-file-pen{--fa:"\\f31c"}.fa-receipt{--fa:"\\f543"}.fa-pen-square,.fa-pencil-square,.fa-square-pen{--fa:"\\f14b"}.fa-suitcase-rolling{--fa:"\\f5c1"}.fa-person-circle-exclamation{--fa:"\\e53f"}.fa-chevron-down{--fa:"\\f078"}.fa-battery,.fa-battery-5,.fa-battery-full{--fa:"\\f240"}.fa-skull-crossbones{--fa:"\\f714"}.fa-code-compare{--fa:"\\e13a"}.fa-list-dots,.fa-list-ul{--fa:"\\f0ca"}.fa-school-lock{--fa:"\\e56f"}.fa-tower-cell{--fa:"\\e585"}.fa-down-long,.fa-long-arrow-alt-down{--fa:"\\f309"}.fa-ranking-star{--fa:"\\e561"}.fa-chess-king{--fa:"\\f43f"}.fa-person-harassing{--fa:"\\e549"}.fa-brazilian-real-sign{--fa:"\\e46c"}.fa-landmark-alt,.fa-landmark-dome{--fa:"\\f752"}.fa-arrow-up{--fa:"\\f062"}.fa-television,.fa-tv,.fa-tv-alt{--fa:"\\f26c"}.fa-shrimp{--fa:"\\e448"}.fa-list-check,.fa-tasks{--fa:"\\f0ae"}.fa-jug-detergent{--fa:"\\e519"}.fa-circle-user,.fa-user-circle{--fa:"\\f2bd"}.fa-user-shield{--fa:"\\f505"}.fa-wind{--fa:"\\f72e"}.fa-car-burst,.fa-car-crash{--fa:"\\f5e1"}.fa-y{--fa:"\\59"}.fa-person-snowboarding,.fa-snowboarding{--fa:"\\f7ce"}.fa-shipping-fast,.fa-truck-fast{--fa:"\\f48b"}.fa-fish{--fa:"\\f578"}.fa-user-graduate{--fa:"\\f501"}.fa-adjust,.fa-circle-half-stroke{--fa:"\\f042"}.fa-clapperboard{--fa:"\\e131"}.fa-circle-radiation,.fa-radiation-alt{--fa:"\\f7ba"}.fa-baseball,.fa-baseball-ball{--fa:"\\f433"}.fa-jet-fighter-up{--fa:"\\e518"}.fa-diagram-project,.fa-project-diagram{--fa:"\\f542"}.fa-copy{--fa:"\\f0c5"}.fa-volume-mute,.fa-volume-times,.fa-volume-xmark{--fa:"\\f6a9"}.fa-hand-sparkles{--fa:"\\e05d"}.fa-grip,.fa-grip-horizontal{--fa:"\\f58d"}.fa-share-from-square,.fa-share-square{--fa:"\\f14d"}.fa-child-combatant,.fa-child-rifle{--fa:"\\e4e0"}.fa-gun{--fa:"\\e19b"}.fa-phone-square,.fa-square-phone{--fa:"\\f098"}.fa-add,.fa-plus{--fa:"\\2b"}.fa-expand{--fa:"\\f065"}.fa-computer{--fa:"\\e4e5"}.fa-close,.fa-multiply,.fa-remove,.fa-times,.fa-xmark{--fa:"\\f00d"}.fa-arrows,.fa-arrows-up-down-left-right{--fa:"\\f047"}.fa-chalkboard-teacher,.fa-chalkboard-user{--fa:"\\f51c"}.fa-peso-sign{--fa:"\\e222"}.fa-building-shield{--fa:"\\e4d8"}.fa-baby{--fa:"\\f77c"}.fa-users-line{--fa:"\\e592"}.fa-quote-left,.fa-quote-left-alt{--fa:"\\f10d"}.fa-tractor{--fa:"\\f722"}.fa-trash-arrow-up,.fa-trash-restore{--fa:"\\f829"}.fa-arrow-down-up-lock{--fa:"\\e4b0"}.fa-lines-leaning{--fa:"\\e51e"}.fa-ruler-combined{--fa:"\\f546"}.fa-copyright{--fa:"\\f1f9"}.fa-equals{--fa:"\\3d"}.fa-blender{--fa:"\\f517"}.fa-teeth{--fa:"\\f62e"}.fa-ils,.fa-shekel,.fa-shekel-sign,.fa-sheqel,.fa-sheqel-sign{--fa:"\\f20b"}.fa-map{--fa:"\\f279"}.fa-rocket{--fa:"\\f135"}.fa-photo-film,.fa-photo-video{--fa:"\\f87c"}.fa-folder-minus{--fa:"\\f65d"}.fa-hexagon-nodes-bolt{--fa:"\\e69a"}.fa-store{--fa:"\\f54e"}.fa-arrow-trend-up{--fa:"\\e098"}.fa-plug-circle-minus{--fa:"\\e55e"}.fa-sign,.fa-sign-hanging{--fa:"\\f4d9"}.fa-bezier-curve{--fa:"\\f55b"}.fa-bell-slash{--fa:"\\f1f6"}.fa-tablet,.fa-tablet-android{--fa:"\\f3fb"}.fa-school-flag{--fa:"\\e56e"}.fa-fill{--fa:"\\f575"}.fa-angle-up{--fa:"\\f106"}.fa-drumstick-bite{--fa:"\\f6d7"}.fa-holly-berry{--fa:"\\f7aa"}.fa-chevron-left{--fa:"\\f053"}.fa-bacteria{--fa:"\\e059"}.fa-hand-lizard{--fa:"\\f258"}.fa-notdef{--fa:"\\e1fe"}.fa-disease{--fa:"\\f7fa"}.fa-briefcase-medical{--fa:"\\f469"}.fa-genderless{--fa:"\\f22d"}.fa-chevron-right{--fa:"\\f054"}.fa-retweet{--fa:"\\f079"}.fa-car-alt,.fa-car-rear{--fa:"\\f5de"}.fa-pump-soap{--fa:"\\e06b"}.fa-video-slash{--fa:"\\f4e2"}.fa-battery-2,.fa-battery-quarter{--fa:"\\f243"}.fa-radio{--fa:"\\f8d7"}.fa-baby-carriage,.fa-carriage-baby{--fa:"\\f77d"}.fa-traffic-light{--fa:"\\f637"}.fa-thermometer{--fa:"\\f491"}.fa-vr-cardboard{--fa:"\\f729"}.fa-hand-middle-finger{--fa:"\\f806"}.fa-percent,.fa-percentage{--fa:"\\25"}.fa-truck-moving{--fa:"\\f4df"}.fa-glass-water-droplet{--fa:"\\e4f5"}.fa-display{--fa:"\\e163"}.fa-face-smile,.fa-smile{--fa:"\\f118"}.fa-thumb-tack,.fa-thumbtack{--fa:"\\f08d"}.fa-trophy{--fa:"\\f091"}.fa-person-praying,.fa-pray{--fa:"\\f683"}.fa-hammer{--fa:"\\f6e3"}.fa-hand-peace{--fa:"\\f25b"}.fa-rotate,.fa-sync-alt{--fa:"\\f2f1"}.fa-spinner{--fa:"\\f110"}.fa-robot{--fa:"\\f544"}.fa-peace{--fa:"\\f67c"}.fa-cogs,.fa-gears{--fa:"\\f085"}.fa-warehouse{--fa:"\\f494"}.fa-arrow-up-right-dots{--fa:"\\e4b7"}.fa-splotch{--fa:"\\f5bc"}.fa-face-grin-hearts,.fa-grin-hearts{--fa:"\\f584"}.fa-dice-four{--fa:"\\f524"}.fa-sim-card{--fa:"\\f7c4"}.fa-transgender,.fa-transgender-alt{--fa:"\\f225"}.fa-mercury{--fa:"\\f223"}.fa-arrow-turn-down,.fa-level-down{--fa:"\\f149"}.fa-person-falling-burst{--fa:"\\e547"}.fa-award{--fa:"\\f559"}.fa-ticket-alt,.fa-ticket-simple{--fa:"\\f3ff"}.fa-building{--fa:"\\f1ad"}.fa-angle-double-left,.fa-angles-left{--fa:"\\f100"}.fa-qrcode{--fa:"\\f029"}.fa-clock-rotate-left,.fa-history{--fa:"\\f1da"}.fa-face-grin-beam-sweat,.fa-grin-beam-sweat{--fa:"\\f583"}.fa-arrow-right-from-file,.fa-file-export{--fa:"\\f56e"}.fa-shield,.fa-shield-blank{--fa:"\\f132"}.fa-arrow-up-short-wide,.fa-sort-amount-up-alt{--fa:"\\f885"}.fa-comment-nodes{--fa:"\\e696"}.fa-house-medical{--fa:"\\e3b2"}.fa-golf-ball,.fa-golf-ball-tee{--fa:"\\f450"}.fa-chevron-circle-left,.fa-circle-chevron-left{--fa:"\\f137"}.fa-house-chimney-window{--fa:"\\e00d"}.fa-pen-nib{--fa:"\\f5ad"}.fa-tent-arrow-turn-left{--fa:"\\e580"}.fa-tents{--fa:"\\e582"}.fa-magic,.fa-wand-magic{--fa:"\\f0d0"}.fa-dog{--fa:"\\f6d3"}.fa-carrot{--fa:"\\f787"}.fa-moon{--fa:"\\f186"}.fa-wine-glass-alt,.fa-wine-glass-empty{--fa:"\\f5ce"}.fa-cheese{--fa:"\\f7ef"}.fa-yin-yang{--fa:"\\f6ad"}.fa-music{--fa:"\\f001"}.fa-code-commit{--fa:"\\f386"}.fa-temperature-low{--fa:"\\f76b"}.fa-biking,.fa-person-biking{--fa:"\\f84a"}.fa-broom{--fa:"\\f51a"}.fa-shield-heart{--fa:"\\e574"}.fa-gopuram{--fa:"\\f664"}.fa-earth-oceania,.fa-globe-oceania{--fa:"\\e47b"}.fa-square-xmark,.fa-times-square,.fa-xmark-square{--fa:"\\f2d3"}.fa-hashtag{--fa:"\\23"}.fa-expand-alt,.fa-up-right-and-down-left-from-center{--fa:"\\f424"}.fa-oil-can{--fa:"\\f613"}.fa-t{--fa:"\\54"}.fa-hippo{--fa:"\\f6ed"}.fa-chart-column{--fa:"\\e0e3"}.fa-infinity{--fa:"\\f534"}.fa-vial-circle-check{--fa:"\\e596"}.fa-person-arrow-down-to-line{--fa:"\\e538"}.fa-voicemail{--fa:"\\f897"}.fa-fan{--fa:"\\f863"}.fa-person-walking-luggage{--fa:"\\e554"}.fa-arrows-alt-v,.fa-up-down{--fa:"\\f338"}.fa-cloud-moon-rain{--fa:"\\f73c"}.fa-calendar{--fa:"\\f133"}.fa-trailer{--fa:"\\e041"}.fa-bahai,.fa-haykal{--fa:"\\f666"}.fa-sd-card{--fa:"\\f7c2"}.fa-dragon{--fa:"\\f6d5"}.fa-shoe-prints{--fa:"\\f54b"}.fa-circle-plus,.fa-plus-circle{--fa:"\\f055"}.fa-face-grin-tongue-wink,.fa-grin-tongue-wink{--fa:"\\f58b"}.fa-hand-holding{--fa:"\\f4bd"}.fa-plug-circle-exclamation{--fa:"\\e55d"}.fa-chain-broken,.fa-chain-slash,.fa-link-slash,.fa-unlink{--fa:"\\f127"}.fa-clone{--fa:"\\f24d"}.fa-person-walking-arrow-loop-left{--fa:"\\e551"}.fa-arrow-up-z-a,.fa-sort-alpha-up-alt{--fa:"\\f882"}.fa-fire-alt,.fa-fire-flame-curved{--fa:"\\f7e4"}.fa-tornado{--fa:"\\f76f"}.fa-file-circle-plus{--fa:"\\e494"}.fa-book-quran,.fa-quran{--fa:"\\f687"}.fa-anchor{--fa:"\\f13d"}.fa-border-all{--fa:"\\f84c"}.fa-angry,.fa-face-angry{--fa:"\\f556"}.fa-cookie-bite{--fa:"\\f564"}.fa-arrow-trend-down{--fa:"\\e097"}.fa-feed,.fa-rss{--fa:"\\f09e"}.fa-draw-polygon{--fa:"\\f5ee"}.fa-balance-scale,.fa-scale-balanced{--fa:"\\f24e"}.fa-gauge-simple-high,.fa-tachometer,.fa-tachometer-fast{--fa:"\\f62a"}.fa-shower{--fa:"\\f2cc"}.fa-desktop,.fa-desktop-alt{--fa:"\\f390"}.fa-m{--fa:"\\4d"}.fa-table-list,.fa-th-list{--fa:"\\f00b"}.fa-comment-sms,.fa-sms{--fa:"\\f7cd"}.fa-book{--fa:"\\f02d"}.fa-user-plus{--fa:"\\f234"}.fa-check{--fa:"\\f00c"}.fa-battery-4,.fa-battery-three-quarters{--fa:"\\f241"}.fa-house-circle-check{--fa:"\\e509"}.fa-angle-left{--fa:"\\f104"}.fa-diagram-successor{--fa:"\\e47a"}.fa-truck-arrow-right{--fa:"\\e58b"}.fa-arrows-split-up-and-left{--fa:"\\e4bc"}.fa-fist-raised,.fa-hand-fist{--fa:"\\f6de"}.fa-cloud-moon{--fa:"\\f6c3"}.fa-briefcase{--fa:"\\f0b1"}.fa-person-falling{--fa:"\\e546"}.fa-image-portrait,.fa-portrait{--fa:"\\f3e0"}.fa-user-tag{--fa:"\\f507"}.fa-rug{--fa:"\\e569"}.fa-earth-europe,.fa-globe-europe{--fa:"\\f7a2"}.fa-cart-flatbed-suitcase,.fa-luggage-cart{--fa:"\\f59d"}.fa-rectangle-times,.fa-rectangle-xmark,.fa-times-rectangle,.fa-window-close{--fa:"\\f410"}.fa-baht-sign{--fa:"\\e0ac"}.fa-book-open{--fa:"\\f518"}.fa-book-journal-whills,.fa-journal-whills{--fa:"\\f66a"}.fa-handcuffs{--fa:"\\e4f8"}.fa-exclamation-triangle,.fa-triangle-exclamation,.fa-warning{--fa:"\\f071"}.fa-database{--fa:"\\f1c0"}.fa-mail-forward,.fa-share{--fa:"\\f064"}.fa-bottle-droplet{--fa:"\\e4c4"}.fa-mask-face{--fa:"\\e1d7"}.fa-hill-rockslide{--fa:"\\e508"}.fa-exchange-alt,.fa-right-left{--fa:"\\f362"}.fa-paper-plane{--fa:"\\f1d8"}.fa-road-circle-exclamation{--fa:"\\e565"}.fa-dungeon{--fa:"\\f6d9"}.fa-align-right{--fa:"\\f038"}.fa-money-bill-1-wave,.fa-money-bill-wave-alt{--fa:"\\f53b"}.fa-life-ring{--fa:"\\f1cd"}.fa-hands,.fa-sign-language,.fa-signing{--fa:"\\f2a7"}.fa-calendar-day{--fa:"\\f783"}.fa-ladder-water,.fa-swimming-pool,.fa-water-ladder{--fa:"\\f5c5"}.fa-arrows-up-down,.fa-arrows-v{--fa:"\\f07d"}.fa-face-grimace,.fa-grimace{--fa:"\\f57f"}.fa-wheelchair-alt,.fa-wheelchair-move{--fa:"\\e2ce"}.fa-level-down-alt,.fa-turn-down{--fa:"\\f3be"}.fa-person-walking-arrow-right{--fa:"\\e552"}.fa-envelope-square,.fa-square-envelope{--fa:"\\f199"}.fa-dice{--fa:"\\f522"}.fa-bowling-ball{--fa:"\\f436"}.fa-brain{--fa:"\\f5dc"}.fa-band-aid,.fa-bandage{--fa:"\\f462"}.fa-calendar-minus{--fa:"\\f272"}.fa-circle-xmark,.fa-times-circle,.fa-xmark-circle{--fa:"\\f057"}.fa-gifts{--fa:"\\f79c"}.fa-hotel{--fa:"\\f594"}.fa-earth-asia,.fa-globe-asia{--fa:"\\f57e"}.fa-id-card-alt,.fa-id-card-clip{--fa:"\\f47f"}.fa-magnifying-glass-plus,.fa-search-plus{--fa:"\\f00e"}.fa-thumbs-up{--fa:"\\f164"}.fa-user-clock{--fa:"\\f4fd"}.fa-allergies,.fa-hand-dots{--fa:"\\f461"}.fa-file-invoice{--fa:"\\f570"}.fa-window-minimize{--fa:"\\f2d1"}.fa-coffee,.fa-mug-saucer{--fa:"\\f0f4"}.fa-brush{--fa:"\\f55d"}.fa-file-half-dashed{--fa:"\\e698"}.fa-mask{--fa:"\\f6fa"}.fa-magnifying-glass-minus,.fa-search-minus{--fa:"\\f010"}.fa-ruler-vertical{--fa:"\\f548"}.fa-user-alt,.fa-user-large{--fa:"\\f406"}.fa-train-tram{--fa:"\\e5b4"}.fa-user-nurse{--fa:"\\f82f"}.fa-syringe{--fa:"\\f48e"}.fa-cloud-sun{--fa:"\\f6c4"}.fa-stopwatch-20{--fa:"\\e06f"}.fa-square-full{--fa:"\\f45c"}.fa-magnet{--fa:"\\f076"}.fa-jar{--fa:"\\e516"}.fa-note-sticky,.fa-sticky-note{--fa:"\\f249"}.fa-bug-slash{--fa:"\\e490"}.fa-arrow-up-from-water-pump{--fa:"\\e4b6"}.fa-bone{--fa:"\\f5d7"}.fa-table-cells-row-unlock{--fa:"\\e691"}.fa-user-injured{--fa:"\\f728"}.fa-face-sad-tear,.fa-sad-tear{--fa:"\\f5b4"}.fa-plane{--fa:"\\f072"}.fa-tent-arrows-down{--fa:"\\e581"}.fa-exclamation{--fa:"\\21"}.fa-arrows-spin{--fa:"\\e4bb"}.fa-print{--fa:"\\f02f"}.fa-try,.fa-turkish-lira,.fa-turkish-lira-sign{--fa:"\\e2bb"}.fa-dollar,.fa-dollar-sign,.fa-usd{--fa:"\\24"}.fa-x{--fa:"\\58"}.fa-magnifying-glass-dollar,.fa-search-dollar{--fa:"\\f688"}.fa-users-cog,.fa-users-gear{--fa:"\\f509"}.fa-person-military-pointing{--fa:"\\e54a"}.fa-bank,.fa-building-columns,.fa-institution,.fa-museum,.fa-university{--fa:"\\f19c"}.fa-umbrella{--fa:"\\f0e9"}.fa-trowel{--fa:"\\e589"}.fa-d{--fa:"\\44"}.fa-stapler{--fa:"\\e5af"}.fa-masks-theater,.fa-theater-masks{--fa:"\\f630"}.fa-kip-sign{--fa:"\\e1c4"}.fa-hand-point-left{--fa:"\\f0a5"}.fa-handshake-alt,.fa-handshake-simple{--fa:"\\f4c6"}.fa-fighter-jet,.fa-jet-fighter{--fa:"\\f0fb"}.fa-share-alt-square,.fa-square-share-nodes{--fa:"\\f1e1"}.fa-barcode{--fa:"\\f02a"}.fa-plus-minus{--fa:"\\e43c"}.fa-video,.fa-video-camera{--fa:"\\f03d"}.fa-graduation-cap,.fa-mortar-board{--fa:"\\f19d"}.fa-hand-holding-medical{--fa:"\\e05c"}.fa-person-circle-check{--fa:"\\e53e"}.fa-level-up-alt,.fa-turn-up{--fa:"\\f3bf"}\n.fa-sr-only,.fa-sr-only-focusable:not(:focus),.sr-only,.sr-only-focusable:not(:focus){position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host,:root{--fa-style-family-brands:"Font Awesome 6 Brands";--fa-font-brands:normal 400 1em/1 "Font Awesome 6 Brands"}@font-face{font-family:"Font Awesome 6 Brands";font-style:normal;font-weight:400;font-display:block;src:url(${y}) format("woff2"),url(${b}) format("truetype")}.fa-brands,.fab{font-weight:400}.fa-monero{--fa:"\\f3d0"}.fa-hooli{--fa:"\\f427"}.fa-yelp{--fa:"\\f1e9"}.fa-cc-visa{--fa:"\\f1f0"}.fa-lastfm{--fa:"\\f202"}.fa-shopware{--fa:"\\f5b5"}.fa-creative-commons-nc{--fa:"\\f4e8"}.fa-aws{--fa:"\\f375"}.fa-redhat{--fa:"\\f7bc"}.fa-yoast{--fa:"\\f2b1"}.fa-cloudflare{--fa:"\\e07d"}.fa-ups{--fa:"\\f7e0"}.fa-pixiv{--fa:"\\e640"}.fa-wpexplorer{--fa:"\\f2de"}.fa-dyalog{--fa:"\\f399"}.fa-bity{--fa:"\\f37a"}.fa-stackpath{--fa:"\\f842"}.fa-buysellads{--fa:"\\f20d"}.fa-first-order{--fa:"\\f2b0"}.fa-modx{--fa:"\\f285"}.fa-guilded{--fa:"\\e07e"}.fa-vnv{--fa:"\\f40b"}.fa-js-square,.fa-square-js{--fa:"\\f3b9"}.fa-microsoft{--fa:"\\f3ca"}.fa-qq{--fa:"\\f1d6"}.fa-orcid{--fa:"\\f8d2"}.fa-java{--fa:"\\f4e4"}.fa-invision{--fa:"\\f7b0"}.fa-creative-commons-pd-alt{--fa:"\\f4ed"}.fa-centercode{--fa:"\\f380"}.fa-glide-g{--fa:"\\f2a6"}.fa-drupal{--fa:"\\f1a9"}.fa-jxl{--fa:"\\e67b"}.fa-dart-lang{--fa:"\\e693"}.fa-hire-a-helper{--fa:"\\f3b0"}.fa-creative-commons-by{--fa:"\\f4e7"}.fa-unity{--fa:"\\e049"}.fa-whmcs{--fa:"\\f40d"}.fa-rocketchat{--fa:"\\f3e8"}.fa-vk{--fa:"\\f189"}.fa-untappd{--fa:"\\f405"}.fa-mailchimp{--fa:"\\f59e"}.fa-css3-alt{--fa:"\\f38b"}.fa-reddit-square,.fa-square-reddit{--fa:"\\f1a2"}.fa-vimeo-v{--fa:"\\f27d"}.fa-contao{--fa:"\\f26d"}.fa-square-font-awesome{--fa:"\\e5ad"}.fa-deskpro{--fa:"\\f38f"}.fa-brave{--fa:"\\e63c"}.fa-sistrix{--fa:"\\f3ee"}.fa-instagram-square,.fa-square-instagram{--fa:"\\e055"}.fa-battle-net{--fa:"\\f835"}.fa-the-red-yeti{--fa:"\\f69d"}.fa-hacker-news-square,.fa-square-hacker-news{--fa:"\\f3af"}.fa-edge{--fa:"\\f282"}.fa-threads{--fa:"\\e618"}.fa-napster{--fa:"\\f3d2"}.fa-snapchat-square,.fa-square-snapchat{--fa:"\\f2ad"}.fa-google-plus-g{--fa:"\\f0d5"}.fa-artstation{--fa:"\\f77a"}.fa-markdown{--fa:"\\f60f"}.fa-sourcetree{--fa:"\\f7d3"}.fa-google-plus{--fa:"\\f2b3"}.fa-diaspora{--fa:"\\f791"}.fa-foursquare{--fa:"\\f180"}.fa-stack-overflow{--fa:"\\f16c"}.fa-github-alt{--fa:"\\f113"}.fa-phoenix-squadron{--fa:"\\f511"}.fa-pagelines{--fa:"\\f18c"}.fa-algolia{--fa:"\\f36c"}.fa-red-river{--fa:"\\f3e3"}.fa-creative-commons-sa{--fa:"\\f4ef"}.fa-safari{--fa:"\\f267"}.fa-google{--fa:"\\f1a0"}.fa-font-awesome-alt,.fa-square-font-awesome-stroke{--fa:"\\f35c"}.fa-atlassian{--fa:"\\f77b"}.fa-linkedin-in{--fa:"\\f0e1"}.fa-digital-ocean{--fa:"\\f391"}.fa-nimblr{--fa:"\\f5a8"}.fa-chromecast{--fa:"\\f838"}.fa-evernote{--fa:"\\f839"}.fa-hacker-news{--fa:"\\f1d4"}.fa-creative-commons-sampling{--fa:"\\f4f0"}.fa-adversal{--fa:"\\f36a"}.fa-creative-commons{--fa:"\\f25e"}.fa-watchman-monitoring{--fa:"\\e087"}.fa-fonticons{--fa:"\\f280"}.fa-weixin{--fa:"\\f1d7"}.fa-shirtsinbulk{--fa:"\\f214"}.fa-codepen{--fa:"\\f1cb"}.fa-git-alt{--fa:"\\f841"}.fa-lyft{--fa:"\\f3c3"}.fa-rev{--fa:"\\f5b2"}.fa-windows{--fa:"\\f17a"}.fa-wizards-of-the-coast{--fa:"\\f730"}.fa-square-viadeo,.fa-viadeo-square{--fa:"\\f2aa"}.fa-meetup{--fa:"\\f2e0"}.fa-centos{--fa:"\\f789"}.fa-adn{--fa:"\\f170"}.fa-cloudsmith{--fa:"\\f384"}.fa-opensuse{--fa:"\\e62b"}.fa-pied-piper-alt{--fa:"\\f1a8"}.fa-dribbble-square,.fa-square-dribbble{--fa:"\\f397"}.fa-codiepie{--fa:"\\f284"}.fa-node{--fa:"\\f419"}.fa-mix{--fa:"\\f3cb"}.fa-steam{--fa:"\\f1b6"}.fa-cc-apple-pay{--fa:"\\f416"}.fa-scribd{--fa:"\\f28a"}.fa-debian{--fa:"\\e60b"}.fa-openid{--fa:"\\f19b"}.fa-instalod{--fa:"\\e081"}.fa-files-pinwheel{--fa:"\\e69f"}.fa-expeditedssl{--fa:"\\f23e"}.fa-sellcast{--fa:"\\f2da"}.fa-square-twitter,.fa-twitter-square{--fa:"\\f081"}.fa-r-project{--fa:"\\f4f7"}.fa-delicious{--fa:"\\f1a5"}.fa-freebsd{--fa:"\\f3a4"}.fa-vuejs{--fa:"\\f41f"}.fa-accusoft{--fa:"\\f369"}.fa-ioxhost{--fa:"\\f208"}.fa-fonticons-fi{--fa:"\\f3a2"}.fa-app-store{--fa:"\\f36f"}.fa-cc-mastercard{--fa:"\\f1f1"}.fa-itunes-note{--fa:"\\f3b5"}.fa-golang{--fa:"\\e40f"}.fa-kickstarter,.fa-square-kickstarter{--fa:"\\f3bb"}.fa-grav{--fa:"\\f2d6"}.fa-weibo{--fa:"\\f18a"}.fa-uncharted{--fa:"\\e084"}.fa-firstdraft{--fa:"\\f3a1"}.fa-square-youtube,.fa-youtube-square{--fa:"\\f431"}.fa-wikipedia-w{--fa:"\\f266"}.fa-rendact,.fa-wpressr{--fa:"\\f3e4"}.fa-angellist{--fa:"\\f209"}.fa-galactic-republic{--fa:"\\f50c"}.fa-nfc-directional{--fa:"\\e530"}.fa-skype{--fa:"\\f17e"}.fa-joget{--fa:"\\f3b7"}.fa-fedora{--fa:"\\f798"}.fa-stripe-s{--fa:"\\f42a"}.fa-meta{--fa:"\\e49b"}.fa-laravel{--fa:"\\f3bd"}.fa-hotjar{--fa:"\\f3b1"}.fa-bluetooth-b{--fa:"\\f294"}.fa-square-letterboxd{--fa:"\\e62e"}.fa-sticker-mule{--fa:"\\f3f7"}.fa-creative-commons-zero{--fa:"\\f4f3"}.fa-hips{--fa:"\\f452"}.fa-css{--fa:"\\e6a2"}.fa-behance{--fa:"\\f1b4"}.fa-reddit{--fa:"\\f1a1"}.fa-discord{--fa:"\\f392"}.fa-chrome{--fa:"\\f268"}.fa-app-store-ios{--fa:"\\f370"}.fa-cc-discover{--fa:"\\f1f2"}.fa-wpbeginner{--fa:"\\f297"}.fa-confluence{--fa:"\\f78d"}.fa-shoelace{--fa:"\\e60c"}.fa-mdb{--fa:"\\f8ca"}.fa-dochub{--fa:"\\f394"}.fa-accessible-icon{--fa:"\\f368"}.fa-ebay{--fa:"\\f4f4"}.fa-amazon{--fa:"\\f270"}.fa-unsplash{--fa:"\\e07c"}.fa-yarn{--fa:"\\f7e3"}.fa-square-steam,.fa-steam-square{--fa:"\\f1b7"}.fa-500px{--fa:"\\f26e"}.fa-square-vimeo,.fa-vimeo-square{--fa:"\\f194"}.fa-asymmetrik{--fa:"\\f372"}.fa-font-awesome,.fa-font-awesome-flag,.fa-font-awesome-logo-full{--fa:"\\f2b4"}.fa-gratipay{--fa:"\\f184"}.fa-apple{--fa:"\\f179"}.fa-hive{--fa:"\\e07f"}.fa-gitkraken{--fa:"\\f3a6"}.fa-keybase{--fa:"\\f4f5"}.fa-apple-pay{--fa:"\\f415"}.fa-padlet{--fa:"\\e4a0"}.fa-amazon-pay{--fa:"\\f42c"}.fa-github-square,.fa-square-github{--fa:"\\f092"}.fa-stumbleupon{--fa:"\\f1a4"}.fa-fedex{--fa:"\\f797"}.fa-phoenix-framework{--fa:"\\f3dc"}.fa-shopify{--fa:"\\e057"}.fa-neos{--fa:"\\f612"}.fa-square-threads{--fa:"\\e619"}.fa-hackerrank{--fa:"\\f5f7"}.fa-researchgate{--fa:"\\f4f8"}.fa-swift{--fa:"\\f8e1"}.fa-angular{--fa:"\\f420"}.fa-speakap{--fa:"\\f3f3"}.fa-angrycreative{--fa:"\\f36e"}.fa-y-combinator{--fa:"\\f23b"}.fa-empire{--fa:"\\f1d1"}.fa-envira{--fa:"\\f299"}.fa-google-scholar{--fa:"\\e63b"}.fa-gitlab-square,.fa-square-gitlab{--fa:"\\e5ae"}.fa-studiovinari{--fa:"\\f3f8"}.fa-pied-piper{--fa:"\\f2ae"}.fa-wordpress{--fa:"\\f19a"}.fa-product-hunt{--fa:"\\f288"}.fa-firefox{--fa:"\\f269"}.fa-linode{--fa:"\\f2b8"}.fa-goodreads{--fa:"\\f3a8"}.fa-odnoklassniki-square,.fa-square-odnoklassniki{--fa:"\\f264"}.fa-jsfiddle{--fa:"\\f1cc"}.fa-sith{--fa:"\\f512"}.fa-themeisle{--fa:"\\f2b2"}.fa-page4{--fa:"\\f3d7"}.fa-hashnode{--fa:"\\e499"}.fa-react{--fa:"\\f41b"}.fa-cc-paypal{--fa:"\\f1f4"}.fa-squarespace{--fa:"\\f5be"}.fa-cc-stripe{--fa:"\\f1f5"}.fa-creative-commons-share{--fa:"\\f4f2"}.fa-bitcoin{--fa:"\\f379"}.fa-keycdn{--fa:"\\f3ba"}.fa-opera{--fa:"\\f26a"}.fa-itch-io{--fa:"\\f83a"}.fa-umbraco{--fa:"\\f8e8"}.fa-galactic-senate{--fa:"\\f50d"}.fa-ubuntu{--fa:"\\f7df"}.fa-draft2digital{--fa:"\\f396"}.fa-stripe{--fa:"\\f429"}.fa-houzz{--fa:"\\f27c"}.fa-gg{--fa:"\\f260"}.fa-dhl{--fa:"\\f790"}.fa-pinterest-square,.fa-square-pinterest{--fa:"\\f0d3"}.fa-xing{--fa:"\\f168"}.fa-blackberry{--fa:"\\f37b"}.fa-creative-commons-pd{--fa:"\\f4ec"}.fa-playstation{--fa:"\\f3df"}.fa-quinscape{--fa:"\\f459"}.fa-less{--fa:"\\f41d"}.fa-blogger-b{--fa:"\\f37d"}.fa-opencart{--fa:"\\f23d"}.fa-vine{--fa:"\\f1ca"}.fa-signal-messenger{--fa:"\\e663"}.fa-paypal{--fa:"\\f1ed"}.fa-gitlab{--fa:"\\f296"}.fa-typo3{--fa:"\\f42b"}.fa-reddit-alien{--fa:"\\f281"}.fa-yahoo{--fa:"\\f19e"}.fa-dailymotion{--fa:"\\e052"}.fa-affiliatetheme{--fa:"\\f36b"}.fa-pied-piper-pp{--fa:"\\f1a7"}.fa-bootstrap{--fa:"\\f836"}.fa-odnoklassniki{--fa:"\\f263"}.fa-nfc-symbol{--fa:"\\e531"}.fa-mintbit{--fa:"\\e62f"}.fa-ethereum{--fa:"\\f42e"}.fa-speaker-deck{--fa:"\\f83c"}.fa-creative-commons-nc-eu{--fa:"\\f4e9"}.fa-patreon{--fa:"\\f3d9"}.fa-avianex{--fa:"\\f374"}.fa-ello{--fa:"\\f5f1"}.fa-gofore{--fa:"\\f3a7"}.fa-bimobject{--fa:"\\f378"}.fa-brave-reverse{--fa:"\\e63d"}.fa-facebook-f{--fa:"\\f39e"}.fa-google-plus-square,.fa-square-google-plus{--fa:"\\f0d4"}.fa-web-awesome{--fa:"\\e682"}.fa-mandalorian{--fa:"\\f50f"}.fa-first-order-alt{--fa:"\\f50a"}.fa-osi{--fa:"\\f41a"}.fa-google-wallet{--fa:"\\f1ee"}.fa-d-and-d-beyond{--fa:"\\f6ca"}.fa-periscope{--fa:"\\f3da"}.fa-fulcrum{--fa:"\\f50b"}.fa-cloudscale{--fa:"\\f383"}.fa-forumbee{--fa:"\\f211"}.fa-mizuni{--fa:"\\f3cc"}.fa-schlix{--fa:"\\f3ea"}.fa-square-xing,.fa-xing-square{--fa:"\\f169"}.fa-bandcamp{--fa:"\\f2d5"}.fa-wpforms{--fa:"\\f298"}.fa-cloudversify{--fa:"\\f385"}.fa-usps{--fa:"\\f7e1"}.fa-megaport{--fa:"\\f5a3"}.fa-magento{--fa:"\\f3c4"}.fa-spotify{--fa:"\\f1bc"}.fa-optin-monster{--fa:"\\f23c"}.fa-fly{--fa:"\\f417"}.fa-square-bluesky{--fa:"\\e6a3"}.fa-aviato{--fa:"\\f421"}.fa-itunes{--fa:"\\f3b4"}.fa-cuttlefish{--fa:"\\f38c"}.fa-blogger{--fa:"\\f37c"}.fa-flickr{--fa:"\\f16e"}.fa-viber{--fa:"\\f409"}.fa-soundcloud{--fa:"\\f1be"}.fa-digg{--fa:"\\f1a6"}.fa-tencent-weibo{--fa:"\\f1d5"}.fa-letterboxd{--fa:"\\e62d"}.fa-symfony{--fa:"\\f83d"}.fa-maxcdn{--fa:"\\f136"}.fa-etsy{--fa:"\\f2d7"}.fa-facebook-messenger{--fa:"\\f39f"}.fa-audible{--fa:"\\f373"}.fa-think-peaks{--fa:"\\f731"}.fa-bilibili{--fa:"\\e3d9"}.fa-erlang{--fa:"\\f39d"}.fa-x-twitter{--fa:"\\e61b"}.fa-cotton-bureau{--fa:"\\f89e"}.fa-dashcube{--fa:"\\f210"}.fa-42-group,.fa-innosoft{--fa:"\\e080"}.fa-stack-exchange{--fa:"\\f18d"}.fa-elementor{--fa:"\\f430"}.fa-pied-piper-square,.fa-square-pied-piper{--fa:"\\e01e"}.fa-creative-commons-nd{--fa:"\\f4eb"}.fa-palfed{--fa:"\\f3d8"}.fa-superpowers{--fa:"\\f2dd"}.fa-resolving{--fa:"\\f3e7"}.fa-xbox{--fa:"\\f412"}.fa-square-web-awesome-stroke{--fa:"\\e684"}.fa-searchengin{--fa:"\\f3eb"}.fa-tiktok{--fa:"\\e07b"}.fa-facebook-square,.fa-square-facebook{--fa:"\\f082"}.fa-renren{--fa:"\\f18b"}.fa-linux{--fa:"\\f17c"}.fa-glide{--fa:"\\f2a5"}.fa-linkedin{--fa:"\\f08c"}.fa-hubspot{--fa:"\\f3b2"}.fa-deploydog{--fa:"\\f38e"}.fa-twitch{--fa:"\\f1e8"}.fa-flutter{--fa:"\\e694"}.fa-ravelry{--fa:"\\f2d9"}.fa-mixer{--fa:"\\e056"}.fa-lastfm-square,.fa-square-lastfm{--fa:"\\f203"}.fa-vimeo{--fa:"\\f40a"}.fa-mendeley{--fa:"\\f7b3"}.fa-uniregistry{--fa:"\\f404"}.fa-figma{--fa:"\\f799"}.fa-creative-commons-remix{--fa:"\\f4ee"}.fa-cc-amazon-pay{--fa:"\\f42d"}.fa-dropbox{--fa:"\\f16b"}.fa-instagram{--fa:"\\f16d"}.fa-cmplid{--fa:"\\e360"}.fa-upwork{--fa:"\\e641"}.fa-facebook{--fa:"\\f09a"}.fa-gripfire{--fa:"\\f3ac"}.fa-jedi-order{--fa:"\\f50e"}.fa-uikit{--fa:"\\f403"}.fa-fort-awesome-alt{--fa:"\\f3a3"}.fa-phabricator{--fa:"\\f3db"}.fa-ussunnah{--fa:"\\f407"}.fa-earlybirds{--fa:"\\f39a"}.fa-trade-federation{--fa:"\\f513"}.fa-autoprefixer{--fa:"\\f41c"}.fa-whatsapp{--fa:"\\f232"}.fa-square-upwork{--fa:"\\e67c"}.fa-slideshare{--fa:"\\f1e7"}.fa-google-play{--fa:"\\f3ab"}.fa-viadeo{--fa:"\\f2a9"}.fa-line{--fa:"\\f3c0"}.fa-google-drive{--fa:"\\f3aa"}.fa-servicestack{--fa:"\\f3ec"}.fa-simplybuilt{--fa:"\\f215"}.fa-bitbucket{--fa:"\\f171"}.fa-imdb{--fa:"\\f2d8"}.fa-deezer{--fa:"\\e077"}.fa-raspberry-pi{--fa:"\\f7bb"}.fa-jira{--fa:"\\f7b1"}.fa-docker{--fa:"\\f395"}.fa-screenpal{--fa:"\\e570"}.fa-bluetooth{--fa:"\\f293"}.fa-gitter{--fa:"\\f426"}.fa-d-and-d{--fa:"\\f38d"}.fa-microblog{--fa:"\\e01a"}.fa-cc-diners-club{--fa:"\\f24c"}.fa-gg-circle{--fa:"\\f261"}.fa-pied-piper-hat{--fa:"\\f4e5"}.fa-kickstarter-k{--fa:"\\f3bc"}.fa-yandex{--fa:"\\f413"}.fa-readme{--fa:"\\f4d5"}.fa-html5{--fa:"\\f13b"}.fa-sellsy{--fa:"\\f213"}.fa-square-web-awesome{--fa:"\\e683"}.fa-sass{--fa:"\\f41e"}.fa-wirsindhandwerk,.fa-wsh{--fa:"\\e2d0"}.fa-buromobelexperte{--fa:"\\f37f"}.fa-salesforce{--fa:"\\f83b"}.fa-octopus-deploy{--fa:"\\e082"}.fa-medapps{--fa:"\\f3c6"}.fa-ns8{--fa:"\\f3d5"}.fa-pinterest-p{--fa:"\\f231"}.fa-apper{--fa:"\\f371"}.fa-fort-awesome{--fa:"\\f286"}.fa-waze{--fa:"\\f83f"}.fa-bluesky{--fa:"\\e671"}.fa-cc-jcb{--fa:"\\f24b"}.fa-snapchat,.fa-snapchat-ghost{--fa:"\\f2ab"}.fa-fantasy-flight-games{--fa:"\\f6dc"}.fa-rust{--fa:"\\e07a"}.fa-wix{--fa:"\\f5cf"}.fa-behance-square,.fa-square-behance{--fa:"\\f1b5"}.fa-supple{--fa:"\\f3f9"}.fa-webflow{--fa:"\\e65c"}.fa-rebel{--fa:"\\f1d0"}.fa-css3{--fa:"\\f13c"}.fa-staylinked{--fa:"\\f3f5"}.fa-kaggle{--fa:"\\f5fa"}.fa-space-awesome{--fa:"\\e5ac"}.fa-deviantart{--fa:"\\f1bd"}.fa-cpanel{--fa:"\\f388"}.fa-goodreads-g{--fa:"\\f3a9"}.fa-git-square,.fa-square-git{--fa:"\\f1d2"}.fa-square-tumblr,.fa-tumblr-square{--fa:"\\f174"}.fa-trello{--fa:"\\f181"}.fa-creative-commons-nc-jp{--fa:"\\f4ea"}.fa-get-pocket{--fa:"\\f265"}.fa-perbyte{--fa:"\\e083"}.fa-grunt{--fa:"\\f3ad"}.fa-weebly{--fa:"\\f5cc"}.fa-connectdevelop{--fa:"\\f20e"}.fa-leanpub{--fa:"\\f212"}.fa-black-tie{--fa:"\\f27e"}.fa-themeco{--fa:"\\f5c6"}.fa-python{--fa:"\\f3e2"}.fa-android{--fa:"\\f17b"}.fa-bots{--fa:"\\e340"}.fa-free-code-camp{--fa:"\\f2c5"}.fa-hornbill{--fa:"\\f592"}.fa-js{--fa:"\\f3b8"}.fa-ideal{--fa:"\\e013"}.fa-git{--fa:"\\f1d3"}.fa-dev{--fa:"\\f6cc"}.fa-sketch{--fa:"\\f7c6"}.fa-yandex-international{--fa:"\\f414"}.fa-cc-amex{--fa:"\\f1f3"}.fa-uber{--fa:"\\f402"}.fa-github{--fa:"\\f09b"}.fa-php{--fa:"\\f457"}.fa-alipay{--fa:"\\f642"}.fa-youtube{--fa:"\\f167"}.fa-skyatlas{--fa:"\\f216"}.fa-firefox-browser{--fa:"\\e007"}.fa-replyd{--fa:"\\f3e6"}.fa-suse{--fa:"\\f7d6"}.fa-jenkins{--fa:"\\f3b6"}.fa-twitter{--fa:"\\f099"}.fa-rockrms{--fa:"\\f3e9"}.fa-pinterest{--fa:"\\f0d2"}.fa-buffer{--fa:"\\f837"}.fa-npm{--fa:"\\f3d4"}.fa-yammer{--fa:"\\f840"}.fa-btc{--fa:"\\f15a"}.fa-dribbble{--fa:"\\f17d"}.fa-stumbleupon-circle{--fa:"\\f1a3"}.fa-internet-explorer{--fa:"\\f26b"}.fa-stubber{--fa:"\\e5c7"}.fa-telegram,.fa-telegram-plane{--fa:"\\f2c6"}.fa-old-republic{--fa:"\\f510"}.fa-odysee{--fa:"\\e5c6"}.fa-square-whatsapp,.fa-whatsapp-square{--fa:"\\f40c"}.fa-node-js{--fa:"\\f3d3"}.fa-edge-legacy{--fa:"\\e078"}.fa-slack,.fa-slack-hash{--fa:"\\f198"}.fa-medrt{--fa:"\\f3c8"}.fa-usb{--fa:"\\f287"}.fa-tumblr{--fa:"\\f173"}.fa-vaadin{--fa:"\\f408"}.fa-quora{--fa:"\\f2c4"}.fa-square-x-twitter{--fa:"\\e61a"}.fa-reacteurope{--fa:"\\f75d"}.fa-medium,.fa-medium-m{--fa:"\\f23a"}.fa-amilia{--fa:"\\f36d"}.fa-mixcloud{--fa:"\\f289"}.fa-flipboard{--fa:"\\f44d"}.fa-viacoin{--fa:"\\f237"}.fa-critical-role{--fa:"\\f6c9"}.fa-sitrox{--fa:"\\e44a"}.fa-discourse{--fa:"\\f393"}.fa-joomla{--fa:"\\f1aa"}.fa-mastodon{--fa:"\\f4f6"}.fa-airbnb{--fa:"\\f834"}.fa-wolf-pack-battalion{--fa:"\\f514"}.fa-buy-n-large{--fa:"\\f8a6"}.fa-gulp{--fa:"\\f3ae"}.fa-creative-commons-sampling-plus{--fa:"\\f4f1"}.fa-strava{--fa:"\\f428"}.fa-ember{--fa:"\\f423"}.fa-canadian-maple-leaf{--fa:"\\f785"}.fa-teamspeak{--fa:"\\f4f9"}.fa-pushed{--fa:"\\f3e1"}.fa-wordpress-simple{--fa:"\\f411"}.fa-nutritionix{--fa:"\\f3d6"}.fa-wodu{--fa:"\\e088"}.fa-google-pay{--fa:"\\e079"}.fa-intercom{--fa:"\\f7af"}.fa-zhihu{--fa:"\\f63f"}.fa-korvue{--fa:"\\f42f"}.fa-pix{--fa:"\\e43a"}.fa-steam-symbol{--fa:"\\f3f6"}:host,:root{--fa-font-regular:normal 400 1em/1 "Font Awesome 6 Free"}@font-face{font-family:"Font Awesome 6 Free";font-style:normal;font-weight:400;font-display:block;src:url(${w}) format("woff2"),url(${_}) format("truetype")}.fa-regular,.far{font-weight:400}:host,:root{--fa-style-family-classic:"Font Awesome 6 Free";--fa-font-solid:normal 900 1em/1 "Font Awesome 6 Free"}@font-face{font-family:"Font Awesome 6 Free";font-style:normal;font-weight:900;font-display:block;src:url(${A}) format("woff2"),url(${x}) format("truetype")}.fa-solid,.fas{font-weight:900}@font-face{font-family:"Font Awesome 5 Brands";font-display:block;font-weight:400;src:url(${y}) format("woff2"),url(${b}) format("truetype")}@font-face{font-family:"Font Awesome 5 Free";font-display:block;font-weight:900;src:url(${A}) format("woff2"),url(${x}) format("truetype")}@font-face{font-family:"Font Awesome 5 Free";font-display:block;font-weight:400;src:url(${w}) format("woff2"),url(${_}) format("truetype")}@font-face{font-family:"FontAwesome";font-display:block;src:url(${A}) format("woff2"),url(${x}) format("truetype")}@font-face{font-family:"FontAwesome";font-display:block;src:url(${y}) format("woff2"),url(${b}) format("truetype")}@font-face{font-family:"FontAwesome";font-display:block;src:url(${w}) format("woff2"),url(${_}) format("truetype");unicode-range:u+f003,u+f006,u+f014,u+f016-f017,u+f01a-f01b,u+f01d,u+f022,u+f03e,u+f044,u+f046,u+f05c-f05d,u+f06e,u+f070,u+f087-f088,u+f08a,u+f094,u+f096-f097,u+f09d,u+f0a0,u+f0a2,u+f0a4-f0a7,u+f0c5,u+f0c7,u+f0e5-f0e6,u+f0eb,u+f0f6-f0f8,u+f10c,u+f114-f115,u+f118-f11a,u+f11c-f11d,u+f133,u+f147,u+f14e,u+f150-f152,u+f185-f186,u+f18e,u+f190-f192,u+f196,u+f1c1-f1c9,u+f1d9,u+f1db,u+f1e3,u+f1ea,u+f1f7,u+f1f9,u+f20a,u+f247-f248,u+f24a,u+f24d,u+f255-f25b,u+f25d,u+f271-f274,u+f278,u+f27b,u+f28c,u+f28e,u+f29c,u+f2b5,u+f2b7,u+f2ba,u+f2bc,u+f2be,u+f2c0-f2c1,u+f2c3,u+f2d0,u+f2d2,u+f2d4,u+f2dc}@font-face{font-family:"FontAwesome";font-display:block;src:url(${E}) format("woff2"),url(${T}) format("truetype");unicode-range:u+f041,u+f047,u+f065-f066,u+f07d-f07e,u+f080,u+f08b,u+f08e,u+f090,u+f09a,u+f0ac,u+f0ae,u+f0b2,u+f0d0,u+f0d6,u+f0e4,u+f0ec,u+f10a-f10b,u+f123,u+f13e,u+f148-f149,u+f14c,u+f156,u+f15e,u+f160-f161,u+f163,u+f175-f178,u+f195,u+f1f8,u+f219,u+f27a}`,""]);const S=v},6314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,a){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(s[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&s[h[0]]||(void 0!==a&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=a),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},4417:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},1601:t=>{"use strict";t.exports=function(t){return t[1]}},4623:function(t){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={407:function(t,e,n){n.d(e,{default:function(){return O}});var i=/([:*])(\w+)/g,r=/\*/g,a=/\/\?/g;function s(t){return void 0===t&&(t="/"),g()?location.pathname+location.search+location.hash:t}function o(t){return t.replace(/\/+$/,"").replace(/^\/+/,"")}function c(t){return"string"==typeof t}function l(t){return t&&t.indexOf("#")>=0&&t.split("#").pop()||""}function h(t){var e=o(t).split(/\?(.*)?$/);return[o(e[0]),e.slice(1).join("")]}function u(t){for(var e={},n=t.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(""!==r[0]){var a=decodeURIComponent(r[0]);e[a]?(Array.isArray(e[a])||(e[a]=[e[a]]),e[a].push(decodeURIComponent(r[1]||""))):e[a]=decodeURIComponent(r[1]||"")}}return e}function f(t,e){var n,s=h(o(t.currentLocationPath)),f=s[0],d=s[1],p=""===d?null:u(d),g=[];if(c(e.path)){if(n="(?:/^|^)"+o(e.path).replace(i,(function(t,e,n){return g.push(n),"([^/]+)"})).replace(r,"?(?:.*)").replace(a,"/?([^/]+|)")+"$",""===o(e.path)&&""===o(f))return{url:f,queryString:d,hashString:l(t.to),route:e,data:null,params:p}}else n=e.path;var m=new RegExp(n,""),v=f.match(m);if(v){var y=c(e.path)?function(t,e){return 0===e.length?null:t?t.slice(1,t.length).reduce((function(t,n,i){return null===t&&(t={}),t[e[i]]=decodeURIComponent(n),t}),null):null}(v,g):v.groups?v.groups:v.slice(1);return{url:o(f.replace(new RegExp("^"+t.instance.root),"")),queryString:d,hashString:l(t.to),route:e,data:y,params:p}}return!1}function d(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function p(t,e){return void 0===t[e]||!0===t[e]}function g(){return"undefined"!=typeof window}function m(t,e){return void 0===t&&(t=[]),void 0===e&&(e={}),t.filter((function(t){return t})).forEach((function(t){["before","after","already","leave"].forEach((function(n){t[n]&&(e[n]||(e[n]=[]),e[n].push(t[n]))}))})),e}function v(t,e,n){var i=e||{},r=0;!function e(){t[r]?Array.isArray(t[r])?(t.splice.apply(t,[r,1].concat(t[r][0](i)?t[r][1]:t[r][2])),e()):t[r](i,(function(t){void 0===t||!0===t?(r+=1,e()):n&&n(i)})):n&&n(i)}()}function y(t,e){void 0===t.currentLocationPath&&(t.currentLocationPath=t.to=s(t.instance.root)),t.currentLocationPath=t.instance._checkForAHash(t.currentLocationPath),e()}function b(t,e){for(var n=0;n<t.instance.routes.length;n++){var i=f(t,t.instance.routes[n]);if(i&&(t.matches||(t.matches=[]),t.matches.push(i),"ONE"===t.resolveOptions.strategy))return void e()}e()}function w(t,e){t.navigateOptions&&(void 0!==t.navigateOptions.shouldResolve&&console.warn('"shouldResolve" is deprecated. Please check the documentation.'),void 0!==t.navigateOptions.silent&&console.warn('"silent" is deprecated. Please check the documentation.')),e()}function _(t,e){!0===t.navigateOptions.force?(t.instance._setCurrent([t.instance._pathToMatchObject(t.to)]),e(!1)):e()}v.if=function(t,e,n){return Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]),[t,e,n]};var A=g(),x=d();function E(t,e){if(p(t.navigateOptions,"updateBrowserURL")){var n=("/"+t.to).replace(/\/\//g,"/"),i=A&&t.resolveOptions&&!0===t.resolveOptions.hash;x?(history[t.navigateOptions.historyAPIMethod||"pushState"](t.navigateOptions.stateObj||{},t.navigateOptions.title||"",i?"#"+n:n),location&&location.hash&&(t.instance.__freezeListening=!0,setTimeout((function(){if(!i){var e=location.hash;location.hash="",location.hash=e}t.instance.__freezeListening=!1}),1))):A&&(window.location.href=t.to)}e()}function T(t,e){var n=t.instance;n.lastResolved()?v(n.lastResolved().map((function(e){return function(n,i){if(e.route.hooks&&e.route.hooks.leave){var r,a=t.instance.matchLocation(e.route.path,t.currentLocationPath,!1);r="*"!==e.route.path?!a:!(t.matches&&t.matches.find((function(t){return e.route.path===t.route.path}))),p(t.navigateOptions,"callHooks")&&r?v(e.route.hooks.leave.map((function(e){return function(n,i){return e((function(e){!1===e?t.instance.__markAsClean(t):i()}),t.matches&&t.matches.length>0?1===t.matches.length?t.matches[0]:t.matches:void 0)}})).concat([function(){return i()}])):i()}else i()}})),{},(function(){return e()})):e()}function S(t,e){p(t.navigateOptions,"updateState")&&t.instance._setCurrent(t.matches),e()}var C=[function(t,e){var n=t.instance.lastResolved();if(n&&n[0]&&n[0].route===t.match.route&&n[0].url===t.match.url&&n[0].queryString===t.match.queryString)return n.forEach((function(e){e.route.hooks&&e.route.hooks.already&&p(t.navigateOptions,"callHooks")&&e.route.hooks.already.forEach((function(e){return e(t.match)}))})),void e(!1);e()},function(t,e){t.match.route.hooks&&t.match.route.hooks.before&&p(t.navigateOptions,"callHooks")?v(t.match.route.hooks.before.map((function(e){return function(n,i){return e((function(e){!1===e?t.instance.__markAsClean(t):i()}),t.match)}})).concat([function(){return e()}])):e()},function(t,e){p(t.navigateOptions,"callHandler")&&t.match.route.handler(t.match),t.instance.updatePageLinks(),e()},function(t,e){t.match.route.hooks&&t.match.route.hooks.after&&p(t.navigateOptions,"callHooks")&&t.match.route.hooks.after.forEach((function(e){return e(t.match)})),e()}],k=[T,function(t,e){var n=t.instance._notFoundRoute;if(n){t.notFoundHandled=!0;var i=h(t.currentLocationPath),r=i[0],a=i[1],s=l(t.to);n.path=o(r);var c={url:n.path,queryString:a,hashString:s,data:null,route:n,params:""!==a?u(a):null};t.matches=[c],t.match=c}e()},v.if((function(t){return t.notFoundHandled}),C.concat([S]),[function(t,e){t.resolveOptions&&!1!==t.resolveOptions.noMatchWarning&&void 0!==t.resolveOptions.noMatchWarning||console.warn('Navigo: "'+t.currentLocationPath+"\" didn't match any of the registered routes."),e()},function(t,e){t.instance._setCurrent(null),e()}])];function I(){return(I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function R(t,e){var n=0;T(t,(function i(){n!==t.matches.length?v(C,I({},t,{match:t.matches[n]}),(function(){n+=1,i()})):S(t,e)}))}function M(t){t.instance.__markAsClean(t)}function P(){return(P=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var D="[data-navigo]";function O(t,e){var n,i=e||{strategy:"ONE",hash:!1,noMatchWarning:!1,linksSelector:D},r=this,a="/",p=null,A=[],x=!1,T=d(),S=g();function C(t){return t.indexOf("#")>=0&&(t=!0===i.hash?t.split("#")[1]||"/":t.split("#")[0]),t}function I(t){return o(a+"/"+o(t))}function O(t,e,n,i){return t=c(t)?I(t):t,{name:i||o(String(t)),path:t,handler:e,hooks:m(n)}}function N(t,e){if(!r.__dirty){r.__dirty=!0,t=t?o(a)+"/"+o(t):void 0;var n={instance:r,to:t,currentLocationPath:t,navigateOptions:{},resolveOptions:P({},i,e)};return v([y,b,v.if((function(t){var e=t.matches;return e&&e.length>0}),R,k)],n,M),!!n.matches&&n.matches}r.__waiting.push((function(){return r.resolve(t,e)}))}function L(t,e){if(r.__dirty)r.__waiting.push((function(){return r.navigate(t,e)}));else{r.__dirty=!0,t=o(a)+"/"+o(t);var n={instance:r,to:t,navigateOptions:e||{},resolveOptions:e&&e.resolveOptions?e.resolveOptions:i,currentLocationPath:C(t)};v([w,_,b,v.if((function(t){var e=t.matches;return e&&e.length>0}),R,k),E,M],n,M)}}function F(){if(S)return(S?[].slice.call(document.querySelectorAll(i.linksSelector||D)):[]).forEach((function(t){"false"!==t.getAttribute("data-navigo")&&"_blank"!==t.getAttribute("target")?t.hasListenerAttached||(t.hasListenerAttached=!0,t.navigoHandler=function(e){if((e.ctrlKey||e.metaKey)&&"a"===e.target.tagName.toLowerCase())return!1;var n=t.getAttribute("href");if(null==n)return!1;if(n.match(/^(http|https)/)&&"undefined"!=typeof URL)try{var i=new URL(n);n=i.pathname+i.search}catch(t){}var a=function(t){if(!t)return{};var e,n=t.split(","),i={};return n.forEach((function(t){var n=t.split(":").map((function(t){return t.replace(/(^ +| +$)/g,"")}));switch(n[0]){case"historyAPIMethod":i.historyAPIMethod=n[1];break;case"resolveOptionsStrategy":e||(e={}),e.strategy=n[1];break;case"resolveOptionsHash":e||(e={}),e.hash="true"===n[1];break;case"updateBrowserURL":case"callHandler":case"updateState":case"force":i[n[0]]="true"===n[1]}})),e&&(i.resolveOptions=e),i}(t.getAttribute("data-navigo-options"));x||(e.preventDefault(),e.stopPropagation(),r.navigate(o(n),a))},t.addEventListener("click",t.navigoHandler)):t.hasListenerAttached&&t.removeEventListener("click",t.navigoHandler)})),r}function U(t,e,n){var i=A.find((function(e){return e.name===t})),r=null;if(i){if(r=i.path,e)for(var s in e)r=r.replace(":"+s,e[s]);r=r.match(/^\//)?r:"/"+r}return r&&n&&!n.includeRoot&&(r=r.replace(new RegExp("^/"+a),"")),r}function j(t){var e=h(o(t)),i=e[0],r=e[1],a=""===r?null:u(r);return{url:i,queryString:r,hashString:l(t),route:O(i,(function(){}),[n],i),data:null,params:a}}function B(t,e,n){return"string"==typeof e&&(e=V(e)),e?(e.hooks[t]||(e.hooks[t]=[]),e.hooks[t].push(n),function(){e.hooks[t]=e.hooks[t].filter((function(t){return t!==n}))}):(console.warn("Route doesn't exists: "+e),function(){})}function V(t){return"string"==typeof t?A.find((function(e){return e.name===I(t)})):A.find((function(e){return e.handler===t}))}t?a=o(t):console.warn('Navigo requires a root path in its constructor. If not provided will use "/" as default.'),this.root=a,this.routes=A,this.destroyed=x,this.current=p,this.__freezeListening=!1,this.__waiting=[],this.__dirty=!1,this.__markAsClean=function(t){t.instance.__dirty=!1,t.instance.__waiting.length>0&&t.instance.__waiting.shift()()},this.on=function(t,e,i){var r=this;return"object"!=typeof t||t instanceof RegExp?("function"==typeof t&&(i=e,e=t,t=a),A.push(O(t,e,[n,i])),this):(Object.keys(t).forEach((function(e){if("function"==typeof t[e])r.on(e,t[e]);else{var i=t[e],a=i.uses,s=i.as,o=i.hooks;A.push(O(e,a,[n,o],s))}})),this)},this.off=function(t){return this.routes=A=A.filter((function(e){return c(t)?o(e.path)!==o(t):"function"==typeof t?t!==e.handler:String(e.path)!==String(t)})),this},this.resolve=N,this.navigate=L,this.navigateByName=function(t,e,n){var i=U(t,e);return null!==i&&(L(i.replace(new RegExp("^/?"+a),""),n),!0)},this.destroy=function(){this.routes=A=[],T&&window.removeEventListener("popstate",this.__popstateListener),this.destroyed=x=!0},this.notFound=function(t,e){return r._notFoundRoute=O("*",t,[n,e],"__NOT_FOUND__"),this},this.updatePageLinks=F,this.link=function(t){return"/"+a+"/"+o(t)},this.hooks=function(t){return n=t,this},this.extractGETParameters=function(t){return h(C(t))},this.lastResolved=function(){return p},this.generate=U,this.getLinkPath=function(t){return t.getAttribute("href")},this.match=function(t){var e={instance:r,currentLocationPath:t,to:t,navigateOptions:{},resolveOptions:i};return b(e,(function(){})),!!e.matches&&e.matches},this.matchLocation=function(t,e,n){void 0===e||void 0!==n&&!n||(e=I(e));var i={instance:r,to:e,currentLocationPath:e};return y(i,(function(){})),"string"==typeof t&&(t=void 0===n||n?I(t):t),f(i,{name:String(t),path:t,handler:function(){},hooks:{}})||!1},this.getCurrentLocation=function(){return j(o(s(a)).replace(new RegExp("^"+a),""))},this.addBeforeHook=B.bind(this,"before"),this.addAfterHook=B.bind(this,"after"),this.addAlreadyHook=B.bind(this,"already"),this.addLeaveHook=B.bind(this,"leave"),this.getRoute=V,this._pathToMatchObject=j,this._clean=o,this._checkForAHash=C,this._setCurrent=function(t){return p=r.current=t},function(){T&&(this.__popstateListener=function(){r.__freezeListening||N()},window.addEventListener("popstate",this.__popstateListener))}.call(this),F.call(this)}}},e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}return n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n(407)}().default},9331:(t,e,n)=>{"use strict";var i=n(5072),r=n.n(i),a=n(7825),s=n.n(a),o=n(7659),c=n.n(o),l=n(5056),h=n.n(l),u=n(540),f=n.n(u),d=n(1113),p=n.n(d),g=n(8758),m={};m.styleTagTransform=p(),m.setAttributes=h(),m.insert=c().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=f(),r()(g.A,m),g.A&&g.A.locals&&g.A.locals},5072:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var a={},s=[],o=0;o<t.length;o++){var c=t[o],l=i.base?c[0]+i.base:c[0],h=a[l]||0,u="".concat(l," ").concat(h);a[l]=h+1;var f=n(u),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=r(d,i);i.byIndex=o,e.splice(o,0,{identifier:u,updater:p,references:1})}s.push(u)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var a=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<a.length;s++){var o=n(a[s]);e[o].references--}for(var c=i(t,r),l=0;l<a.length;l++){var h=n(a[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}a=c}}},7659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},5056:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},1113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},4189:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-brands-400.ttf"},2459:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-brands-400.woff2"},2539:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-regular-400.ttf"},3321:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-regular-400.woff2"},651:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-solid-900.ttf"},3369:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-solid-900.woff2"},8326:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-v4compatibility.ttf"},720:(t,e,n)=>{"use strict";t.exports=n.p+"assets/fa-v4compatibility.woff2"},1990:(t,e,n)=>{"use strict";n.d(e,{MF:()=>lt,j6:()=>at,xZ:()=>st,om:()=>rt,Sx:()=>ut,Wp:()=>ht,KO:()=>ft});var i=n(5125),r=n(3424),a=n(6743);let s,o;const c=new WeakMap,l=new WeakMap,h=new WeakMap,u=new WeakMap,f=new WeakMap;let d={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return l.get(t);if("objectStoreNames"===e)return t.objectStoreNames||h.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function p(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(m(this),t),g(c.get(this))}:function(...t){return g(e.apply(m(this),t))}:function(t,...n){const i=e.call(m(this),t,...n);return h.set(i,t.sort?t.sort():[t]),g(i)}:(t instanceof IDBTransaction&&function(t){if(l.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{e(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)}));l.set(t,e)}(t),n=t,(s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,d):t);var e,n}function g(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{e(g(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",a)}));return e.then((e=>{e instanceof IDBCursor&&c.set(e,t)})).catch((()=>{})),f.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=p(t);return e!==t&&(u.set(t,e),f.set(e,t)),e}const m=t=>f.get(t),v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function w(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(b.get(e))return b.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!v.includes(n))return;const a=async function(t,...e){const a=this.transaction(t,r?"readwrite":"readonly");let s=a.store;return i&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),r&&a.done]))[0]};return b.set(e,a),a}var _;_=d,d={..._,get:(t,e,n)=>w(t,e)||_.get(t,e,n),has:(t,e)=>!!w(t,e)||_.has(t,e)};class A{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const x="@firebase/app",E="0.10.17",T=new r.Vy("@firebase/app"),S="@firebase/app-compat",C="@firebase/analytics-compat",k="@firebase/analytics",I="@firebase/app-check-compat",R="@firebase/app-check",M="@firebase/auth",P="@firebase/auth-compat",D="@firebase/database",O="@firebase/data-connect",N="@firebase/database-compat",L="@firebase/functions",F="@firebase/functions-compat",U="@firebase/installations",j="@firebase/installations-compat",B="@firebase/messaging",V="@firebase/messaging-compat",z="@firebase/performance",q="@firebase/performance-compat",H="@firebase/remote-config",$="@firebase/remote-config-compat",G="@firebase/storage",W="@firebase/storage-compat",K="@firebase/firestore",X="@firebase/vertexai",Y="@firebase/firestore-compat",Q="firebase",J="[DEFAULT]",Z={[x]:"fire-core",[S]:"fire-core-compat",[k]:"fire-analytics",[C]:"fire-analytics-compat",[R]:"fire-app-check",[I]:"fire-app-check-compat",[M]:"fire-auth",[P]:"fire-auth-compat",[D]:"fire-rtdb",[O]:"fire-data-connect",[N]:"fire-rtdb-compat",[L]:"fire-fn",[F]:"fire-fn-compat",[U]:"fire-iid",[j]:"fire-iid-compat",[B]:"fire-fcm",[V]:"fire-fcm-compat",[z]:"fire-perf",[q]:"fire-perf-compat",[H]:"fire-rc",[$]:"fire-rc-compat",[G]:"fire-gcs",[W]:"fire-gcs-compat",[K]:"fire-fst",[Y]:"fire-fst-compat",[X]:"fire-vertex","fire-js":"fire-js",[Q]:"fire-js-all"},tt=new Map,et=new Map,nt=new Map;function it(t,e){try{t.container.addComponent(e)}catch(n){T.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function rt(t){const e=t.name;if(nt.has(e))return T.debug(`There were multiple attempts to register component ${e}.`),!1;nt.set(e,t);for(const e of tt.values())it(e,t);for(const e of et.values())it(e,t);return!0}function at(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function st(t){return void 0!==t.settings}const ot=new a.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ct{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ot.create("app-deleted",{appName:this._name})}}const lt="11.1.0";function ht(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:J,automaticDataCollectionEnabled:!1},e),s=r.name;if("string"!=typeof s||!s)throw ot.create("bad-app-name",{appName:String(s)});if(n||(n=(0,a.T9)()),!n)throw ot.create("no-options");const o=tt.get(s);if(o){if((0,a.bD)(n,o.options)&&(0,a.bD)(r,o.config))return o;throw ot.create("duplicate-app",{appName:s})}const c=new i.h1(s);for(const t of nt.values())c.addComponent(t);const l=new ct(n,r,c);return tt.set(s,l),l}function ut(t=J){const e=tt.get(t);if(!e&&t===J&&(0,a.T9)())return ht();if(!e)throw ot.create("no-app",{appName:t});return e}function ft(t,e,n){var r;let a=null!==(r=Z[t])&&void 0!==r?r:t;n&&(a+=`-${n}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${a}" with version "${e}":`];return s&&t.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void T.warn(t.join(" "))}rt(new i.uA(`${a}-version`,(()=>({library:a,version:e})),"VERSION"))}const dt="firebase-heartbeat-store";let pt=null;function gt(){return pt||(pt=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:a}={}){const s=indexedDB.open(t,e),o=g(s);return i&&s.addEventListener("upgradeneeded",(t=>{i(g(s.result),t.oldVersion,t.newVersion,g(s.transaction),t)})),n&&s.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),o.then((t=>{a&&t.addEventListener("close",(()=>a())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(dt)}catch(t){console.warn(t)}}}).catch((t=>{throw ot.create("idb-open",{originalErrorMessage:t.message})}))),pt}async function mt(t,e){try{const n=(await gt()).transaction(dt,"readwrite"),i=n.objectStore(dt);await i.put(e,vt(t)),await n.done}catch(t){if(t instanceof a.g)T.warn(t.message);else{const e=ot.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});T.warn(e.message)}}}function vt(t){return`${t.name}!${t.options.appId}`}class yt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new wt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=bt();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(t){T.warn(t)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=bt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),_t(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),_t(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=(0,a.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return T.warn(t),""}}}function bt(){return(new Date).toISOString().substring(0,10)}class wt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await gt()).transaction(dt),n=await e.objectStore(dt).get(vt(t));return await e.done,n}catch(t){if(t instanceof a.g)T.warn(t.message);else{const e=ot.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});T.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function _t(t){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:t})).length}rt(new i.uA("platform-logger",(t=>new A(t)),"PRIVATE")),rt(new i.uA("heartbeat",(t=>new yt(t)),"PRIVATE")),ft(x,E,""),ft(x,E,"esm2017"),ft("fire-js","")},5125:(t,e,n)=>{"use strict";n.d(e,{h1:()=>o,uA:()=>r});var i=n(6743);class r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const a="[DEFAULT]";class s{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.cY;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=a){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=a){return this.instances.has(t)}getOptions(t=a){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&t(a,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===a?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=a){return this.component?this.component.multipleInstances?t:a:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new s(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},3424:(t,e,n)=>{"use strict";n.d(e,{$b:()=>r,Vy:()=>l});const i=[];var r;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));const a={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},s=r.INFO,o={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=o[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class l{constructor(t){this.name=t,this._logLevel=s,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?a[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},223:(t,e,n)=>{"use strict";n.d(e,{Wp:()=>i.Wp});var i=n(1990);(0,i.KO)("firebase","11.1.0","app")},6887:(t,e,n)=>{"use strict";n.d(e,{IX:()=>Vt,HF:()=>$t,eJ:()=>re,xI:()=>xn,hg:()=>ce,kZ:()=>ee,J1:()=>ie,x9:()=>ae,df:()=>He,CI:()=>le,f3:()=>oe,r7:()=>se});var i=n(1990),r=n(6743),a=n(3424);function s(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var o=n(5125);const c=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},l=new r.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),h=new a.Vy("@firebase/auth");function u(t,...e){h.logLevel<=a.$b.ERROR&&h.error(`Auth (${i.MF}): ${t}`,...e)}function f(t,...e){throw m(t,...e)}function d(t,...e){return m(t,...e)}function p(t,e,n){const i=Object.assign(Object.assign({},c()),{[e]:n});return new r.FA("auth","Firebase",i).create(e,{appName:t.name})}function g(t){return p(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function m(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return l.create(t,...e)}function v(t,e,...n){if(!t)throw m(e,...n)}function y(t){const e="INTERNAL ASSERTION FAILED: "+t;throw u(e),new Error(e)}function b(t,e){t||y(e)}function w(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function _(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class A{constructor(t,e){this.shortDelay=t,this.longDelay=e,b(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===_()||"https:"===_()||(0,r.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function x(t,e){b(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class E{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void y("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void y("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void y("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const T={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},S=new A(3e4,6e4);function C(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function k(t,e,n,i,a={}){return I(t,a,(async()=>{let a={},s={};i&&("GET"===e?s=i:a={body:JSON.stringify(i)});const o=(0,r.Am)(Object.assign({key:t.config.apiKey},s)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l=Object.assign({method:e,headers:c},a);return(0,r.c1)()||(l.referrerPolicy="no-referrer"),E.fetch()(M(t,t.config.apiHost,n,o),l)}))}async function I(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},T),e);try{const e=new D(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw O(t,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const e=r.ok?a.errorMessage:a.error.message,[n,s]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw O(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw O(t,"email-already-in-use",a);if("USER_DISABLED"===n)throw O(t,"user-disabled",a);const o=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw p(t,o,s);f(t,o)}}catch(e){if(e instanceof r.g)throw e;f(t,"network-request-failed",{message:String(e)})}}async function R(t,e,n,i,r={}){const a=await k(t,e,n,i,r);return"mfaPendingCredential"in a&&f(t,"multi-factor-auth-required",{_serverResponse:a}),a}function M(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?x(t.config,r):`${t.config.apiScheme}://${r}`}function P(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class D{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(d(this.auth,"network-request-failed"))),S.get())}))}}function O(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=d(t,e,i);return r.customData._tokenResponse=n,r}function N(t){return void 0!==t&&void 0!==t.enterprise}class L{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return P(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function F(t,e){return k(t,"GET","/v2/recaptchaConfig",C(t,e))}async function U(t,e){return k(t,"POST","/v1/accounts:lookup",e)}function j(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function B(t){return 1e3*Number(t)}function V(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return u("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,r.u)(n);return t?JSON.parse(t):(u("Failed to decode base64 JWT payload"),null)}catch(t){return u("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}function z(t){const e=V(t);return v(e,"internal-error"),v(void 0!==e.exp,"internal-error"),v(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function q(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof r.g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class H{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class ${constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=j(this.lastLoginAt),this.creationTime=j(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function G(t){var e;const n=t.auth,i=await t.getIdToken(),r=await q(t,U(n,{idToken:i}));v(null==r?void 0:r.users.length,n,"internal-error");const a=r.users[0];t._notifyReloadListener(a);const s=(null===(e=a.providerUserInfo)||void 0===e?void 0:e.length)?W(a.providerUserInfo):[],o=(c=t.providerData,l=s,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const h=t.isAnonymous,u=!(t.email&&a.passwordHash||(null==o?void 0:o.length)),f=!!h&&u,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new $(a.createdAt,a.lastLoginAt),isAnonymous:f};Object.assign(t,d)}function W(t){return t.map((t=>{var{providerId:e}=t,n=s(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class K{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){v(t.idToken,"internal-error"),v(void 0!==t.idToken,"internal-error"),v(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):z(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){v(0!==t.length,"internal-error");const e=z(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return e||!this.accessToken||this.isExpired?(v(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:a}=await async function(t,e){const n=await I(t,{},(async()=>{const n=(0,r.Am)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=M(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",E.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,a=new K;return n&&(v("string"==typeof n,"internal-error",{appName:t}),a.refreshToken=n),i&&(v("string"==typeof i,"internal-error",{appName:t}),a.accessToken=i),r&&(v("number"==typeof r,"internal-error",{appName:t}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new K,this.toJSON())}_performRefresh(){return y("not implemented")}}function X(t,e){v("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Y{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=s(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new $(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await q(this,this.stsTokenManager.getToken(this.auth,t));return v(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=(0,r.Ku)(t),i=await n.getIdToken(e),a=V(i);v(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const s="object"==typeof a.firebase?a.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:a,token:i,authTime:j(B(a.auth_time)),issuedAtTime:j(B(a.iat)),expirationTime:j(B(a.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=(0,r.Ku)(t);await G(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(v(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Y(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await G(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,i.xZ)(this.auth.app))return Promise.reject(g(this.auth));const t=await this.getIdToken();return await q(this,async function(t,e){return k(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,a,s,o,c,l;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,f=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,d=null!==(a=e.photoURL)&&void 0!==a?a:void 0,p=null!==(s=e.tenantId)&&void 0!==s?s:void 0,g=null!==(o=e._redirectEventId)&&void 0!==o?o:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:b,emailVerified:w,isAnonymous:_,providerData:A,stsTokenManager:x}=e;v(b&&x,t,"internal-error");const E=K.fromJSON(this.name,x);v("string"==typeof b,t,"internal-error"),X(h,t.name),X(u,t.name),v("boolean"==typeof w,t,"internal-error"),v("boolean"==typeof _,t,"internal-error"),X(f,t.name),X(d,t.name),X(p,t.name),X(g,t.name),X(m,t.name),X(y,t.name);const T=new Y({uid:b,auth:t,email:u,emailVerified:w,displayName:h,isAnonymous:_,photoURL:d,phoneNumber:f,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:y});return A&&Array.isArray(A)&&(T.providerData=A.map((t=>Object.assign({},t)))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(t,e,n=!1){const i=new K;i.updateFromServerResponse(e);const r=new Y({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await G(r),r}static async _fromGetAccountInfoResponse(t,e,n){const i=e.users[0];v(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?W(i.providerUserInfo):[],a=!(i.email&&i.passwordHash||(null==r?void 0:r.length)),s=new K;s.updateFromIdToken(n);const o=new Y({uid:i.localId,auth:t,stsTokenManager:s,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new $(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==r?void 0:r.length))};return Object.assign(o,c),o}}const Q=new Map;function J(t){b(t instanceof Function,"Expected a class definition");let e=Q.get(t);return e?(b(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Q.set(t,e),e)}class Z{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Z.type="NONE";const tt=Z;function et(t,e,n){return`firebase:${t}:${e}:${n}`}class nt{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=et(this.userKey,i.apiKey,r),this.fullPersistenceKey=et("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Y._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new nt(J(tt),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||J(tt);const a=et(n,t.config.apiKey,t.name);let s=null;for(const n of e)try{const e=await n._get(a);if(e){const i=Y._fromJSON(t,e);n!==r&&(s=i),r=n;break}}catch(t){}const o=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&o.length?(r=o[0],s&&await r._set(a,s.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(a)}catch(t){}}))),new nt(r,t,n)):new nt(r,t,n)}}function it(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ot(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rt(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(lt(e))return"Blackberry";if(ht(e))return"Webos";if(at(e))return"Safari";if((e.includes("chrome/")||st(e))&&!e.includes("edge/"))return"Chrome";if(ct(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function rt(t=(0,r.ZQ)()){return/firefox\//i.test(t)}function at(t=(0,r.ZQ)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function st(t=(0,r.ZQ)()){return/crios\//i.test(t)}function ot(t=(0,r.ZQ)()){return/iemobile/i.test(t)}function ct(t=(0,r.ZQ)()){return/android/i.test(t)}function lt(t=(0,r.ZQ)()){return/blackberry/i.test(t)}function ht(t=(0,r.ZQ)()){return/webos/i.test(t)}function ut(t=(0,r.ZQ)()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ft(t=(0,r.ZQ)()){return ut(t)||ct(t)||ht(t)||lt(t)||/windows phone/i.test(t)||ot(t)}function dt(t,e=[]){let n;switch(t){case"Browser":n=it((0,r.ZQ)());break;case"Worker":n=`${it((0,r.ZQ)())}-${t}`;break;default:n=t}const a=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.MF}/${a}`}class pt{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class gt{constructor(t){var e,n,i,r;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=a.minPasswordLength)&&void 0!==e?e:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=t.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,r,a,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,o),this.validatePasswordCharacterOptions(t,o),o.isValid&&(o.isValid=null===(e=o.meetsMinPasswordLength)||void 0===e||e),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(i=o.containsLowercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(r=o.containsUppercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsNumericCharacter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class mt{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yt(this),this.idTokenSubscription=new yt(this),this.beforeStateQueue=new pt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=J(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await nt.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await U(this,{idToken:t}),n=await Y._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if((0,i.xZ)(this.app)){const t=this.app.settings.authIdToken;return t?new Promise((e=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(t).then(e,e)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,i=null==r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(t);n&&n!==i||!(null==s?void 0:s.user)||(r=s.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(t){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await G(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if((0,i.xZ)(this.app))return Promise.reject(g(this));const e=t?(0,r.Ku)(t):null;return e&&v(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&v(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(0,i.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return(0,i.xZ)(this.app)?Promise.reject(g(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(J(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return k(t,"GET","/v2/passwordPolicy",C(t,e))}(this),e=new gt(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new r.FA("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return k(t,"POST","/v2/accounts:revokeToken",C(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&J(t)||this._popupRedirectResolver;v(e,this,"argument-error"),this.redirectPersistenceManager=await nt.create(this,[J(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(v(s,this,"internal-error"),s.then((()=>{a||r(this.currentUser)})),"function"==typeof e){const r=t.addObserver(e,n,i);return()=>{a=!0,r()}}{const n=t.addObserver(e);return()=>{a=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=dt(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){h.logLevel<=a.$b.WARN&&h.warn(`Auth (${i.MF}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function vt(t){return(0,r.Ku)(t)}class yt{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,r.tD)((t=>this.observer=t))}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let bt={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wt(t){return bt.loadJS(t)}function _t(t){return`__${t}${Math.floor(1e6*Math.random())}`}class At{constructor(){this.enterprise=new xt}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class xt{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const Et="NO_RECAPTCHA";class Tt{constructor(t){this.type="recaptcha-enterprise",this.auth=vt(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;N(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n(Et)}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new At).execute("siteKey",{action:"verify"}):new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{F(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new L(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&N(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=bt.recaptchaEnterpriseScript;0!==e.length&&(e+=r),wt(e).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function St(t,e,n,i=!1,r=!1){const a=new Tt(t);let s;if(r)s=Et;else try{s=await a.verify(n)}catch(t){s=await a.verify(n,!0)}const o=Object.assign({},e);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const t=o.phoneEnrollmentInfo.phoneNumber,e=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const t=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ct(t,e,n,i,r){var a,s;if("EMAIL_PASSWORD_PROVIDER"===r){if(null===(a=t._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await St(t,e,n,"getOobCode"===n);return i(t,r)}return i(t,e).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await St(t,e,n,"getOobCode"===n);return i(t,r)}return Promise.reject(r)}))}if("PHONE_PROVIDER"===r){if(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const r=await St(t,e,n);return i(t,r).catch((async r=>{var a;if("AUDIT"===(null===(a=t._getRecaptchaConfig())||void 0===a?void 0:a.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===r.code||"auth/invalid-app-credential"===r.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const r=await St(t,e,n,!1,!0);return i(t,r)}return Promise.reject(r)}))}{const r=await St(t,e,n,!1,!0);return i(t,r)}}return Promise.reject(r+" provider is not supported.")}function kt(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function It(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Rt{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return y("not implemented")}_getIdTokenResponse(t){return y("not implemented")}_linkToIdToken(t,e){return y("not implemented")}_getReauthenticationResolver(t){return y("not implemented")}}async function Mt(t,e){return k(t,"POST","/v1/accounts:signUp",e)}async function Pt(t,e){return R(t,"POST","/v1/accounts:signInWithPassword",C(t,e))}async function Dt(t,e){return async function(t,e){return k(t,"POST","/v1/accounts:sendOobCode",C(t,e))}(t,e)}class Ot extends Rt{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Ot(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Ot(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Ct(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Pt,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return R(t,"POST","/v1/accounts:signInWithEmailLink",C(t,e))}(t,{email:this._email,oobCode:this._password});default:f(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Ct(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Mt,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return R(t,"POST","/v1/accounts:signInWithEmailLink",C(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:f(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Nt(t,e){return R(t,"POST","/v1/accounts:signInWithIdp",C(t,e))}class Lt extends Rt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Lt(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):f("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=s(e,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Lt(n,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(t){return Nt(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Nt(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Nt(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,r.Am)(e)}return t}}async function Ft(t,e){return k(t,"POST","/v1/accounts:sendVerificationCode",C(t,e))}const Ut={USER_NOT_FOUND:"user-not-found"};class jt extends Rt{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new jt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new jt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return R(t,"POST","/v1/accounts:signInWithPhoneNumber",C(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await R(t,"POST","/v1/accounts:signInWithPhoneNumber",C(t,e));if(n.temporaryProof)throw O(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return R(t,"POST","/v1/accounts:signInWithPhoneNumber",C(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Ut)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new jt({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Bt{constructor(t){var e,n,i,a,s,o;const c=(0,r.I9)((0,r.hp)(t)),l=null!==(e=c.apiKey)&&void 0!==e?e:null,h=null!==(n=c.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);v(l&&h&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=h,this.continueUrl=null!==(a=c.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=c.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=(0,r.I9)((0,r.hp)(t)).link,n=e?(0,r.I9)((0,r.hp)(e)).deep_link_id:null,i=(0,r.I9)((0,r.hp)(t)).deep_link_id;return(i?(0,r.I9)((0,r.hp)(i)).link:null)||i||n||e||t}(t);try{return new Bt(e)}catch(t){return null}}}class Vt{constructor(){this.providerId=Vt.PROVIDER_ID}static credential(t,e){return Ot._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Bt.parseLink(e);return v(n,"argument-error"),Ot._fromEmailAndCode(t,n.code,n.tenantId)}}Vt.PROVIDER_ID="password",Vt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Vt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class zt{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class qt extends zt{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Ht extends qt{constructor(){super("facebook.com")}static credential(t){return Lt._fromParams({providerId:Ht.PROVIDER_ID,signInMethod:Ht.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ht.credentialFromTaggedObject(t)}static credentialFromError(t){return Ht.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ht.credential(t.oauthAccessToken)}catch(t){return null}}}Ht.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ht.PROVIDER_ID="facebook.com";class $t extends qt{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Lt._fromParams({providerId:$t.PROVIDER_ID,signInMethod:$t.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return $t.credentialFromTaggedObject(t)}static credentialFromError(t){return $t.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return $t.credential(e,n)}catch(t){return null}}}$t.GOOGLE_SIGN_IN_METHOD="google.com",$t.PROVIDER_ID="google.com";class Gt extends qt{constructor(){super("github.com")}static credential(t){return Lt._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Gt.credentialFromTaggedObject(t)}static credentialFromError(t){return Gt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Gt.credential(t.oauthAccessToken)}catch(t){return null}}}Gt.GITHUB_SIGN_IN_METHOD="github.com",Gt.PROVIDER_ID="github.com";class Wt extends qt{constructor(){super("twitter.com")}static credential(t,e){return Lt._fromParams({providerId:Wt.PROVIDER_ID,signInMethod:Wt.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Wt.credentialFromTaggedObject(t)}static credentialFromError(t){return Wt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return Wt.credential(e,n)}catch(t){return null}}}async function Kt(t,e){return R(t,"POST","/v1/accounts:signUp",C(t,e))}Wt.TWITTER_SIGN_IN_METHOD="twitter.com",Wt.PROVIDER_ID="twitter.com";class Xt{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await Y._fromIdTokenResponse(t,n,i),a=Yt(n);return new Xt({user:r,providerId:a,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=Yt(n);return new Xt({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function Yt(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Qt extends r.g{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Qt.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Qt(t,e,n,i)}}function Jt(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Qt._fromErrorAndOperation(t,n,e,i);throw n}))}async function Zt(t,e,n=!1){const{auth:r}=t;if((0,i.xZ)(r.app))return Promise.reject(g(r));const a="reauthenticate";try{const i=await q(t,Jt(r,a,e,t),n);v(i.idToken,r,"internal-error");const s=V(i.idToken);v(s,r,"internal-error");const{sub:o}=s;return v(t.uid===o,r,"user-mismatch"),Xt._forOperation(t,a,i)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&f(r,"user-mismatch"),t}}async function te(t,e,n=!1){if((0,i.xZ)(t.app))return Promise.reject(g(t));const r="signIn",a=await Jt(t,r,e),s=await Xt._fromIdTokenResponse(t,r,a);return n||await t._updateCurrentUser(s.user),s}async function ee(t,e){return Zt((0,r.Ku)(t),e)}async function ne(t){const e=vt(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ie(t,e,n){const i=vt(t),r={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&function(t,e,n){var i;v((null===(i=n.url)||void 0===i?void 0:i.length)>0,t,"invalid-continue-uri"),v(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(v(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(v(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}(i,r,n),await Ct(i,r,"getOobCode",Dt,"EMAIL_PASSWORD_PROVIDER")}async function re(t,e,n){if((0,i.xZ)(t.app))return Promise.reject(g(t));const r=vt(t),a=Ct(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kt,"EMAIL_PASSWORD_PROVIDER"),s=await a.catch((e=>{throw"auth/password-does-not-meet-requirements"===e.code&&ne(t),e})),o=await Xt._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}function ae(t,e,n){return(0,i.xZ)(t.app)?Promise.reject(g(t)):async function(t,e){return te(vt(t),e)}((0,r.Ku)(t),Vt.credential(e,n)).catch((async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&ne(t),e}))}async function se(t,{displayName:e,photoURL:n}){if(void 0===e&&void 0===n)return;const i=(0,r.Ku)(t),a={idToken:await i.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},s=await q(i,async function(t,e){return k(t,"POST","/v1/accounts:update",e)}(i.auth,a));i.displayName=s.displayName||null,i.photoURL=s.photoUrl||null;const o=i.providerData.find((({providerId:t})=>"password"===t));o&&(o.displayName=i.displayName,o.photoURL=i.photoURL),await i._updateTokensIfNecessary(s)}function oe(t,e){return async function(t,e,n){const{auth:i}=t,r={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(r.email=e),n&&(r.password=n);const a=await q(t,async function(t,e){return k(t,"POST","/v1/accounts:update",e)}(i,r));await t._updateTokensIfNecessary(a,!0)}((0,r.Ku)(t),null,e)}function ce(t,e,n,i){return(0,r.Ku)(t).onAuthStateChanged(e,n,i)}function le(t){return(0,r.Ku)(t).signOut()}function he(t,e){return k(t,"POST","/v2/accounts/mfaEnrollment:start",C(t,e))}new WeakMap;const ue="__sak";class fe{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(ue,"1"),this.storage.removeItem(ue),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class de extends fe{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ft(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},a=this.storage.getItem(n);(0,r.lT)()&&10===document.documentMode&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}de.type="LOCAL";const pe=de;class ge extends fe{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}ge.type="SESSION";const me=ge;class ve{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new ve(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,a=this.handlersMap[i];if(!(null==a?void 0:a.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const s=Array.from(a).map((async t=>t(e.origin,r))),o=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:o})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ye(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}ve.receivers=[];class be{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise(((s,o)=>{const c=ye("",20);i.port1.start();const l=setTimeout((()=>{o(new Error("unsupported_event"))}),n);a={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),s(e.data.response);break;default:clearTimeout(l),clearTimeout(r),o(new Error("invalid_response"))}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function we(){return window}function _e(){return void 0!==we().WorkerGlobalScope&&"function"==typeof we().importScripts}const Ae="firebaseLocalStorageDb",xe="firebaseLocalStorage",Ee="fbase_key";class Te{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Se(t,e){return t.transaction([xe],e?"readwrite":"readonly").objectStore(xe)}function Ce(){const t=indexedDB.open(Ae,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(xe,{keyPath:Ee})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(xe)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Ae);return new Te(t).toPromise()}(),e(await Ce()))}))}))}async function ke(t,e,n){const i=Se(t,!0).put({[Ee]:e,value:n});return new Te(i).toPromise()}function Ie(t,e){const n=Se(t,!0).delete(e);return new Te(n).toPromise()}class Re{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ce()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _e()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ve._getInstance(_e()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new be(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Ce();return await ke(t,ue,"1"),await Ie(t,ue),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>ke(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Se(t,!1).get(e),i=await new Te(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Ie(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Se(t,!1).getAll();return new Te(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Re.type="LOCAL";const Me=Re;function Pe(t,e){return k(t,"POST","/v2/accounts/mfaSignIn:start",C(t,e))}_t("rcb"),new A(3e4,6e4);const De="recaptcha";async function Oe(t,e,n){var i;if(!t._getRecaptchaConfig())try{await async function(t){const e=vt(t),n=await F(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new L(n);null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.isAnyProviderEnabled()&&new Tt(e).verify()}(t)}catch(t){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"==typeof e?{phoneNumber:e}:e,"session"in r){const e=r.session;if("phoneNumber"in r){v("enroll"===e.type,t,"internal-error");const i=Ct(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},"mfaSmsEnrollment",(async(t,e)=>e.phoneEnrollmentInfo.captchaResponse===Et?(v((null==n?void 0:n.type)===De,t,"argument-error"),he(t,await Ne(t,e,n))):he(t,e)),"PHONE_PROVIDER");return(await i.catch((t=>Promise.reject(t)))).phoneSessionInfo.sessionInfo}{v("signin"===e.type,t,"internal-error");const a=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;v(a,t,"missing-multi-factor-info");const s=Ct(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},"mfaSmsSignIn",(async(t,e)=>e.phoneSignInInfo.captchaResponse===Et?(v((null==n?void 0:n.type)===De,t,"argument-error"),Pe(t,await Ne(t,e,n))):Pe(t,e)),"PHONE_PROVIDER");return(await s.catch((t=>Promise.reject(t)))).phoneResponseInfo.sessionInfo}}{const e=Ct(t,{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},"sendVerificationCode",(async(t,e)=>e.captchaResponse===Et?(v((null==n?void 0:n.type)===De,t,"argument-error"),Ft(t,await Ne(t,e,n))):Ft(t,e)),"PHONE_PROVIDER");return(await e.catch((t=>Promise.reject(t)))).sessionInfo}}finally{null==n||n._reset()}}async function Ne(t,e,n){v(n.type===De,t,"argument-error");const i=await n.verify();v("string"==typeof i,t,"argument-error");const r=Object.assign({},e);if("phoneEnrollmentInfo"in r){const t=r.phoneEnrollmentInfo.phoneNumber,e=r.phoneEnrollmentInfo.captchaResponse,n=r.phoneEnrollmentInfo.clientType,a=r.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(r,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:i,captchaResponse:e,clientType:n,recaptchaVersion:a}}),r}if("phoneSignInInfo"in r){const t=r.phoneSignInInfo.captchaResponse,e=r.phoneSignInInfo.clientType,n=r.phoneSignInInfo.recaptchaVersion;return Object.assign(r,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:t,clientType:e,recaptchaVersion:n}}),r}return Object.assign(r,{recaptchaToken:i}),r}class Le{constructor(t){this.providerId=Le.PROVIDER_ID,this.auth=vt(t)}verifyPhoneNumber(t,e){return Oe(this.auth,t,(0,r.Ku)(e))}static credential(t,e){return jt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Le.credentialFromTaggedObject(e)}static credentialFromError(t){return Le.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?jt._fromTokenResponse(e,n):null}}function Fe(t,e){return e?J(e):(v(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Le.PROVIDER_ID="phone",Le.PHONE_SIGN_IN_METHOD="phone";class Ue extends Rt{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Nt(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Nt(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Nt(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function je(t){return te(t.auth,new Ue(t),t.bypassAuthState)}function Be(t){const{auth:e,user:n}=t;return v(n,e,"internal-error"),Zt(n,new Ue(t),t.bypassAuthState)}async function Ve(t){const{auth:e,user:n}=t;return v(n,e,"internal-error"),async function(t,e,n=!1){const i=await q(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Xt._forOperation(t,"link",i)}(n,new Ue(t),t.bypassAuthState)}class ze{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:a,type:s}=t;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return je;case"linkViaPopup":case"linkViaRedirect":return Ve;case"reauthViaPopup":case"reauthViaRedirect":return Be;default:f(this.auth,"internal-error")}}resolve(t){b(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){b(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qe=new A(2e3,1e4);async function He(t,e,n){if((0,i.xZ)(t.app))return Promise.reject(d(t,"operation-not-supported-in-this-environment"));const r=vt(t);!function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&f(t,"argument-error"),p(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,e,zt);const a=Fe(r,n);return new $e(r,"signInViaPopup",e,a).executeNotNull()}class $e extends ze{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,$e.currentPopupAction&&$e.currentPopupAction.cancel(),$e.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return v(t,this.auth,"internal-error"),t}async onExecution(){b(1===this.filter.length,"Popup operations only handle one event");const t=ye();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(d(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(d(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$e.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(d(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,qe.get())};t()}}$e.currentPopupAction=null;const Ge=new Map;class We extends ze{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Ge.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return et("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return J(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}Ge.set(this.auth._key(),t)}return this.bypassAuthState||Ge.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ke(t,e){Ge.set(t._key(),e)}async function Xe(t,e,n=!1){if((0,i.xZ)(t.app))return Promise.reject(g(t));const r=vt(t),a=Fe(r,e),s=new We(r,a,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}class Ye{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Je(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Je(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(d(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qe(t))}saveEventToCache(t){this.cachedEventUids.add(Qe(t)),this.lastProcessedEventTime=Date.now()}}function Qe(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Je({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Ze=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tn=/^https?/;function en(t){const e=w(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!tn.test(n))return!1;if(Ze.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const nn=new A(3e4,6e4);function rn(){const t=we().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function an(t){return new Promise(((e,n)=>{var i,r,a;function s(){rn(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rn(),n(d(t,"network-request-failed"))},timeout:nn.get()})}if(null===(r=null===(i=we().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(a=we().gapi)||void 0===a?void 0:a.load)){const e=_t("iframefcb");return we()[e]=()=>{gapi.load?s():n(d(t,"network-request-failed"))},wt(`${bt.gapiScript}?onload=${e}`).catch((t=>n(t)))}s()}})).catch((t=>{throw sn=null,t}))}let sn=null;const on=new A(5e3,15e3),cn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ln=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hn(t){const e=t.config;v(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?x(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,a={apiKey:e.apiKey,appName:t.name,v:i.MF},s=ln.get(t.config.apiHost);s&&(a.eid=s);const o=t._getFrameworks();return o.length&&(a.fw=o.join(",")),`${n}?${(0,r.Am)(a).slice(1)}`}const un={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class fn{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const dn=encodeURIComponent("fac");async function pn(t,e,n,a,s,o){v(t.config.authDomain,t,"auth-domain-config-required"),v(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:a,v:i.MF,eventId:s};if(e instanceof zt){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",(0,r.Im)(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(o||{}))c[t]=e}if(e instanceof qt){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(c.scopes=t.join(","))}t.tenantId&&(c.tid=t.tenantId);const l=c;for(const t of Object.keys(l))void 0===l[t]&&delete l[t];const h=await t._getAppCheckToken(),u=h?`#${dn}=${encodeURIComponent(h)}`:"";return`${function({config:t}){return t.emulator?x(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${(0,r.Am)(l).slice(1)}${u}`}const gn="webStorageSupport",mn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=me,this._completeRedirectFn=Xe,this._overrideRedirectResult=Ke}async _openPopup(t,e,n,i){var a;return b(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,a=600){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const l=Object.assign(Object.assign({},un),{width:i.toString(),height:a.toString(),top:s,left:o}),h=(0,r.ZQ)().toLowerCase();n&&(c=st(h)?"_blank":n),rt(h)&&(e=e||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=(0,r.ZQ)()){var e;return ut(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new fn(null);const f=window.open(e||"",c,u);v(f,t,"popup-blocked");try{f.focus()}catch(t){}return new fn(f)}(t,await pn(t,e,n,w(),i),ye())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await pn(t,e,n,w(),i),we().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(b(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return sn=sn||an(t),sn}(t),n=we().gapi;return v(n,t,"internal-error"),e.open({where:document.body,url:hn(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cn,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=d(t,"network-request-failed"),a=we().setTimeout((()=>{i(r)}),on.get());function s(){we().clearTimeout(a),n(e)}e.ping(s).then(s,(()=>{i(r)}))}))))}(t),n=new Ye(t);return e.register("authEvent",(e=>(v(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(gn,{type:gn},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[gn];void 0!==r&&e(!!r),f(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return k(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(en(t))return}catch(t){}f(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return ft()||at()||ut()}};var vn="@firebase/auth",yn="1.8.1";class bn{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const wn=(0,r.XA)("authIdTokenMaxAge")||300;let _n=null;const An=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>wn)return;const r=null==n?void 0:n.token;_n!==r&&(_n=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function xn(t=(0,i.Sx)()){const e=(0,i.j6)(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=(0,i.j6)(t,"auth");if(n.isInitialized()){const t=n.getImmediate(),i=n.getOptions();if((0,r.bD)(i,null!=e?e:{}))return t;f(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:mn,persistence:[Me,pe,me]}),a=(0,r.XA)("authTokenSyncURL");if(a&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(a,location.origin);if(location.origin===t.origin){const e=An(t.toString());!function(t,e,n){(0,r.Ku)(t).beforeAuthStateChanged(e,n)}(n,e,(()=>e(n.currentUser))),function(t){(0,r.Ku)(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}}const s=(0,r.Tj)("auth");return s&&function(t,e,n){const i=vt(t);v(i._canInitEmulator,i,"emulator-config-failed"),v(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),a=kt(e),{host:s,port:o}=function(t){const e=kt(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:It(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:It(e)}}}(e),c=null===o?"":`:${o}`;i.config.emulator={url:`${a}//${s}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}var En;bt={loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");var r,a;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=d("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(a=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==a?a:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},En="Browser",(0,i.om)(new o.uA("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:a,authDomain:s}=n.options;v(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const o={apiKey:a,authDomain:s,clientPlatform:En,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dt(En)},c=new mt(n,i,r,o);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(J);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),(0,i.om)(new o.uA("auth-internal",(t=>{return e=vt(t.getProvider("auth").getImmediate()),new bn(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(vn,yn,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(En)),(0,i.KO)(vn,yn,"esm2017")},7594:(t,e,n)=>{"use strict";n.d(e,{gS:()=>Oo,hq:()=>Vo,rJ:()=>bs,kd:()=>Do,H9:()=>ws,x7:()=>ko,GG:()=>Ro,aU:()=>Es,GV:()=>zo,AB:()=>go,aQ:()=>No,My:()=>fo,P:()=>oo,O5:()=>Bo,BN:()=>Mo,HM:()=>vo,mZ:()=>Po,_M:()=>lo,wP:()=>qo});var i,r,a=n(1990),s=n(5125),o=n(3424),c=n(6743),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var a=t.g[3],s=e+(a^n&(r^a))+i[0]+3614090360&4294967295;s=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=(n=(r=(a=(e=n+(s<<7&4294967295|s>>>25))+((s=a+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(a^e))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=e+(a^n&(r^a))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(a^e))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=e+(a^n&(r^a))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(a^e))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=e+(a^n&(r^a))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(a^e))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=e+(r^a&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(a^e))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^e&(r^a))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^a&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(a^e))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^e&(r^a))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^a&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(a^e))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^e&(r^a))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^a&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(a^e))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^e&(r^a))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=e+(n^r^a)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=a+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^e)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^a)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=a+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^e)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^a)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=a+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^e)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^a)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=a+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^e^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^e)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=e+(r^(n|~a))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(a|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=e+(r^(n|~a))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(a|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=e+(r^(n|~a))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(a|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((a=(e=n+((s=e+(r^(n|~a))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((r=a+((s=r+(e^(a|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(s<<21&4294967295|s>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+a&4294967295}function a(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var a=0|t[r];i&&a==e||(n[r]=a,i=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return e.prototype[n].apply(t,r)}}(e,(function(){this.blockSize=-1})),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var i=e-this.blockSize,r=this.B,a=this.h,s=0;s<e;){if(0==a)for(;s<=i;)n(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[a++]=t.charCodeAt(s++),a==this.blockSize){n(this,r),a=0;break}}else for(;s<e;)if(r[a++]=t[s++],a==this.blockSize){n(this,r),a=0;break}}this.h=a,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var s={};function o(t){return-128<=t&&128>t?function(t){var e=s;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=function(t){return new a([0|t],0>t?-1:0)}(t)}(t):new a([0|t],0>t?-1:0)}function c(t){if(isNaN(t)||!isFinite(t))return l;if(0>t)return g(c(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=4294967296;return new a(e,0)}var l=o(0),u=o(1),f=o(16777216);function d(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function p(t){return-1==t.h}function g(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new a(n,~t.h).add(u)}function m(t,e){return t.add(g(e))}function v(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function y(t,e){this.g=t,this.h=e}function b(t,e){if(d(e))throw Error("division by zero");if(d(t))return new y(l,l);if(p(t))return e=b(g(t),e),new y(g(e.g),g(e.h));if(p(e))return e=b(t,g(e)),new y(g(e.g),e.h);if(30<t.g.length){if(p(t)||p(e))throw Error("slowDivide_ only works with positive integers.");for(var n=u,i=e;0>=i.l(t);)n=w(n),i=w(i);var r=_(n,1),a=_(i,1);for(i=_(i,2),n=_(n,2);!d(i);){var s=a.add(i);0>=s.l(t)&&(r=r.add(n),a=s),i=_(i,1),n=_(n,1)}return e=m(t,r.j(e)),new y(r,e)}for(r=l;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),s=(a=c(n)).j(e);p(s)||0<s.l(t);)s=(a=c(n-=i)).j(e);d(a)&&(a=u),r=r.add(a),t=m(t,s)}return new y(r,t)}function w(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.i(i)<<1|t.i(i-1)>>>31;return new a(n,t.h)}function _(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.i(s+n)>>>e|t.i(s+n+1)<<32-e:t.i(s+n);return new a(r,t.h)}(t=a.prototype).m=function(){if(p(this))return-g(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.i(n);t+=(0<=i?i:4294967296+i)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(d(this))return"0";if(p(this))return"-"+g(this).toString(t);for(var e=c(Math.pow(t,6)),n=this,i="";;){var r=b(n,e).g,a=((0<(n=m(n,r.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(d(n=r))return a+i;for(;6>a.length;)a="0"+a;i=a+i}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return p(t=m(this,t))?-1:d(t)?0:1},t.abs=function(){return p(this)?g(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.i(r))+(65535&t.i(r)),o=(s>>>16)+(this.i(r)>>>16)+(t.i(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new a(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(d(this)||d(t))return l;if(p(this))return p(t)?g(this).j(g(t)):g(g(this).j(t));if(p(t))return g(this.j(g(t)));if(0>this.l(f)&&0>t.l(f))return c(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.i(i)>>>16,o=65535&this.i(i),h=t.i(r)>>>16,u=65535&t.i(r);n[2*i+2*r]+=o*u,v(n,2*i+2*r),n[2*i+2*r+1]+=s*u,v(n,2*i+2*r+1),n[2*i+2*r+1]+=o*h,v(n,2*i+2*r+1),n[2*i+2*r+2]+=s*h,v(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new a(n,0)},t.A=function(t){return b(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)&t.i(i);return new a(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)|t.i(i);return new a(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)^t.i(i);return new a(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,r=h.Md5=e,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return g(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=c(Math.pow(n,8)),r=l,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),o=parseInt(e.substring(a,a+s),n);8>s?(s=c(Math.pow(n,s)),r=r.j(s).add(c(o))):r=(r=r.j(i)).add(c(o))}return r},i=h.Integer=a}).apply(void 0!==l?l:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var u,f,d,p,g,m,v,y,b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},w={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,i){if(i)t:{var r=n;t=t.split(".");for(var a=0;a<t.length-1;a++){var s=t[a];if(!(s in r))break t;r=r[s]}(i=i(a=r[t=t[t.length-1]]))!=a&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,i=!1,r={next:function(){if(!i&&n<t.length){var r=n++;return{value:e(0,t[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(t,e){return e}))}}));var i=i||{},r=this||self;function a(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function s(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function o(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function l(t,e,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:c).apply(null,arguments)}function h(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function _(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return e.prototype[n].apply(t,r)}}function A(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function x(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(a(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function E(t){return/^[\s\xa0]*$/.test(t)}function T(){var t=r.navigator;return t&&(t=t.userAgent)?t:""}function S(t){return S[" "](t),t}S[" "]=function(){};var C=!(-1==T().indexOf("Gecko")||-1!=T().toLowerCase().indexOf("webkit")&&-1==T().indexOf("Edge")||-1!=T().indexOf("Trident")||-1!=T().indexOf("MSIE")||-1!=T().indexOf("Edge"));function k(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function I(t){const e={};for(const n in t)e[n]=t[n];return e}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<R.length;e++)n=R[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function P(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function D(t){r.setTimeout((()=>{throw t}),0)}function O(){var t=j;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var N=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new L),(t=>t.reset()));class L{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let F,U=!1,j=new class{constructor(){this.h=this.g=null}add(t,e){const n=N.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},B=()=>{const t=r.Promise.resolve(void 0);F=()=>{t.then(V)}};var V=()=>{for(var t;t=O();){try{t.h.call(t.g)}catch(t){D(t)}var e=N;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}U=!1};function z(){this.s=this.s,this.C=this.C}function q(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},q.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};r.addEventListener("test",t,e),r.removeEventListener("test",t,e)}catch(t){}return t}();function $(t,e){if(q.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(C){t:{try{S(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:G[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&$.aa.h.call(this)}}_($,q);var G={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),K=0;function X(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=r,this.key=++K,this.da=this.fa=!1}function Y(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Q(t){this.src=t,this.g={},this.h=0}function J(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],a=Array.prototype.indexOf.call(r,e,void 0);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(Y(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Z(t,e,n,i){for(var r=0;r<t.length;++r){var a=t[r];if(!a.da&&a.listener==e&&a.capture==!!n&&a.ha==i)return r}return-1}Q.prototype.add=function(t,e,n,i,r){var a=t.toString();(t=this.g[a])||(t=this.g[a]=[],this.h++);var s=Z(t,e,i,r);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new X(e,this.src,a,!!i,r)).fa=n,t.push(e)),e};var tt="closure_lm_"+(1e6*Math.random()|0),et={};function nt(t,e,n,i,r){if(i&&i.once)return rt(t,e,n,i,r);if(Array.isArray(e)){for(var a=0;a<e.length;a++)nt(t,e[a],n,i,r);return null}return n=ut(n),t&&t[W]?t.K(e,n,s(i)?!!i.capture:!!i,r):it(t,e,n,!1,i,r)}function it(t,e,n,i,r,a){if(!e)throw Error("Invalid event type");var o=s(r)?!!r.capture:!!r,c=lt(t);if(c||(t[tt]=c=new Q(t)),(n=c.add(e,n,i,o,a)).proxy)return n;if(i=function(){const t=ct;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)H||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(ot(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function rt(t,e,n,i,r){if(Array.isArray(e)){for(var a=0;a<e.length;a++)rt(t,e[a],n,i,r);return null}return n=ut(n),t&&t[W]?t.L(e,n,s(i)?!!i.capture:!!i,r):it(t,e,n,!0,i,r)}function at(t,e,n,i,r){if(Array.isArray(e))for(var a=0;a<e.length;a++)at(t,e[a],n,i,r);else i=s(i)?!!i.capture:!!i,n=ut(n),t&&t[W]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Z(a=t.g[e],n,i,r))&&(Y(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete t.g[e],t.h--))):t&&(t=lt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Z(e,n,i,r)),(n=-1<t?e[t]:null)&&st(n))}function st(t){if("number"!=typeof t&&t&&!t.da){var e=t.src;if(e&&e[W])J(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(ot(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=lt(e))?(J(n,t),0==n.h&&(n.src=null,e[tt]=null)):Y(t)}}}function ot(t){return t in et?et[t]:et[t]="on"+t}function ct(t,e){if(t.da)t=!0;else{e=new $(e,this);var n=t.listener,i=t.ha||t.src;t.fa&&st(t),t=n.call(i,e)}return t}function lt(t){return(t=t[tt])instanceof Q?t:null}var ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function ut(t){return"function"==typeof t?t:(t[ht]||(t[ht]=function(e){return t.handleEvent(e)}),t[ht])}function ft(){z.call(this),this.i=new Q(this),this.M=this,this.F=null}function dt(t,e){var n,i=t.F;if(i)for(n=[];i;i=i.F)n.push(i);if(t=t.M,i=e.type||e,"string"==typeof e)e=new q(e,t);else if(e instanceof q)e.target=e.target||t;else{var r=e;M(e=new q(i,t),r)}if(r=!0,n)for(var a=n.length-1;0<=a;a--){var s=e.g=n[a];r=pt(s,i,!0,e)&&r}if(r=pt(s=e.g=t,i,!0,e)&&r,r=pt(s,i,!1,e)&&r,n)for(a=0;a<n.length;a++)r=pt(s=e.g=n[a],i,!1,e)&&r}function pt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,a=0;a<e.length;++a){var s=e[a];if(s&&!s.da&&s.capture==n){var o=s.listener,c=s.ha||s.src;s.fa&&J(t.i,s),r=!1!==o.call(c,i)&&r}}return r&&!i.defaultPrevented}function gt(t,e,n){if("function"==typeof t)n&&(t=l(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=l(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function mt(t){t.g=gt((()=>{t.g=null,t.i&&(t.i=!1,mt(t))}),t.l);const e=t.h;t.h=null,t.m.apply(null,e)}_(ft,z),ft.prototype[W]=!0,ft.prototype.removeEventListener=function(t,e,n,i){at(this,t,e,n,i)},ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Y(n[i]);delete e.g[t],e.h--}}this.F=null},ft.prototype.K=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},ft.prototype.L=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};class vt extends z{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yt(t){z.call(this),this.h=t,this.g={}}_(yt,z);var bt=[];function wt(t){k(t.g,(function(t,e){this.g.hasOwnProperty(e)&&st(t)}),t),t.g={}}yt.prototype.N=function(){yt.aa.N.call(this),wt(this)},yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _t=r.JSON.stringify,At=r.JSON.parse,xt=class{stringify(t){return r.JSON.stringify(t,void 0)}parse(t){return r.JSON.parse(t,void 0)}};function Et(){}function Tt(t){return t.h||(t.h=t.i())}function St(){}Et.prototype.h=null;var Ct={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function kt(){q.call(this,"d")}function It(){q.call(this,"c")}_(kt,q),_(It,q);var Rt={},Mt=null;function Pt(){return Mt=Mt||new ft}function Dt(t){q.call(this,Rt.La,t)}function Ot(t){const e=Pt();dt(e,new Dt(e))}function Nt(t,e){q.call(this,Rt.STAT_EVENT,t),this.stat=e}function Lt(t){const e=Pt();dt(e,new Nt(e,t))}function Ft(t,e){q.call(this,Rt.Ma,t),this.size=e}function Ut(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return r.setTimeout((function(){t()}),e)}function jt(){this.g=!0}function Bt(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<r.length;s++)r[s]=""}}}return _t(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Rt.La="serverreachability",_(Dt,q),Rt.STAT_EVENT="statevent",_(Nt,q),Rt.Ma="timingevent",_(Ft,q),jt.prototype.xa=function(){this.g=!1},jt.prototype.info=function(){};var Vt,zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ht(){}function $t(t,e,n,i){this.j=t,this.i=e,this.l=n,this.R=i||1,this.U=new yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}_(Ht,Et),Ht.prototype.g=function(){return new XMLHttpRequest},Ht.prototype.i=function(){return{}},Vt=new Ht;var Wt={},Kt={};function Xt(t,e,n){t.L=1,t.v=_e(me(e)),t.m=n,t.P=!0,Yt(t,null)}function Yt(t,e){t.F=Date.now(),Zt(t),t.A=me(t.v);var n=t.A,i=t.R;Array.isArray(i)||(i=[String(i)]),Ne(n.i,"t",i),t.C=0,n=t.j.J,t.h=new Gt,t.g=xn(t.j,n?e:null,!t.m),0<t.O&&(t.M=new vt(l(t.Y,t,t.g),t.O)),e=t.U,n=t.g,i=t.ca;var r="readystatechange";Array.isArray(r)||(r&&(bt[0]=r.toString()),r=bt);for(var a=0;a<r.length;a++){var s=nt(n,r[a],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}e=t.H?I(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ot(),function(t,e,n,i,r,a){t.info((function(){if(t.g)if(a)for(var s="",o=a.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");s=2<=u.length&&"type"==u[1]?s+(h+"=")+l+"&":s+(h+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+s}))}(t.i,t.u,t.A,t.l,t.R,t.m)}function Qt(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.j.Ca}function Jt(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Kt:(n=Number(e.substring(n,i)),isNaN(n)?Wt:(i+=1)+n>e.length?Kt:(e=e.slice(i,i+n),t.C=i+n,e))}function Zt(t){t.S=Date.now()+t.I,te(t,t.I)}function te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ut(l(t.ba,t),e)}function ee(t){t.B&&(r.clearTimeout(t.B),t.B=null)}function ne(t){0==t.j.G||t.J||yn(t.j,t)}function ie(t){ee(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,wt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function re(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||le(n.h,t)))if(!t.K&&le(n.h,t)&&3==n.G){try{var i=n.Da.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;vn(n),on(n)}pn(n),Lt(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ut(l(n.Za,n),6e3));if(1>=ce(n.h)&&n.ca){try{n.ca()}catch(t){}n.ca=void 0}}else wn(n,11)}else if((t.K||n.g==t)&&vn(n),!E(e))for(r=n.Da.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const e=l[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const r=l[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var a=i.h;a.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(he(a,a.h),a.h=null))}if(i.D){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.ya=t,we(i.I,i.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=t;if((i=n).qa=An(i,i.J?i.ia:null,i.W),s.K){ue(i.h,s);var o=s,c=i.L;c&&(o.I=c),o.B&&(ee(o),Zt(o)),i.g=s}else dn(i);0<n.i.length&&ln(n)}else"stop"!=l[0]&&"close"!=l[0]||wn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?wn(n,7):sn(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Ot()}catch(t){}}$t.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==en(t)?e.j():this.Y(t)},$t.prototype.Y=function(t){try{if(t==this.g)t:{const f=en(this.g);var e=this.g.Ba();if(this.g.Z(),!(3>f)&&(3!=f||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=f||7==e||Ot(),ee(this);var n=this.g.Z();this.X=n;e:if(Qt(this)){var i=nn(this.g);t="";var a=i.length,s=4==en(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ie(this),ne(this);var o="";break e}this.h.i=new r.TextDecoder}for(e=0;e<a;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:!(s&&e==a-1)});i.length=0,this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(t,e,n,i,r,a,s){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+a+" "+s}))}(this.i,this.u,this.A,this.l,this.R,f,n),this.o){if(this.T&&!this.K){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(c)){var h=c;break e}}h=null}if(!(n=h)){this.o=!1,this.s=3,Lt(12),ie(this),ne(this);break t}Bt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,re(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<o.length;){if(t=Jt(this,o),t==Kt){4==f&&(this.s=4,Lt(14),n=!1),Bt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Wt){this.s=4,Lt(15),Bt(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Bt(this.i,this.l,t,null),re(this,t)}if(Qt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=o.length||this.h.h||(this.s=1,Lt(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),gn(u),u.M=!0,Lt(11))}}else Bt(this.i,this.l,o,"[Invalid Chunked Response]"),ie(this),ne(this)}else Bt(this.i,this.l,o,null),re(this,o);4==f&&ie(this),this.o&&!this.J&&(4==f?yn(this.j,this):(this.o=!1,Zt(this)))}else(function(t){const e={};t=(t.g&&2<=en(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(E(t[i]))continue;var n=P(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const a=e[r]||[];e[r]=a,a.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Lt(12)):(this.s=0,Lt(13)),ie(this),ne(this)}}}catch(t){}},$t.prototype.cancel=function(){this.J=!0,ie(this)},$t.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.i,this.A),2!=this.L&&(Ot(),Lt(17)),ie(this),this.s=2,ne(this)):te(this,this.S-t)};var ae=class{constructor(t,e){this.g=t,this.map=e}};function se(t){this.l=t||10,t=r.PerformanceNavigationTiming?0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function oe(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ce(t){return t.h?1:t.g?t.g.size:0}function le(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function he(t,e){t.g?t.g.add(e):t.h=e}function ue(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function fe(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return A(t.i)}function de(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(a(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(a(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(a(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}se.prototype.cancel=function(){if(this.i=fe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ge(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof ge){this.h=t.h,ve(this,t.j),this.o=t.o,this.g=t.g,ye(this,t.s),this.l=t.l;var e=t.i,n=new Me;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),be(this,n),this.m=t.m}else t&&(e=String(t).match(pe))?(this.h=!1,ve(this,e[1]||"",!0),this.o=Ae(e[2]||""),this.g=Ae(e[3]||"",!0),ye(this,e[4]),this.l=Ae(e[5]||"",!0),be(this,e[6]||"",!0),this.m=Ae(e[7]||"")):(this.h=!1,this.i=new Me(null,this.h))}function me(t){return new ge(t)}function ve(t,e,n){t.j=n?Ae(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ye(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function be(t,e,n){e instanceof Me?(t.i=e,function(t,e){e&&!t.j&&(Pe(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(De(this,e),Ne(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=xe(e,Ie)),t.i=new Me(e,t.h))}function we(t,e,n){t.i.set(e,n)}function _e(t){return we(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ae(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function xe(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ee),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ee(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ge.prototype.toString=function(){var t=[],e=this.j;e&&t.push(xe(e,Se,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(xe(e,Se,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(xe(n,"/"==n.charAt(0)?ke:Ce,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",xe(n,Re)),t.join("")};var Te,Se=/[#\/\?@]/g,Ce=/[#\?:]/g,ke=/[#\?]/g,Ie=/[#\?@]/g,Re=/#/g;function Me(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Pe(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var a=t[n].substring(0,i);r=t[n].substring(i+1)}else a=t[n];e(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function De(t,e){Pe(t),e=Le(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Oe(t,e){return Pe(t),e=Le(t,e),t.g.has(e)}function Ne(t,e,n){De(t,e),0<n.length&&(t.i=null,t.g.set(Le(t,e),A(n)),t.h+=n.length)}function Le(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Fe(t,e,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(t){}}function Ue(){this.g=new xt}function je(t,e,n){const i=n||"";try{de(t,(function(t,n){let r=t;s(t)&&(r=_t(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Be(t){this.l=t.Ub||null,this.j=t.eb||!1}function Ve(t,e){ft.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function ze(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function qe(t){t.readyState=4,t.l=null,t.j=null,t.v=null,He(t)}function He(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function $e(t){let e="";return k(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Ge(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=$e(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):we(t,e,n))}function We(t){ft.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Me.prototype).add=function(t,e){Pe(this),this.i=null,t=Le(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Pe(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},t.na=function(){Pe(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},t.V=function(t){Pe(this);let e=[];if("string"==typeof t)Oe(this,t)&&(e=e.concat(this.g.get(Le(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Pe(this),this.i=null,Oe(this,t=Le(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const a=encodeURIComponent(String(i)),s=this.V(i);for(i=0;i<s.length;i++){var r=a;""!==s[i]&&(r+="="+encodeURIComponent(String(s[i]))),t.push(r)}}return this.i=t.join("&")},_(Be,Et),Be.prototype.g=function(){return new Ve(this.l,this.j)},Be.prototype.i=(Te={},function(){return Te}),_(Ve,ft),(t=Ve.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,He(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||r).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,qe(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,He(this)),this.g&&(this.readyState=3,He(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ze(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?qe(this):He(this),3==this.readyState&&ze(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,qe(this))},t.Qa=function(t){this.g&&(this.response=t,qe(this))},t.ga=function(){this.g&&qe(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ve.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),_(We,ft);var Ke=/^https?$/i,Xe=["POST","PUT"];function Ye(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Qe(t),Ze(t)}function Qe(t){t.A||(t.A=!0,dt(t,"complete"),dt(t,"error"))}function Je(t){if(t.h&&void 0!==i&&(!t.v[1]||4!=en(t)||2!=t.Z()))if(t.u&&4==en(t))gt(t.Ea,0,t);else if(dt(t,"readystatechange"),4==en(t)){t.h=!1;try{const i=t.Z();t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var a;if(a=0===i){var s=String(t.D).match(pe)[1]||null;!s&&r.self&&r.self.location&&(s=r.self.location.protocol.slice(0,-1)),a=!Ke.test(s?s.toLowerCase():"")}n=a}if(n)dt(t,"complete"),dt(t,"success");else{t.m=6;try{var o=2<en(t)?t.g.statusText:""}catch(t){o=""}t.l=o+" ["+t.Z()+"]",Qe(t)}}finally{Ze(t)}}}function Ze(t,e){if(t.g){tn(t);const n=t.g,i=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||dt(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function tn(t){t.I&&(r.clearTimeout(t.I),t.I=null)}function en(t){return t.g?t.g.readyState:0}function nn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function an(t){this.Aa=0,this.i=[],this.j=new jt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,t),this.cb=rn("retryDelaySeedMs",1e4,t),this.Wa=rn("forwardChannelMaxRetries",2,t),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new se(t&&t.concurrentRequestLimit),this.Da=new Ue,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function sn(t){if(cn(t),3==t.G){var e=t.U++,n=me(t.I);if(we(n,"SID",t.K),we(n,"RID",e),we(n,"TYPE","terminate"),un(t,n),(e=new $t(t,t.j,e)).L=2,e.v=_e(me(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&r.Image&&((new Image).src=e.v,n=!0),n||(e.g=xn(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Zt(e)}_n(t)}function on(t){t.g&&(gn(t),t.g.cancel(),t.g=null)}function cn(t){on(t),t.u&&(r.clearTimeout(t.u),t.u=null),vn(t),t.h.cancel(),t.s&&("number"==typeof t.s&&r.clearTimeout(t.s),t.s=null)}function ln(t){if(!oe(t.h)&&!t.s){t.s=!0;var e=t.Ga;F||B(),U||(F(),U=!0),j.add(e,t),t.B=0}}function hn(t,e){var n;n=e?e.l:t.U++;const i=me(t.I);we(i,"SID",t.K),we(i,"RID",n),we(i,"AID",t.T),un(t,i),t.m&&t.o&&Ge(i,t.m,t.o),n=new $t(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=fn(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),he(t.h,n),Xt(n,i,e)}function un(t,e){t.H&&k(t.H,(function(t,n){we(e,n,t)})),t.l&&de({},(function(t,n){we(e,n,t)}))}function fn(t,e,n){n=Math.min(t.i.length,n);var i=t.l?l(t.l.Na,t.l,t):null;t:{var r=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let a=!0;for(let s=0;s<n;s++){let n=r[s].g;const o=r[s].map;if(n-=e,0>n)e=Math.max(0,r[s].g-100),a=!1;else try{je(o,t,"req"+n+"_")}catch(t){i&&i(o)}}if(a){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function dn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;F||B(),U||(F(),U=!0),j.add(e,t),t.v=0}}function pn(t){return!(t.g||t.u||3<=t.v||(t.Y++,t.u=Ut(l(t.Fa,t),bn(t,t.v)),t.v++,0))}function gn(t){null!=t.A&&(r.clearTimeout(t.A),t.A=null)}function mn(t){t.g=new $t(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=me(t.qa);we(e,"RID","rpc"),we(e,"SID",t.K),we(e,"AID",t.T),we(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&we(e,"TO",t.ja),we(e,"TYPE","xmlhttp"),un(t,e),t.m&&t.o&&Ge(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=_e(me(e)),n.m=null,n.P=!0,Yt(n,t)}function vn(t){null!=t.C&&(r.clearTimeout(t.C),t.C=null)}function yn(t,e){var n=null;if(t.g==e){vn(t),gn(t),t.g=null;var i=2}else{if(!le(t.h,e))return;n=e.D,ue(t.h,e),i=1}if(0!=t.G)if(e.o)if(1==i){n=e.m?e.m.length:0,e=Date.now()-e.F;var r=t.B;dt(i=Pt(),new Ft(i,n)),ln(t)}else dn(t);else if(3==(r=e.s)||0==r&&0<e.X||!(1==i&&function(t,e){return!(ce(t.h)>=t.h.j-(t.s?1:0)||(t.s?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa)||(t.s=Ut(l(t.Ga,t,e),bn(t,t.B)),t.B++,0)))}(t,e)||2==i&&pn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:wn(t,5);break;case 4:wn(t,10);break;case 3:wn(t,6);break;default:wn(t,2)}}function bn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function wn(t,e){if(t.j.info("Error code "+e),2==e){var n=l(t.fb,t),i=t.Xa;const e=!i;i=new ge(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||ve(i,"https"),_e(i),e?function(t,e){const n=new jt;if(r.Image){const i=new Image;i.onload=h(Fe,n,"TestLoadImage: loaded",!0,e,i),i.onerror=h(Fe,n,"TestLoadImage: error",!1,e,i),i.onabort=h(Fe,n,"TestLoadImage: abort",!1,e,i),i.ontimeout=h(Fe,n,"TestLoadImage: timeout",!1,e,i),r.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(i.toString(),n):function(t,e){new jt;const n=new AbortController,i=setTimeout((()=>{n.abort(),Fe(0,0,!1,e)}),1e4);fetch(t,{signal:n.signal}).then((t=>{clearTimeout(i),t.ok?Fe(0,0,!0,e):Fe(0,0,!1,e)})).catch((()=>{clearTimeout(i),Fe(0,0,!1,e)}))}(i.toString(),n)}else Lt(2);t.G=0,t.l&&t.l.sa(e),_n(t),cn(t)}function _n(t){if(t.G=0,t.ka=[],t.l){const e=fe(t.h);0==e.length&&0==t.i.length||(x(t.ka,e),x(t.ka,t.i),t.h.i.length=0,A(t.i),t.i.length=0),t.l.ra()}}function An(t,e,n){var i=n instanceof ge?me(n):new ge(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ye(i,i.s);else{var a=r.location;i=a.protocol,e=e?e+"."+a.hostname:a.hostname,a=+a.port;var s=new ge(null);i&&ve(s,i),e&&(s.g=e),a&&ye(s,a),n&&(s.l=n),i=s}return n=t.D,e=t.ya,n&&e&&we(i,n,e),we(i,"VER",t.la),un(t,i),i}function xn(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new We(new Be({eb:n})):new We(t.pa)).Ha(t.J),e}function En(){}function Tn(){}function Sn(t,e){ft.call(this),this.g=new an(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!E(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!E(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new In(this)}function Cn(t){kt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function kn(){It.call(this),this.status=1}function In(t){this.g=t}(t=We.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vt.g(),this.v=this.o?Tt(this.o):Tt(Vt),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(t){return void Ye(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var a in i)n.set(a,i[a]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),a=r.FormData&&t instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Xe,e,void 0))||i||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(t),this.u=!1}catch(t){Ye(this,t)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,dt(this,"complete"),dt(this,"abort"),Ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ze(this,!0)),We.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Je(this):this.bb())},t.bb=function(){Je(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<en(this)?this.g.status:-1}catch(t){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),At(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=an.prototype).la=8,t.G=1,t.connect=function(t,e,n,i){Lt(0),this.W=t,this.H=e||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=An(this,null,this.W),ln(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new $t(this,this.j,t);let a=this.o;if(this.S&&(a?(a=I(a),M(a,this.S)):a=this.S),null!==this.m||this.O||(r.H=a,a=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=fn(this,r,e),we(n=me(this.I),"RID",t),we(n,"CVER",22),this.D&&we(n,"X-HTTP-Session-Id",this.D),un(this,n),a&&(this.O?e="headers="+encodeURIComponent(String($e(a)))+"&"+e:this.m&&Ge(n,this.m,a)),he(this.h,r),this.Ua&&we(n,"TYPE","init"),this.P?(we(n,"$req",e),we(n,"SID","null"),r.T=!0,Xt(r,n,null)):Xt(r,n,e),this.G=2}}else 3==this.G&&(t?hn(this,t):0==this.i.length||oe(this.h)||hn(this))},t.Fa=function(){if(this.u=null,mn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Ut(l(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Lt(10),on(this),mn(this))},t.Za=function(){null!=this.C&&(this.C=null,on(this),pn(this),Lt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Lt(2)):(this.j.info("Failed to ping google.com"),Lt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=En.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},Tn.prototype.g=function(t,e){return new Sn(t,e)},_(Sn,ft),Sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){sn(this.g)},Sn.prototype.o=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=_t(t),t=n);e.i.push(new ae(e.Ya++,t)),3==e.G&&ln(e)},Sn.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,Sn.aa.N.call(this)},_(Cn,kt),_(kn,It),_(In,En),In.prototype.ua=function(){dt(this.g,"a")},In.prototype.ta=function(t){dt(this.g,new Cn(t))},In.prototype.sa=function(t){dt(this.g,new kn)},In.prototype.ra=function(){dt(this.g,"b")},Tn.prototype.createWebChannel=Tn.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,y=w.createWebChannelTransport=function(){return new Tn},v=w.getStatEventTarget=function(){return Pt()},m=w.Event=Rt,g=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zt.NO_ERROR=0,zt.TIMEOUT=8,zt.HTTP_ERROR=6,p=w.ErrorCode=zt,qt.COMPLETE="complete",d=w.EventType=qt,St.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",ft.prototype.listen=ft.prototype.K,f=w.WebChannel=St,w.FetchXmlHttpFactory=Be,We.prototype.listenOnce=We.prototype.L,We.prototype.getLastError=We.prototype.Ka,We.prototype.getLastErrorCode=We.prototype.Ba,We.prototype.getStatus=We.prototype.Z,We.prototype.getResponseJson=We.prototype.Oa,We.prototype.getResponseText=We.prototype.oa,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Ha,u=w.XhrIo=We}).apply(void 0!==b?b:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const _="@firebase/firestore";class A{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}A.UNAUTHENTICATED=new A(null),A.GOOGLE_CREDENTIALS=new A("google-credentials-uid"),A.FIRST_PARTY=new A("first-party-uid"),A.MOCK_USER=new A("mock-user");let x="11.0.2";const E=new o.Vy("@firebase/firestore");function T(){return E.logLevel}function S(t,...e){if(E.logLevel<=o.$b.DEBUG){const n=e.map(I);E.debug(`Firestore (${x}): ${t}`,...n)}}function C(t,...e){if(E.logLevel<=o.$b.ERROR){const n=e.map(I);E.error(`Firestore (${x}): ${t}`,...n)}}function k(t,...e){if(E.logLevel<=o.$b.WARN){const n=e.map(I);E.warn(`Firestore (${x}): ${t}`,...n)}}function I(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function R(t="Unexpected state"){const e=`FIRESTORE (${x}) INTERNAL ASSERTION FAILED: `+t;throw C(e),new Error(e)}function M(t,e){t||R()}function P(t,e){return t}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class O extends c.g{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class N{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class L{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class F{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(A.UNAUTHENTICATED)))}shutdown(){}}class U{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class j{constructor(t){this.t=t,this.currentUser=A.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){M(void 0===this.o);let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new N;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new N,t.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},s=t=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((t=>s(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?s(t):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new N)}}),0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(M("string"==typeof e.accessToken),new L(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return M(null===t||"string"==typeof t),new A(t)}}class B{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=A.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class V{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new B(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(A.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class z{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class q{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){M(void 0===this.o);const n=t=>{null!=t.error&&S("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,S("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(M("string"==typeof t.token),this.R=t.token,new z(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function H(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class ${static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=H(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function G(t,e){return t<e?-1:t>e?1:0}function W(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class K{static now(){return K.fromMillis(Date.now())}static fromDate(t){return K.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new K(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new O(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new O(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new O(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new O(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?G(this.nanoseconds,t.nanoseconds):G(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class X{static fromTimestamp(t){return new X(t)}static min(){return new X(new K(0,0))}static max(){return new X(new K(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Y{constructor(t,e,n){void 0===e?e=0:e>t.length&&R(),void 0===n?n=t.length-e:n>t.length-e&&R(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Y.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Y?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Q extends Y{construct(t,e,n){return new Q(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new O(D.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Q(e)}static emptyPath(){return new Q([])}}const J=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Z extends Y{construct(t,e,n){return new Z(t,e,n)}static isValidIdentifier(t){return J.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Z.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Z(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new O(D.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let a=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new O(D.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new O(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(a=!a,i++):"."!==e||a?(n+=e,i++):(r(),i++)}if(r(),a)throw new O(D.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Z(e)}static emptyPath(){return new Z([])}}class tt{constructor(t){this.path=t}static fromPath(t){return new tt(Q.fromString(t))}static fromName(t){return new tt(Q.fromString(t).popFirst(5))}static empty(){return new tt(Q.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Q.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Q.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new tt(new Q(t.slice()))}}function et(t){return new nt(t.readTime,t.key,-1)}class nt{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new nt(X.min(),tt.empty(),-1)}static max(){return new nt(X.max(),tt.empty(),-1)}}function it(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=tt.comparator(t.documentKey,e.documentKey),0!==n?n:G(t.largestBatchId,e.largestBatchId))}const rt="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class at{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function st(t){if(t.code!==D.FAILED_PRECONDITION||t.message!==rt)throw t;S("LocalStore","Unexpectedly lost primary lease")}class ot{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&R(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ot(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof ot?e:ot.resolve(e)}catch(t){return ot.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):ot.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):ot.reject(e)}static resolve(t){return new ot(((e,n)=>{e(t)}))}static reject(t){return new ot(((e,n)=>{n(t)}))}static waitFor(t){return new ot(((e,n)=>{let i=0,r=0,a=!1;t.forEach((t=>{++i,t.next((()=>{++r,a&&r===i&&e()}),(t=>n(t)))})),a=!0,r===i&&e()}))}static or(t){let e=ot.resolve(!1);for(const n of t)e=e.next((t=>t?ot.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new ot(((n,i)=>{const r=t.length,a=new Array(r);let s=0;for(let o=0;o<r;o++){const c=o;e(t[c]).next((t=>{a[c]=t,++s,s===r&&n(a)}),(t=>i(t)))}}))}static doWhile(t,e){return new ot(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function ct(t){return"IndexedDbTransactionError"===t.name}class lt{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ie(t),this.se=t=>e.writeSequenceNumber(t))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}function ht(t){return null==t}function ut(t){return 0===t&&1/t==-1/0}function ft(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function dt(t){return t+""}lt.oe=-1;function pt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gt(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mt(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class vt{constructor(t,e){this.comparator=t,this.root=e||bt.EMPTY}insert(t,e){return new vt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(t){return new vt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yt(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yt(this.root,t,this.comparator,!1)}getReverseIterator(){return new yt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yt(this.root,t,this.comparator,!0)}}class yt{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class bt{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:bt.RED,this.left=null!=i?i:bt.EMPTY,this.right=null!=r?r:bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new bt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return bt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw R();if(this.right.isRed())throw R();const t=this.left.check();if(t!==this.right.check())throw R();return t+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1,bt.EMPTY=new class{constructor(){this.size=0}get key(){throw R()}get value(){throw R()}get color(){throw R()}get left(){throw R()}get right(){throw R()}copy(t,e,n,i,r){return this}insert(t,e,n){return new bt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class wt{constructor(t){this.comparator=t,this.data=new vt(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new _t(this.data.getIterator())}getIteratorFrom(t){return new _t(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof wt))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new wt(this.comparator);return e.data=t,e}}class _t{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class At{constructor(t){this.fields=t,t.sort(Z.comparator)}static empty(){return new At([])}unionWith(t){let e=new wt(Z.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new At(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return W(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class xt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Et{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new xt("Invalid base64 string: "+t):t}}(t);return new Et(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Et(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return G(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const Tt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function St(t){if(M(!!t),"string"==typeof t){let e=0;const n=Tt.exec(t);if(M(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ct(t.seconds),nanos:Ct(t.nanos)}}function Ct(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function kt(t){return"string"==typeof t?Et.fromBase64String(t):Et.fromUint8Array(t)}function It(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Rt(t){const e=t.mapValue.fields.__previous_value__;return It(e)?Rt(e):e}function Mt(t){const e=St(t.mapValue.fields.__local_write_time__.timestampValue);return new K(e.seconds,e.nanos)}class Pt{constructor(t,e,n,i,r,a,s,o,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=c}}class Dt{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Dt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Dt&&t.projectId===this.projectId&&t.database===this.database}}const Ot={fields:{__type__:{stringValue:"__max__"}}};function Nt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?It(t)?4:Jt(t)?9007199254740991:Yt(t)?10:11:R()}function Lt(t,e){if(t===e)return!0;const n=Nt(t);if(n!==Nt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mt(t).isEqual(Mt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=St(t.timestampValue),i=St(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return kt(t.bytesValue).isEqual(kt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ct(t.geoPointValue.latitude)===Ct(e.geoPointValue.latitude)&&Ct(t.geoPointValue.longitude)===Ct(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ct(t.integerValue)===Ct(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Ct(t.doubleValue),i=Ct(e.doubleValue);return n===i?ut(n)===ut(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return W(t.arrayValue.values||[],e.arrayValue.values||[],Lt);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(pt(n)!==pt(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Lt(n[t],i[t])))return!1;return!0}(t,e);default:return R()}}function Ft(t,e){return void 0!==(t.values||[]).find((t=>Lt(t,e)))}function Ut(t,e){if(t===e)return 0;const n=Nt(t),i=Nt(e);if(n!==i)return G(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return G(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Ct(t.integerValue||t.doubleValue),i=Ct(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return jt(t.timestampValue,e.timestampValue);case 4:return jt(Mt(t),Mt(e));case 5:return G(t.stringValue,e.stringValue);case 6:return function(t,e){const n=kt(t),i=kt(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=G(n[t],i[t]);if(0!==e)return e}return G(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=G(Ct(t.latitude),Ct(e.latitude));return 0!==n?n:G(Ct(t.longitude),Ct(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bt(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,i,r,a;const s=t.fields||{},o=e.fields||{},c=null===(n=s.value)||void 0===n?void 0:n.arrayValue,l=null===(i=o.value)||void 0===i?void 0:i.arrayValue,h=G((null===(r=null==c?void 0:c.values)||void 0===r?void 0:r.length)||0,(null===(a=null==l?void 0:l.values)||void 0===a?void 0:a.length)||0);return 0!==h?h:Bt(c,l)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===Ot&&e===Ot)return 0;if(t===Ot)return 1;if(e===Ot)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},a=Object.keys(r);i.sort(),a.sort();for(let t=0;t<i.length&&t<a.length;++t){const e=G(i[t],a[t]);if(0!==e)return e;const s=Ut(n[i[t]],r[a[t]]);if(0!==s)return s}return G(i.length,a.length)}(t.mapValue,e.mapValue);default:throw R()}}function jt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return G(t,e);const n=St(t),i=St(e),r=G(n.seconds,i.seconds);return 0!==r?r:G(n.nanos,i.nanos)}function Bt(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Ut(n[t],i[t]);if(e)return e}return G(n.length,i.length)}function Vt(t){return zt(t)}function zt(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=St(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return kt(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return tt.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=zt(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${zt(t.fields[r])}`;return n+"}"}(t.mapValue):R()}function qt(t){switch(Nt(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Rt(t);return e?16+qt(e):16;case 5:return 2*t.stringValue.length;case 6:return kt(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce(((t,e)=>t+qt(e)),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return gt(t.fields,((t,n)=>{e+=t.length+qt(n)})),e}(t.mapValue);default:throw R()}}function Ht(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $t(t){return!!t&&"integerValue"in t}function Gt(t){return!!t&&"arrayValue"in t}function Wt(t){return!!t&&"nullValue"in t}function Kt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xt(t){return!!t&&"mapValue"in t}function Yt(t){var e,n;return"__vector__"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Qt(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gt(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Qt(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Qt(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Jt(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Zt{constructor(t){this.value=t}static empty(){return new Zt({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Xt(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Qt(e)}setAll(t){let e=Z.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Qt(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Xt(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Lt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Xt(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){gt(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Zt(Qt(this.value))}}function te(t){const e=[];return gt(t.fields,((t,n)=>{const i=new Z([t]);if(Xt(n)){const t=te(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new At(e)}class ee{constructor(t,e,n,i,r,a,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=a,this.documentState=s}static newInvalidDocument(t){return new ee(t,0,X.min(),X.min(),X.min(),Zt.empty(),0)}static newFoundDocument(t,e,n,i){return new ee(t,1,e,X.min(),n,i,0)}static newNoDocument(t,e){return new ee(t,2,e,X.min(),X.min(),Zt.empty(),0)}static newUnknownDocument(t,e){return new ee(t,3,e,X.min(),X.min(),Zt.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(X.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof ee&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ee(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ne{constructor(t,e){this.position=t,this.inclusive=e}}function ie(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const a=e[r],s=t.position[r];if(i=a.field.isKeyField()?tt.comparator(tt.fromName(s.referenceValue),n.key):Ut(s,n.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function re(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Lt(t.position[n],e.position[n]))return!1;return!0}class ae{constructor(t,e="asc"){this.field=t,this.dir=e}}function se(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class oe{}class ce extends oe{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new ge(t,e,n):"array-contains"===e?new be(t,n):"in"===e?new we(t,n):"not-in"===e?new _e(t,n):"array-contains-any"===e?new Ae(t,n):new ce(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new me(t,n):new ve(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Ut(e,this.value)):null!==e&&Nt(this.value)===Nt(e)&&this.matchesComparison(Ut(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return R()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class le extends oe{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new le(t,e)}matches(t){return he(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function he(t){return"and"===t.op}function ue(t){return function(t){for(const e of t.filters)if(e instanceof le)return!1;return!0}(t)&&he(t)}function fe(t){if(t instanceof ce)return t.field.canonicalString()+t.op.toString()+Vt(t.value);if(ue(t))return t.filters.map((t=>fe(t))).join(",");{const e=t.filters.map((t=>fe(t))).join(",");return`${t.op}(${e})`}}function de(t,e){return t instanceof ce?function(t,e){return e instanceof ce&&t.op===e.op&&t.field.isEqual(e.field)&&Lt(t.value,e.value)}(t,e):t instanceof le?function(t,e){return e instanceof le&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&de(n,e.filters[i])),!0)}(t,e):void R()}function pe(t){return t instanceof ce?function(t){return`${t.field.canonicalString()} ${t.op} ${Vt(t.value)}`}(t):t instanceof le?function(t){return t.op.toString()+" {"+t.getFilters().map(pe).join(" ,")+"}"}(t):"Filter"}class ge extends ce{constructor(t,e,n){super(t,e,n),this.key=tt.fromName(n.referenceValue)}matches(t){const e=tt.comparator(t.key,this.key);return this.matchesComparison(e)}}class me extends ce{constructor(t,e){super(t,"in",e),this.keys=ye(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class ve extends ce{constructor(t,e){super(t,"not-in",e),this.keys=ye(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ye(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>tt.fromName(t.referenceValue)))}class be extends ce{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Gt(e)&&Ft(e.arrayValue,this.value)}}class we extends ce{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ft(this.value.arrayValue,e)}}class _e extends ce{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ft(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ft(this.value.arrayValue,e)}}class Ae extends ce{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Gt(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ft(this.value.arrayValue,t)))}}class xe{constructor(t,e=null,n=[],i=[],r=null,a=null,s=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=a,this.endAt=s,this.ue=null}}function Ee(t,e=null,n=[],i=[],r=null,a=null,s=null){return new xe(t,e,n,i,r,a,s)}function Te(t){const e=P(t);if(null===e.ue){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>fe(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),ht(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Vt(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Vt(t))).join(",")),e.ue=t}return e.ue}function Se(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!se(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!de(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!re(t.startAt,e.startAt)&&re(t.endAt,e.endAt)}function Ce(t){return tt.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class ke{constructor(t,e=null,n=[],i=[],r=null,a="F",s=null,o=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=a,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Ie(t){return new ke(t)}function Re(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Me(t){return null!==t.collectionGroup}function Pe(t){const e=P(t);if(null===e.ce){e.ce=[];const t=new Set;for(const n of e.explicitOrderBy)e.ce.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new wt(Z.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ae(i,n))})),t.has(Z.keyField().canonicalString())||e.ce.push(new ae(Z.keyField(),n))}return e.ce}function De(t){const e=P(t);return e.le||(e.le=function(t,e){if("F"===t.limitType)return Ee(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new ae(t.field,e)}));const n=t.endAt?new ne(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new ne(t.startAt.position,t.startAt.inclusive):null;return Ee(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,Pe(t))),e.le}function Oe(t,e){const n=t.filters.concat([e]);return new ke(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ne(t,e,n){return new ke(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Le(t,e){return Se(De(t),De(e))&&t.limitType===e.limitType}function Fe(t){return`${Te(De(t))}|lt:${t.limitType}`}function Ue(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>pe(t))).join(", ")}]`),ht(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Vt(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Vt(t))).join(",")),`Target(${e})`}(De(t))}; limitType=${t.limitType})`}function je(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):tt.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Pe(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=ie(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,Pe(t),e)||t.endAt&&!function(t,e,n){const i=ie(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,Pe(t),e))}(t,e)}function Be(t){return(e,n)=>{let i=!1;for(const r of Pe(t)){const t=Ve(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Ve(t,e,n){const i=t.field.isKeyField()?tt.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Ut(i,r):R()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return R()}}class ze{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){gt(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return mt(this.inner)}size(){return this.innerSize}}const qe=new vt(tt.comparator);function He(){return qe}const $e=new vt(tt.comparator);function Ge(...t){let e=$e;for(const n of t)e=e.insert(n.key,n);return e}function We(t){let e=$e;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Ke(){return Ye()}function Xe(){return Ye()}function Ye(){return new ze((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Qe=new vt(tt.comparator),Je=new wt(tt.comparator);function Ze(...t){let e=Je;for(const n of t)e=e.add(n);return e}const tn=new wt(G);function en(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ut(e)?"-0":e}}function nn(t){return{integerValue:""+t}}function rn(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ut(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?nn(e):en(t,e)}class an{constructor(){this._=void 0}}function sn(t,e,n){return t instanceof ln?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&It(e)&&(e=Rt(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof hn?un(t,e):t instanceof fn?dn(t,e):function(t,e){const n=cn(t,e),i=gn(n)+gn(t.Pe);return $t(n)&&$t(t.Pe)?nn(i):en(t.serializer,i)}(t,e)}function on(t,e,n){return t instanceof hn?un(t,e):t instanceof fn?dn(t,e):n}function cn(t,e){return t instanceof pn?function(t){return $t(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class ln extends an{}class hn extends an{constructor(t){super(),this.elements=t}}function un(t,e){const n=mn(e);for(const e of t.elements)n.some((t=>Lt(t,e)))||n.push(e);return{arrayValue:{values:n}}}class fn extends an{constructor(t){super(),this.elements=t}}function dn(t,e){let n=mn(e);for(const e of t.elements)n=n.filter((t=>!Lt(t,e)));return{arrayValue:{values:n}}}class pn extends an{constructor(t,e){super(),this.serializer=t,this.Pe=e}}function gn(t){return Ct(t.integerValue||t.doubleValue)}function mn(t){return Gt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class vn{constructor(t,e){this.field=t,this.transform=e}}class yn{constructor(t,e){this.version=t,this.transformResults=e}}class bn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new bn}static exists(t){return new bn(void 0,t)}static updateTime(t){return new bn(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function wn(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class _n{}function An(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Pn(t.key,bn.none()):new Cn(t.key,t.data,bn.none());{const n=t.data,i=Zt.empty();let r=new wt(Z.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new kn(t.key,i,new At(r.toArray()),bn.none())}}function xn(t,e,n){t instanceof Cn?function(t,e,n){const i=t.value.clone(),r=Rn(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof kn?function(t,e,n){if(!wn(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Rn(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(In(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function En(t,e,n,i){return t instanceof Cn?function(t,e,n,i){if(!wn(t.precondition,e))return n;const r=t.value.clone(),a=Mn(t.fieldTransforms,i,e);return r.setAll(a),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof kn?function(t,e,n,i){if(!wn(t.precondition,e))return n;const r=Mn(t.fieldTransforms,i,e),a=e.data;return a.setAll(In(t)),a.setAll(r),e.convertToFoundDocument(e.version,a).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return wn(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Tn(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=cn(i.transform,t||null);null!=r&&(null===n&&(n=Zt.empty()),n.set(i.field,r))}return n||null}function Sn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&W(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof hn&&e instanceof hn||t instanceof fn&&e instanceof fn?W(t.elements,e.elements,Lt):t instanceof pn&&e instanceof pn?Lt(t.Pe,e.Pe):t instanceof ln&&e instanceof ln}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cn extends _n{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class kn extends _n{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function In(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Rn(t,e,n){const i=new Map;M(t.length===n.length);for(let r=0;r<n.length;r++){const a=t[r],s=a.transform,o=e.data.field(a.field);i.set(a.field,on(s,o,n[r]))}return i}function Mn(t,e,n){const i=new Map;for(const r of t){const t=r.transform,a=n.data.field(r.field);i.set(r.field,sn(t,a,e))}return i}class Pn extends _n{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dn extends _n{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class On{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&xn(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=En(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=En(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Xe();return this.mutations.forEach((i=>{const r=t.get(i.key),a=r.overlayedDocument;let s=this.applyToLocalView(a,r.mutatedFields);s=e.has(i.key)?null:s;const o=An(a,s);null!==o&&n.set(i.key,o),a.isValidDocument()||a.convertToNoDocument(X.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ze())}isEqual(t){return this.batchId===t.batchId&&W(this.mutations,t.mutations,((t,e)=>Sn(t,e)))&&W(this.baseMutations,t.baseMutations,((t,e)=>Sn(t,e)))}}class Nn{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){M(t.mutations.length===n.length);let i=Qe;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new Nn(t,e,n,i)}}class Ln{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Fn{constructor(t,e){this.count=t,this.unchangedNames=e}}var Un,jn;function Bn(t){if(void 0===t)return C("GRPC error has no .code"),D.UNKNOWN;switch(t){case Un.OK:return D.OK;case Un.CANCELLED:return D.CANCELLED;case Un.UNKNOWN:return D.UNKNOWN;case Un.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case Un.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case Un.INTERNAL:return D.INTERNAL;case Un.UNAVAILABLE:return D.UNAVAILABLE;case Un.UNAUTHENTICATED:return D.UNAUTHENTICATED;case Un.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case Un.NOT_FOUND:return D.NOT_FOUND;case Un.ALREADY_EXISTS:return D.ALREADY_EXISTS;case Un.PERMISSION_DENIED:return D.PERMISSION_DENIED;case Un.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case Un.ABORTED:return D.ABORTED;case Un.OUT_OF_RANGE:return D.OUT_OF_RANGE;case Un.UNIMPLEMENTED:return D.UNIMPLEMENTED;case Un.DATA_LOSS:return D.DATA_LOSS;default:return R()}}(jn=Un||(Un={}))[jn.OK=0]="OK",jn[jn.CANCELLED=1]="CANCELLED",jn[jn.UNKNOWN=2]="UNKNOWN",jn[jn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jn[jn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jn[jn.NOT_FOUND=5]="NOT_FOUND",jn[jn.ALREADY_EXISTS=6]="ALREADY_EXISTS",jn[jn.PERMISSION_DENIED=7]="PERMISSION_DENIED",jn[jn.UNAUTHENTICATED=16]="UNAUTHENTICATED",jn[jn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jn[jn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jn[jn.ABORTED=10]="ABORTED",jn[jn.OUT_OF_RANGE=11]="OUT_OF_RANGE",jn[jn.UNIMPLEMENTED=12]="UNIMPLEMENTED",jn[jn.INTERNAL=13]="INTERNAL",jn[jn.UNAVAILABLE=14]="UNAVAILABLE",jn[jn.DATA_LOSS=15]="DATA_LOSS";const Vn=new i([4294967295,4294967295],0);function zn(t){const e=(new TextEncoder).encode(t),n=new r;return n.update(e),new Uint8Array(n.digest())}function qn(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new i([n,r],0),new i([a,s],0)]}class Hn{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new $n(`Invalid padding: ${e}`);if(n<0)throw new $n(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new $n(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new $n(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ie=i.fromNumber(this.Te)}Ee(t,e,n){let r=t.add(e.multiply(i.fromNumber(n)));return 1===r.compare(Vn)&&(r=new i([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ie).toNumber()}de(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=zn(t),[n,i]=qn(e);for(let t=0;t<this.hashCount;t++){const e=this.Ee(n,i,t);if(!this.de(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),a=new Hn(r,i,e);return n.forEach((t=>a.insert(t))),a}insert(t){if(0===this.Te)return;const e=zn(t),[n,i]=qn(e);for(let t=0;t<this.hashCount;t++){const e=this.Ee(n,i,t);this.Ae(e)}}Ae(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class $n extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gn{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Wn.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Gn(X.min(),i,new vt(G),He(),Ze())}}class Wn{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Wn(n,e,Ze(),Ze(),Ze())}}class Kn{constructor(t,e,n,i){this.Re=t,this.removedTargetIds=e,this.key=n,this.Ve=i}}class Xn{constructor(t,e){this.targetId=t,this.me=e}}class Yn{constructor(t,e,n=Et.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Qn{constructor(){this.fe=0,this.ge=ti(),this.pe=Et.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Ze(),e=Ze(),n=Ze();return this.ge.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:R()}})),new Wn(this.pe,this.ye,t,e,n)}Ce(){this.we=!1,this.ge=ti()}Fe(t,e){this.we=!0,this.ge=this.ge.insert(t,e)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,M(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Jn{constructor(t){this.Le=t,this.Be=new Map,this.ke=He(),this.qe=Zn(),this.Qe=Zn(),this.Ke=new vt(G)}$e(t){for(const e of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.Ue(e,t.Ve):this.We(e,t.key,t.Ve);for(const e of t.removedTargetIds)this.We(e,t.key,t.Ve)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(e);break;case 3:this.je(e)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.De(t.resumeToken));break;default:R()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Be.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.me.count,i=this.Ye(e);if(i){const r=i.target;if(Ce(r))if(0===n){const t=new tt(r.path);this.We(e,t,ee.newNoDocument(t,X.min()))}else M(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.me.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let a,s;try{a=kt(n).toUint8Array()}catch(t){if(t instanceof xt)return k("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{s=new Hn(a,i,r)}catch(t){return k(t instanceof $n?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===s.Te?null:s}et(t,e,n){return e.me.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),a=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(a)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.Be.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&Ce(r.target)){const e=new tt(r.target.path);this.st(e).has(i)||this.ot(i,e)||this.We(i,e,ee.newNoDocument(e,t))}n.be&&(e.set(i,n.ve()),n.Ce())}}));let n=Ze();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.ke.forEach(((e,n)=>n.setReadTime(t)));const i=new Gn(t,e,this.Ke,this.ke,n);return this.ke=He(),this.qe=Zn(),this.Qe=Zn(),this.Ke=new vt(G),i}Ue(t,e){if(!this.je(t))return;const n=this.ot(t,e.key)?2:0;this.ze(t).Fe(e.key,n),this.ke=this.ke.insert(e.key,e),this.qe=this.qe.insert(e.key,this.st(e.key).add(t)),this.Qe=this.Qe.insert(e.key,this._t(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.ot(t,e)?i.Fe(e,1):i.Me(e),this.Qe=this.Qe.insert(e,this._t(e).delete(t)),this.Qe=this.Qe.insert(e,this._t(e).add(t)),n&&(this.ke=this.ke.insert(e,n))}removeTarget(t){this.Be.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}xe(t){this.ze(t).xe()}ze(t){let e=this.Be.get(t);return e||(e=new Qn,this.Be.set(t,e)),e}_t(t){let e=this.Qe.get(t);return e||(e=new wt(G),this.Qe=this.Qe.insert(t,e)),e}st(t){let e=this.qe.get(t);return e||(e=new wt(G),this.qe=this.qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||S("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.Be.get(t);return e&&e.Se?null:this.Le.ut(t)}He(t){this.Be.set(t,new Qn),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}ot(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Zn(){return new vt(tt.comparator)}function ti(){return new vt(tt.comparator)}const ei={asc:"ASCENDING",desc:"DESCENDING"},ni={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ii={and:"AND",or:"OR"};class ri{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function ai(t,e){return t.useProto3Json||ht(e)?e:{value:e}}function si(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oi(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ci(t,e){return si(t,e.toTimestamp())}function li(t){return M(!!t),X.fromTimestamp(function(t){const e=St(t);return new K(e.seconds,e.nanos)}(t))}function hi(t,e){return ui(t,e).canonicalString()}function ui(t,e){const n=function(t){return new Q(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function fi(t){const e=Q.fromString(t);return M(Ri(e)),e}function di(t,e){return hi(t.databaseId,e.path)}function pi(t,e){const n=fi(e);if(n.get(1)!==t.databaseId.projectId)throw new O(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new O(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new tt(vi(n))}function gi(t,e){return hi(t.databaseId,e)}function mi(t){return new Q(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vi(t){return M(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function yi(t,e,n){return{name:di(t,e),fields:n.value.mapValue.fields}}function bi(t,e){return{documents:[gi(t,e.path)]}}function wi(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=gi(t,r);const a=function(t){if(0!==t.length)return ki(le.create(t,"and"))}(e.filters);a&&(n.structuredQuery.where=a);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Si(t.field),direction:xi(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ai(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ct:n,parent:r}}function _i(t){let e=function(t){const e=fi(t);return 4===e.length?Q.emptyPath():vi(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){M(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let a=[];n.where&&(a=function(t){const e=Ai(t);return e instanceof le&&ue(e)?e.getFilters():[e]}(n.where));let s=[];n.orderBy&&(s=function(t){return t.map((t=>function(t){return new ae(Ci(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let o=null;n.limit&&(o=function(t){let e;return e="object"==typeof t?t.value:t,ht(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new ne(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new ne(n,e)}(n.endAt)),function(t,e,n,i,r,a,s,o){return new ke(t,e,n,i,r,a,s,o)}(e,r,s,a,o,"F",c,l)}function Ai(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ci(t.unaryFilter.field);return ce.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ci(t.unaryFilter.field);return ce.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ci(t.unaryFilter.field);return ce.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Ci(t.unaryFilter.field);return ce.create(r,"!=",{nullValue:"NULL_VALUE"});default:return R()}}(t):void 0!==t.fieldFilter?function(t){return ce.create(Ci(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return R()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return le.create(t.compositeFilter.filters.map((t=>Ai(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return R()}}(t.compositeFilter.op))}(t):R()}function xi(t){return ei[t]}function Ei(t){return ni[t]}function Ti(t){return ii[t]}function Si(t){return{fieldPath:t.canonicalString()}}function Ci(t){return Z.fromServerFormat(t.fieldPath)}function ki(t){return t instanceof ce?function(t){if("=="===t.op){if(Kt(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NAN"}};if(Wt(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Kt(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NOT_NAN"}};if(Wt(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Si(t.field),op:Ei(t.op),value:t.value}}}(t):t instanceof le?function(t){const e=t.getFilters().map((t=>ki(t)));return 1===e.length?e[0]:{compositeFilter:{op:Ti(t.op),filters:e}}}(t):R()}function Ii(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ri(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Mi{constructor(t,e,n,i,r=X.min(),a=X.min(),s=Et.EMPTY_BYTE_STRING,o=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(t){return new Mi(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Pi{constructor(t){this.ht=t}}function Di(t){const e=_i({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ne(e,e.limit,"L"):e}class Oi{constructor(){}Et(t,e){this.dt(t,e),e.At()}dt(t,e){if("nullValue"in t)this.Rt(e,5);else if("booleanValue"in t)this.Rt(e,10),e.Vt(t.booleanValue?1:0);else if("integerValue"in t)this.Rt(e,15),e.Vt(Ct(t.integerValue));else if("doubleValue"in t){const n=Ct(t.doubleValue);isNaN(n)?this.Rt(e,13):(this.Rt(e,15),ut(n)?e.Vt(0):e.Vt(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Rt(e,20),"string"==typeof n&&(n=St(n)),e.ft(`${n.seconds||""}`),e.Vt(n.nanos||0)}else if("stringValue"in t)this.gt(t.stringValue,e),this.yt(e);else if("bytesValue"in t)this.Rt(e,30),e.wt(kt(t.bytesValue)),this.yt(e);else if("referenceValue"in t)this.St(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Rt(e,45),e.Vt(n.latitude||0),e.Vt(n.longitude||0)}else"mapValue"in t?Jt(t)?this.Rt(e,Number.MAX_SAFE_INTEGER):Yt(t)?this.bt(t.mapValue,e):(this.Dt(t.mapValue,e),this.yt(e)):"arrayValue"in t?(this.vt(t.arrayValue,e),this.yt(e)):R()}gt(t,e){this.Rt(e,25),this.Ct(t,e)}Ct(t,e){e.ft(t)}Dt(t,e){const n=t.fields||{};this.Rt(e,55);for(const t of Object.keys(n))this.gt(t,e),this.dt(n[t],e)}bt(t,e){var n,i;const r=t.fields||{};this.Rt(e,53);const a="value",s=(null===(i=null===(n=r[a].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.Rt(e,15),e.Vt(Ct(s)),this.gt(a,e),this.dt(r[a],e)}vt(t,e){const n=t.values||[];this.Rt(e,50);for(const t of n)this.dt(t,e)}St(t,e){this.Rt(e,37),tt.fromName(t).path.forEach((t=>{this.Rt(e,60),this.Ct(t,e)}))}Rt(t,e){t.Vt(e)}yt(t){t.Vt(2)}}Oi.Ft=new Oi;class Ni{constructor(){this.ln=new Li}addToCollectionParentIndex(t,e){return this.ln.add(e),ot.resolve()}getCollectionParents(t,e){return ot.resolve(this.ln.getEntries(e))}addFieldIndex(t,e){return ot.resolve()}deleteFieldIndex(t,e){return ot.resolve()}deleteAllFieldIndexes(t){return ot.resolve()}createTargetIndexes(t,e){return ot.resolve()}getDocumentsMatchingTarget(t,e){return ot.resolve(null)}getIndexType(t,e){return ot.resolve(0)}getFieldIndexes(t,e){return ot.resolve([])}getNextCollectionGroupToUpdate(t){return ot.resolve(null)}getMinOffset(t,e){return ot.resolve(nt.min())}getMinOffsetFromCollectionGroup(t,e){return ot.resolve(nt.min())}updateCollectionGroup(t,e,n){return ot.resolve()}updateIndexEntries(t,e){return ot.resolve()}}class Li{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new wt(Q.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new wt(Q.comparator)).toArray()}}new Uint8Array(0);const Fi={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ui{static withCacheSize(t){return new Ui(t,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Ui.DEFAULT_COLLECTION_PERCENTILE=10,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ui.DEFAULT=new Ui(41943040,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ui.DISABLED=new Ui(-1,0,0);class ji{constructor(t){this.kn=t}next(){return this.kn+=2,this.kn}static qn(){return new ji(0)}static Qn(){return new ji(-1)}}function Bi([t,e],[n,i]){const r=G(t,n);return 0===r?G(e,i):r}class Vi{constructor(t){this.Gn=t,this.buffer=new wt(Bi),this.zn=0}jn(){return++this.zn}Hn(t){const e=[t,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Bi(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class zi{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return null!==this.Jn}Yn(t){S("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ct(t)?S("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await st(t)}await this.Yn(3e5)}))}}class qi{constructor(t,e){this.Zn=t,this.params=e}calculateTargetCount(t,e){return this.Zn.Xn(t).next((t=>Math.floor(e/100*t)))}nthSequenceNumber(t,e){if(0===e)return ot.resolve(lt.oe);const n=new Vi(e);return this.Zn.forEachTarget(t,(t=>n.Hn(t.sequenceNumber))).next((()=>this.Zn.er(t,(t=>n.Hn(t))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.Zn.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.Zn.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector","Garbage collection skipped; disabled"),ot.resolve(Fi)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fi):this.tr(t,e)))}getCacheSize(t){return this.Zn.getCacheSize(t)}tr(t,e){let n,i,r,a,s,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((e=>(e>this.params.maximumSequenceNumbersToCollect?(S("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),i=this.params.maximumSequenceNumbersToCollect):i=e,a=Date.now(),this.nthSequenceNumber(t,i)))).next((i=>(n=i,s=Date.now(),this.removeTargets(t,n,e)))).next((e=>(r=e,c=Date.now(),this.removeOrphanedDocuments(t,n)))).next((t=>(l=Date.now(),T()<=o.$b.DEBUG&&S("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-h}ms\n\tDetermined least recently used ${i} in `+(s-a)+"ms\n"+`\tRemoved ${r} targets in `+(c-s)+"ms\n"+`\tRemoved ${t} documents in `+(l-c)+"ms\n"+`Total Duration: ${l-h}ms`),ot.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:t}))))}}class Hi{constructor(){this.changes=new ze((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,ee.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?ot.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class $i{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Gi{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&En(n.mutation,t,At.empty(),K.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Ze()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=Ze()){const i=Ke();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=Ge();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Ke();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Ze())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=He();const a=Ye(),s=Ye();return e.forEach(((t,e)=>{const s=n.get(e.key);i.has(e.key)&&(void 0===s||s.mutation instanceof kn)?r=r.insert(e.key,e):void 0!==s?(a.set(e.key,s.mutation.getFieldMask()),En(s.mutation,e,s.mutation.getFieldMask(),K.now())):a.set(e.key,At.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>a.set(t,e))),e.forEach(((t,e)=>{var n;return s.set(t,new $i(e,null!==(n=a.get(t))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(t,e){const n=Ye();let i=new vt(((t,e)=>t-e)),r=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const a=e.get(t);if(null===a)return;let s=n.get(t)||At.empty();s=r.applyToLocalView(a,s),n.set(t,s);const o=(i.get(r.batchId)||Ze()).add(t);i=i.insert(r.batchId,o)}))})).next((()=>{const a=[],s=i.getReverseIterator();for(;s.hasNext();){const i=s.getNext(),o=i.key,c=i.value,l=Xe();c.forEach((t=>{if(!r.has(t)){const i=An(e.get(t),n.get(t));null!==i&&l.set(t,i),r=r.add(t)}})),a.push(this.documentOverlayCache.saveOverlays(t,o,l))}return ot.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return tt.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Me(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const a=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):ot.resolve(Ke());let s=-1,o=r;return a.next((e=>ot.forEach(e,((e,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),r.get(e)?ot.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{o=o.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,o,e,Ze()))).next((t=>({batchId:s,changes:We(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new tt(e)).next((t=>{let e=Ge();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let a=Ge();return this.indexManager.getCollectionParents(t,r).next((s=>ot.forEach(s,(s=>{const o=function(t,e){return new ke(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(r));return this.getDocumentsMatchingCollectionQuery(t,o,n,i).next((t=>{t.forEach(((t,e)=>{a=a.insert(t,e)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((a=>(r=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,ee.newInvalidDocument(i)))}));let n=Ge();return t.forEach(((t,i)=>{const a=r.get(t);void 0!==a&&En(a.mutation,i,At.empty(),K.now()),je(e,i)&&(n=n.insert(t,i))})),n}))}}class Wi{constructor(t){this.serializer=t,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(t,e){return ot.resolve(this.Tr.get(e))}saveBundleMetadata(t,e){return this.Tr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:li(t.createTime)}}(e)),ot.resolve()}getNamedQuery(t,e){return ot.resolve(this.Ir.get(e))}saveNamedQuery(t,e){return this.Ir.set(e.name,function(t){return{name:t.name,query:Di(t.bundledQuery),readTime:li(t.readTime)}}(e)),ot.resolve()}}class Ki{constructor(){this.overlays=new vt(tt.comparator),this.Er=new Map}getOverlay(t,e){return ot.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Ke();return ot.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.Tt(t,e,i)})),ot.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Er.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Er.delete(n)),ot.resolve()}getOverlaysForCollection(t,e,n){const i=Ke(),r=e.length+1,a=new tt(e.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const t=s.getNext().value,a=t.getKey();if(!e.isPrefixOf(a.path))break;a.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return ot.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new vt(((t,e)=>t-e));const a=this.overlays.getIterator();for(;a.hasNext();){const t=a.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=Ke(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const s=Ke(),o=r.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((t,e)=>s.set(t,e))),!(s.size()>=i)););return ot.resolve(s)}Tt(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.Er.get(i.largestBatchId).delete(n.key);this.Er.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Ln(e,n));let r=this.Er.get(e);void 0===r&&(r=Ze(),this.Er.set(e,r)),this.Er.set(e,r.add(n.key))}}class Xi{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(t){return ot.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,ot.resolve()}}class Yi{constructor(){this.dr=new wt(Qi.Ar),this.Rr=new wt(Qi.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(t,e){const n=new Qi(t,e);this.dr=this.dr.add(n),this.Rr=this.Rr.add(n)}mr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.gr(new Qi(t,e))}pr(t,e){t.forEach((t=>this.removeReference(t,e)))}yr(t){const e=new tt(new Q([])),n=new Qi(e,t),i=new Qi(e,t+1),r=[];return this.Rr.forEachInRange([n,i],(t=>{this.gr(t),r.push(t.key)})),r}wr(){this.dr.forEach((t=>this.gr(t)))}gr(t){this.dr=this.dr.delete(t),this.Rr=this.Rr.delete(t)}Sr(t){const e=new tt(new Q([])),n=new Qi(e,t),i=new Qi(e,t+1);let r=Ze();return this.Rr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Qi(t,0),n=this.dr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Qi{constructor(t,e){this.key=t,this.br=e}static Ar(t,e){return tt.comparator(t.key,e.key)||G(t.br,e.br)}static Vr(t,e){return G(t.br,e.br)||tt.comparator(t.key,e.key)}}class Ji{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Dr=1,this.vr=new wt(Qi.Ar)}checkEmpty(t){return ot.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new On(r,e,n,i);this.mutationQueue.push(a);for(const e of i)this.vr=this.vr.add(new Qi(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return ot.resolve(a)}lookupMutationBatch(t,e){return ot.resolve(this.Cr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.Fr(n),r=i<0?0:i;return ot.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return ot.resolve(0===this.mutationQueue.length?-1:this.Dr-1)}getAllMutationBatches(t){return ot.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Qi(e,0),i=new Qi(e,Number.POSITIVE_INFINITY),r=[];return this.vr.forEachInRange([n,i],(t=>{const e=this.Cr(t.br);r.push(e)})),ot.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new wt(G);return e.forEach((t=>{const e=new Qi(t,0),i=new Qi(t,Number.POSITIVE_INFINITY);this.vr.forEachInRange([e,i],(t=>{n=n.add(t.br)}))})),ot.resolve(this.Mr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;tt.isDocumentKey(r)||(r=r.child(""));const a=new Qi(new tt(r),0);let s=new wt(G);return this.vr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.br)),!0)}),a),ot.resolve(this.Mr(s))}Mr(t){const e=[];return t.forEach((t=>{const n=this.Cr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){M(0===this.Or(e.batchId,"removed")),this.mutationQueue.shift();let n=this.vr;return ot.forEach(e.mutations,(i=>{const r=new Qi(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.vr=n}))}Ln(t){}containsKey(t,e){const n=new Qi(e,0),i=this.vr.firstAfterOrEqual(n);return ot.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ot.resolve()}Or(t,e){return this.Fr(t)}Fr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Cr(t){const e=this.Fr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Zi{constructor(t){this.Nr=t,this.docs=new vt(tt.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,a=this.Nr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:a}),this.size+=a-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return ot.resolve(n?n.document.mutableCopy():ee.newInvalidDocument(e))}getEntries(t,e){let n=He();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():ee.newInvalidDocument(t))})),ot.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=He();const a=e.path,s=new tt(a.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:t,value:{document:s}}=o.getNext();if(!a.isPrefixOf(t.path))break;t.path.length>a.length+1||it(et(s),n)<=0||(i.has(s.key)||je(e,s))&&(r=r.insert(s.key,s.mutableCopy()))}return ot.resolve(r)}getAllFromCollectionGroup(t,e,n,i){R()}Lr(t,e){return ot.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new tr(this)}getSize(t){return ot.resolve(this.size)}}class tr extends Hi{constructor(t){super(),this.hr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.hr.addEntry(t,i)):this.hr.removeEntry(n)})),ot.waitFor(e)}getFromCache(t,e){return this.hr.getEntry(t,e)}getAllFromCache(t,e){return this.hr.getEntries(t,e)}}class er{constructor(t){this.persistence=t,this.Br=new ze((t=>Te(t)),Se),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.kr=0,this.qr=new Yi,this.targetCount=0,this.Qr=ji.qn()}forEachTarget(t,e){return this.Br.forEach(((t,n)=>e(n))),ot.resolve()}getLastRemoteSnapshotVersion(t){return ot.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ot.resolve(this.kr)}allocateTargetId(t){return this.highestTargetId=this.Qr.next(),ot.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.kr&&(this.kr=e),ot.resolve()}Un(t){this.Br.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Qr=new ji(e),this.highestTargetId=e),t.sequenceNumber>this.kr&&(this.kr=t.sequenceNumber)}addTargetData(t,e){return this.Un(e),this.targetCount+=1,ot.resolve()}updateTargetData(t,e){return this.Un(e),ot.resolve()}removeTargetData(t,e){return this.Br.delete(e.target),this.qr.yr(e.targetId),this.targetCount-=1,ot.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Br.forEach(((a,s)=>{s.sequenceNumber<=e&&null===n.get(s.targetId)&&(this.Br.delete(a),r.push(this.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),ot.waitFor(r).next((()=>i))}getTargetCount(t){return ot.resolve(this.targetCount)}getTargetData(t,e){const n=this.Br.get(e)||null;return ot.resolve(n)}addMatchingKeys(t,e,n){return this.qr.mr(e,n),ot.resolve()}removeMatchingKeys(t,e,n){this.qr.pr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),ot.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.qr.yr(e),ot.resolve()}getMatchingKeysForTargetId(t,e){const n=this.qr.Sr(e);return ot.resolve(n)}containsKey(t,e){return ot.resolve(this.qr.containsKey(e))}}class nr{constructor(t,e){this.Kr={},this.overlays={},this.$r=new lt(0),this.Ur=!1,this.Ur=!0,this.Wr=new Xi,this.referenceDelegate=t(this),this.Gr=new er(this),this.indexManager=new Ni,this.remoteDocumentCache=function(t){return new Zi(t)}((t=>this.referenceDelegate.zr(t))),this.serializer=new Pi(e),this.jr=new Wi(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Ki,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Kr[t.toKey()];return n||(n=new Ji(e,this.referenceDelegate),this.Kr[t.toKey()]=n),n}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(t,e,n){S("MemoryPersistence","Starting transaction:",t);const i=new ir(this.$r.next());return this.referenceDelegate.Hr(),n(i).next((t=>this.referenceDelegate.Jr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Yr(t,e){return ot.or(Object.values(this.Kr).map((n=>()=>n.containsKey(t,e))))}}class ir extends at{constructor(t){super(),this.currentSequenceNumber=t}}class rr{constructor(t){this.persistence=t,this.Zr=new Yi,this.Xr=null}static ei(t){return new rr(t)}get ti(){if(this.Xr)return this.Xr;throw R()}addReference(t,e,n){return this.Zr.addReference(n,e),this.ti.delete(n.toString()),ot.resolve()}removeReference(t,e,n){return this.Zr.removeReference(n,e),this.ti.add(n.toString()),ot.resolve()}markPotentiallyOrphaned(t,e){return this.ti.add(e.toString()),ot.resolve()}removeTarget(t,e){this.Zr.yr(e.targetId).forEach((t=>this.ti.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.ti.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Hr(){this.Xr=new Set}Jr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ot.forEach(this.ti,(n=>{const i=tt.fromPath(n);return this.ni(t,i).next((t=>{t||e.removeEntry(i,X.min())}))})).next((()=>(this.Xr=null,e.apply(t))))}updateLimboDocument(t,e){return this.ni(t,e).next((t=>{t?this.ti.delete(e.toString()):this.ti.add(e.toString())}))}zr(t){return 0}ni(t,e){return ot.or([()=>ot.resolve(this.Zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Yr(t,e)])}}class ar{constructor(t,e){this.persistence=t,this.ri=new ze((t=>function(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=dt(e)),e=ft(t.get(n),e);return dt(e)}(t.path)),((t,e)=>t.isEqual(e))),this.garbageCollector=function(t,e){return new qi(t,e)}(this,e)}static ei(t,e){return new ar(t,e)}Hr(){}Jr(t){return ot.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}Xn(t){const e=this.nr(t);return this.persistence.getTargetCache().getTargetCount(t).next((t=>e.next((e=>t+e))))}nr(t){let e=0;return this.er(t,(t=>{e++})).next((()=>e))}er(t,e){return ot.forEach(this.ri,((n,i)=>this.ir(t,n,i).next((t=>t?ot.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.Lr(t,(i=>this.ir(t,i,e).next((t=>{t||(n++,r.removeEntry(i,X.min()))})))).next((()=>r.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.ri.set(e,t.currentSequenceNumber),ot.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.ri.set(n,t.currentSequenceNumber),ot.resolve()}removeReference(t,e,n){return this.ri.set(n,t.currentSequenceNumber),ot.resolve()}updateLimboDocument(t,e){return this.ri.set(e,t.currentSequenceNumber),ot.resolve()}zr(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=qt(t.data.value)),e}ir(t,e,n){return ot.or([()=>this.persistence.Yr(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.ri.get(e);return ot.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class sr{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Wi=n,this.Gi=i}static zi(t,e){let n=Ze(),i=Ze();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new sr(t,e.fromCache,n,i)}}class or{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class cr{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=(0,c.nr)()?8:function(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}((0,c.ZQ)())>0?6:4}initialize(t,e){this.Zi=t,this.indexManager=e,this.ji=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.Xi(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.es(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new or;return this.ts(t,e,n).next((i=>{if(r.result=i,this.Hi)return this.ns(t,e,n,i.size)}))})).next((()=>r.result))}ns(t,e,n,i){return n.documentReadCount<this.Ji?(T()<=o.$b.DEBUG&&S("QueryEngine","SDK will not create cache indexes for query:",Ue(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),ot.resolve()):(T()<=o.$b.DEBUG&&S("QueryEngine","Query:",Ue(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Yi*i?(T()<=o.$b.DEBUG&&S("QueryEngine","The SDK decides to create cache indexes for query:",Ue(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,De(e))):ot.resolve())}Xi(t,e){if(Re(e))return ot.resolve(null);let n=De(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=Ne(e,null,"F"),n=De(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=Ze(...i);return this.Zi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const a=this.rs(e,i);return this.ss(e,a,r,n.readTime)?this.Xi(t,Ne(e,null,"F")):this.os(t,a,e,n)}))))})))))}es(t,e,n,i){return Re(e)||i.isEqual(X.min())?ot.resolve(null):this.Zi.getDocuments(t,n).next((r=>{const a=this.rs(e,r);return this.ss(e,a,n,i)?ot.resolve(null):(T()<=o.$b.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ue(e)),this.os(t,a,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=X.fromTimestamp(1e9===i?new K(n+1,0):new K(n,i));return new nt(r,tt.empty(),e)}(i,-1)).next((t=>t)))}))}rs(t,e){let n=new wt(Be(t));return e.forEach(((e,i)=>{je(t,i)&&(n=n.add(i))})),n}ss(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}ts(t,e,n){return T()<=o.$b.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",Ue(e)),this.Zi.getDocumentsMatchingQuery(t,e,nt.min(),n)}os(t,e,n,i){return this.Zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class lr{constructor(t,e,n,i){this.persistence=t,this._s=e,this.serializer=i,this.us=new vt(G),this.cs=new ze((t=>Te(t)),Se),this.ls=new Map,this.hs=t.getRemoteDocumentCache(),this.Gr=t.getTargetCache(),this.jr=t.getBundleCache(),this.Ps(n)}Ps(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Gi(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.us)))}}async function hr(t,e){const n=P(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.Ps(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],a=[];let s=Ze();for(const t of i){r.push(t.batchId);for(const e of t.mutations)s=s.add(e.key)}for(const t of e){a.push(t.batchId);for(const e of t.mutations)s=s.add(e.key)}return n.localDocuments.getDocuments(t,s).next((t=>({Ts:t,removedBatchIds:r,addedBatchIds:a})))}))}))}function ur(t){const e=P(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Gr.getLastRemoteSnapshotVersion(t)))}function fr(t,e){const n=P(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function dr(t,e,n){const i=P(t),r=i.us.get(e),a=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",a,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!ct(t))throw t;S("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.us=i.us.remove(e),i.cs.delete(r.target)}function pr(t,e,n){const i=P(t);let r=X.min(),a=Ze();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=P(t),r=i.cs.get(n);return void 0!==r?ot.resolve(i.us.get(r)):i.Gr.getTargetData(e,n)}(i,t,De(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{a=t}))})).next((()=>i._s.getDocumentsMatchingQuery(t,e,n?r:X.min(),n?a:Ze()))).next((t=>(function(t,e,n){let i=t.ls.get(e)||X.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ls.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,ds:a})))))}class gr{constructor(){this.activeTargetIds=tn}ps(t){this.activeTargetIds=this.activeTargetIds.add(t)}ys(t){this.activeTargetIds=this.activeTargetIds.delete(t)}gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class mr{constructor(){this._o=new gr,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this._o.ps(t),this.ao[t]||"not-current"}updateQueryState(t,e,n){this.ao[t]=e}removeLocalQueryTarget(t){this._o.ys(t)}isLocalQueryTarget(t){return this._o.activeTargetIds.has(t)}clearQueryState(t){delete this.ao[t]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(t){return this._o.activeTargetIds.has(t)}start(){return this._o=new gr,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class vr{uo(t){}shutdown(){}}class yr{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(t){this.To.push(t)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.To)t(0)}Po(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.To)t(1)}static p(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let br=null;function wr(){return null===br?br=268435456+Math.round(2147483648*Math.random()):br++,"0x"+br.toString(16)}const _r={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ar{constructor(t){this.Eo=t.Eo,this.Ao=t.Ao}Ro(t){this.Vo=t}mo(t){this.fo=t}po(t){this.yo=t}onMessage(t){this.wo=t}close(){this.Ao()}send(t){this.Eo(t)}So(){this.Vo()}bo(){this.fo()}Do(t){this.yo(t)}vo(t){this.wo(t)}}const xr="WebChannelConnection";class Er extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Fo=e+"://"+t.host,this.Mo=`projects/${n}/databases/${i}`,this.xo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Oo(t,e,n,i,r){const a=wr(),s=this.No(t,e.toUriEncodedString());S("RestConnection",`Sending RPC '${t}' ${a}:`,s,n);const o={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(o,i,r),this.Bo(t,s,o,n).then((e=>(S("RestConnection",`Received RPC '${t}' ${a}: `,e),e)),(e=>{throw k("RestConnection",`RPC '${t}' ${a} failed with error: `,e,"url: ",s,"request:",n),e}))}ko(t,e,n,i,r,a){return this.Oo(t,e,n,i,r)}Lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+x,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}No(t,e){const n=_r[t];return`${this.Fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Bo(t,e,n,i){const r=wr();return new Promise(((a,s)=>{const o=new u;o.setWithCredentials(!0),o.listenOnce(d.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case p.NO_ERROR:const e=o.getResponseJson();S(xr,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),a(e);break;case p.TIMEOUT:S(xr,`RPC '${t}' ${r} timed out`),s(new O(D.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=o.getStatus();if(S(xr,`RPC '${t}' ${r} failed with status:`,n,"response text:",o.getResponseText()),n>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(e)>=0?e:D.UNKNOWN}(e.status);s(new O(t,e.message))}else s(new O(D.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new O(D.UNAVAILABLE,"Connection failed."));break;default:R()}}finally{S(xr,`RPC '${t}' ${r} completed.`)}}));const c=JSON.stringify(i);S(xr,`RPC '${t}' ${r} sending request:`,i),o.send(e,"POST",c,n,15)}))}qo(t,e,n){const i=wr(),r=[this.Fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=y(),s=v(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(o.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const l=r.join("");S(xr,`Creating RPC '${t}' stream ${i}: ${l}`,o);const h=a.createWebChannel(l,o);let u=!1,d=!1;const p=new Ar({Eo:e=>{d?S(xr,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(u||(S(xr,`Opening RPC '${t}' stream ${i} transport.`),h.open(),u=!0),S(xr,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},Ao:()=>h.close()}),b=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return b(h,f.EventType.OPEN,(()=>{d||(S(xr,`RPC '${t}' stream ${i} transport opened.`),p.So())})),b(h,f.EventType.CLOSE,(()=>{d||(d=!0,S(xr,`RPC '${t}' stream ${i} transport closed`),p.Do())})),b(h,f.EventType.ERROR,(e=>{d||(d=!0,k(xr,`RPC '${t}' stream ${i} transport errored:`,e),p.Do(new O(D.UNAVAILABLE,"The operation could not be completed")))})),b(h,f.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];M(!!r);const a=r,s=(null==a?void 0:a.error)||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){S(xr,`RPC '${t}' stream ${i} received error:`,s);const e=s.status;let n=function(t){const e=Un[t];if(void 0!==e)return Bn(e)}(e),r=s.message;void 0===n&&(n=D.INTERNAL,r="Unknown error status: "+e+" with message "+s.message),d=!0,p.Do(new O(n,r)),h.close()}else S(xr,`RPC '${t}' stream ${i} received:`,r),p.vo(r)}})),b(s,m.STAT_EVENT,(e=>{e.stat===g.PROXY?S(xr,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===g.NOPROXY&&S(xr,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{p.bo()}),0),p}}function Tr(){return"undefined"!=typeof document?document:null}function Sr(t){return new ri(t,!0)}class Cr{constructor(t,e,n=1e3,i=1.5,r=6e4){this.li=t,this.timerId=e,this.Qo=n,this.Ko=i,this.$o=r,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(t){this.cancel();const e=Math.floor(this.Uo+this.Ho()),n=Math.max(0,Date.now()-this.Go),i=Math.max(0,e-n);i>0&&S("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,(()=>(this.Go=Date.now(),t()))),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){null!==this.Wo&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){null!==this.Wo&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}class kr{constructor(t,e,n,i,r,a,s,o){this.li=t,this.Yo=n,this.Zo=i,this.connection=r,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new Cr(t,e)}i_(){return 1===this.state||5===this.state||this.s_()}s_(){return 2===this.state||3===this.state}start(){this.n_=0,4!==this.state?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&null===this.e_&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,(()=>this.u_())))}c_(t){this.l_(),this.stream.send(t)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(t,e){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,4!==t?this.r_.reset():e&&e.code===D.RESOURCE_EXHAUSTED?(C(e.toString()),C("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):e&&e.code===D.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.P_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.po(e)}P_(){}auth(){this.state=1;const t=this.T_(this.Xo),e=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Xo===e&&this.I_(t,n)}),(e=>{t((()=>{const t=new O(D.UNKNOWN,"Fetching auth token failed: "+e.message);return this.E_(t)}))}))}I_(t,e){const n=this.T_(this.Xo);this.stream=this.d_(t,e),this.stream.Ro((()=>{n((()=>this.listener.Ro()))})),this.stream.mo((()=>{n((()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,(()=>(this.s_()&&(this.state=3),Promise.resolve()))),this.listener.mo())))})),this.stream.po((t=>{n((()=>this.E_(t)))})),this.stream.onMessage((t=>{n((()=>1==++this.n_?this.A_(t):this.onNext(t)))}))}o_(){this.state=5,this.r_.jo((async()=>{this.state=0,this.start()}))}E_(t){return S("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}T_(t){return e=>{this.li.enqueueAndForget((()=>this.Xo===t?e():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ir extends kr{constructor(t,e,n,i,r,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,a),this.serializer=r}d_(t,e){return this.connection.qo("Listen",t,e)}A_(t){return this.onNext(t)}onNext(t){this.r_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:R()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],a=function(t,e){return t.useProto3Json?(M(void 0===e||"string"==typeof e),Et.fromBase64String(e||"")):(M(void 0===e||e instanceof Buffer||e instanceof Uint8Array),Et.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(t){const e=void 0===t.code?D.UNKNOWN:Bn(t.code);return new O(e,t.message||"")}(s);n=new Yn(i,r,a,o||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=pi(t,i.document.name),a=li(i.document.updateTime),s=i.document.createTime?li(i.document.createTime):X.min(),o=new Zt({mapValue:{fields:i.document.fields}}),c=ee.newFoundDocument(r,a,s,o),l=i.targetIds||[],h=i.removedTargetIds||[];n=new Kn(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=pi(t,i.document),a=i.readTime?li(i.readTime):X.min(),s=ee.newNoDocument(r,a),o=i.removedTargetIds||[];n=new Kn([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=pi(t,i.document),a=i.removedTargetIds||[];n=new Kn([],a,r,null)}else{if(!("filter"in e))return R();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,a=new Fn(i,r),s=t.targetId;n=new Xn(s,a)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return X.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?X.min():e.readTime?li(e.readTime):X.min()}(t);return this.listener.R_(e,n)}V_(t){const e={};e.database=mi(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=Ce(i)?{documents:bi(t,i)}:{query:wi(t,i).ct},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=oi(t,e.resumeToken);const i=ai(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(X.min())>0){n.readTime=si(t,e.snapshotVersion.toTimestamp());const i=ai(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return R()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.c_(e)}m_(t){const e={};e.database=mi(this.serializer),e.removeTarget=t,this.c_(e)}}class Rr extends kr{constructor(t,e,n,i,r,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,a),this.serializer=r}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(t,e){return this.connection.qo("Write",t,e)}A_(t){return M(!!t.streamToken),this.lastStreamToken=t.streamToken,M(!t.writeResults||0===t.writeResults.length),this.listener.p_()}onNext(t){M(!!t.streamToken),this.lastStreamToken=t.streamToken,this.r_.reset();const e=function(t,e){return t&&t.length>0?(M(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?li(t.updateTime):li(e);return n.isEqual(X.min())&&(n=li(e)),new yn(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=li(t.commitTime);return this.listener.y_(n,e)}w_(){const t={};t.database=mi(this.serializer),this.c_(t)}g_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Cn)n={update:yi(t,e.key,e.value)};else if(e instanceof Pn)n={delete:di(t,e.key)};else if(e instanceof kn)n={update:yi(t,e.key,e.data),updateMask:Ii(e.fieldMask)};else{if(!(e instanceof Dn))return R();n={verify:di(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof ln)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof hn)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof fn)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof pn)return{fieldPath:e.field.canonicalString(),increment:n.Pe};throw R()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ci(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:R()}(t,e.precondition)),n}(this.serializer,t)))};this.c_(e)}}class Mr extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new O(D.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(t,e,n,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,a])=>this.connection.Oo(t,ui(e,n),i,r,a))).catch((t=>{throw"FirebaseError"===t.name?(t.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new O(D.UNKNOWN,t.toString())}))}ko(t,e,n,i,r){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,s])=>this.connection.ko(t,ui(e,n),i,a,s,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new O(D.UNKNOWN,t.toString())}))}terminate(){this.S_=!0,this.connection.terminate()}}class Pr{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){0===this.D_&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve()))))}O_(t){"Online"===this.state?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.M_("Offline")))}set(t){this.N_(),this.D_=0,"Online"===t&&(this.C_=!1),this.M_(t)}M_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}x_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(C(e),this.C_=!1):S("OnlineStateTracker",e)}N_(){null!==this.v_&&(this.v_.cancel(),this.v_=null)}}class Dr{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=r,this.Q_.uo((t=>{n.enqueueAndForget((async()=>{zr(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=P(t);e.k_.add(4),await Nr(e),e.K_.set("Unknown"),e.k_.delete(4),await Or(e)}(this))}))})),this.K_=new Pr(n,i)}}async function Or(t){if(zr(t))for(const e of t.q_)await e(!0)}async function Nr(t){for(const e of t.q_)await e(!1)}function Lr(t,e){const n=P(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),Vr(n)?Br(n):sa(n).s_()&&Ur(n,e))}function Fr(t,e){const n=P(t),i=sa(n);n.B_.delete(e),i.s_()&&jr(n,e),0===n.B_.size&&(i.s_()?i.a_():zr(n)&&n.K_.set("Unknown"))}function Ur(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}sa(t).V_(e)}function jr(t,e){t.U_.xe(e),sa(t).m_(e)}function Br(t){t.U_=new Jn({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),sa(t).start(),t.K_.F_()}function Vr(t){return zr(t)&&!sa(t).i_()&&t.B_.size>0}function zr(t){return 0===P(t).k_.size}function qr(t){t.U_=void 0}async function Hr(t){t.K_.set("Online")}async function $r(t){t.B_.forEach(((e,n)=>{Ur(t,e)}))}async function Gr(t,e){qr(t),Vr(t)?(t.K_.O_(e),Br(t)):t.K_.set("Unknown")}async function Wr(t,e,n){if(t.K_.set("Online"),e instanceof Yn&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.B_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.B_.delete(i),t.U_.removeTarget(i))}(t,e)}catch(n){S("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Kr(t,n)}else if(e instanceof Kn?t.U_.$e(e):e instanceof Xn?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(X.min()))try{const e=await ur(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.U_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.B_.get(i);r&&t.B_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.B_.get(e);if(!i)return;t.B_.set(e,i.withResumeToken(Et.EMPTY_BYTE_STRING,i.snapshotVersion)),jr(t,e);const r=new Mi(i.target,e,n,i.sequenceNumber);Ur(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){S("RemoteStore","Failed to raise snapshot:",e),await Kr(t,e)}}async function Kr(t,e,n){if(!ct(e))throw e;t.k_.add(1),await Nr(t),t.K_.set("Offline"),n||(n=()=>ur(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{S("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await Or(t)}))}function Xr(t,e){return e().catch((n=>Kr(t,n,e)))}async function Yr(t){const e=P(t),n=oa(e);let i=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;Qr(e);)try{const t=await fr(e.localStore,i);if(null===t){0===e.L_.length&&n.a_();break}i=t.batchId,Jr(e,t)}catch(t){await Kr(e,t)}Zr(e)&&ta(e)}function Qr(t){return zr(t)&&t.L_.length<10}function Jr(t,e){t.L_.push(e);const n=oa(t);n.s_()&&n.f_&&n.g_(e.mutations)}function Zr(t){return zr(t)&&!oa(t).i_()&&t.L_.length>0}function ta(t){oa(t).start()}async function ea(t){oa(t).w_()}async function na(t){const e=oa(t);for(const n of t.L_)e.g_(n.mutations)}async function ia(t,e,n){const i=t.L_.shift(),r=Nn.from(i,e,n);await Xr(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await Yr(t)}async function ra(t,e){e&&oa(t).f_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return R();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}(t)&&t!==D.ABORTED}(e.code)){const n=t.L_.shift();oa(t).__(),await Xr(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Yr(t)}}(t,e),Zr(t)&&ta(t)}async function aa(t,e){const n=P(t);n.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const i=zr(n);n.k_.add(3),await Nr(n),i&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await Or(n)}function sa(t){return t.W_||(t.W_=function(t,e,n){const i=P(t);return i.b_(),new Ir(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Ro:Hr.bind(null,t),mo:$r.bind(null,t),po:Gr.bind(null,t),R_:Wr.bind(null,t)}),t.q_.push((async e=>{e?(t.W_.__(),Vr(t)?Br(t):t.K_.set("Unknown")):(await t.W_.stop(),qr(t))}))),t.W_}function oa(t){return t.G_||(t.G_=function(t,e,n){const i=P(t);return i.b_(),new Rr(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:ea.bind(null,t),po:ra.bind(null,t),p_:na.bind(null,t),y_:ia.bind(null,t)}),t.q_.push((async e=>{e?(t.G_.__(),await Yr(t)):(await t.G_.stop(),t.L_.length>0&&(S("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))}))),t.G_}class ca{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new N,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const a=Date.now()+n,s=new ca(t,e,a,i,r);return s.start(n),s}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new O(D.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function la(t,e){if(C("AsyncQueue",`${e}: ${t}`),ct(t))return new O(D.UNAVAILABLE,`${e}: ${t}`);throw t}class ha{static emptySet(t){return new ha(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||tt.comparator(e.key,n.key):(t,e)=>tt.comparator(t.key,e.key),this.keyedMap=Ge(),this.sortedSet=new vt(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof ha))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new ha;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class ua{constructor(){this.z_=new vt(tt.comparator)}track(t){const e=t.doc.key,n=this.z_.get(e);n?0!==t.type&&3===n.type?this.z_=this.z_.insert(e,t):3===t.type&&1!==n.type?this.z_=this.z_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.z_=this.z_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.z_=this.z_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.z_=this.z_.remove(e):1===t.type&&2===n.type?this.z_=this.z_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.z_=this.z_.insert(e,{type:2,doc:t.doc}):R():this.z_=this.z_.insert(e,t)}j_(){const t=[];return this.z_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class fa{constructor(t,e,n,i,r,a,s,o,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,r){const a=[];return e.forEach((t=>{a.push({type:0,doc:t})})),new fa(t,e,ha.emptySet(e),a,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Le(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class da{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some((t=>t.Z_()))}}class pa{constructor(){this.queries=ga(),this.onlineState="Unknown",this.X_=new Set}terminate(){!function(t,e){const n=P(t),i=n.queries;n.queries=ga(),i.forEach(((t,n)=>{for(const t of n.J_)t.onError(e)}))}(this,new O(D.ABORTED,"Firestore shutting down"))}}function ga(){return new ze((t=>Fe(t)),Le)}async function ma(t,e){const n=P(t);let i=3;const r=e.query;let a=n.queries.get(r);a?!a.Y_()&&e.Z_()&&(i=2):(a=new da,i=e.Z_()?0:1);try{switch(i){case 0:a.H_=await n.onListen(r,!0);break;case 1:a.H_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(t){const n=la(t,`Initialization of query '${Ue(e.query)}' failed`);return void e.onError(n)}n.queries.set(r,a),a.J_.push(e),e.ea(n.onlineState),a.H_&&e.ta(a.H_)&&wa(n)}async function va(t,e){const n=P(t),i=e.query;let r=3;const a=n.queries.get(i);if(a){const t=a.J_.indexOf(e);t>=0&&(a.J_.splice(t,1),0===a.J_.length?r=e.Z_()?0:1:!a.Y_()&&e.Z_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function ya(t,e){const n=P(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.J_)e.ta(t)&&(i=!0);r.H_=t}}i&&wa(n)}function ba(t,e,n){const i=P(t),r=i.queries.get(e);if(r)for(const t of r.J_)t.onError(n);i.queries.delete(e)}function wa(t){t.X_.forEach((t=>{t.next()}))}var _a,Aa;(Aa=_a||(_a={})).na="default",Aa.Cache="cache";class xa{constructor(t,e,n){this.query=t,this.ra=e,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=n||{}}ta(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new fa(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.ia?this.oa(t)&&(this.ra.next(t),e=!0):this._a(t,this.onlineState)&&(this.aa(t),e=!0),this.sa=t,e}onError(t){this.ra.error(t)}ea(t){this.onlineState=t;let e=!1;return this.sa&&!this.ia&&this._a(this.sa,t)&&(this.aa(this.sa),e=!0),e}_a(t,e){if(!t.fromCache)return!0;if(!this.Z_())return!0;const n="Offline"!==e;return(!this.options.ua||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}oa(t){if(t.docChanges.length>0)return!0;const e=this.sa&&this.sa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}aa(t){t=fa.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ia=!0,this.ra.next(t)}Z_(){return this.options.source!==_a.Cache}}class Ea{constructor(t){this.key=t}}class Ta{constructor(t){this.key=t}}class Sa{constructor(t,e){this.query=t,this.da=e,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Ze(),this.mutatedKeys=Ze(),this.Va=Be(t),this.ma=new ha(this.Va)}get fa(){return this.da}ga(t,e){const n=e?e.pa:new ua,i=e?e.ma:this.ma;let r=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1;const o="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const l=i.get(t),h=je(this.query,e)?e:null,u=!!l&&this.mutatedKeys.has(l.key),f=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let d=!1;l&&h?l.data.isEqual(h.data)?u!==f&&(n.track({type:3,doc:h}),d=!0):this.ya(l,h)||(n.track({type:2,doc:h}),d=!0,(o&&this.Va(h,o)>0||c&&this.Va(h,c)<0)&&(s=!0)):!l&&h?(n.track({type:0,doc:h}),d=!0):l&&!h&&(n.track({type:1,doc:l}),d=!0,(o||c)&&(s=!0)),d&&(h?(a=a.add(h),r=f?r.add(t):r.delete(t)):(a=a.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const t="F"===this.query.limitType?a.last():a.first();a=a.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{ma:a,pa:n,ss:s,mutatedKeys:r}}ya(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.ma;this.ma=t.ma,this.mutatedKeys=t.mutatedKeys;const a=t.pa.j_();a.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return R()}};return n(t)-n(e)}(t.type,e.type)||this.Va(t.doc,e.doc))),this.wa(n),i=null!=i&&i;const s=e&&!i?this.Sa():[],o=0===this.Ra.size&&this.current&&!i?1:0,c=o!==this.Aa;return this.Aa=o,0!==a.length||c?{snapshot:new fa(this.query,t.ma,r,a,t.mutatedKeys,0===o,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),ba:s}:{ba:s}}ea(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ma:this.ma,pa:new ua,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(t){return!this.da.has(t)&&!!this.ma.has(t)&&!this.ma.get(t).hasLocalMutations}wa(t){t&&(t.addedDocuments.forEach((t=>this.da=this.da.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.da=this.da.delete(t))),this.current=t.current)}Sa(){if(!this.current)return[];const t=this.Ra;this.Ra=Ze(),this.ma.forEach((t=>{this.Da(t.key)&&(this.Ra=this.Ra.add(t.key))}));const e=[];return t.forEach((t=>{this.Ra.has(t)||e.push(new Ta(t))})),this.Ra.forEach((n=>{t.has(n)||e.push(new Ea(n))})),e}va(t){this.da=t.ds,this.Ra=Ze();const e=this.ga(t.documents);return this.applyChanges(e,!0)}Ca(){return fa.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,0===this.Aa,this.hasCachedResults)}}class Ca{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class ka{constructor(t){this.key=t,this.Fa=!1}}class Ia{constructor(t,e,n,i,r,a){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=a,this.Ma={},this.xa=new ze((t=>Fe(t)),Le),this.Oa=new Map,this.Na=new Set,this.La=new vt(tt.comparator),this.Ba=new Map,this.ka=new Yi,this.qa={},this.Qa=new Map,this.Ka=ji.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return!0===this.$a}}async function Ra(t,e,n=!0){const i=Ya(t);let r;const a=i.xa.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.Ca()):r=await Pa(i,e,n,!0),r}async function Ma(t,e){const n=Ya(t);await Pa(n,e,!0,!1)}async function Pa(t,e,n,i){const r=await function(t,e){const n=P(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Gr.getTargetData(t,e).next((r=>r?(i=r,ot.resolve(i)):n.Gr.allocateTargetId(t).next((r=>(i=new Mi(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Gr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.us.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.us=n.us.insert(t.targetId,t),n.cs.set(e,t.targetId)),t}))}(t.localStore,De(e)),a=r.targetId,s=t.sharedClientState.addLocalQueryTarget(a,n);let o;return i&&(o=await async function(t,e,n,i,r){t.Ua=(e,n,i)=>async function(t,e,n,i){let r=e.view.ga(n);r.ss&&(r=await pr(t.localStore,e.query,!1).then((({documents:t})=>e.view.ga(t,r))));const a=i&&i.targetChanges.get(e.targetId),s=i&&null!=i.targetMismatches.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,a,s);return Ha(t,e.targetId,o.ba),o.snapshot}(t,e,n,i);const a=await pr(t.localStore,e,!0),s=new Sa(e,a.ds),o=s.ga(a.documents),c=Wn.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),l=s.applyChanges(o,t.isPrimaryClient,c);Ha(t,n,l.ba);const h=new Ca(e,n,s);return t.xa.set(e,h),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),l.snapshot}(t,e,a,"current"===s,r.resumeToken)),t.isPrimaryClient&&n&&Lr(t.remoteStore,r),o}async function Da(t,e,n){const i=P(t),r=i.xa.get(e),a=i.Oa.get(r.targetId);if(a.length>1)return i.Oa.set(r.targetId,a.filter((t=>!Le(t,e)))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await dr(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Fr(i.remoteStore,r.targetId),za(i,r.targetId)})).catch(st)):(za(i,r.targetId),await dr(i.localStore,r.targetId,!0))}async function Oa(t,e){const n=P(t),i=n.xa.get(e),r=n.Oa.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Fr(n.remoteStore,i.targetId))}async function Na(t,e){const n=P(t);try{const t=await function(t,e){const n=P(t),i=e.snapshotVersion;let r=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const a=n.hs.newChangeBuffer({trackRemovals:!0});r=n.us;const s=[];e.targetChanges.forEach(((a,o)=>{const c=r.get(o);if(!c)return;s.push(n.Gr.removeMatchingKeys(t,a.removedDocuments,o).next((()=>n.Gr.addMatchingKeys(t,a.addedDocuments,o))));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(o)?l=l.withResumeToken(Et.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):a.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(a.resumeToken,i)),r=r.insert(o,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,a)&&s.push(n.Gr.updateTargetData(t,l))}));let o=He(),c=Ze();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),s.push(function(t,e,n){let i=Ze(),r=Ze();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=He();return n.forEach(((n,a)=>{const s=t.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(r=r.add(n)),a.isNoDocument()&&a.version.isEqual(X.min())?(e.removeEntry(n,a.readTime),i=i.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a),i=i.insert(n,a)):S("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),{Is:i,Es:r}}))}(t,a,e.documentUpdates).next((t=>{o=t.Is,c=t.Es}))),!i.isEqual(X.min())){const e=n.Gr.getLastRemoteSnapshotVersion(t).next((e=>n.Gr.setTargetsMetadata(t,t.currentSequenceNumber,i)));s.push(e)}return ot.waitFor(s).next((()=>a.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,o,c))).next((()=>o))})).then((t=>(n.us=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Ba.get(e);i&&(M(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.Fa=!0:t.modifiedDocuments.size>0?M(i.Fa):t.removedDocuments.size>0&&(M(i.Fa),i.Fa=!1))})),await Wa(n,t,e)}catch(t){await st(t)}}function La(t,e,n){const i=P(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.xa.forEach(((n,i)=>{const r=i.view.ea(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=P(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.J_)t.ea(e)&&(i=!0)})),i&&wa(n)}(i.eventManager,e),t.length&&i.Ma.R_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Fa(t,e,n){const i=P(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Ba.get(e),a=r&&r.key;if(a){let t=new vt(tt.comparator);t=t.insert(a,ee.newNoDocument(a,X.min()));const n=Ze().add(a),r=new Gn(X.min(),new Map,new vt(G),t,n);await Na(i,r),i.La=i.La.remove(a),i.Ba.delete(e),Ga(i)}else await dr(i.localStore,e,!1).then((()=>za(i,e,n))).catch(st)}async function Ua(t,e){const n=P(t),i=e.batch.batchId;try{const t=await function(t,e){const n=P(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.hs.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,a=r.keys();let s=ot.resolve();return a.forEach((t=>{s=s.next((()=>i.getEntry(e,t))).next((e=>{const a=n.docVersions.get(t);M(null!==a),e.version.compareTo(a)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),s.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Ze();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Va(n,i,null),Ba(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Wa(n,t)}catch(t){await st(t)}}async function ja(t,e,n){const i=P(t);try{const t=await function(t,e){const n=P(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(M(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Va(i,e,n),Ba(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Wa(i,t)}catch(n){await st(n)}}function Ba(t,e){(t.Qa.get(e)||[]).forEach((t=>{t.resolve()})),t.Qa.delete(e)}function Va(t,e,n){const i=P(t);let r=i.qa[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.qa[i.currentUser.toKey()]=r}}function za(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Oa.get(e))t.xa.delete(i),n&&t.Ma.Wa(i,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach((e=>{t.ka.containsKey(e)||qa(t,e)}))}function qa(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);null!==n&&(Fr(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),Ga(t))}function Ha(t,e,n){for(const i of n)i instanceof Ea?(t.ka.addReference(i.key,e),$a(t,i)):i instanceof Ta?(S("SyncEngine","Document no longer in limbo: "+i.key),t.ka.removeReference(i.key,e),t.ka.containsKey(i.key)||qa(t,i.key)):R()}function $a(t,e){const n=e.key,i=n.path.canonicalString();t.La.get(n)||t.Na.has(i)||(S("SyncEngine","New document in limbo: "+n),t.Na.add(i),Ga(t))}function Ga(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new tt(Q.fromString(e)),i=t.Ka.next();t.Ba.set(i,new ka(n)),t.La=t.La.insert(n,i),Lr(t.remoteStore,new Mi(De(Ie(n.path)),i,"TargetPurposeLimboResolution",lt.oe))}}async function Wa(t,e,n){const i=P(t),r=[],a=[],s=[];i.xa.isEmpty()||(i.xa.forEach(((t,o)=>{s.push(i.Ua(o,e,n).then((t=>{var e;if((t||n)&&i.isPrimaryClient){const r=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===e?void 0:e.current;i.sharedClientState.updateQueryState(o.targetId,r?"current":"not-current")}if(t){r.push(t);const e=sr.zi(o.targetId,t);a.push(e)}})))})),await Promise.all(s),i.Ma.R_(r),await async function(t,e){const n=P(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>ot.forEach(e,(e=>ot.forEach(e.Wi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>ot.forEach(e.Gi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!ct(t))throw t;S("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.us.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.us=n.us.insert(e,r)}}}(i.localStore,a))}async function Ka(t,e){const n=P(t);if(!n.currentUser.isEqual(e)){S("SyncEngine","User change. New user:",e.toKey());const t=await hr(n.localStore,e);n.currentUser=e,function(t){t.Qa.forEach((t=>{t.forEach((t=>{t.reject(new O(D.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Qa.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Wa(n,t.Ts)}}function Xa(t,e){const n=P(t),i=n.Ba.get(e);if(i&&i.Fa)return Ze().add(i.key);{let t=Ze();const i=n.Oa.get(e);if(!i)return t;for(const e of i){const i=n.xa.get(e);t=t.unionWith(i.view.fa)}return t}}function Ya(t){const e=P(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Na.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Xa.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Fa.bind(null,e),e.Ma.R_=ya.bind(null,e.eventManager),e.Ma.Wa=ba.bind(null,e.eventManager),e}function Qa(t){const e=P(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ua.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ja.bind(null,e),e}class Ja{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Sr(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),await this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)}Ja(t,e){return null}Ya(t,e){return null}Ha(t){return function(t,e,n,i){return new lr(t,e,n,i)}(this.persistence,new cr,t.initialUser,this.serializer)}ja(t){return new nr(rr.ei,this.serializer)}za(t){return new mr}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ja.provider={build:()=>new Ja};class Za extends Ja{constructor(t){super(),this.cacheSizeBytes=t}Ja(t,e){M(this.persistence.referenceDelegate instanceof ar);const n=this.persistence.referenceDelegate.garbageCollector;return new zi(n,t.asyncQueue,e)}ja(t){const e=void 0!==this.cacheSizeBytes?Ui.withCacheSize(this.cacheSizeBytes):Ui.DEFAULT;return new nr((t=>ar.ei(t,e)),this.serializer)}}class ts{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>La(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ka.bind(null,this.syncEngine),await async function(t,e){const n=P(t);e?(n.k_.delete(2),await Or(n)):e||(n.k_.add(2),await Nr(n),n.K_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new pa}createDatastore(t){const e=Sr(t.databaseInfo.databaseId),n=function(t){return new Er(t)}(t.databaseInfo);return function(t,e,n,i){return new Mr(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new Dr(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>La(this.syncEngine,t,0)),yr.p()?new yr:new vr)}createSyncEngine(t,e){return function(t,e,n,i,r,a,s){const o=new Ia(t,e,n,i,r,a);return s&&(o.$a=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=P(t);S("RemoteStore","RemoteStore shutting down."),e.k_.add(5),await Nr(e),e.Q_.shutdown(),e.K_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}ts.provider={build:()=>new ts};class es{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Xa(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Xa(this.observer.error,t):C("Uncaught Error in snapshot listener:",t.toString()))}eu(){this.muted=!0}Xa(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}class ns{constructor(t,e,n,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=A.UNAUTHENTICATED,this.clientId=$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async t=>{S("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(S("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new N;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=la(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function is(t,e){t.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await hr(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function rs(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){S("FirestoreClient","Using user provided OfflineComponentProvider");try{await is(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===D.FAILED_PRECONDITION||t.code===D.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;k("Error using user provided cache. Falling back to memory cache: "+n),await is(t,new Ja)}}else S("FirestoreClient","Using default OfflineComponentProvider"),await is(t,new Za(void 0));return t._offlineComponents}(t);S("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>aa(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>aa(e.remoteStore,n))),t._onlineComponents=e}async function as(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(S("FirestoreClient","Using user provided OnlineComponentProvider"),await rs(t,t._uninitializedComponentsProvider._online)):(S("FirestoreClient","Using default OnlineComponentProvider"),await rs(t,new ts))),t._onlineComponents}async function ss(t){const e=await as(t),n=e.eventManager;return n.onListen=Ra.bind(null,e.syncEngine),n.onUnlisten=Da.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Ma.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Oa.bind(null,e.syncEngine),n}function os(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const cs=new Map;function ls(t,e,n){if(!n)throw new O(D.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function hs(t){if(!tt.isDocumentKey(t))throw new O(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function us(t){if(tt.isDocumentKey(t))throw new O(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fs(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":R()}function ds(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new O(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fs(t);throw new O(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ps{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new O(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new O(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new O(D.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=os(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new O(D.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new O(D.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new O(D.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class gs{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ps({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new O(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ps(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new F;switch(t.type){case"firstParty":return new V(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new O(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=cs.get(t);e&&(S("ComponentProvider","Removing Datastore"),cs.delete(t),e.terminate())}(this),Promise.resolve()}}class ms{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ms(this.firestore,t,this._query)}}class vs{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ys(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new vs(this.firestore,t,this._key)}}class ys extends ms{constructor(t,e,n){super(t,e,Ie(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new vs(this.firestore,null,new tt(t))}withConverter(t){return new ys(this.firestore,t,this._path)}}function bs(t,e,...n){if(t=(0,c.Ku)(t),ls("collection","path",e),t instanceof gs){const i=Q.fromString(e,...n);return us(i),new ys(t,null,i)}{if(!(t instanceof vs||t instanceof ys))throw new O(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Q.fromString(e,...n));return us(i),new ys(t.firestore,null,i)}}function ws(t,e,...n){if(t=(0,c.Ku)(t),1===arguments.length&&(e=$.newId()),ls("doc","path",e),t instanceof gs){const i=Q.fromString(e,...n);return hs(i),new vs(t,null,new tt(i))}{if(!(t instanceof vs||t instanceof ys))throw new O(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Q.fromString(e,...n));return hs(i),new vs(t.firestore,t instanceof ys?t.converter:null,new tt(i))}}class _s{constructor(t=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new Cr(this,"async_queue_retry"),this.fu=()=>{const t=Tr();t&&S("AsyncQueue","Visibility state changed to "+t.visibilityState),this.r_.Jo()},this.gu=t;const e=Tr();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.pu(),this.yu(t)}enterRestrictedMode(t){if(!this.Eu){this.Eu=!0,this.Vu=t||!1;const e=Tr();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.fu)}}enqueue(t){if(this.pu(),this.Eu)return new Promise((()=>{}));const e=new N;return this.yu((()=>this.Eu&&this.Vu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Iu.push(t),this.wu())))}async wu(){if(0!==this.Iu.length){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(t){if(!ct(t))throw t;S("AsyncQueue","Operation failed with retryable error: "+t)}this.Iu.length>0&&this.r_.jo((()=>this.wu()))}}yu(t){const e=this.gu.then((()=>(this.Ru=!0,t().catch((t=>{this.Au=t,this.Ru=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw C("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Ru=!1,t))))));return this.gu=e,e}enqueueAfterDelay(t,e,n){this.pu(),this.mu.indexOf(t)>-1&&(e=0);const i=ca.createAndSchedule(this,t,e,n,(t=>this.Su(t)));return this.du.push(i),i}pu(){this.Au&&R()}verifyOperationInProgress(){}async bu(){let t;do{t=this.gu,await t}while(t!==this.gu)}Du(t){for(const e of this.du)if(e.timerId===t)return!0;return!1}vu(t){return this.bu().then((()=>{this.du.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.du)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.bu()}))}Cu(t){this.mu.push(t)}Su(t){const e=this.du.indexOf(t);this.du.splice(e,1)}}function As(t){return function(t){if("object"!=typeof t||null===t)return!1;const e=t;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(t)}class xs extends gs{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new _s,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new _s(t),this._firestoreClient=void 0,await t}}}function Es(t,e){const n="object"==typeof t?t:(0,a.Sx)(),i="string"==typeof t?t:e||"(default)",r=(0,a.j6)(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const t=(0,c.yU)("firestore");t&&function(t,e,n,i={}){var r;const a=(t=ds(t,gs))._getSettings(),s=`${e}:${n}`;if("firestore.googleapis.com"!==a.host&&a.host!==s&&k("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:s,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=A.MOCK_USER;else{e=(0,c.Fy)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new O(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new A(a)}t._authCredentials=new U(new L(e,n))}}(r,...t)}return r}function Ts(t){if(t._terminated)throw new O(D.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||function(t){var e,n,i;const r=t._freezeSettings(),a=function(t,e,n,i){return new Pt(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,os(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new ns(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}(t),t._firestoreClient}class Ss{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ss(Et.fromBase64String(t))}catch(t){throw new O(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ss(Et.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Cs{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new O(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Z(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class ks{constructor(t){this._methodName=t}}class Is{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new O(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new O(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return G(this._lat,t._lat)||G(this._long,t._long)}}class Rs{constructor(t){this._values=(t||[]).map((t=>t))}toArray(){return this._values.map((t=>t))}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}}const Ms=/^__.*__$/;class Ps{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new kn(t,this.data,this.fieldMask,e,this.fieldTransforms):new Cn(t,this.data,e,this.fieldTransforms)}}class Ds{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new kn(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Os(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw R()}}class Ns{constructor(t,e,n,i,r,a){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Fu(),this.fieldTransforms=r||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(t){return new Ns(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.xu({path:n,Nu:!1});return i.Lu(t),i}Bu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.xu({path:n,Nu:!1});return i.Fu(),i}ku(t){return this.xu({path:void 0,Nu:!0})}qu(t){return Zs(t,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Fu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Lu(this.path.get(t))}Lu(t){if(0===t.length)throw this.qu("Document fields must not be empty");if(Os(this.Mu)&&Ms.test(t))throw this.qu('Document fields cannot begin and end with "__"')}}class Ls{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Sr(t)}$u(t,e,n,i=!1){return new Ns({Mu:t,methodName:e,Ku:n,path:Z.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fs(t){const e=t._freezeSettings(),n=Sr(t._databaseId);return new Ls(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Us(t,e,n,i,r,a={}){const s=t.$u(a.merge||a.mergeFields?2:0,e,n,r);Xs("Data must be an object, but it was:",s,i);const o=Ws(i,s);let c,l;if(a.merge)c=new At(s.fieldMask),l=s.fieldTransforms;else if(a.mergeFields){const t=[];for(const i of a.mergeFields){const r=Ys(e,i,n);if(!s.contains(r))throw new O(D.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);to(t,r)||t.push(r)}c=new At(t),l=s.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=s.fieldTransforms;return new Ps(new Zt(o),c,l)}class js extends ks{_toFieldTransform(t){if(2!==t.Mu)throw 1===t.Mu?t.qu(`${this._methodName}() can only appear at the top level of your update data`):t.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof js}}class Bs extends ks{_toFieldTransform(t){return new vn(t.path,new ln)}isEqual(t){return t instanceof Bs}}class Vs extends ks{constructor(t,e){super(t),this.Uu=e}_toFieldTransform(t){const e=function(t,e,n){return new Ns({Mu:3,Ku:e.settings.Ku,methodName:t._methodName,Nu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}(this,t,!0),n=this.Uu.map((t=>Gs(t,e))),i=new hn(n);return new vn(t.path,i)}isEqual(t){return t instanceof Vs&&(0,c.bD)(this.Uu,t.Uu)}}class zs extends ks{constructor(t,e){super(t),this.Wu=e}_toFieldTransform(t){const e=new pn(t.serializer,rn(t.serializer,this.Wu));return new vn(t.path,e)}isEqual(t){return t instanceof zs&&this.Wu===t.Wu}}function qs(t,e,n,i){const r=t.$u(1,e,n);Xs("Data must be an object, but it was:",r,i);const a=[],s=Zt.empty();gt(i,((t,i)=>{const o=Js(e,t,n);i=(0,c.Ku)(i);const l=r.Bu(o);if(i instanceof js)a.push(o);else{const t=Gs(i,l);null!=t&&(a.push(o),s.set(o,t))}}));const o=new At(a);return new Ds(s,o,r.fieldTransforms)}function Hs(t,e,n,i,r,a){const s=t.$u(1,e,n),o=[Ys(e,i,n)],l=[r];if(a.length%2!=0)throw new O(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<a.length;t+=2)o.push(Ys(e,a[t])),l.push(a[t+1]);const h=[],u=Zt.empty();for(let t=o.length-1;t>=0;--t)if(!to(h,o[t])){const e=o[t];let n=l[t];n=(0,c.Ku)(n);const i=s.Bu(e);if(n instanceof js)h.push(e);else{const t=Gs(n,i);null!=t&&(h.push(e),u.set(e,t))}}const f=new At(h);return new Ds(u,f,s.fieldTransforms)}function $s(t,e,n,i=!1){return Gs(n,t.$u(i?4:3,e))}function Gs(t,e){if(Ks(t=(0,c.Ku)(t)))return Xs("Unsupported field value:",e,t),Ws(t,e);if(t instanceof ks)return function(t,e){if(!Os(e.Mu))throw e.qu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.qu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&4!==e.Mu)throw e.qu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Gs(r,e.ku(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,c.Ku)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return rn(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=K.fromDate(t);return{timestampValue:si(e.serializer,n)}}if(t instanceof K){const n=new K(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:si(e.serializer,n)}}if(t instanceof Is)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ss)return{bytesValue:oi(e.serializer,t._byteString)};if(t instanceof vs){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.qu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:hi(t.firestore._databaseId||e.databaseId,t._key.path)}}if(t instanceof Rs)return function(t,e){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:t.toArray().map((t=>{if("number"!=typeof t)throw e.qu("VectorValues must only contain numeric values.");return en(e.serializer,t)}))}}}}}}(t,e);throw e.qu(`Unsupported field value: ${fs(t)}`)}(t,e)}function Ws(t,e){const n={};return mt(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gt(t,((t,i)=>{const r=Gs(i,e.Ou(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Ks(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof K||t instanceof Is||t instanceof Ss||t instanceof vs||t instanceof ks||t instanceof Rs)}function Xs(t,e,n){if(!Ks(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=fs(n);throw"an object"===i?e.qu(t+" a custom object"):e.qu(t+" "+i)}}function Ys(t,e,n){if((e=(0,c.Ku)(e))instanceof Cs)return e._internalPath;if("string"==typeof e)return Js(t,e);throw Zs("Field path arguments must be of type string or ",t,!1,void 0,n)}const Qs=new RegExp("[~\\*/\\[\\]]");function Js(t,e,n){if(e.search(Qs)>=0)throw Zs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Cs(...e.split("."))._internalPath}catch(i){throw Zs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zs(t,e,n,i,r){const a=i&&!i.isEmpty(),s=void 0!==r;let o=`Function ${e}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(a||s)&&(c+=" (found",a&&(c+=` in field ${i}`),s&&(c+=` in document ${r}`),c+=")"),new O(D.INVALID_ARGUMENT,o+t+c)}function to(t,e){return t.some((t=>t.isEqual(e)))}class eo{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new vs(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new no(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(io("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class no extends eo{data(){return super.data()}}function io(t,e){return"string"==typeof e?Js(t,e):e instanceof Cs?e._internalPath:e._delegate._internalPath}function ro(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new O(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ao{}class so extends ao{}function oo(t,e,...n){let i=[];e instanceof ao&&i.push(e),i=i.concat(n),function(t){const e=t.filter((t=>t instanceof ho)).length,n=t.filter((t=>t instanceof co)).length;if(e>1||e>0&&n>0)throw new O(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const e of i)t=e._apply(t);return t}class co extends so{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new co(t,e,n)}_apply(t){const e=this._parse(t);return wo(t._query,e),new ms(t.firestore,t.converter,Oe(t._query,e))}_parse(t){const e=Fs(t.firestore),n=function(t,e,n,i,r,a,s){let o;if(r.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new O(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){bo(s,a);const e=[];for(const n of s)e.push(yo(i,t,n));o={arrayValue:{values:e}}}else o=yo(i,t,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||bo(s,a),o=$s(n,"where",s,"in"===a||"not-in"===a);return ce.create(r,a,o)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return n}}function lo(t,e,n){const i=e,r=io("where",t);return co._create(r,i,n)}class ho extends ao{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new ho(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:le.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const t of i)wo(n,t),n=Oe(n,t)}(t._query,e),new ms(t.firestore,t.converter,Oe(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class uo extends so{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new uo(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new O(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new O(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ae(e,n)}(t._query,this._field,this._direction);return new ms(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new ke(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function fo(t,e="asc"){const n=e,i=io("orderBy",t);return uo._create(i,n)}class po extends so{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new po(t,e,n)}_apply(t){return new ms(t.firestore,t.converter,Ne(t._query,this._limit,this._limitType))}}function go(t){return function(t,e){if(e<=0)throw new O(D.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}("limit",t),po._create("limit",t,"F")}class mo extends so{constructor(t,e,n){super(),this.type=t,this._docOrFields=e,this._inclusive=n}static _create(t,e,n){return new mo(t,e,n)}_apply(t){const e=function(t,e,n,i){if(n[0]=(0,c.Ku)(n[0]),n[0]instanceof eo)return function(t,e,n,i,r){if(!i)throw new O(D.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const a=[];for(const n of Pe(t))if(n.field.isKeyField())a.push(Ht(e,i.key));else{const t=i.data.field(n.field);if(It(t))throw new O(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.canonicalString();throw new O(D.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}a.push(t)}return new ne(a,r)}(t._query,t.firestore._databaseId,e,n[0]._document,i);{const r=Fs(t.firestore);return function(t,e,n,i,r,a){const s=t.explicitOrderBy;if(r.length>s.length)throw new O(D.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const o=[];for(let a=0;a<r.length;a++){const c=r[a];if(s[a].field.isKeyField()){if("string"!=typeof c)throw new O(D.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof c}`);if(!Me(t)&&-1!==c.indexOf("/"))throw new O(D.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${c}' contains a slash.`);const n=t.path.child(Q.fromString(c));if(!tt.isDocumentKey(n))throw new O(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new tt(n);o.push(Ht(e,r))}else{const t=$s(n,i,c);o.push(t)}}return new ne(o,a)}(t._query,t.firestore._databaseId,r,e,n,i)}}(t,this.type,this._docOrFields,this._inclusive);return new ms(t.firestore,t.converter,function(t,e){return new ke(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))}}function vo(...t){return mo._create("startAfter",t,!1)}function yo(t,e,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new O(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Me(e)&&-1!==n.indexOf("/"))throw new O(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Q.fromString(n));if(!tt.isDocumentKey(i))throw new O(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ht(t,new tt(i))}if(n instanceof vs)return Ht(t,n._key);throw new O(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fs(n)}.`)}function bo(t,e){if(!Array.isArray(t)||0===t.length)throw new O(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wo(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new O(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new O(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class _o{convertValue(t,e="none"){switch(Nt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(kt(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw R()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return gt(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertVectorValue(t){var e,n,i;const r=null===(i=null===(n=null===(e=t.fields)||void 0===e?void 0:e.value.arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map((t=>Ct(t.doubleValue)));return new Rs(r)}convertGeoPoint(t){return new Is(Ct(t.latitude),Ct(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Rt(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Mt(t));default:return null}}convertTimestamp(t){const e=St(t);return new K(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Q.fromString(t);M(Ri(n));const i=new Dt(n.get(1),n.get(3)),r=new tt(n.popFirst(5));return i.isEqual(e)||C(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function Ao(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class xo{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Eo extends eo{constructor(t,e,n,i,r,a){super(t,e,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new To(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(io("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class To extends Eo{data(t={}){return super.data(t)}}class So{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new xo(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new To(this._firestore,this._userDataWriter,n.key,n,new xo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new O(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new To(t._firestore,t._userDataWriter,n.doc.key,n.doc,new xo(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new To(t._firestore,t._userDataWriter,e.doc.key,e.doc,new xo(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,a=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),a=n.indexOf(e.doc.key)),{type:Co(e.type),doc:i,oldIndex:r,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Co(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return R()}}function ko(t){t=ds(t,vs);const e=ds(t.firestore,xs);return function(t,e,n={}){const i=new N;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const a=new es({next:o=>{a.eu(),e.enqueueAndForget((()=>va(t,s)));const c=o.docs.has(n);!c&&o.fromCache?r.reject(new O(D.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&o.fromCache&&i&&"server"===i.source?r.reject(new O(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(o)},error:t=>r.reject(t)}),s=new xa(Ie(n.path),a,{includeMetadataChanges:!0,ua:!0});return ma(t,s)}(await ss(t),t.asyncQueue,e,n,i))),i.promise}(Ts(e),t._key).then((n=>Fo(e,t,n)))}class Io extends _o{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ss(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new vs(this.firestore,null,e)}}function Ro(t){t=ds(t,ms);const e=ds(t.firestore,xs),n=Ts(e),i=new Io(e);return ro(t._query),function(t,e,n={}){const i=new N;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const a=new es({next:n=>{a.eu(),e.enqueueAndForget((()=>va(t,s))),n.fromCache&&"server"===i.source?r.reject(new O(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),s=new xa(n,a,{includeMetadataChanges:!0,ua:!0});return ma(t,s)}(await ss(t),t.asyncQueue,e,n,i))),i.promise}(n,t._query).then((n=>new So(e,i,t,n)))}function Mo(t,e,n){t=ds(t,vs);const i=ds(t.firestore,xs),r=Ao(t.converter,e,n);return Lo(i,[Us(Fs(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,bn.none())])}function Po(t,e,n,...i){t=ds(t,vs);const r=ds(t.firestore,xs),a=Fs(r);let s;return s="string"==typeof(e=(0,c.Ku)(e))||e instanceof Cs?Hs(a,"updateDoc",t._key,e,n,i):qs(a,"updateDoc",t._key,e),Lo(r,[s.toMutation(t._key,bn.exists(!0))])}function Do(t){return Lo(ds(t.firestore,xs),[new Pn(t._key,bn.none())])}function Oo(t,e){const n=ds(t.firestore,xs),i=ws(t),r=Ao(t.converter,e);return Lo(n,[Us(Fs(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,bn.exists(!1))]).then((()=>i))}function No(t,...e){var n,i,r;t=(0,c.Ku)(t);let a={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof e[s]||As(e[s])||(a=e[s],s++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(As(e[s])){const t=e[s];e[s]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[s+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[s+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let l,h,u;if(t instanceof vs)h=ds(t.firestore,xs),u=Ie(t._key.path),l={next:n=>{e[s]&&e[s](Fo(h,t,n))},error:e[s+1],complete:e[s+2]};else{const n=ds(t,ms);h=ds(n.firestore,xs),u=n._query;const i=new Io(h);l={next:t=>{e[s]&&e[s](new So(h,i,n,t))},error:e[s+1],complete:e[s+2]},ro(t._query)}return function(t,e,n,i){const r=new es(i),a=new xa(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>ma(await ss(t),a))),()=>{r.eu(),t.asyncQueue.enqueueAndForget((async()=>va(await ss(t),a)))}}(Ts(h),u,o,l)}function Lo(t,e){return function(t,e){const n=new N;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Qa(t);try{const t=await function(t,e){const n=P(t),i=K.now(),r=e.reduce(((t,e)=>t.add(e.key)),Ze());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let o=He(),c=Ze();return n.hs.getEntries(t,r).next((t=>{o=t,o.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,o))).next((r=>{a=r;const s=[];for(const t of e){const e=Tn(t,a.get(t.key).overlayedDocument);null!=e&&s.push(new kn(t.key,e,te(e.value.mapValue),bn.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,s,e)})).next((e=>{s=e;const i=e.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:s.batchId,changes:We(a)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.qa[t.currentUser.toKey()];i||(i=new vt(G)),i=i.insert(e,n),t.qa[t.currentUser.toKey()]=i}(i,t.batchId,n),await Wa(i,t.changes),await Yr(i.remoteStore)}catch(t){const e=la(t,"Failed to persist write");n.reject(e)}}(await function(t){return as(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Ts(t),e)}function Fo(t,e,n){const i=n.docs.get(e._key),r=new Io(t);return new Eo(t,r,e._key,i,new xo(n.hasPendingWrites,n.fromCache),e.converter)}class Uo{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Fs(t)}set(t,e,n){this._verifyNotCommitted();const i=jo(t,this._firestore),r=Ao(i.converter,e,n),a=Us(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(a.toMutation(i._key,bn.none())),this}update(t,e,n,...i){this._verifyNotCommitted();const r=jo(t,this._firestore);let a;return a="string"==typeof(e=(0,c.Ku)(e))||e instanceof Cs?Hs(this._dataReader,"WriteBatch.update",r._key,e,n,i):qs(this._dataReader,"WriteBatch.update",r._key,e),this._mutations.push(a.toMutation(r._key,bn.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=jo(t,this._firestore);return this._mutations=this._mutations.concat(new Pn(e._key,bn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function jo(t,e){if((t=(0,c.Ku)(t)).firestore!==e)throw new O(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Bo(){return new Bs("serverTimestamp")}function Vo(...t){return new Vs("arrayUnion",t)}function zo(t){return new zs("increment",t)}function qo(t){return Ts(t=ds(t,xs)),new Uo(t,(e=>Lo(t,e)))}new WeakMap,function(t,e=!0){!function(t){x=t}(a.MF),(0,a.om)(new s.uA("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),a=new xs(new j(t.getProvider("auth-internal")),new q(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new O(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dt(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),(0,a.KO)(_,"4.7.5",t),(0,a.KO)(_,"4.7.5","esm2017")}()},4920:(t,e,n)=>{"use strict";n.d(e,{c7:()=>E});var i=n(1990),r=n(6743),a=n(5125);const s="firebasestorage.googleapis.com";class o extends r.g{constructor(t,e,n=0){super(h(t),`Firebase Storage: ${e} (${h(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,o.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return h(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var c,l;function h(t){return"storage/"+t}function u(t){return new o(c.INVALID_ARGUMENT,t)}function f(){return new o(c.APP_DELETED,"The Firebase app was deleted.")}!function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(c||(c={}));class d{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=d.makeFromUrl(t,e)}catch(e){return new d(t,"")}if(""===n.path)return n;throw i=t,new o(c.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}const l=e.replace(/[.]/g,"\\."),h=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${l}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp(`^https?://${e===s?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:a}];for(let e=0;e<h.length;e++){const i=h[e],r=i.regex.exec(t);if(r){const t=r[i.indices.bucket];let e=r[i.indices.path];e||(e=""),n=new d(t,e),i.postModify(n);break}}if(null==n)throw function(t){return new o(c.INVALID_URL,"Invalid URL '"+t+"'.")}(t);return n}}class p{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function g(t,e,n,i){if(i<e)throw u(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw u(`Invalid value for '${t}'. Expected ${n} or less.`)}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(l||(l={}));class m{constructor(t,e,n,i,r,a,s,o,c,l,h,u=!0){this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=a,this.callback_=s,this.errorCallback_=o,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=h,this.retry=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=(t,e)=>{const n=this.resolve_,i=this.reject_,r=e.connection;if(e.wasSuccessCode)try{const t=this.callback_(r,r.getResponse());void 0!==t?n(t):n()}catch(t){i(t)}else if(null!==r){const t=new o(c.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");t.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,t)):i(t)}else e.canceled?i(this.appDelete_?f():new o(c.CANCELED,"User canceled the upload/download.")):i(new o(c.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new v(!1,null,!0)):this.backoffId_=function(t,e,n){let i=1,r=null,a=null,s=!1,o=0;function c(){return 2===o}let l=!1;function h(...t){l||(l=!0,e.apply(null,t))}function u(e){r=setTimeout((()=>{r=null,t(d,c())}),e)}function f(){a&&clearTimeout(a)}function d(t,...e){if(l)return void f();if(t)return f(),void h.call(null,t,...e);if(c()||s)return f(),void h.call(null,t,...e);let n;i<64&&(i*=2),1===o?(o=2,n=0):n=1e3*(i+Math.random()),u(n)}let p=!1;function g(t){p||(p=!0,f(),l||(null!==r?(t||(o=2),clearTimeout(r),u(0)):t||(o=1)))}return u(0),a=setTimeout((()=>{s=!0,g(!0)}),n),g}(((t,e)=>{if(e)return void t(!1,new v(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=t=>{const e=t.loaded,n=t.lengthComputable?t.total:-1;null!==this.progressCallback_&&this.progressCallback_(e,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const e=n.getErrorCode()===l.NO_ERROR,r=n.getStatus();if(!e||function(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),r=-1!==e.indexOf(t);return n||i||r}(r,this.additionalRetryCodes_)&&this.retry){const e=n.getErrorCode()===l.ABORT;return void t(!1,new v(!1,null,e))}const a=-1!==this.successCodes_.indexOf(r);t(!0,new v(a,n))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class v{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}class y{constructor(t,e){this._service=t,this._location=e instanceof d?e:d.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new y(t,e)}get root(){const t=new d(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new d(this._location.bucket,t);return new y(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new o(c.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}function b(t,e){const n=null==e?void 0:e.storageBucket;return null==n?null:d.makeFromBucketSpec(n,t)}class w{constructor(t,e,n,i,r){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=s,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?d.makeFromBucketSpec(i,this._host):b(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=d.makeFromBucketSpec(this._url,t):this._bucket=b(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){g("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){g("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new y(this,t)}_makeRequest(t,e,n,i,r=!0){if(this._deleted)return new p(f());{const a=function(t,e,n,i,r,a,s=!0){const o=function(t){const e=encodeURIComponent;let n="?";for(const i in t)t.hasOwnProperty(i)&&(n=n+(e(i)+"=")+e(t[i])+"&");return n=n.slice(0,-1),n}(t.urlParams),c=t.url+o,l=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(l,a),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,i),new m(c,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,s)}(t,this._appId,n,i,e,this._firebaseVersion,r);return this._requests.add(a),a.getPromise().then((()=>this._requests.delete(a)),(()=>this._requests.delete(a))),a}}async makeRequestWithTokens(t,e){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,i).getPromise()}}const _="@firebase/storage",A="0.13.4",x="storage";function E(t=(0,i.Sx)(),e){t=(0,r.Ku)(t);const n=(0,i.j6)(t,x).getImmediate({identifier:e}),a=(0,r.yU)("storage");return a&&function(t,e,n,i={}){!function(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:a}=i;a&&(t._overrideAuthToken="string"==typeof a?a:(0,r.Fy)(a,t.app.options.projectId))}(t,e,n,i)}(n,...a),n}(0,i.om)(new a.uA(x,(function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new w(n,r,a,e,i.MF)}),"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(_,A,""),(0,i.KO)(_,A,"esm2017")},1100:(t,e,n)=>{"use strict";n.d(e,{EA:()=>pi,YE:()=>gi});var i={d:(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},r=globalThis.pdfjsLib={};i.d(r,{AbortException:()=>D,AnnotationEditorLayer:()=>fi,AnnotationEditorParamsType:()=>u,AnnotationEditorType:()=>h,AnnotationEditorUIManager:()=>yt,AnnotationLayer:()=>Wn,AnnotationMode:()=>l,ColorPicker:()=>ii,DOMSVGFactory:()=>gn,DrawLayer:()=>di,FeatureTest:()=>F,GlobalWorkerOptions:()=>pe,ImageKind:()=>d,InvalidPDFException:()=>I,MissingPDFException:()=>R,OPS:()=>g,OutputScale:()=>lt,PDFDataRangeTransport:()=>Je,PDFDateString:()=>it,PDFWorker:()=>nn,PasswordResponses:()=>m,PermissionFlag:()=>f,PixelsPerInch:()=>$,RenderingCancelledException:()=>K,TextLayer:()=>ze,TouchManager:()=>wt,UnexpectedResponseException:()=>M,Util:()=>j,VerbosityLevel:()=>p,XfaLayer:()=>mn,build:()=>hn,createValidAbsoluteUrl:()=>E,fetchData:()=>G,getDocument:()=>Xe,getFilenameFromUrl:()=>Q,getPdfFilenameFromUrl:()=>J,getXfaPageViewport:()=>rt,isDataScheme:()=>X,isPdfFile:()=>Y,noContextMenu:()=>et,normalizeUnicode:()=>z,setLayerDimensions:()=>ct,shadow:()=>T,stopEvent:()=>nt,version:()=>ln});const a=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),s=[1,0,0,1,0,0],o=[.001,0,0,.001,0,0],c=1.35,l={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},h={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},u={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},f={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},d={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},p={ERRORS:0,WARNINGS:1,INFOS:5},g={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},m={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let v=p.WARNINGS;function y(t){Number.isInteger(t)&&(v=t)}function b(){return v}function w(t){v>=p.INFOS&&console.log(`Info: ${t}`)}function _(t){v>=p.WARNINGS&&console.log(`Warning: ${t}`)}function A(t){throw new Error(t)}function x(t,e){t||A(e)}function E(t,e=null,n=null){if(!t)return null;try{if(n&&"string"==typeof t){if(n.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(n.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch{}}const i=e?new URL(t,e):new URL(t);if(function(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function T(t,e,n,i=!1){return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const S=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class C extends S{constructor(t,e){super(t,"PasswordException"),this.code=e}}class k extends S{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class I extends S{constructor(t){super(t,"InvalidPDFException")}}class R extends S{constructor(t){super(t,"MissingPDFException")}}class M extends S{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class P extends S{constructor(t){super(t,"FormatError")}}class D extends S{constructor(t){super(t,"AbortException")}}function O(t){"object"==typeof t&&void 0!==t?.length||A("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const i=[];for(let r=0;r<e;r+=n){const a=Math.min(r+n,e),s=t.subarray(r,a);i.push(String.fromCharCode.apply(null,s))}return i.join("")}function N(t){"string"!=typeof t&&A("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}function L(t){const e=Object.create(null);for(const[n,i]of t)e[n]=i;return e}class F{static get isLittleEndian(){return T(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return T(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return T(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get isImageDecoderSupported(){return T(this,"isImageDecoderSupported","undefined"!=typeof ImageDecoder)}static get platform(){return"undefined"!=typeof navigator&&"string"==typeof navigator?.platform?T(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:"string"==typeof navigator?.userAgent&&navigator.userAgent.includes("Firefox")}):T(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return T(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const U=Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0")));class j{static makeHexColor(t,e,n){return`#${U[t]}${U[e]}${U[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],r[0],a[0]),Math.min(n[1],i[1],r[1],a[1]),Math.max(n[0],i[0],r[0],a[0]),Math.max(n[1],i[1],r[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],s=(n+a)/2,o=Math.sqrt((n+a)**2-4*(n*a-r*i))/2,c=s+o||1,l=s-o||1;return[Math.sqrt(c),Math.sqrt(l)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[n,r,i,a]}static#t(t,e,n,i,r,a,s,o,c,l){if(c<=0||c>=1)return;const h=1-c,u=c*c,f=u*c,d=h*(h*(h*t+3*c*e)+3*u*n)+f*i,p=h*(h*(h*r+3*c*a)+3*u*s)+f*o;l[0]=Math.min(l[0],d),l[1]=Math.min(l[1],p),l[2]=Math.max(l[2],d),l[3]=Math.max(l[3],p)}static#e(t,e,n,i,r,a,s,o,c,l,h,u){if(Math.abs(c)<1e-12)return void(Math.abs(l)>=1e-12&&this.#t(t,e,n,i,r,a,s,o,-h/l,u));const f=l**2-4*h*c;if(f<0)return;const d=Math.sqrt(f),p=2*c;this.#t(t,e,n,i,r,a,s,o,(-l+d)/p,u),this.#t(t,e,n,i,r,a,s,o,(-l-d)/p,u)}static bezierBoundingBox(t,e,n,i,r,a,s,o,c){return c?(c[0]=Math.min(c[0],t,s),c[1]=Math.min(c[1],e,o),c[2]=Math.max(c[2],t,s),c[3]=Math.max(c[3],e,o)):c=[Math.min(t,s),Math.min(e,o),Math.max(t,s),Math.max(e,o)],this.#e(t,n,r,s,e,i,a,o,3*(3*(n-r)-t+s),6*(t-2*n+r),3*(n-t),c),this.#e(t,n,r,s,e,i,a,o,3*(3*(i-a)-e+o),6*(e-2*i+a),3*(i-e),c),c}}let B=null,V=null;function z(t){return B||(B=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,V=new Map([["","t"]])),t.replaceAll(B,((t,e,n)=>e?e.normalize("NFKC"):V.get(n)))}const q="pdfjs_internal_id_";"function"!=typeof Promise.try&&(Promise.try=function(t,...e){return new Promise((n=>{n(t(...e))}))});const H="http://www.w3.org/2000/svg";class ${static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function G(t,e="text"){if(tt(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise(((n,i)=>{const r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE)if(200!==r.status&&0!==r.status)i(new Error(r.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void n(r.response)}n(r.responseText)}},r.send(null)}))}class W{constructor({viewBox:t,userUnit:e,scale:n,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:s=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=i,this.offsetX=r,this.offsetY=a,n*=e;const o=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let l,h,u,f,d,p,g,m;switch((i%=360)<0&&(i+=360),i){case 180:l=-1,h=0,u=0,f=1;break;case 90:l=0,h=1,u=1,f=0;break;case 270:l=0,h=-1,u=-1,f=0;break;case 0:l=1,h=0,u=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(u=-u,f=-f),0===l?(d=Math.abs(c-t[1])*n+r,p=Math.abs(o-t[0])*n+a,g=(t[3]-t[1])*n,m=(t[2]-t[0])*n):(d=Math.abs(o-t[0])*n+r,p=Math.abs(c-t[1])*n+a,g=(t[2]-t[0])*n,m=(t[3]-t[1])*n),this.transform=[l*n,h*n,u*n,f*n,d-l*n*o-u*n*c,p-h*n*o-f*n*c],this.width=g,this.height=m}get rawDims(){const{userUnit:t,viewBox:e}=this,n=e.map((e=>e*t));return T(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new W({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(t,e){return j.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=j.applyTransform([t[0],t[1]],this.transform),n=j.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return j.applyInverseTransform([t,e],this.transform)}}class K extends S{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function X(t){const e=t.length;let n=0;for(;n<e&&""===t[n].trim();)n++;return"data:"===t.substring(n,n+5).toLowerCase()}function Y(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function Q(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function J(t,e="document.pdf"){if("string"!=typeof t)return e;if(X(t))return _('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let r=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=n.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Z{started=Object.create(null);times=[];time(t){t in this.started&&_(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||_(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:t}of this.times)e=Math.max(t.length,e);for(const{name:n,start:i,end:r}of this.times)t.push(`${n.padEnd(e)} ${r-i}ms\n`);return t.join("")}}function tt(t,e){try{const{protocol:n}=e?new URL(t,e):new URL(t);return"http:"===n||"https:"===n}catch{return!1}}function et(t){t.preventDefault()}function nt(t){t.preventDefault(),t.stopPropagation()}class it{static#n;static toDateObject(t){if(!t||"string"!=typeof t)return null;this.#n||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#n.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let s=parseInt(e[5],10);s=s>=0&&s<=59?s:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const c=e[7]||"Z";let l=parseInt(e[8],10);l=l>=0&&l<=23?l:0;let h=parseInt(e[9],10)||0;return h=h>=0&&h<=59?h:0,"-"===c?(a+=l,s+=h):"+"===c&&(a-=l,s-=h),new Date(Date.UTC(n,i,r,a,s,o))}}function rt(t,{scale:e=1,rotation:n=0}){const{width:i,height:r}=t.attributes.style,a=[0,0,parseInt(i),parseInt(r)];return new W({viewBox:a,userUnit:1,scale:e,rotation:n})}function at(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((t=>parseInt(t))):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3):(_(`Not a valid color format: "${t}"`),[0,0,0])}function st(t){const{a:e,b:n,c:i,d:r,e:a,f:s}=t.getTransform();return[e,n,i,r,a,s]}function ot(t){const{a:e,b:n,c:i,d:r,e:a,f:s}=t.getTransform().invertSelf();return[e,n,i,r,a,s]}function ct(t,e,n=!1,i=!0){if(e instanceof W){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=t,s=F.isCSSRoundSupported,o=`var(--scale-factor) * ${i}px`,c=`var(--scale-factor) * ${r}px`,l=s?`round(down, ${o}, var(--scale-round-x, 1px))`:`calc(${o})`,h=s?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;n&&e.rotation%180!=0?(a.width=h,a.height=l):(a.width=l,a.height=h)}i&&t.setAttribute("data-main-rotation",e.rotation)}class lt{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}}class ht{#i=null;#r=null;#a;#s=null;#o=null;static#c=null;constructor(t){this.#a=t,ht.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#i=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#a._uiManager._signal;t.addEventListener("contextmenu",et,{signal:e}),t.addEventListener("pointerdown",ht.#l,{signal:e});const n=this.#s=document.createElement("div");n.className="buttons",t.append(n);const i=this.#a.toolbarPosition;if(i){const{style:e}=t,n="ltr"===this.#a._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd=100*n+"%",e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),t}get div(){return this.#i}static#l(t){t.stopPropagation()}#u(t){this.#a._focusEventsAllowed=!1,nt(t)}#f(t){this.#a._focusEventsAllowed=!0,nt(t)}#d(t){const e=this.#a._uiManager._signal;t.addEventListener("focusin",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",et,{signal:e})}hide(){this.#i.classList.add("hidden"),this.#r?.hideDropdown()}show(){this.#i.classList.remove("hidden"),this.#o?.shown()}#h(){const{editorType:t,_uiManager:e}=this.#a,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",ht.#c[t]),this.#d(n),n.addEventListener("click",(t=>{e.delete()}),{signal:e._signal}),this.#s.append(n)}get#p(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#d(e),this.#s.prepend(e,this.#p),this.#o=t}addColorPicker(t){this.#r=t;const e=t.renderButton();this.#d(e),this.#s.prepend(e,this.#p)}remove(){this.#i.remove(),this.#r?.destroy(),this.#r=null}}class ut{#s=null;#i=null;#g;constructor(t){this.#g=t}#m(){const t=this.#i=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",et,{signal:this.#g._signal});const e=this.#s=document.createElement("div");return e.className="buttons",t.append(e),this.#v(),t}#y(t,e){let n=0,i=0;for(const r of t){const t=r.y+r.height;if(t<n)continue;const a=r.x+(e?r.width:0);t>n?(i=a,n=t):e?a>i&&(i=a):a<i&&(i=a)}return[e?1-i:i,n]}show(t,e,n){const[i,r]=this.#y(e,n),{style:a}=this.#i||=this.#m();t.append(this.#i),a.insetInlineEnd=100*i+"%",a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#i.remove()}#v(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#g._signal;t.addEventListener("contextmenu",et,{signal:n}),t.addEventListener("click",(()=>{this.#g.highlightSelection("floating_button")}),{signal:n}),this.#s.append(t)}}function ft(t,e,n){for(const i of n)e.addEventListener(i,t[i].bind(t))}class dt{#b=0;get id(){return"pdfjs_internal_editor_"+this.#b++}}class pt{#w=function(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);return crypto.getRandomValues(t),O(t)}();#b=0;#_=null;static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',T(this,"_isSVGFittingCanvas",e.decode().then((()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]))))}async#A(t,e){this.#_||=new Map;let n=this.#_.get(t);if(null===n)return null;if(n?.bitmap)return n.refCounter+=1,n;try{let t;if(n||={bitmap:null,id:`image_${this.#w}_${this.#b++}`,refCounter:0,isSvg:!1},"string"==typeof e?(n.url=e,t=await G(e,"blob")):e instanceof File?t=n.file=e:e instanceof Blob&&(t=e),"image/svg+xml"===t.type){const e=pt._isSVGFittingCanvas,i=new FileReader,r=new Image,a=new Promise(((t,a)=>{r.onload=()=>{n.bitmap=r,n.isSvg=!0,t()},i.onload=async()=>{const t=n.svgUrl=i.result;r.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},r.onerror=i.onerror=a}));i.readAsDataURL(t),await a}else n.bitmap=await createImageBitmap(t);n.refCounter=1}catch(t){_(t),n=null}return this.#_.set(t,n),n&&this.#_.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:i,type:r}=t;return this.#A(`${e}_${n}_${i}_${r}`,t)}async getFromUrl(t){return this.#A(t,t)}async getFromBlob(t,e){const n=await e;return this.#A(t,n)}async getFromId(t){this.#_||=new Map;const e=this.#_.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:t}=e;return delete e.blobPromise,this.getFromBlob(e.id,t)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#_||=new Map;let n=this.#_.get(t);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#w}_${this.#b++}`,refCounter:1,isSvg:!1},this.#_.set(t,n),this.#_.set(n.id,n),n}getSvgUrl(t){const e=this.#_.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#_||=new Map;const e=this.#_.get(t);if(!e)return;if(e.refCounter-=1,0!==e.refCounter)return;const{bitmap:n}=e;if(!e.url&&!e.file){const t=new OffscreenCanvas(n.width,n.height);t.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=t.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#w}_`)}}class gt{#x=[];#E=!1;#T;#S=-1;constructor(t=128){this.#T=t}add({cmd:t,undo:e,post:n,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:s=!1}){if(i&&t(),this.#E)return;const o={cmd:t,undo:e,post:n,type:r};if(-1===this.#S)return this.#x.length>0&&(this.#x.length=0),this.#S=0,void this.#x.push(o);if(a&&this.#x[this.#S].type===r)return s&&(o.undo=this.#x[this.#S].undo),void(this.#x[this.#S]=o);const c=this.#S+1;c===this.#T?this.#x.splice(0,1):(this.#S=c,c<this.#x.length&&this.#x.splice(c)),this.#x.push(o)}undo(){if(-1===this.#S)return;this.#E=!0;const{undo:t,post:e}=this.#x[this.#S];t(),e?.(),this.#E=!1,this.#S-=1}redo(){if(this.#S<this.#x.length-1){this.#S+=1,this.#E=!0;const{cmd:t,post:e}=this.#x[this.#S];t(),e?.(),this.#E=!1}}hasSomethingToUndo(){return-1!==this.#S}hasSomethingToRedo(){return this.#S<this.#x.length-1}cleanType(t){if(-1!==this.#S){for(let e=this.#S;e>=0;e--)if(this.#x[e].type!==t)return this.#x.splice(e+1,this.#S-e),void(this.#S=e);this.#x.length=0,this.#S=-1}}destroy(){this.#x=null}}class mt{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=F.platform;for(const[n,i,r={}]of t)for(const t of n){const n=t.startsWith("mac+");e&&n?(this.callbacks.set(t.slice(4),{callback:i,options:r}),this.allKeys.add(t.split("+").at(-1))):e||n||(this.callbacks.set(t,{callback:i,options:r}),this.allKeys.add(t.split("+").at(-1)))}}#C(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#C(e));if(!n)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:s=null}}=n;s&&!s(t,e)||(i.bind(t,...a,e)(),r||nt(e))}}class vt{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const n of t.keys()){e.style.color=n;const i=window.getComputedStyle(e).color;t.set(n,at(i))}e.remove()}(t),T(this,"_colors",t)}convert(t){const e=at(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[t,n]of this._colors)if(n.every(((t,n)=>t===e[n])))return vt._colorsMapping.get(t);return e}getHexCode(t){const e=this._colors.get(t);return e?j.makeHexColor(...e):t}}class yt{#k=new AbortController;#I=null;#R=new Map;#M=new Map;#P=null;#D=null;#O=null;#N=new gt;#L=null;#F=null;#U=0;#j=new Set;#B=null;#V=null;#z=new Set;_editorUndoBar=null;#q=!1;#H=!1;#$=!1;#G=null;#W=null;#K=null;#X=null;#Y=!1;#Q=null;#J=new dt;#Z=!1;#tt=!1;#et=null;#nt=null;#it=null;#rt=null;#at=h.NONE;#st=new Set;#ot=null;#ct=null;#lt=null;#ht={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#ut=[0,0];#ft=null;#dt=null;#pt=null;#gt=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=yt.prototype,e=t=>t.#dt.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),n=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return T(this,"_keyboardManager",new mt([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#dt.contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#dt.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,n,i,r,a,s,o,c,l,h,u,f){const d=this._signal=this.#k.signal;this.#dt=t,this.#pt=e,this.#P=n,this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:d}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:d}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:d}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:d}),i._on("setpreference",this.onSetPreference.bind(this),{signal:d}),i._on("switchannotationeditorparams",(t=>this.updateParams(t.type,t.value)),{signal:d}),this.#mt(),this.#vt(),this.#yt(),this.#D=r.annotationStorage,this.#G=r.filterFactory,this.#ct=a,this.#X=s||null,this.#q=o,this.#H=c,this.#$=l,this.#rt=h||null,this.viewParameters={realScale:$.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=u||null,this._supportsPinchToZoom=!1!==f}destroy(){this.#gt?.resolve(),this.#gt=null,this.#k?.abort(),this.#k=null,this._signal=null;for(const t of this.#M.values())t.destroy();this.#M.clear(),this.#R.clear(),this.#z.clear(),this.#I=null,this.#st.clear(),this.#N.destroy(),this.#P?.destroy(),this.#Q?.hide(),this.#Q=null,this.#W&&(clearTimeout(this.#W),this.#W=null),this.#ft&&(clearTimeout(this.#ft),this.#ft=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#rt}get useNewAltTextFlow(){return this.#H}get useNewAltTextWhenAddingImage(){return this.#$}get hcmFilter(){return T(this,"hcmFilter",this.#ct?this.#G.addHCMFilter(this.#ct.foreground,this.#ct.background):"none")}get direction(){return T(this,"direction",getComputedStyle(this.#dt).direction)}get highlightColors(){return T(this,"highlightColors",this.#X?new Map(this.#X.split(",").map((t=>t.split("=").map((t=>t.trim()))))):null)}get highlightColorNames(){return T(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(t=>t.reverse()))):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#F=t}setMainHighlightColorPicker(t){this.#it=t}editAltText(t,e=!1){this.#P?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){"enableNewAltTextWhenAddingImage"===t&&(this.#$=e)}onPageChanging({pageNumber:t}){this.#U=t-1}focusMainContainer(){this.#dt.focus()}findParent(t,e){for(const n of this.#M.values()){const{x:i,y:r,width:a,height:s}=n.div.getBoundingClientRect();if(t>=i&&t<=i+a&&e>=r&&e<=r+s)return n}return null}disableUserSelect(t=!1){this.#pt.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#z.add(t)}removeShouldRescale(t){this.#z.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*$.PDF_TO_CSS_UNITS;for(const t of this.#z)t.onScaleChanging();this.#F?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#bt({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#wt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const e of this.#M.values())if(e.hasTextLayer(t))return e;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:a}=e,s=e.toString(),o=this.#bt(e).closest(".textLayer"),c=this.getSelectionBoxes(o);if(!c)return;e.empty();const l=this.#wt(o),u=this.#at===h.NONE,f=()=>{l?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:c,anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:a,text:s}),u&&this.showAllEditors("highlight",!0,!0)};u?this.switchToMode(h.HIGHLIGHT,f):f()}#_t(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=this.#bt(t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(this.#Q||=new ut(this),this.#Q.show(e,n,"ltr"===this.direction))}addToAnnotationStorage(t){t.isEmpty()||!this.#D||this.#D.has(t.id)||this.#D.setValue(t.id,t)}#At(){const t=document.getSelection();if(!t||t.isCollapsed)return void(this.#ot&&(this.#Q?.hide(),this.#ot=null,this.#xt({hasSelectedText:!1})));const{anchorNode:e}=t;if(e===this.#ot)return;const n=this.#bt(t).closest(".textLayer");if(n){if(this.#Q?.hide(),this.#ot=e,this.#xt({hasSelectedText:!0}),(this.#at===h.HIGHLIGHT||this.#at===h.NONE)&&(this.#at===h.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#Y=this.isShiftKeyDown,!this.isShiftKeyDown)){const t=this.#at===h.HIGHLIGHT?this.#wt(n):null;t?.toggleDrawing();const e=new AbortController,i=this.combinedSignal(e),r=n=>{"pointerup"===n.type&&0!==n.button||(e.abort(),t?.toggleDrawing(!0),"pointerup"===n.type&&this.#Et("main_toolbar"))};window.addEventListener("pointerup",r,{signal:i}),window.addEventListener("blur",r,{signal:i})}}else this.#ot&&(this.#Q?.hide(),this.#ot=null,this.#xt({hasSelectedText:!1}))}#Et(t=""){this.#at===h.HIGHLIGHT?this.highlightSelection(t):this.#q&&this.#_t()}#mt(){document.addEventListener("selectionchange",this.#At.bind(this),{signal:this._signal})}#Tt(){if(this.#K)return;this.#K=new AbortController;const t=this.combinedSignal(this.#K);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#St(){this.#K?.abort(),this.#K=null}blur(){if(this.isShiftKeyDown=!1,this.#Y&&(this.#Y=!1,this.#Et("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#st)if(e.div.contains(t)){this.#nt=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#nt)return;const[t,e]=this.#nt;this.#nt=null,e.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),e.focus()}#yt(){if(this.#et)return;this.#et=new AbortController;const t=this.combinedSignal(this.#et);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#Ct(){this.#et?.abort(),this.#et=null}#kt(){if(this.#L)return;this.#L=new AbortController;const t=this.combinedSignal(this.#L);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#It(){this.#L?.abort(),this.#L=null}#vt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#yt(),this.#kt()}removeEditListeners(){this.#Ct(),this.#It()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#V)if(n.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#V)if(n.isHandlingMimeForPasting(e.type))return n.paste(e,this.currentLayer),void t.preventDefault()}copy(t){if(t.preventDefault(),this.#I?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const t of this.#st){const n=t.serialize(!0);n&&e.push(n)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const t of e.items)for(const e of this.#V)if(e.isHandlingMimeForPasting(t.type))return void e.paste(t,this.currentLayer);let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(t){return void _(`paste: "${t.message}".`)}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const t=[];for(const e of n){const n=await i.deserialize(e);if(!n)return;t.push(n)}const e=()=>{for(const e of t)this.#Rt(e);this.#Mt(t)},r=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:r,mustExec:!0})}catch(t){_(`paste: "${t.message}".`)}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),this.#at===h.NONE||this.isEditorHandlingKeyboard||yt._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,this.#Y&&(this.#Y=!1,this.#Et("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}#xt(t){Object.entries(t).some((([t,e])=>this.#ht[t]!==e))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#ht,t)}),this.#at===h.HIGHLIGHT&&!1===t.hasSelectedEditor&&this.#Pt([[u.HIGHLIGHT_FREE,!0]]))}#Pt(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#Tt(),this.#kt(),this.#xt({isEditing:this.#at!==h.NONE,isEmpty:this.#Dt(),hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:this.#N.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#St(),this.#It(),this.#xt({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#V){this.#V=t;for(const t of this.#V)this.#Pt(t.defaultPropertiesToUpdate)}}getId(){return this.#J.id}get currentLayer(){return this.#M.get(this.#U)}getLayer(t){return this.#M.get(t)}get currentPageIndex(){return this.#U}addLayer(t){this.#M.set(t.pageIndex,t),this.#Z?t.enable():t.disable()}removeLayer(t){this.#M.delete(t.pageIndex)}async updateMode(t,e=null,n=!1){if(this.#at!==t&&(!this.#gt||(await this.#gt.promise,this.#gt))){if(this.#gt=Promise.withResolvers(),this.#at=t,t===h.NONE)return this.setEditingState(!1),this.#Ot(),this._editorUndoBar?.hide(),void this.#gt.resolve();this.setEditingState(!0),await this.#Nt(),this.unselectAll();for(const e of this.#M.values())e.updateMode(t);if(!e)return n&&this.addNewEditorFromKeyboard(),void this.#gt.resolve();for(const t of this.#R.values())t.annotationElementId===e?(this.setSelected(t),t.enterInEditMode()):t.unselect();this.#gt.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#at&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#V){switch(t){case u.CREATE:return void this.currentLayer.addNewEditor();case u.HIGHLIGHT_DEFAULT_COLOR:this.#it?.updateColor(e);break;case u.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#lt||=new Map).set(t,e),this.showAllEditors("highlight",e)}for(const n of this.#st)n.updateParams(t,e);for(const n of this.#V)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const n of this.#R.values())n.editorType===t&&n.show(e);(this.#lt?.get(u.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#Pt([[u.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#tt!==t){this.#tt=t;for(const e of this.#M.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#Nt(){if(!this.#Z){this.#Z=!0;const t=[];for(const e of this.#M.values())t.push(e.enable());await Promise.all(t);for(const t of this.#R.values())t.enable()}}#Ot(){if(this.unselectAll(),this.#Z){this.#Z=!1;for(const t of this.#M.values())t.disable();for(const t of this.#R.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#R.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#R.get(t)}addEditor(t){this.#R.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#W&&clearTimeout(this.#W),this.#W=setTimeout((()=>{this.focusMainContainer(),this.#W=null}),0)),this.#R.delete(t.id),this.unselect(t),t.annotationElementId&&this.#j.has(t.annotationElementId)||this.#D?.remove(t.id)}addDeletedAnnotationElement(t){this.#j.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#j.has(t)}removeDeletedAnnotationElement(t){this.#j.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Rt(t){const e=this.#M.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#I!==t&&(this.#I=t,t&&this.#Pt(t.propertiesToUpdate))}get#Lt(){let t=null;for(t of this.#st);return t}updateUI(t){this.#Lt===t&&this.#Pt(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#Pt(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#st.has(t))return this.#st.delete(t),t.unselect(),void this.#xt({hasSelectedEditor:this.hasSelection});this.#st.add(t),t.select(),this.#Pt(t.propertiesToUpdate),this.#xt({hasSelectedEditor:!0})}setSelected(t){this.#F?.commitOrRemove();for(const e of this.#st)e!==t&&e.unselect();this.#st.clear(),this.#st.add(t),t.select(),this.#Pt(t.propertiesToUpdate),this.#xt({hasSelectedEditor:!0})}isSelected(t){return this.#st.has(t)}get firstSelectedEditor(){return this.#st.values().next().value}unselect(t){t.unselect(),this.#st.delete(t),this.#xt({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#st.size}get isEnterHandled(){return 1===this.#st.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#N.undo(),this.#xt({hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Dt()}),this._editorUndoBar?.hide()}redo(){this.#N.redo(),this.#xt({hasSomethingToUndo:!0,hasSomethingToRedo:this.#N.hasSomethingToRedo(),isEmpty:this.#Dt()})}addCommands(t){this.#N.add(t),this.#xt({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Dt()})}cleanUndoStack(t){this.#N.cleanType(t)}#Dt(){if(0===this.#R.size)return!0;if(1===this.#R.size)for(const t of this.#R.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#st],n=()=>{for(const t of e)this.#Rt(t)};this.addCommands({cmd:()=>{this._editorUndoBar?.show(n,1===e.length?e[0].editorType:e.length);for(const t of e)t.remove()},undo:n,mustExec:!0})}commitOrRemove(){this.#I?.commitOrRemove()}hasSomethingToControl(){return this.#I||this.hasSelection}#Mt(t){for(const t of this.#st)t.unselect();this.#st.clear();for(const e of t)e.isEmpty()||(this.#st.add(e),e.select());this.#xt({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#st)t.commit();this.#Mt(this.#R.values())}unselectAll(){if((!this.#I||(this.#I.commitOrRemove(),this.#at===h.NONE))&&!this.#F?.commitOrRemove()&&this.hasSelection){for(const t of this.#st)t.unselect();this.#st.clear(),this.#xt({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#ut[0]+=t,this.#ut[1]+=e;const[i,r]=this.#ut,a=[...this.#st];this.#ft&&clearTimeout(this.#ft),this.#ft=setTimeout((()=>{this.#ft=null,this.#ut[0]=this.#ut[1]=0,this.addCommands({cmd:()=>{for(const t of a)this.#R.has(t.id)&&t.translateInPage(i,r)},undo:()=>{for(const t of a)this.#R.has(t.id)&&t.translateInPage(-i,-r)},mustExec:!1})}),1e3);for(const n of a)n.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#B=new Map;for(const t of this.#st)this.#B.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#B)return!1;this.disableUserSelect(!1);const t=this.#B;this.#B=null;let e=!1;for(const[{x:n,y:i,pageIndex:r},a]of t)a.newX=n,a.newY=i,a.newPageIndex=r,e||=n!==a.savedX||i!==a.savedY||r!==a.savedPageIndex;if(!e)return!1;const n=(t,e,n,i)=>{if(this.#R.has(t.id)){const r=this.#M.get(i);r?t._setParentAndPosition(r,e,n):(t.pageIndex=i,t.x=e,t.y=n)}};return this.addCommands({cmd:()=>{for(const[e,{newX:i,newY:r,newPageIndex:a}]of t)n(e,i,r,a)},undo:()=>{for(const[e,{savedX:i,savedY:r,savedPageIndex:a}]of t)n(e,i,r,a)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#B)for(const n of this.#B.keys())n.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#st.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#I===t}getActive(){return this.#I}getMode(){return this.#at}get imageManager(){return T(this,"imageManager",new pt)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let n=0,i=e.rangeCount;n<i;n++)if(!t.contains(e.getRangeAt(n).commonAncestorContainer))return null;const{x:n,y:i,width:r,height:a}=t.getBoundingClientRect();let s;switch(t.getAttribute("data-main-rotation")){case"90":s=(t,e,s,o)=>({x:(e-i)/a,y:1-(t+s-n)/r,width:o/a,height:s/r});break;case"180":s=(t,e,s,o)=>({x:1-(t+s-n)/r,y:1-(e+o-i)/a,width:s/r,height:o/a});break;case"270":s=(t,e,s,o)=>({x:1-(e+o-i)/a,y:(t-n)/r,width:o/a,height:s/r});break;default:s=(t,e,s,o)=>({x:(t-n)/r,y:(e-i)/a,width:s/r,height:o/a})}const o=[];for(let t=0,n=e.rangeCount;t<n;t++){const n=e.getRangeAt(t);if(!n.collapsed)for(const{x:t,y:e,width:i,height:r}of n.getClientRects())0!==i&&0!==r&&o.push(s(t,e,i,r))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#O||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#O?.delete(t)}renderAnnotationElement(t){const e=this.#O?.get(t.data.id);if(!e)return;const n=this.#D.getRawValue(e);n&&(this.#at!==h.NONE||n.hasBeenModified)&&n.renderAnnotationElement(t)}}class bt{#o=null;#Ft=!1;#Ut=null;#jt=null;#Bt=null;#Vt=null;#zt=!1;#qt=null;#a=null;#Ht=null;#$t=null;#Gt=!1;static#Wt=null;static _l10n=null;constructor(t){this.#a=t,this.#Gt=t._uiManager.useNewAltTextFlow,bt.#Wt||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){bt._l10n??=t}async render(){const t=this.#Ut=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#jt=document.createElement("span");t.append(e),this.#Gt?(t.classList.add("new"),t.setAttribute("data-l10n-id",bt.#Wt.missing),e.setAttribute("data-l10n-id",bt.#Wt["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#a._uiManager._signal;t.addEventListener("contextmenu",et,{signal:n}),t.addEventListener("pointerdown",(t=>t.stopPropagation()),{signal:n});const i=t=>{t.preventDefault(),this.#a._uiManager.editAltText(this.#a),this.#Gt&&this.#a._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#Kt}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",(e=>{e.target===t&&"Enter"===e.key&&(this.#zt=!0,i(e))}),{signal:n}),await this.#Xt(),t}get#Kt(){return(this.#o?"added":null===this.#o&&this.guessedText&&"review")||"missing"}finish(){this.#Ut&&(this.#Ut.focus({focusVisible:this.#zt}),this.#zt=!1)}isEmpty(){return this.#Gt?null===this.#o:!this.#o&&!this.#Ft}hasData(){return this.#Gt?null!==this.#o||!!this.#Ht:this.isEmpty()}get guessedText(){return this.#Ht}async setGuessedText(t){null===this.#o&&(this.#Ht=t,this.#$t=await bt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#Xt())}toggleAltTextBadge(t=!1){if(!this.#Gt||this.#o)return this.#qt?.remove(),void(this.#qt=null);if(!this.#qt){const t=this.#qt=document.createElement("div");t.className="noAltTextBadge",this.#a.div.append(t)}this.#qt.classList.toggle("hidden",!t)}serialize(t){let e=this.#o;return t||this.#Ht!==e||(e=this.#$t),{altText:e,decorative:this.#Ft,guessedText:this.#Ht,textWithDisclaimer:this.#$t}}get data(){return{altText:this.#o,decorative:this.#Ft}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:r=!1}){n&&(this.#Ht=n,this.#$t=i),this.#o===t&&this.#Ft===e||(r||(this.#o=t,this.#Ft=e),this.#Xt())}toggle(t=!1){this.#Ut&&(!t&&this.#Vt&&(clearTimeout(this.#Vt),this.#Vt=null),this.#Ut.disabled=!t)}shown(){this.#a._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#Kt}})}destroy(){this.#Ut?.remove(),this.#Ut=null,this.#jt=null,this.#Bt=null,this.#qt?.remove(),this.#qt=null}async#Xt(){const t=this.#Ut;if(!t)return;if(this.#Gt){if(t.classList.toggle("done",!!this.#o),t.setAttribute("data-l10n-id",bt.#Wt[this.#Kt]),this.#jt?.setAttribute("data-l10n-id",bt.#Wt[`${this.#Kt}-label`]),!this.#o)return void this.#Bt?.remove()}else{if(!this.#o&&!this.#Ft)return t.classList.remove("done"),void this.#Bt?.remove();t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#Bt;if(!e){this.#Bt=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#a.id}`;const n=100,i=this.#a._uiManager._signal;i.addEventListener("abort",(()=>{clearTimeout(this.#Vt),this.#Vt=null}),{once:!0}),t.addEventListener("mouseenter",(()=>{this.#Vt=setTimeout((()=>{this.#Vt=null,this.#Bt.classList.add("show"),this.#a._reportTelemetry({action:"alt_text_tooltip"})}),n)}),{signal:i}),t.addEventListener("mouseleave",(()=>{this.#Vt&&(clearTimeout(this.#Vt),this.#Vt=null),this.#Bt?.classList.remove("show")}),{signal:i})}this.#Ft?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#o),e.parentNode||t.append(e);const n=this.#a.getImageForAltText();n?.setAttribute("aria-describedby",e.id)}}class wt{#dt;#Yt=!1;#Qt=null;#Jt;#Zt;#te;#ee;#ne;#ie=null;#re;#ae=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:s}){this.#dt=t,this.#Qt=n,this.#Jt=e,this.#Zt=i,this.#te=r,this.#ee=a,this.#re=new AbortController,this.#ne=AbortSignal.any([s,this.#re.signal]),t.addEventListener("touchstart",this.#se.bind(this),{passive:!1,signal:this.#ne})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return T(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#se(t){if(this.#Jt?.()||t.touches.length<2)return;if(!this.#ae){this.#ae=new AbortController;const t=AbortSignal.any([this.#ne,this.#ae.signal]),e=this.#dt,n={signal:t,passive:!1};e.addEventListener("touchmove",this.#oe.bind(this),n),e.addEventListener("touchend",this.#ce.bind(this),n),e.addEventListener("touchcancel",this.#ce.bind(this),n),this.#Zt?.()}if(nt(t),2!==t.touches.length||this.#Qt?.())return void(this.#ie=null);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#ie={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#oe(t){if(!this.#ie||2!==t.touches.length)return;let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:i,screenY:r}=e,{screenX:a,screenY:s}=n,o=this.#ie,{touch0X:c,touch0Y:l,touch1X:h,touch1Y:u}=o,f=h-c,d=u-l,p=a-i,g=s-r,m=Math.hypot(p,g)||1,v=Math.hypot(f,d)||1;if(!this.#Yt&&Math.abs(v-m)<=wt.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(o.touch0X=i,o.touch0Y=r,o.touch1X=a,o.touch1Y=s,t.preventDefault(),!this.#Yt)return void(this.#Yt=!0);const y=[(i+a)/2,(r+s)/2];this.#te?.(y,v,m)}#ce(t){this.#ae.abort(),this.#ae=null,this.#ee?.(),this.#ie&&(t.preventDefault(),this.#ie=null,this.#Yt=!1)}destroy(){this.#re?.abort(),this.#re=null}}class _t{#le=null;#he=null;#o=null;#ue=!1;#fe=null;#de="";#pe=!1;#ge=null;#me=null;#ve=null;#ye=null;#be="";#we=!1;#_e=null;#Ae=!1;#xe=!1;#Ee=!1;#Te=null;#Se=0;#Ce=0;#ke=null;#Ie=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#Re=!1;#Me=_t._zIndex++;static _borderLineWidth=-1;static _colorManager=new vt;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=_t.prototype._resizeWithKeyboard,e=yt.TRANSLATE_SMALL,n=yt.TRANSLATE_BIG;return T(this,"_resizerKeyboardManager",new mt([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],_t.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[r,a];const[s,o]=this.parentDimensions;this.x=t.x/s,this.y=t.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return T(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new At({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(_t._l10n??=t,_t._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),-1!==_t._borderLineWidth)return;const n=getComputedStyle(document.documentElement);_t._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){A("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#Re}set _isDraggable(t){this.#Re=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#Me}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#Pe(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#we?this.#we=!1:this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[r,a]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/r,this.y=(e+i)/a,this.fixAndSetPosition()}#De([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#De(this.parentDimensions,t,e)}translateInPage(t,e){this.#_e||=[this.x,this.y,this.width,this.height],this.#De(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#_e||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,r]}=this;if(this.x+=t/i,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:s}=this;const[o,c]=this.getBaseTranslation();a+=o,s+=c;const{style:l}=n;l.left=`${(100*a).toFixed(2)}%`,l.top=`${(100*s).toFixed(2)}%`,this._onTranslating(a,s),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#_e&&(this.#_e[0]!==this.x||this.#_e[1]!==this.y)}get _hasBeenResized(){return!!this.#_e&&(this.#_e[2]!==this.width||this.#_e[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=_t,i=n/t,r=n/e;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,i]}=this;let{x:r,y:a,width:s,height:o}=this;if(s*=n,o*=i,r*=n,a*=i,this._mustFixPosition)switch(t){case 0:r=Math.max(0,Math.min(n-s,r)),a=Math.max(0,Math.min(i-o,a));break;case 90:r=Math.max(0,Math.min(n-o,r)),a=Math.min(i,Math.max(s,a));break;case 180:r=Math.min(n,Math.max(s,r)),a=Math.min(i,Math.max(o,a));break;case 270:r=Math.min(n,Math.max(o,r)),a=Math.max(0,Math.min(i-s,a))}this.x=r/=n,this.y=a/=i;const[c,l]=this.getBaseTranslation();r+=c,a+=l,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#Oe(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return _t.#Oe(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return _t.#Oe(t,e,360-this.parentRotation)}#Ne(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/n).toFixed(2)}%`,this.#pe||(r.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),r=!this.#pe&&e.endsWith("%");if(i&&r)return;const[a,s]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/a).toFixed(2)}%`),this.#pe||r||(t.height=`${(100*parseFloat(e)/s).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#Le(){if(this.#ge)return;this.#ge=document.createElement("div"),this.#ge.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const t=document.createElement("div");this.#ge.append(t),t.classList.add("resizer",n),t.setAttribute("data-resizer-name",n),t.addEventListener("pointerdown",this.#Fe.bind(this,n),{signal:e}),t.addEventListener("contextmenu",et,{signal:e}),t.tabIndex=-1}this.div.prepend(this.#ge)}#Fe(t,e){e.preventDefault();const{isMac:n}=F.platform;if(0!==e.button||e.ctrlKey&&n)return;this.#o?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#me=[e.screenX,e.screenY];const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#Ue.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",nt,{passive:!1,signal:a}),window.addEventListener("contextmenu",et,{signal:a}),this.#ve={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const s=this.parent.div.style.cursor,o=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const c=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#o?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=s,this.div.style.cursor=o,this.#je()};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})}#Be(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[r,a]=this.parentDimensions;this.setDims(r*n,a*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#je(){if(!this.#ve)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=this.#ve;this.#ve=null;const r=this.x,a=this.y,s=this.width,o=this.height;r===t&&a===e&&s===n&&o===i||this.addCommands({cmd:this.#Be.bind(this,r,a,s,o),undo:this.#Be.bind(this,t,e,n,i),mustExec:!0})}static _round(t){return Math.round(1e4*t)/1e4}#Ue(t,e){const[n,i]=this.parentDimensions,r=this.x,a=this.y,s=this.width,o=this.height,c=_t.MIN_SIZE/n,l=_t.MIN_SIZE/i,h=this.#Ne(this.rotation),u=(t,e)=>[h[0]*t+h[2]*e,h[1]*t+h[3]*e],f=this.#Ne(360-this.rotation);let d,p,g=!1,m=!1;switch(t){case"topLeft":g=!0,d=(t,e)=>[0,0],p=(t,e)=>[t,e];break;case"topMiddle":d=(t,e)=>[t/2,0],p=(t,e)=>[t/2,e];break;case"topRight":g=!0,d=(t,e)=>[t,0],p=(t,e)=>[0,e];break;case"middleRight":m=!0,d=(t,e)=>[t,e/2],p=(t,e)=>[0,e/2];break;case"bottomRight":g=!0,d=(t,e)=>[t,e],p=(t,e)=>[0,0];break;case"bottomMiddle":d=(t,e)=>[t/2,e],p=(t,e)=>[t/2,0];break;case"bottomLeft":g=!0,d=(t,e)=>[0,e],p=(t,e)=>[t,0];break;case"middleLeft":m=!0,d=(t,e)=>[0,e/2],p=(t,e)=>[t,e/2]}const v=d(s,o),y=p(s,o);let b=u(...y);const w=_t._round(r+b[0]),_=_t._round(a+b[1]);let A,x,E=1,T=1;if(e.fromKeyboard)({deltaX:A,deltaY:x}=e);else{const{screenX:t,screenY:n}=e,[i,r]=this.#me;[A,x]=this.screenToPageTranslation(t-i,n-r),this.#me[0]=t,this.#me[1]=n}var S,C;if([A,x]=(S=A/n,C=x/i,[f[0]*S+f[2]*C,f[1]*S+f[3]*C]),g){const t=Math.hypot(s,o);E=T=Math.max(Math.min(Math.hypot(y[0]-v[0]-A,y[1]-v[1]-x)/t,1/s,1/o),c/s,l/o)}else m?E=Math.max(c,Math.min(1,Math.abs(y[0]-v[0]-A)))/s:T=Math.max(l,Math.min(1,Math.abs(y[1]-v[1]-x)))/o;const k=_t._round(s*E),I=_t._round(o*T);b=u(...p(k,I));const R=w-b[0],M=_-b[1];this.#_e||=[this.x,this.y,this.width,this.height],this.width=k,this.height=I,this.x=R,this.y=M,this.setDims(n*k,i*I),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#o?.finish()}async addEditToolbar(){return this._editToolbar||this.#xe||(this._editToolbar=new ht(this),this.div.append(this._editToolbar.render()),this.#o&&await this._editToolbar.addAltText(this.#o)),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#o?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#o||(bt.initialize(_t._l10n),this.#o=new bt(this),this.#le&&(this.#o.data=this.#le,this.#le=null),await this.addEditToolbar())}get altTextData(){return this.#o?.data}set altTextData(t){this.#o&&(this.#o.data=t)}get guessedAltText(){return this.#o?.guessedText}async setGuessedAltText(t){await(this.#o?.setGuessedText(t))}serializeAltText(t){return this.#o?.serialize(t)}hasAltText(){return!!this.#o&&!this.#o.isEmpty()}hasAltTextData(){return this.#o?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#ue?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#Ve();const[t,e]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),ft(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#Ie||=new wt({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#ze.bind(this),onPinching:this.#qe.bind(this),onPinchEnd:this.#He.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#ze(){this.#ve={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#o?.toggle(!1),this.parent.togglePointerEvents(!1)}#qe(t,e,n){let i=n/e*.7+1-.7;if(1===i)return;const r=this.#Ne(this.rotation),a=(t,e)=>[r[0]*t+r[2]*e,r[1]*t+r[3]*e],[s,o]=this.parentDimensions,c=this.x,l=this.y,h=this.width,u=this.height,f=_t.MIN_SIZE/s,d=_t.MIN_SIZE/o;i=Math.max(Math.min(i,1/h,1/u),f/h,d/u);const p=_t._round(h*i),g=_t._round(u*i);if(p===h&&g===u)return;this.#_e||=[c,l,h,u];const m=a(h/2,u/2),v=_t._round(c+m[0]),y=_t._round(l+m[1]),b=a(p/2,g/2);this.x=v-b[0],this.y=y-b[1],this.width=p,this.height=g,this.setDims(s*p,o*g),this.fixAndSetPosition(),this._onResizing()}#He(){this.#o?.toggle(!0),this.parent.togglePointerEvents(!0),this.#je()}pointerdown(t){const{isMac:e}=F.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(this.#we=!0,this._isDraggable?this.#$e(t):this.#Ge(t))}get isSelected(){return this._uiManager.isSelected(this)}#Ge(t){const{isMac:e}=F.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$e(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},s=t=>{i.abort(),this.#fe=null,this.#we=!1,this._uiManager.endDragSession()||this.#Ge(t),n&&this._onStopDragging()};e&&(this.#Se=t.clientX,this.#Ce=t.clientY,this.#fe=t.pointerId,this.#de=t.pointerType,window.addEventListener("pointermove",(t=>{n||(n=!0,this._onStartDragging());const{clientX:e,clientY:i,pointerId:r}=t;if(r!==this.#fe)return void nt(t);const[a,s]=this.screenToPageTranslation(e-this.#Se,i-this.#Ce);this.#Se=e,this.#Ce=i,this._uiManager.dragSelectedEditors(a,s)}),a),window.addEventListener("touchmove",nt,a),window.addEventListener("pointerdown",(t=>{t.pointerType===this.#de&&(this.#Ie||t.isPrimary)&&s(t),nt(t)}),a));const o=t=>{this.#fe&&this.#fe!==t.pointerId?nt(t):s(t)};window.addEventListener("pointerup",o,{signal:r}),window.addEventListener("blur",o,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#Te&&clearTimeout(this.#Te),this.#Te=setTimeout((()=>{this.#Te=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[s,o]=this.pageTranslation,c=t/i,l=e/i,h=this.x*r,u=this.y*a,f=this.width*r,d=this.height*a;switch(n){case 0:return[h+c+s,a-u-l-d+o,h+c+f+s,a-u-l+o];case 90:return[h+l+s,a-u+c+o,h+l+d+s,a-u+c+f+o];case 180:return[h-c-f+s,a-u+l+o,h-c+s,a-u+l+d+o];case 270:return[h-l-d+s,a-u-c-f+o,h-l+s,a-u-c+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,r,a]=t,s=r-n,o=a-i;switch(this.rotation){case 0:return[n,e-a,s,o];case 90:return[n,e-i,o,s];case 180:return[r,e-i,s,o];case 270:return[r,e-a,o,s];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){this.#xe=!0}disableEditMode(){this.#xe=!1}isInEditMode(){return this.#xe}shouldGetKeyboardEvents(){return this.#Ee}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return e<a&&i>0&&t<r&&n>0}#Ve(){if(this.#ye||!this.div)return;this.#ye=new AbortController;const t=this._uiManager.combinedSignal(this.#ye);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#Ve()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){A("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,i.#le=t.accessibilityData;const[r,a]=i.pageDimensions,[s,o,c,l]=i.getRectInCurrentCoords(t.rect,a);return i.x=s/r,i.y=o/a,i.width=c/r,i.height=l/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.#ye?.abort(),this.#ye=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#Te&&(clearTimeout(this.#Te),this.#Te=null),this.#Pe(),this.removeEditToolbar(),this.#ke){for(const t of this.#ke.values())clearTimeout(t);this.#ke=null}this.parent=null,this.#Ie?.destroy(),this.#Ie=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#Le(),this.#ge.classList.remove("hidden"),ft(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),this.#ve={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#ge.children;if(!this.#he){this.#he=Array.from(e);const t=this.#We.bind(this),n=this.#Ke.bind(this),i=this._uiManager._signal;for(const e of this.#he){const r=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t,{signal:i}),e.addEventListener("blur",n,{signal:i}),e.addEventListener("focus",this.#Xe.bind(this,r),{signal:i}),e.setAttribute("data-l10n-id",_t._l10nResizer[r])}}const n=this.#he[0];let i=0;for(const t of e){if(t===n)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#he.length/4);if(r!==i){if(r<i)for(let t=0;t<i-r;t++)this.#ge.append(this.#ge.firstChild);else if(r>i)for(let t=0;t<r-i;t++)this.#ge.firstChild.before(this.#ge.lastChild);let t=0;for(const n of e){const e=this.#he[t++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",_t._l10nResizer[e])}}this.#Ye(0),this.#Ee=!0,this.#ge.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#We(t){_t._resizerKeyboardManager.exec(this,t)}#Ke(t){this.#Ee&&t.relatedTarget?.parentNode!==this.#ge&&this.#Pe()}#Xe(t){this.#be=this.#Ee?t:""}#Ye(t){if(this.#he)for(const e of this.#he)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#Ee&&this.#Ue(this.#be,{deltaX:t,deltaY:e,fromKeyboard:!0})}#Pe(){this.#Ee=!1,this.#Ye(-1),this.#je()}_stopResizingWithKeyboard(){this.#Pe(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),this.#o?.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}unselect(){this.#ge?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#o?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#Ae}set isEditing(t){this.#Ae=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#pe=!0;const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#ke||=new Map;const{action:e}=t;let n=this.#ke.get(e);return n&&clearTimeout(n),n=setTimeout((()=>{this._reportTelemetry(t),this.#ke.delete(e),0===this.#ke.size&&(this.#ke=null)}),_t._telemetryTimeout),void this.#ke.set(e,n)}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#ue=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#ue=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e?.nodeName&&e.classList.contains("annotationContent")&&e.remove()}}class At extends _t{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const xt=3285377520,Et=4294901760,Tt=65535;class St{constructor(t){this.h1=t?4294967295&t:xt,this.h2=t?4294967295&t:xt}update(t){let e,n;if("string"==typeof t){e=new Uint8Array(2*t.length),n=0;for(let i=0,r=t.length;i<r;i++){const r=t.charCodeAt(i);r<=255?e[n++]=r:(e[n++]=r>>>8,e[n++]=255&r)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),n=e.byteLength}const i=n>>2,r=n-4*i,a=new Uint32Array(e.buffer,0,i);let s=0,o=0,c=this.h1,l=this.h2;const h=3432918353,u=461845907,f=11601,d=13715;for(let t=0;t<i;t++)1&t?(s=a[t],s=s*h&Et|s*f&Tt,s=s<<15|s>>>17,s=s*u&Et|s*d&Tt,c^=s,c=c<<13|c>>>19,c=5*c+3864292196):(o=a[t],o=o*h&Et|o*f&Tt,o=o<<15|o>>>17,o=o*u&Et|o*d&Tt,l^=o,l=l<<13|l>>>19,l=5*l+3864292196);switch(s=0,r){case 3:s^=e[4*i+2]<<16;case 2:s^=e[4*i+1]<<8;case 1:s^=e[4*i],s=s*h&Et|s*f&Tt,s=s<<15|s>>>17,s=s*u&Et|s*d&Tt,1&i?c^=s:l^=s}this.h1=c,this.h2=l}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&Et|36045*t&Tt,e=4283543511*e&Et|(2950163797*(e<<16|t>>>16)&Et)>>>16,t^=e>>>1,t=444984403*t&Et|60499*t&Tt,e=3301882366*e&Et|(3120437893*(e<<16|t>>>16)&Et)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Ct=Object.freeze({map:null,hash:"",transfer:void 0});class kt{#Qe=!1;#Je=null;#Ze=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#Ze.get(t);return void 0===n?e:Object.assign(e,n)}getRawValue(t){return this.#Ze.get(t)}remove(t){if(this.#Ze.delete(t),0===this.#Ze.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const t of this.#Ze.values())if(t instanceof _t)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#Ze.get(t);let i=!1;if(void 0!==n)for(const[t,r]of Object.entries(e))n[t]!==r&&(i=!0,n[t]=r);else i=!0,this.#Ze.set(t,e);i&&this.#tn(),e instanceof _t&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#Ze.has(t)}getAll(){return this.#Ze.size>0?L(this.#Ze):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return this.#Ze.size}#tn(){this.#Qe||(this.#Qe=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Qe&&(this.#Qe=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new It(this)}get serializable(){if(0===this.#Ze.size)return Ct;const t=new Map,e=new St,n=[],i=Object.create(null);let r=!1;for(const[n,a]of this.#Ze){const s=a instanceof _t?a.serialize(!1,i):a;s&&(t.set(n,s),e.update(`${n}:${JSON.stringify(s)}`),r||=!!s.bitmap)}if(r)for(const e of t.values())e.bitmap&&n.push(e.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Ct}get editorStats(){let t=null;const e=new Map;for(const n of this.#Ze.values()){if(!(n instanceof _t))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:r}=i;e.has(r)||e.set(r,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const a=t[r]||=new Map;for(const[t,e]of Object.entries(i)){if("type"===t)continue;let n=a.get(t);n||(n=new Map,a.set(t,n));const i=n.get(e)??0;n.set(e,i+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#Je=null}get modifiedIds(){if(this.#Je)return this.#Je;const t=[];for(const e of this.#Ze.values())e instanceof _t&&e.annotationElementId&&e.serialize()&&t.push(e.annotationElementId);return this.#Je={ids:new Set(t),hash:t.join(",")}}}class It extends kt{#en;constructor(t){super();const{map:e,hash:n,transfer:i}=t.serializable,r=structuredClone(e,i?{transfer:i}:null);this.#en={map:r,hash:n,transfer:i}}get print(){A("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#en}get modifiedIds(){return T(this,"modifiedIds",{ids:new Set,hash:""})}}class Rt{#nn=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#nn.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(t&&!this.#nn.has(t.loadedName))if(x(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:r}=t,a=new FontFace(n,i,r);this.addNativeFontFace(a);try{await a.load(),this.#nn.add(n),e?.(t)}catch{_(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}}else A("Not implemented: loadSystemFont without the Font Loading API.")}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(n){throw _(`Failed to load font '${e.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise((e=>{const n=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,n)}))}}get isFontLoadingAPISupported(){return T(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let t=!1;return(a||"undefined"!=typeof navigator&&"string"==typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),T(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:e}=this,n={done:!1,complete:function(){for(x(!n.done,"completeRequest() cannot be called twice."),n.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(n),n}get _loadTestFont(){return T(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function i(t,e,n,i){return t.substring(0,e)+i+t.substring(e+n)}let r,a;const s=this._document.createElement("canvas");s.width=1,s.height=1;const o=s.getContext("2d");let c=0;const l=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=i(h,976,l.length,l);const u=1482184792;let f=n(h,16);for(r=0,a=l.length-3;r<a;r+=4)f=f-u+n(l,r)|0;var d;r<l.length&&(f=f-u+n(l+"XXX",r)|0),h=i(h,16,4,(d=f,String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,255&d)));const p=`@font-face {font-family:"${l}";src:url(data:font/opentype;base64,${btoa(h)});}`;this.insertRule(p);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const e of[t.loadedName,l]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=e,g.append(t)}this._document.body.append(g),function t(e,n){if(++c>30)return _("Load test font never loaded."),void n();o.font="30px "+e,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(t.bind(null,e,n))}(l,(()=>{g.remove(),e.complete()}))}}class Mt{constructor(t,{disableFontFace:e=!1,fontExtraProperties:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const e in t)this[e]=t[e];this.disableFontFace=!0===e,this.fontExtraProperties=!0===n,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${e=this.data,Uint8Array.prototype.toBase64?e.toBase64():btoa(O(e))});`;var e;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),n}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(t){_(`getPathGenerator - ignoring character: "${t}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=r}}function Pt(){}function Dt(t){if(t instanceof D||t instanceof I||t instanceof R||t instanceof C||t instanceof M||t instanceof k)return t;switch(t instanceof Error||"object"==typeof t&&null!==t||A('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new D(t.message);case"InvalidPDFException":return new I(t.message);case"MissingPDFException":return new R(t.message);case"PasswordException":return new C(t.message,t.code);case"UnexpectedResponseException":return new M(t.message,t.status);case"UnknownErrorException":return new k(t.message,t.details)}return new k(t.message,t.toString())}class Ot{#in=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#rn.bind(this),{signal:this.#in.signal})}#rn({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#an(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],1===t.callback)n.resolve(t.data);else{if(2!==t.callback)throw new Error("Unexpected callback case");n.reject(Dt(t.reason))}return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,r=this.comObj;Promise.try(e,t.data).then((function(e){r.postMessage({sourceName:n,targetName:i,callback:1,callbackId:t.callbackId,data:e})}),(function(e){r.postMessage({sourceName:n,targetName:i,callback:2,callbackId:t.callbackId,reason:Dt(e)})}))}else t.streamId?this.#sn(t):e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(t){r.reject(t)}return r.promise}sendWithStream(t,e,n,i){const r=this.streamId++,a=this.sourceName,s=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const c=Promise.withResolvers();return this.streamControllers[r]={controller:n,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:a,targetName:s,action:t,streamId:r,data:e,desiredSize:n.desiredSize},i),c.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[r].pullCall=e,o.postMessage({sourceName:a,targetName:s,stream:6,streamId:r,desiredSize:t.desiredSize}),e.promise},cancel:t=>{x(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[r].cancelCall=e,this.streamControllers[r].isClosed=!0,o.postMessage({sourceName:a,targetName:s,stream:1,streamId:r,reason:Dt(t)}),e.promise}},n)}#sn(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,r=this.comObj,a=this,s=this.actionHandler[t.action],o={enqueue(t,a=1,s){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=a,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:i,stream:4,streamId:e,chunk:t},s)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:3,streamId:e}),delete a.streamSinks[e])},error(t){x(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:5,streamId:e,reason:Dt(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,Promise.try(s,t.data,o).then((function(){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,reason:Dt(t)})}))}#an(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,r=this.comObj,a=this.streamControllers[e],s=this.streamSinks[e];switch(t.stream){case 8:t.success?a.startCall.resolve():a.startCall.reject(Dt(t.reason));break;case 7:t.success?a.pullCall.resolve():a.pullCall.reject(Dt(t.reason));break;case 6:if(!s){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0});break}s.desiredSize<=0&&t.desiredSize>0&&s.sinkCapability.resolve(),s.desiredSize=t.desiredSize,Promise.try(s.onPull||Pt).then((function(){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,reason:Dt(t)})}));break;case 4:if(x(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case 3:if(x(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#on(a,e);break;case 5:x(a,"error should have stream controller"),a.controller.error(Dt(t.reason)),this.#on(a,e);break;case 2:t.success?a.cancelCall.resolve():a.cancelCall.reject(Dt(t.reason)),this.#on(a,e);break;case 1:if(!s)break;const o=Dt(t.reason);Promise.try(s.onCancel||Pt,o).then((function(){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,reason:Dt(t)})})),s.sinkCapability.reject(o),s.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#on(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#in?.abort(),this.#in=null}}class Nt{#cn=!1;constructor({enableHWA:t=!1}){this.#cn=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#cn})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){A("Abstract method `_createCanvas` called.")}}class Lt{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then((t=>({cMapData:t,isCompressed:this.isCompressed}))).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)}))}async _fetch(t){A("Abstract method `_fetch` called.")}}class Ft extends Lt{async _fetch(t){const e=await G(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):N(e)}}class Ut{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,r){return"none"}destroy(t=!1){}}class jt{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch((t=>{throw new Error(`Unable to load font data at: ${e}`)}))}async _fetch(t){A("Abstract method `_fetch` called.")}}class Bt extends jt{async _fetch(t){const e=await G(t,"arraybuffer");return new Uint8Array(e)}}async function Vt(t){const e=process.getBuiltinModule("fs"),n=await e.promises.readFile(t);return new Uint8Array(n)}a&&_("Please use the `legacy` build in Node.js environments.");const zt="Fill",qt="Stroke",Ht="Shading";function $t(t,e){if(!e)return;const n=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],n,i),t.clip(r)}class Gt{getPattern(){A("Abstract method `getPattern` called.")}}class Wt extends Gt{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)e.addColorStop(t[0],t[1]);return e}getPattern(t,e,n,i){let r;if(i===qt||i===zt){const a=e.current.getClippedPathBoundingBox(i,st(t))||[0,0,0,0],s=Math.ceil(a[2]-a[0])||1,o=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",s,o),l=c.context;l.clearRect(0,0,l.canvas.width,l.canvas.height),l.beginPath(),l.rect(0,0,l.canvas.width,l.canvas.height),l.translate(-a[0],-a[1]),n=j.transform(n,[1,0,0,1,a[0],a[1]]),l.transform(...e.baseTransform),this.matrix&&l.transform(...this.matrix),$t(l,this._bbox),l.fillStyle=this._createGradient(l),l.fill(),r=t.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(n);r.setTransform(h)}else $t(t,this._bbox),r=this._createGradient(t);return r}}function Kt(t,e,n,i,r,a,s,o){const c=e.coords,l=e.colors,h=t.data,u=4*t.width;let f;c[n+1]>c[i+1]&&(f=n,n=i,i=f,f=a,a=s,s=f),c[i+1]>c[r+1]&&(f=i,i=r,r=f,f=s,s=o,o=f),c[n+1]>c[i+1]&&(f=n,n=i,i=f,f=a,a=s,s=f);const d=(c[n]+e.offsetX)*e.scaleX,p=(c[n+1]+e.offsetY)*e.scaleY,g=(c[i]+e.offsetX)*e.scaleX,m=(c[i+1]+e.offsetY)*e.scaleY,v=(c[r]+e.offsetX)*e.scaleX,y=(c[r+1]+e.offsetY)*e.scaleY;if(p>=y)return;const b=l[a],w=l[a+1],_=l[a+2],A=l[s],x=l[s+1],E=l[s+2],T=l[o],S=l[o+1],C=l[o+2],k=Math.round(p),I=Math.round(y);let R,M,P,D,O,N,L,F;for(let t=k;t<=I;t++){if(t<m){const e=t<p?0:(p-t)/(p-m);R=d-(d-g)*e,M=b-(b-A)*e,P=w-(w-x)*e,D=_-(_-E)*e}else{let e;e=t>y?1:m===y?0:(m-t)/(m-y),R=g-(g-v)*e,M=A-(A-T)*e,P=x-(x-S)*e,D=E-(E-C)*e}let e;e=t<p?0:t>y?1:(p-t)/(p-y),O=d-(d-v)*e,N=b-(b-T)*e,L=w-(w-S)*e,F=_-(_-C)*e;const n=Math.round(Math.min(R,O)),i=Math.round(Math.max(R,O));let r=u*t+4*n;for(let t=n;t<=i;t++)e=(R-t)/(R-O),e<0?e=0:e>1&&(e=1),h[r++]=M-(M-N)*e|0,h[r++]=P-(P-L)*e|0,h[r++]=D-(D-F)*e|0,h[r++]=255}}function Xt(t,e,n){const i=e.coords,r=e.colors;let a,s;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(i.length/o)-1,l=o-1;for(a=0;a<c;a++){let e=a*o;for(let a=0;a<l;a++,e++)Kt(t,n,i[e],i[e+1],i[e+o],r[e],r[e+1],r[e+o]),Kt(t,n,i[e+o+1],i[e+1],i[e+o],r[e+o+1],r[e+1],r[e+o])}break;case"triangles":for(a=0,s=i.length;a<s;a+=3)Kt(t,n,i[a],i[a+1],i[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class Yt extends Gt{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-i,s=Math.ceil(this._bounds[3])-r,o=Math.min(Math.ceil(Math.abs(a*t[0]*1.1)),3e3),c=Math.min(Math.ceil(Math.abs(s*t[1]*1.1)),3e3),l=a/o,h=s/c,u={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/l,scaleY:1/h},f=o+4,d=c+4,p=n.getCanvas("mesh",f,d),g=p.context,m=g.createImageData(o,c);if(e){const t=m.data;for(let n=0,i=t.length;n<i;n+=4)t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=255}for(const t of this._figures)Xt(m,t,u);return g.putImageData(m,2,2),{canvas:p.canvas,offsetX:i-2*l,offsetY:r-2*h,scaleX:l,scaleY:h}}getPattern(t,e,n,i){let r;if($t(t,this._bbox),i===Ht)r=j.singularValueDecompose2dScale(st(t));else if(r=j.singularValueDecompose2dScale(e.baseTransform),this.matrix){const t=j.singularValueDecompose2dScale(this.matrix);r=[r[0]*t[0],r[1]*t[1]]}const a=this._createMeshCanvas(r,i===Ht?null:this._background,e.cachedCanvases);return i!==Ht&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class Qt extends Gt{getPattern(){return"hotpink"}}class Jt{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,i,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:s}=this;let{xstep:o,ystep:c}=this;o=Math.abs(o),c=Math.abs(c),w("TilingType: "+r);const l=e[0],h=e[1],u=e[2],f=e[3],d=u-l,p=f-h,g=j.singularValueDecompose2dScale(this.matrix),m=j.singularValueDecompose2dScale(this.baseTransform),v=g[0]*m[0],y=g[1]*m[1];let b=d,_=p,A=!1,x=!1;const E=Math.ceil(o*v),T=Math.ceil(c*y);E>=Math.ceil(d*v)?b=o:A=!0,T>=Math.ceil(p*y)?_=c:x=!0;const S=this.getSizeAndScale(b,this.ctx.canvas.width,v),C=this.getSizeAndScale(_,this.ctx.canvas.height,y),k=t.cachedCanvases.getCanvas("pattern",S.size,C.size),I=k.context,R=s.createCanvasGraphics(I);if(R.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(R,i,a),I.translate(-S.scale*l,-C.scale*h),R.transform(S.scale,0,0,C.scale,0,0),I.save(),this.clipBbox(R,l,h,u,f),R.baseTransform=st(R.ctx),R.executeOperatorList(n),R.endDrawing(),I.restore(),A||x){const e=k.canvas;A&&(b=o),x&&(_=c);const n=this.getSizeAndScale(b,this.ctx.canvas.width,v),i=this.getSizeAndScale(_,this.ctx.canvas.height,y),r=n.size,a=i.size,s=t.cachedCanvases.getCanvas("pattern-workaround",r,a),u=s.context,f=A?Math.floor(d/o):0,g=x?Math.floor(p/c):0;for(let t=0;t<=f;t++)for(let n=0;n<=g;n++)u.drawImage(e,r*t,a*n,r,a,0,0,r,a);return{canvas:s.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:l,offsetY:h}}return{canvas:k.canvas,scaleX:S.scale,scaleY:C.scale,offsetX:l,offsetY:h}}getSizeAndScale(t,e,n){const i=Math.max(Jt.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*n);return r>=i?r=i:n=r/t,{scale:n,size:r}}clipBbox(t,e,n,i,r){const a=i-e,s=r-n;t.ctx.rect(e,n,a,s),t.current.updateRectMinMax(st(t.ctx),[e,n,i,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,r=t.current;switch(e){case 1:const t=this.ctx;i.fillStyle=t.fillStyle,i.strokeStyle=t.strokeStyle,r.fillColor=t.fillStyle,r.strokeColor=t.strokeStyle;break;case 2:const a=j.makeHexColor(n[0],n[1],n[2]);i.fillStyle=a,i.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new P(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let r=n;i!==Ht&&(r=j.transform(r,e.baseTransform),this.matrix&&(r=j.transform(r,this.matrix)));const a=this.createPatternCanvas(e);let s=new DOMMatrix(r);s=s.translate(a.offsetX,a.offsetY),s=s.scale(1/a.scaleX,1/a.scaleY);const o=t.createPattern(a.canvas,"repeat");return o.setTransform(s),o}}function Zt({src:t,srcPos:e=0,dest:n,width:i,height:r,nonBlackColor:a=4294967295,inverseDecode:s=!1}){const o=F.isLittleEndian?4278190080:255,[c,l]=s?[a,o]:[o,a],h=i>>3,u=7&i,f=t.length;n=new Uint32Array(n.buffer);let d=0;for(let i=0;i<r;i++){for(const i=e+h;e<i;e++){const i=e<f?t[e]:255;n[d++]=128&i?l:c,n[d++]=64&i?l:c,n[d++]=32&i?l:c,n[d++]=16&i?l:c,n[d++]=8&i?l:c,n[d++]=4&i?l:c,n[d++]=2&i?l:c,n[d++]=1&i?l:c}if(0===u)continue;const i=e<f?t[e++]:255;for(let t=0;t<u;t++)n[d++]=i&1<<7-t?l:c}return{srcPos:e,destPos:d}}const te=16;class ee{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return void 0!==this.cache[t]?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function ne(t,e,n,i,r,a,s,o,c,l){const[h,u,f,d,p,g]=st(t);if(0===u&&0===f){const m=s*h+p,v=Math.round(m),y=o*d+g,b=Math.round(y),w=(s+c)*h+p,_=Math.abs(Math.round(w)-v)||1,A=(o+l)*d+g,x=Math.abs(Math.round(A)-b)||1;return t.setTransform(Math.sign(h),0,0,Math.sign(d),v,b),t.drawImage(e,n,i,r,a,0,0,_,x),t.setTransform(h,u,f,d,p,g),[_,x]}if(0===h&&0===d){const m=o*f+p,v=Math.round(m),y=s*u+g,b=Math.round(y),w=(o+l)*f+p,_=Math.abs(Math.round(w)-v)||1,A=(s+c)*u+g,x=Math.abs(Math.round(A)-b)||1;return t.setTransform(0,Math.sign(u),Math.sign(f),0,v,b),t.drawImage(e,n,i,r,a,0,0,x,_),t.setTransform(h,u,f,d,p,g),[x,_]}return t.drawImage(e,n,i,r,a,s,o,c,l),[Math.hypot(h,u)*c,Math.hypot(f,d)*l]}class ie{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=s,this.textMatrixScale=1,this.fontMatrix=o,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=0,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=j.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=j.applyTransform(e,t),i=j.applyTransform(e.slice(2),t),r=j.applyTransform([e[0],e[3]],t),a=j.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,n[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,n[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,n[1],i[1],r[1],a[1])}updateScalingPathMinMax(t,e){j.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,r,a,s,o,c,l){const h=j.bezierBoundingBox(e,n,i,r,a,s,o,c,l);l||this.updateRectMinMax(t,h)}getPathBoundingBox(t=zt,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===qt){e||A("Stroke bounding box must include transform.");const t=j.singularValueDecompose2dScale(e),i=t[0]*this.lineWidth/2,r=t[1]*this.lineWidth/2;n[0]-=i,n[1]-=r,n[2]+=i,n[3]+=r}return n}updateClipFromPath(){const t=j.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=zt,e=null){return j.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function re(t,e){if(e instanceof ImageData)return void t.putImageData(e,0,0);const n=e.height,i=e.width,r=n%te,a=(n-r)/te,s=0===r?a:a+1,o=t.createImageData(i,te);let c,l=0;const h=e.data,u=o.data;let f,p,g,m;if(e.kind===d.GRAYSCALE_1BPP){const e=h.byteLength,n=new Uint32Array(u.buffer,0,u.byteLength>>2),d=n.length,m=i+7>>3,v=4294967295,y=F.isLittleEndian?4278190080:255;for(f=0;f<s;f++){for(g=f<a?te:r,c=0,p=0;p<g;p++){const t=e-l;let r=0;const a=t>m?i:8*t-7,s=-8&a;let o=0,u=0;for(;r<s;r+=8)u=h[l++],n[c++]=128&u?v:y,n[c++]=64&u?v:y,n[c++]=32&u?v:y,n[c++]=16&u?v:y,n[c++]=8&u?v:y,n[c++]=4&u?v:y,n[c++]=2&u?v:y,n[c++]=1&u?v:y;for(;r<a;r++)0===o&&(u=h[l++],o=128),n[c++]=u&o?v:y,o>>=1}for(;c<d;)n[c++]=0;t.putImageData(o,0,f*te)}}else if(e.kind===d.RGBA_32BPP){for(p=0,m=i*te*4,f=0;f<a;f++)u.set(h.subarray(l,l+m)),l+=m,t.putImageData(o,0,p),p+=te;f<s&&(m=i*r*4,u.set(h.subarray(l,l+m)),t.putImageData(o,0,p))}else{if(e.kind!==d.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(g=te,m=i*g,f=0;f<s;f++){for(f>=a&&(g=r,m=i*g),c=0,p=m;p--;)u[c++]=h[l++],u[c++]=h[l++],u[c++]=h[l++],u[c++]=255;t.putImageData(o,0,f*te)}}}function ae(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const n=e.height,i=e.width,r=n%te,a=(n-r)/te,s=0===r?a:a+1,o=t.createImageData(i,te);let c=0;const l=e.data,h=o.data;for(let e=0;e<s;e++){const n=e<a?te:r;({srcPos:c}=Zt({src:l,srcPos:c,dest:h,width:i,height:n,nonBlackColor:0})),t.putImageData(o,0,e*te)}}function se(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==t[i]&&(e[i]=t[i]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function oe(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0),!a){const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}}function ce(t,e){if(e)return!0;const n=j.singularValueDecompose2dScale(t);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*$.PDF_TO_CSS_UNITS);return n[0]<=i&&n[1]<=i}const le=["butt","round","square"],he=["miter","round","bevel"],ue={},fe={};class de{constructor(t,e,n,i,r,{optionalContentConfig:a,markedContentStack:s=null},o,c){this.ctx=t,this.current=new ie(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=s||[],this.optionalContentConfig=a,this.cachedCanvases=new ee(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,s=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=s,n){const t=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...st(this.compositeCtx))}this.ctx.save(),oe(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=st(this.ctx)}executeOperatorList(t,e,n,i){const r=t.argsArray,a=t.fnArray;let s=e||0;const o=r.length;if(o===s)return s;const c=o-s>10&&"function"==typeof n,l=c?Date.now()+15:0;let h=0;const u=this.commonObjs,f=this.objs;let d;for(;;){if(void 0!==i&&s===i.nextBreakPoint)return i.breakIt(s,n),s;if(d=a[s],d!==g.dependency)this[d].apply(this,r[s]);else for(const t of r[s]){const e=t.startsWith("g_")?u:f;if(!e.has(t))return e.get(t,n),s}if(s++,s===o)return s;if(c&&++h>10){if(Date.now()>l)return n(),s;h=0}}}#ln(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#ln(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#hn()}#hn(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let r,a,s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),c=n,l=i,h="prescale1";for(;s>2&&c>1||o>2&&l>1;){let e=c,n=l;s>2&&c>1&&(e=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),s/=c/e),o>2&&l>1&&(n=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/n),r=this.cachedCanvases.getCanvas(h,e,n),a=r.context,a.clearRect(0,0,e,n),a.drawImage(t,0,0,c,l,0,0,e,n),t=r.canvas,c=e,l=n,h="prescale1"===h?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,r=this.current.fillColor,a=this.current.patternFill,s=st(e);let o,c,l,h;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;c=JSON.stringify(a?s:[s.slice(0,4),r]),o=this._cachedBitmapsMap.get(e),o||(o=new Map,this._cachedBitmapsMap.set(e,o));const n=o.get(c);if(n&&!a)return{canvas:n,offsetX:Math.round(Math.min(s[0],s[2])+s[4]),offsetY:Math.round(Math.min(s[1],s[3])+s[5])};l=n}l||(h=this.cachedCanvases.getCanvas("maskCanvas",n,i),ae(h.context,t));let u=j.transform(s,[1/n,0,0,-1/i,0,0]);u=j.transform(u,[1,0,0,1,0,-i]);const[f,d,p,g]=j.getAxialAlignedBoundingBox([0,0,n,i],u),m=Math.round(p-f)||1,v=Math.round(g-d)||1,y=this.cachedCanvases.getCanvas("fillCanvas",m,v),b=y.context,w=f,_=d;b.translate(-w,-_),b.transform(...u),l||(l=this._scaleImage(h.canvas,ot(b)),l=l.img,o&&a&&o.set(c,l)),b.imageSmoothingEnabled=ce(st(b),t.interpolate),ne(b,l,0,0,l.width,l.height,0,0,n,i),b.globalCompositeOperation="source-in";const A=j.transform(ot(b),[1,0,0,1,-w,-_]);return b.fillStyle=a?r.getPattern(e,this,A,zt):r,b.fillRect(0,0,n,i),o&&!a&&(this.cachedCanvases.delete("fillCanvas"),o.set(c,y.canvas)),{canvas:y.canvas,offsetX:Math.round(w),offsetY:Math.round(_)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=le[t]}setLineJoin(t){this.ctx.lineJoin=he[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...st(this.suspendedCtx)),se(this.suspendedCtx,r),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},t.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},t.transform=function(t,n,i,r,a,s){e.transform(t,n,i,r,a,s),this.__originalTransform(t,n,i,r,a,s)},t.setTransform=function(t,n,i,r,a,s){e.setTransform(t,n,i,r,a,s),this.__originalSetTransform(t,n,i,r,a,s)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},t.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},t.bezierCurveTo=function(t,n,i,r,a,s){e.bezierCurveTo(t,n,i,r,a,s),this.__originalBezierCurveTo(t,n,i,r,a,s)},t.rect=function(t,n,i,r){e.rect(t,n,i,r),this.__originalRect(t,n,i,r)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),se(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const r=i[0],a=i[1],s=i[2]-r,o=i[3]-a;0!==s&&0!==o&&(this.genericComposeSMask(e.context,n,s,o,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,r,a,s,o,c,l,h){let u=t.canvas,f=o-l,d=c-h;if(a){const e=j.makeHexColor(...a);if(f<0||d<0||f+n>u.width||d+i>u.height){const t=this.cachedCanvases.getCanvas("maskExtension",n,i),r=t.context;r.drawImage(u,-f,-d),r.globalCompositeOperation="destination-atop",r.fillStyle=e,r.fillRect(0,0,n,i),r.globalCompositeOperation="source-over",u=t.canvas,f=d=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const r=new Path2D;r.rect(f,d,n,i),t.clip(r),t.globalCompositeOperation="destination-atop",t.fillStyle=e,t.fillRect(f,d,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===r&&s?e.filter=this.filterFactory.addAlphaFilter(s):"Luminosity"===r&&(e.filter=this.filterFactory.addLuminosityFilter(s));const p=new Path2D;p.rect(o,c,n,i),e.clip(p),e.globalCompositeOperation="destination-in",e.drawImage(u,f,d,n,i,o,c,n,i),e.restore()}save(){this.inSMaskMode?(se(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),se(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,r,a){this.ctx.transform(t,e,n,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,r=this.current;let a,s,o=r.x,c=r.y;const l=st(i),h=0===l[0]&&0===l[3]||0===l[1]&&0===l[2],u=h?n.slice(0):null;for(let n=0,f=0,d=t.length;n<d;n++)switch(0|t[n]){case g.rectangle:o=e[f++],c=e[f++];const t=e[f++],n=e[f++],d=o+t,p=c+n;i.moveTo(o,c),0===t||0===n?i.lineTo(d,p):(i.lineTo(d,c),i.lineTo(d,p),i.lineTo(o,p)),h||r.updateRectMinMax(l,[o,c,d,p]),i.closePath();break;case g.moveTo:o=e[f++],c=e[f++],i.moveTo(o,c),h||r.updatePathMinMax(l,o,c);break;case g.lineTo:o=e[f++],c=e[f++],i.lineTo(o,c),h||r.updatePathMinMax(l,o,c);break;case g.curveTo:a=o,s=c,o=e[f+4],c=e[f+5],i.bezierCurveTo(e[f],e[f+1],e[f+2],e[f+3],o,c),r.updateCurvePathMinMax(l,a,s,e[f],e[f+1],e[f+2],e[f+3],o,c,u),f+=6;break;case g.curveTo2:a=o,s=c,i.bezierCurveTo(o,c,e[f],e[f+1],e[f+2],e[f+3]),r.updateCurvePathMinMax(l,a,s,o,c,e[f],e[f+1],e[f+2],e[f+3],u),o=e[f+2],c=e[f+3],f+=4;break;case g.curveTo3:a=o,s=c,o=e[f+2],c=e[f+3],i.bezierCurveTo(e[f],e[f+1],o,c,o,c),r.updateCurvePathMinMax(l,a,s,e[f],e[f+1],o,c,o,c,u),f+=4;break;case g.closePath:i.closePath()}h&&r.updateScalingPathMinMax(l,u),r.setCurrentPoint(o,c)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof n&&n?.getPattern?(e.save(),e.strokeStyle=n.getPattern(e,this,ot(e),qt),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor;let i=!1;this.current.patternFill&&(e.save(),e.fillStyle=n.getPattern(e,this,ot(e),zt),i=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),i&&e.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ue}eoClip(){this.pendingClip=fe}beginText(){this.current.textMatrix=s,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0===t)return void e.beginPath();const n=new Path2D,i=e.getTransform().invertSelf();for(const{transform:e,x:r,y:a,fontSize:s,path:o}of t)n.addPath(o,new DOMMatrix(e).preMultiplySelf(i).translate(r,a).scale(s,-s));e.clip(n),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||o,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||_("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const r=n.loadedName||"sans-serif",a=n.systemFontInfo?.css||`"${r}", ${n.fallbackName}`;let s="normal";n.black?s="900":n.bold&&(s="bold");const c=n.italic?"italic":"normal";let l=e;e<16?l=16:e>100&&(l=100),this.current.fontSizeScale=e/l,this.ctx.font=`${c} ${s} ${l}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,r,a){this.current.textMatrix=[t,e,n,i,r,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#un(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i}paintChar(t,e,n,i,r){const a=this.ctx,s=this.current,o=s.font,c=s.textRenderingMode,l=s.fontSize/s.fontSizeScale,h=3&c,u=!!(4&c),f=s.patternFill&&!o.missingFile,d=s.patternStroke&&!o.missingFile;let p;if((o.disableFontFace||u||f||d)&&(p=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||f||d){if(a.save(),a.translate(e,n),a.scale(l,-l),0===h||2===h)if(i){const t=a.getTransform();a.setTransform(...i),a.fill(this.#un(p,t,i))}else a.fill(p);if(1===h||2===h)if(r){const t=a.getTransform();a.setTransform(...r),a.stroke(this.#un(p,t,r))}else a.lineWidth/=l,a.stroke(p);a.restore()}else 0!==h&&2!==h||a.fillText(t,e,n),1!==h&&2!==h||a.strokeText(t,e,n);u&&(this.pendingTextPaths||=[]).push({transform:st(a),x:e,y:n,fontSize:l,path:p})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let t=3;t<e.length;t+=4)if(e[t]>0&&e[t]<255){n=!0;break}return T(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(0===i)return;const r=this.ctx,a=e.fontSizeScale,s=e.charSpacing,o=e.wordSpacing,c=e.fontDirection,l=e.textHScale*c,h=t.length,u=n.vertical,f=u?1:-1,d=n.defaultVMetrics,p=i*e.fontMatrix[0],g=0===e.textRenderingMode&&!n.disableFontFace&&!e.patternFill;let m,v;if(r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),c>0?r.scale(l,-1):r.scale(l,1),e.patternFill){r.save();const t=e.fillColor.getPattern(r,this,ot(r),zt);m=st(r),r.restore(),r.fillStyle=t}if(e.patternStroke){r.save();const t=e.strokeColor.getPattern(r,this,ot(r),qt);v=st(r),r.restore(),r.strokeStyle=t}let y=e.lineWidth;const b=e.textMatrixScale;if(0===b||0===y){const t=3&e.textRenderingMode;1!==t&&2!==t||(y=this.getSinglePixelWidth())}else y/=b;if(1!==a&&(r.scale(a,a),y/=a),r.lineWidth=y,n.isInvalidPDFjsFont){const n=[];let i=0;for(const e of t)n.push(e.unicode),i+=e.width;return r.fillText(n.join(""),0,0),e.x+=i*p*l,r.restore(),void this.compose()}let w,_=0;for(w=0;w<h;++w){const e=t[w];if("number"==typeof e){_+=f*e*i/1e3;continue}let l=!1;const h=(e.isSpace?o:0)+s,y=e.fontChar,b=e.accent;let A,x,E=e.width;if(u){const t=e.vmetric||d,n=-(e.vmetric?t[1]:.5*E)*p,i=t[2]*p;E=t?-t[0]:E,A=n/a,x=(_+i)/a}else A=_/a,x=0;if(n.remeasure&&E>0){const t=1e3*r.measureText(y).width/i*a;if(E<t&&this.isFontSubpixelAAEnabled){const e=E/t;l=!0,r.save(),r.scale(e,1),A/=e}else E!==t&&(A+=(E-t)/2e3*i/a)}if(this.contentVisible&&(e.isInFont||n.missingFile))if(g&&!b)r.fillText(y,A,x);else if(this.paintChar(y,A,x,m,v),b){const t=A+i*b.offset.x/a,e=x-i*b.offset.y/a;this.paintChar(b.fontChar,t,e,m,v)}_+=u?E*p-h*c:E*p+h*c,l&&r.restore()}u?e.y-=_:e.x+=_*l,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,r=n.fontSize,a=n.fontDirection,s=i.vertical?1:-1,c=n.charSpacing,l=n.wordSpacing,h=n.textHScale*a,u=n.fontMatrix||o,f=t.length;let d,p,g,m;if(3!==n.textRenderingMode&&0!==r){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(h,a),d=0;d<f;++d){if(p=t[d],"number"==typeof p){m=s*p*r/1e3,this.ctx.translate(m,0),n.x+=m*h;continue}const a=(p.isSpace?l:0)+c,o=i.charProcOperatorList[p.operatorListId];o?(this.contentVisible&&(this.processingType3=p,this.save(),e.scale(r,r),e.transform(...u),this.executeOperatorList(o),this.restore()),g=j.applyTransform([p.width,0],u)[0]*r+a,e.translate(g,0),n.x+=g*h):_(`Type3 character "${p.operatorListId}" is not available.`)}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,r,a){this.ctx.rect(n,i,r-n,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const n=t[1],i=this.baseTransform||st(this.ctx),r={createCanvasGraphics:t=>new de(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Jt(t,n,this.ctx,r,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=j.makeHexColor(t,e,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=j.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(t){switch(t[0]){case"RadialAxial":return new Wt(t);case"Mesh":return new Yt(t);case"Dummy":return new Qt}throw new Error(`Unknown IR type: ${t[0]}`)}(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,ot(e),Ht);const i=ot(e);if(i){const{width:t,height:n}=e.canvas,[r,a,s,o]=j.getAxialAlignedBoundingBox([0,0,t,n],i);this.ctx.fillRect(r,a,s-r,o-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){A("Should not call beginInlineImage")}beginImageData(){A("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=st(this.ctx),e)){const t=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],t,n),this.current.updateRectMinMax(st(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||w("TODO: Support non-isolated groups."),t.knockout&&_("Knockout groups not supported.");const n=st(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=j.getAxialAlignedBoundingBox(t.bbox,st(e));const r=[0,0,e.canvas.width,e.canvas.height];i=j.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),s=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-a,1),c=Math.max(Math.ceil(i[3])-s,1);this.current.startNewPathAndClipBox([0,0,o,c]);let l="groupAt"+this.groupLevel;t.smask&&(l+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(l,o,c),u=h.context;u.translate(-a,-s),u.transform(...n),t.smask?this.smaskStack.push({canvas:h.canvas,context:u,offsetX:a,offsetY:s,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,s),e.save()),se(e,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=st(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const n=j.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,n,i,r){if(this.#ln(),oe(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const i=e[2]-e[0],a=e[3]-e[1];if(r&&this.annotationCanvasMap){(n=n.slice())[4]-=e[0],n[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=i,e[3]=a;const[r,s]=j.singularValueDecompose2dScale(st(this.ctx)),{viewportScale:o}=this,c=Math.ceil(i*this.outputScaleX*o),l=Math.ceil(a*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(c,l);const{canvas:h,context:u}=this.annotationCanvas;this.annotationCanvasMap.set(t,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=u,this.ctx.save(),this.ctx.setTransform(r,0,0,-s,0,a*s),oe(this.ctx)}else oe(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],i,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new ie(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#hn(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const n=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=function(t){const{width:e,height:n}=t;if(e>1e3||n>1e3)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a,s,o,c=new Uint8Array(r*(n+1));const l=e+7&-8;let h=new Uint8Array(l*n),u=0;for(const e of t.data){let t=128;for(;t>0;)h[u++]=e&t?0:255,t>>=1}let f=0;for(u=0,0!==h[u]&&(c[0]=1,++f),s=1;s<e;s++)h[u]!==h[u+1]&&(c[s]=h[u]?2:1,++f),u++;for(0!==h[u]&&(c[s]=2,++f),a=1;a<n;a++){u=a*l,o=a*r,h[u-l]!==h[u]&&(c[o]=h[u]?1:8,++f);let t=(h[u]?4:0)+(h[u-l]?8:0);for(s=1;s<e;s++)t=(t>>2)+(h[u+1]?4:0)+(h[u-l+1]?8:0),i[t]&&(c[o+s]=i[t],++f),u++;if(h[u-l]!==h[u]&&(c[o+s]=h[u]?2:4,++f),f>1e3)return null}for(u=l*(n-1),o=a*r,0!==h[u]&&(c[o]=8,++f),s=1;s<e;s++)h[u]!==h[u+1]&&(c[o+s]=h[u]?4:8,++f),u++;if(0!==h[u]&&(c[o+s]=4,++f),f>1e3)return null;const d=new Int32Array([0,r,-1,0,-r,0,0,0,1]),p=new Path2D;for(a=0;f&&a<=n;a++){let t=a*r;const n=t+e;for(;t<n&&!c[t];)t++;if(t===n)continue;p.moveTo(t%r,a);const i=t;let s=c[t];do{const e=d[s];do{t+=e}while(!c[t]);const n=c[t];5!==n&&10!==n?(s=n,c[t]=0):(s=n&51*s>>4,c[t]&=s>>2|s<<2),p.lineTo(t%r,t/r|0),c[t]||--f}while(i!==t);--a}return h=null,c=null,function(t){t.save(),t.scale(1/e,-1/n),t.translate(0,-n),t.fill(p),t.beginPath(),t.restore()}}(t)),i.compiled))return void i.compiled(n);const r=this._createMaskCanvas(t),a=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,r.offsetX,r.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,r,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const s=this.ctx;s.save();const o=st(s);s.transform(e,n,i,r,0,0);const c=this._createMaskCanvas(t);s.setTransform(1,0,0,1,c.offsetX-o[4],c.offsetY-o[5]);for(let t=0,l=a.length;t<l;t+=2){const l=j.transform(o,[e,n,i,r,a[t],a[t+1]]),[h,u]=j.applyTransform([0,0],l);s.drawImage(c.canvas,h,u)}s.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const r of t){const{data:t,width:a,height:s,transform:o}=r,c=this.cachedCanvases.getCanvas("maskCanvas",a,s),l=c.context;l.save(),ae(l,this.getObject(t,r)),l.globalCompositeOperation="source-in",l.fillStyle=i?n.getPattern(l,this,ot(e),zt):n,l.fillRect(0,0,a,s),l.restore(),e.save(),e.transform(...o),e.scale(1,-1),ne(e,c.canvas,0,0,a,s,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):_("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const r=this.getObject(t);if(!r)return void _("Dependent image isn't ready yet");const a=r.width,s=r.height,o=[];for(let t=0,r=i.length;t<r;t+=2)o.push({transform:[e,0,0,n,i[t],i[t+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(r,o)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:n,height:i}=t,r=this.cachedCanvases.getCanvas("inlineImage",n,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!a){const{filter:t}=i;"none"!==t&&""!==t&&(i.filter="none")}let r;if(i.scale(1/e,-1/n),t.bitmap)r=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)r=t;else{const i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;re(i,t),r=this.applyTransferMapsToCanvas(i)}const s=this._scaleImage(r,ot(i));i.imageSmoothingEnabled=ce(st(i),t.interpolate),ne(i,s.img,0,0,s.paintWidth,s.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const e=t.width,n=t.height,r=this.cachedCanvases.getCanvas("inlineImage",e,n).context;re(r,t),i=this.applyTransferMapsToCanvas(r)}for(const t of e)n.save(),n.transform(...t.transform),n.scale(1,-1),ne(n,i,t.x,t.y,t.w,t.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===fe?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=st(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:r}=this.ctx.getTransform();let a,s;if(0===n&&0===i){const n=Math.abs(e),i=Math.abs(r);if(n===i)if(0===t)a=s=1/n;else{const e=n*t;a=s=e<1?1/e:1}else if(0===t)a=1/n,s=1/i;else{const e=n*t,r=i*t;a=e<1?1/e:1,s=r<1?1/r:1}}else{const o=Math.abs(e*r-n*i),c=Math.hypot(e,n),l=Math.hypot(i,r);if(0===t)a=l/o,s=c/o;else{const e=t*o;a=l>e?l/e:1,s=c>e?c/e:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=s}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,r]=this.getScaleForStroking();if(e.lineWidth=n||1,1===i&&1===r)return void e.stroke();const a=e.getLineDash();if(t&&e.save(),e.scale(i,r),a.length>0){const t=Math.max(i,r);e.setLineDash(a.map((e=>e/t))),e.lineDashOffset/=t}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const t in g)void 0!==de.prototype[t]&&(de.prototype[g[t]]=de.prototype[t]);class pe{static#fn=null;static#dn="";static get workerPort(){return this.#fn}static set workerPort(t){if(!("undefined"!=typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");this.#fn=t}static get workerSrc(){return this.#dn}static set workerSrc(t){if("string"!=typeof t)throw new Error("Invalid `workerSrc` type.");this.#dn=t}}class ge{#pn;#gn;constructor({parsedData:t,rawData:e}){this.#pn=t,this.#gn=e}getRaw(){return this.#gn}get(t){return this.#pn.get(t)??null}getAll(){return L(this.#pn)}has(t){return this.#pn.has(t)}}const me=Symbol("INTERNAL");class ve{#mn=!1;#vn=!1;#yn=!1;#bn=!0;constructor(t,{name:e,intent:n,usage:i,rbGroups:r}){this.#mn=!!(2&t),this.#vn=!!(4&t),this.name=e,this.intent=n,this.usage=i,this.rbGroups=r}get visible(){if(this.#yn)return this.#bn;if(!this.#bn)return!1;const{print:t,view:e}=this.usage;return this.#mn?"OFF"!==e?.viewState:!this.#vn||"OFF"!==t?.printState}_setVisible(t,e,n=!1){t!==me&&A("Internal method `_setVisible` called."),this.#yn=n,this.#bn=e}}class ye{#wn=null;#_n=new Map;#An=null;#xn=null;constructor(t,e=2){if(this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,this.#xn=t.order;for(const n of t.groups)this.#_n.set(n.id,new ve(e,n));if("OFF"===t.baseState)for(const t of this.#_n.values())t._setVisible(me,!1);for(const e of t.on)this.#_n.get(e)._setVisible(me,!0);for(const e of t.off)this.#_n.get(e)._setVisible(me,!1);this.#An=this.getHash()}}#En(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const e=t[i];let r;if(Array.isArray(e))r=this.#En(e);else{if(!this.#_n.has(e))return _(`Optional content group not found: ${e}`),!0;r=this.#_n.get(e).visible}switch(n){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return"And"===n}isVisible(t){if(0===this.#_n.size)return!0;if(!t)return w("Optional content group not defined."),!0;if("OCG"===t.type)return this.#_n.has(t.id)?this.#_n.get(t.id).visible:(_(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this.#En(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!this.#_n.has(e))return _(`Optional content group not found: ${e}`),!0;if(this.#_n.get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!this.#_n.has(e))return _(`Optional content group not found: ${e}`),!0;if(!this.#_n.get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!this.#_n.has(e))return _(`Optional content group not found: ${e}`),!0;if(!this.#_n.get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!this.#_n.has(e))return _(`Optional content group not found: ${e}`),!0;if(this.#_n.get(e).visible)return!1}return!0}return _(`Unknown optional content policy ${t.policy}.`),!0}return _(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const i=this.#_n.get(t);if(i){if(n&&e&&i.rbGroups.length)for(const e of i.rbGroups)for(const n of e)n!==t&&this.#_n.get(n)?._setVisible(me,!1,!0);i._setVisible(me,!!e,!0),this.#wn=null}else _(`Optional content group not found: ${t}`)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const t=this.#_n.get(i);if(t)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!t.visible,e)}}this.#wn=null}get hasInitialVisibility(){return null===this.#An||this.getHash()===this.#An}getOrder(){return this.#_n.size?this.#xn?this.#xn.slice():[...this.#_n.keys()]:null}getGroups(){return this.#_n.size>0?L(this.#_n):null}getGroup(t){return this.#_n.get(t)||null}getHash(){if(null!==this.#wn)return this.#wn;const t=new St;for(const[e,n]of this.#_n)t.update(`${e}:${n.visible}`);return this.#wn=t.hexdigest()}}class be{constructor(t,{disableRange:e=!1,disableStream:n=!1}){x(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:s}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=s,r?.length>0){const t=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})})),t.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})})),t.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),t.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;void 0===t?this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n):x(this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(n),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){x(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new we(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new _e(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class we{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=Y(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class _e{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Ae(t,e){const n=new Headers;if(!t||!e||"object"!=typeof e)return n;for(const t in e){const i=e[t];void 0!==i&&n.append(t,i)}return n}function xe(t){try{return new URL(t).origin}catch{}return null}function Ee({responseHeaders:t,isHttp:e,rangeChunkSize:n,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(t.get("Content-Length"),10);return Number.isInteger(a)?(r.suggestedLength=a,a<=2*n||i||!e||"bytes"!==t.get("Accept-Ranges")||"identity"!==(t.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r):r}function Te(t){const e=t.get("Content-Disposition");if(e){let t=function(t){let e=!0,n=i("filename\\*","i").exec(t);if(n){n=n[1];let t=s(n);return t=unescape(t),t=o(t),t=c(t),a(t)}if(n=function(t){const e=[];let n;const r=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(t));){let[,t,i,r]=n;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[i,r]}const a=[];for(let t=0;t<e.length&&t in e;++t){let[n,i]=e[t];i=s(i),n&&(i=unescape(i),0===t&&(i=o(i))),a.push(i)}return a.join("")}(t),n)return a(c(n));if(n=i("filename","i").exec(t),n){n=n[1];let t=s(n);return t=c(t),a(t)}function i(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function r(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(t,{fatal:!0}),r=N(n);n=i.decode(r),e=!1}catch{}}return n}function a(t){return e&&/[\x80-\xff]/.test(t)&&(t=r("utf-8",t),e&&(t=r("iso-8859-1",t))),t}function s(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const n=e[t].indexOf('"');-1!==n&&(e[t]=e[t].slice(0,n),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function o(t){const e=t.indexOf("'");return-1===e?t:r(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function c(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,n,i){if("q"===n||"Q"===n)return r(e,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{i=atob(i)}catch{}return r(e,i)}))}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Y(t))return t}return null}function Se(t,e){return 404===t||0===t&&e.startsWith("file:")?new R('Missing PDF "'+e+'".'):new M(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function Ce(t){return 200===t||206===t}function ke(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Ie(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(_(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class Re{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Ae(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return x(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Me(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Pe(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Me{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,ke(n,this._withCredentials,this._abortController)).then((e=>{if(t._responseOrigin=xe(e.url),!Ce(e.status))throw Se(e.status,i);this._reader=e.body.getReader(),this._headersCapability.resolve();const n=e.headers,{allowRangeRequests:r,suggestedLength:a}=Ee({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=Te(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new D("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ie(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Pe{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${n-1}`);const a=i.url;fetch(a,ke(r,this._withCredentials,this._abortController)).then((e=>{const n=xe(e.url);if(n!==t._responseOrigin)throw new Error(`Expected range response-origin "${n}" to match "${t._responseOrigin}".`);if(!Ce(e.status))throw Se(e.status,a);this._readCapability.resolve(),this._reader=e.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ie(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class De{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Ae(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[t,n]of this.headers)e.setRequestHeader(t,n);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=206):i.expectedStatus=200,e.responseType="arraybuffer",x(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===i.status&&this.isHttp)return void n.onError(i.status);const r=i.status||200;if((200!==r||206!==n.expectedStatus)&&r!==n.expectedStatus)return void n.onError(i.status);const a=function(t){const e=t.response;return"string"!=typeof e?e:N(e).buffer}(i);if(206===r){const t=i.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);e?n.onDone({begin:parseInt(e[1],10),chunk:a}):(_('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Oe{constructor(t){this._source=t,this._manager=new De(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return x(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Ne(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new Le(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Ne{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=xe(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map((t=>{const[e,...n]=t.split(": ");return[e,n.join(": ")]})):[]),{allowRangeRequests:r,suggestedLength:a}=Ee({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Te(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Se(t,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Le{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=xe(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Se(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Fe=/^[a-z][a-z0-9\-+.]+:/i;class Ue{constructor(t){this.source=t,this.url=function(t){if(Fe.test(t))return new URL(t);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}(t.url),x("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return x(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new je(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Be(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class je{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then((t=>{this._contentLength=t.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()}),(t=>{"ENOENT"===t.code&&(t=new R(`Missing PDF "${this._url}".`)),this._storedError=t,this._headersCapability.reject(t)}))}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new D("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Be{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}const Ve=30;class ze{#Tn=Promise.withResolvers();#dt=null;#Sn=!1;#Cn=!!globalThis.FontInspector?.enabled;#kn=null;#In=null;#Rn=0;#Mn=0;#Pn=null;#Dn=null;#On=0;#Nn=0;#Ln=Object.create(null);#Fn=[];#Un=null;#jn=[];#Bn=new WeakMap;#Vn=null;static#zn=new Map;static#qn=new Map;static#Hn=new WeakMap;static#$n=null;static#Gn=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#Un=t;else{if("object"!=typeof t)throw new Error('No "textContentSource" parameter specified.');this.#Un=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#dt=this.#Dn=e,this.#Nn=n.scale*(globalThis.devicePixelRatio||1),this.#On=n.rotation,this.#In={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:r,pageX:a,pageY:s}=n.rawDims;this.#Vn=[1,0,0,-1,-a,s+r],this.#Mn=i,this.#Rn=r,ze.#Wn(),ct(e,n),this.#Tn.promise.finally((()=>{ze.#Gn.delete(this),this.#In=null,this.#Ln=null})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=F.platform;return T(this,"fontFamilyMap",new Map([["sans-serif",(t&&e?"Calibri, ":"")+"sans-serif"],["monospace",(t&&e?"Lucida Console, ":"")+"monospace"]]))}render(){const t=()=>{this.#Pn.read().then((({value:e,done:n})=>{n?this.#Tn.resolve():(this.#kn??=e.lang,Object.assign(this.#Ln,e.styles),this.#Kn(e.items),t())}),this.#Tn.reject)};return this.#Pn=this.#Un.getReader(),ze.#Gn.add(this),t(),this.#Tn.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==this.#On&&(e?.(),this.#On=i,ct(this.#Dn,{rotation:i})),n!==this.#Nn){e?.(),this.#Nn=n;const t={div:null,properties:null,ctx:ze.#Xn(this.#kn)};for(const e of this.#jn)t.properties=this.#Bn.get(e),t.div=e,this.#Yn(t)}}cancel(){const t=new D("TextLayer task cancelled.");this.#Pn?.cancel(t).catch((()=>{})),this.#Pn=null,this.#Tn.reject(t)}get textDivs(){return this.#jn}get textContentItemsStr(){return this.#Fn}#Kn(t){if(this.#Sn)return;this.#In.ctx??=ze.#Xn(this.#kn);const e=this.#jn,n=this.#Fn;for(const i of t){if(e.length>1e5)return _("Ignoring additional textDivs for performance reasons."),void(this.#Sn=!0);if(void 0!==i.str)n.push(i.str),this.#Qn(i);else if("beginMarkedContentProps"===i.type||"beginMarkedContent"===i.type){const t=this.#dt;this.#dt=document.createElement("span"),this.#dt.classList.add("markedContent"),null!==i.id&&this.#dt.setAttribute("id",`${i.id}`),t.append(this.#dt)}else"endMarkedContent"===i.type&&(this.#dt=this.#dt.parentNode)}}#Qn(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};this.#jn.push(e);const i=j.transform(this.#Vn,t.transform);let r=Math.atan2(i[1],i[0]);const a=this.#Ln[t.fontName];a.vertical&&(r+=Math.PI/2);let s=this.#Cn&&a.fontSubstitution||a.fontFamily;s=ze.fontFamilyMap.get(s)||s;const o=Math.hypot(i[2],i[3]),c=o*ze.#Jn(s,this.#kn);let l,h;0===r?(l=i[4],h=i[5]-c):(l=i[4]+c*Math.sin(r),h=i[5]-c*Math.cos(r));const u="calc(var(--scale-factor)*",f=e.style;this.#dt===this.#Dn?(f.left=`${(100*l/this.#Mn).toFixed(2)}%`,f.top=`${(100*h/this.#Rn).toFixed(2)}%`):(f.left=`${u}${l.toFixed(2)}px)`,f.top=`${u}${h.toFixed(2)}px)`),f.fontSize=`${u}${(ze.#$n*o).toFixed(2)}px)`,f.fontFamily=s,n.fontSize=o,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#Cn&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),0!==r&&(n.angle=r*(180/Math.PI));let d=!1;if(t.str.length>1)d=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(d=!0)}if(d&&(n.canvasWidth=a.vertical?t.height:t.width),this.#Bn.set(e,n),this.#In.div=e,this.#In.properties=n,this.#Yn(this.#In),n.hasText&&this.#dt.append(e),n.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this.#dt.append(t)}}#Yn(t){const{div:e,properties:n,ctx:i}=t,{style:r}=e;let a="";if(ze.#$n>1&&(a=`scale(${1/ze.#$n})`),0!==n.canvasWidth&&n.hasText){const{fontFamily:t}=r,{canvasWidth:s,fontSize:o}=n;ze.#Zn(i,o*this.#Nn,t);const{width:c}=i.measureText(e.textContent);c>0&&(a=`scaleX(${s*this.#Nn/c}) ${a}`)}0!==n.angle&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(r.transform=a)}static cleanup(){if(!(this.#Gn.size>0)){this.#zn.clear();for(const{canvas:t}of this.#qn.values())t.remove();this.#qn.clear()}}static#Xn(t=null){let e=this.#qn.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#qn.set(t,e),this.#Hn.set(e,{size:0,family:""})}return e}static#Zn(t,e,n){const i=this.#Hn.get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)}static#Wn(){if(null!==this.#$n)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#$n=t.getBoundingClientRect().height,t.remove()}static#Jn(t,e){const n=this.#zn.get(t);if(n)return n;const i=this.#Xn(e);i.canvas.width=i.canvas.height=Ve,this.#Zn(i,Ve,t);const r=i.measureText("");let a=r.fontBoundingBoxAscent,s=Math.abs(r.fontBoundingBoxDescent);if(a){const e=a/(a+s);return this.#zn.set(t,e),i.canvas.width=i.canvas.height=0,e}i.strokeStyle="red",i.clearRect(0,0,Ve,Ve),i.strokeText("g",0,0);let o=i.getImageData(0,0,Ve,Ve).data;s=0;for(let t=o.length-1-3;t>=0;t-=4)if(o[t]>0){s=Math.ceil(t/4/Ve);break}i.clearRect(0,0,Ve,Ve),i.strokeText("A",0,Ve),o=i.getImageData(0,0,Ve,Ve).data,a=0;for(let t=0,e=o.length;t<e;t+=4)if(o[t]>0){a=Ve-Math.floor(t/4/Ve);break}i.canvas.width=i.canvas.height=0;const c=a?a/(a+s):.8;return this.#zn.set(t,c),c}}class qe{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};return function t(n){if(!n)return;let i=null;const r=n.name;if("#text"===r)i=n.value;else{if(!qe.shouldBuildText(r))return;n?.attributes?.textContent?i=n.attributes.textContent:n.value&&(i=n.value)}if(null!==i&&e.push({str:i}),n.children)for(const e of n.children)t(e)}(t),n}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}const He=65536,$e=a?class extends Nt{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire("file:///C:/Users/vinic/Documentos%20(Sem%20OneDrive)/papelaria-sis/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(t,e)}}:class extends Nt{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}},Ge=a?class extends Lt{async _fetch(t){return Vt(t)}}:Ft,We=a?class extends Ut{}:class extends Ut{#ti;#ei;#ni;#ii;#ri;#ai;#b=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#ii=t,this.#ri=e}get#_(){return this.#ei||=new Map}get#si(){return this.#ai||=new Map}get#oi(){if(!this.#ni){const t=this.#ri.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#ri.createElementNS(H,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#ni=this.#ri.createElementNS(H,"defs"),t.append(n),n.append(this.#ni),this.#ri.body.append(t)}return this.#ni}#ci(t){if(1===t.length){const e=t[0],n=new Array(256);for(let t=0;t<256;t++)n[t]=e[t]/255;const i=n.join(",");return[i,i,i]}const[e,n,i]=t,r=new Array(256),a=new Array(256),s=new Array(256);for(let t=0;t<256;t++)r[t]=e[t]/255,a[t]=n[t]/255,s[t]=i[t]/255;return[r.join(","),a.join(","),s.join(",")]}#li(t){if(void 0===this.#ti){this.#ti="";const t=this.#ri.URL;t!==this.#ri.baseURI&&(X(t)?_('#createUrl: ignore "data:"-URL for performance reasons.'):this.#ti=t.split("#",1)[0])}return`url(${this.#ti}#${t})`}addFilter(t){if(!t)return"none";let e=this.#_.get(t);if(e)return e;const[n,i,r]=this.#ci(t),a=1===t.length?n:`${n}${i}${r}`;if(e=this.#_.get(a),e)return this.#_.set(t,e),e;const s=`g_${this.#ii}_transfer_map_${this.#b++}`,o=this.#li(s);this.#_.set(t,o),this.#_.set(a,o);const c=this.#hi(s);return this.#ui(n,i,r,c),o}addHCMFilter(t,e){const n=`${t}-${e}`,i="base";let r=this.#si.get(i);if(r?.key===n)return r.url;if(r?(r.filter?.remove(),r.key=n,r.url="none",r.filter=null):(r={key:n,url:"none",filter:null},this.#si.set(i,r)),!t||!e)return r.url;const a=this.#fi(t);t=j.makeHexColor(...a);const s=this.#fi(e);if(e=j.makeHexColor(...s),this.#oi.style.color="","#000000"===t&&"#ffffff"===e||t===e)return r.url;const o=new Array(256);for(let t=0;t<=255;t++){const e=t/255;o[t]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const c=o.join(","),l=`g_${this.#ii}_hcm_filter`,h=r.filter=this.#hi(l);this.#ui(c,c,c,h),this.#di(h);const u=(t,e)=>{const n=a[t]/255,i=s[t]/255,r=new Array(e+1);for(let t=0;t<=e;t++)r[t]=n+t/e*(i-n);return r.join(",")};return this.#ui(u(0,5),u(1,5),u(2,5),h),r.url=this.#li(l),r.url}addAlphaFilter(t){let e=this.#_.get(t);if(e)return e;const[n]=this.#ci([t]),i=`alpha_${n}`;if(e=this.#_.get(i),e)return this.#_.set(t,e),e;const r=`g_${this.#ii}_alpha_map_${this.#b++}`,a=this.#li(r);this.#_.set(t,a),this.#_.set(i,a);const s=this.#hi(r);return this.#pi(n,s),a}addLuminosityFilter(t){let e,n,i=this.#_.get(t||"luminosity");if(i)return i;if(t?([e]=this.#ci([t]),n=`luminosity_${e}`):n="luminosity",i=this.#_.get(n),i)return this.#_.set(t,i),i;const r=`g_${this.#ii}_luminosity_map_${this.#b++}`,a=this.#li(r);this.#_.set(t,a),this.#_.set(n,a);const s=this.#hi(r);return this.#gi(s),t&&this.#pi(e,s),a}addHighlightHCMFilter(t,e,n,i,r){const a=`${e}-${n}-${i}-${r}`;let s=this.#si.get(t);if(s?.key===a)return s.url;if(s?(s.filter?.remove(),s.key=a,s.url="none",s.filter=null):(s={key:a,url:"none",filter:null},this.#si.set(t,s)),!e||!n)return s.url;const[o,c]=[e,n].map(this.#fi.bind(this));let l=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[u,f]=[i,r].map(this.#fi.bind(this));h<l&&([l,h,u,f]=[h,l,f,u]),this.#oi.style.color="";const d=(t,e,n)=>{const i=new Array(256),r=(h-l)/n,a=t/255,s=(e-t)/(255*n);let o=0;for(let t=0;t<=n;t++){const e=Math.round(l+t*r),n=a+t*s;for(let t=o;t<=e;t++)i[t]=n;o=e+1}for(let t=o;t<256;t++)i[t]=i[o-1];return i.join(",")},p=`g_${this.#ii}_hcm_${t}_filter`,g=s.filter=this.#hi(p);return this.#di(g),this.#ui(d(u[0],f[0],5),d(u[1],f[1],5),d(u[2],f[2],5),g),s.url=this.#li(p),s.url}destroy(t=!1){t&&this.#ai?.size||(this.#ni?.parentNode.parentNode.remove(),this.#ni=null,this.#ei?.clear(),this.#ei=null,this.#ai?.clear(),this.#ai=null,this.#b=0)}#gi(t){const e=this.#ri.createElementNS(H,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#di(t){const e=this.#ri.createElementNS(H,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#hi(t){const e=this.#ri.createElementNS(H,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#oi.append(e),e}#mi(t,e,n){const i=this.#ri.createElementNS(H,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}#ui(t,e,n,i){const r=this.#ri.createElementNS(H,"feComponentTransfer");i.append(r),this.#mi(r,"feFuncR",t),this.#mi(r,"feFuncG",e),this.#mi(r,"feFuncB",n)}#pi(t,e){const n=this.#ri.createElementNS(H,"feComponentTransfer");e.append(n),this.#mi(n,"feFuncA",t)}#fi(t){return this.#oi.style.color=t,at(getComputedStyle(this.#oi).getPropertyValue("color"))}},Ke=a?class extends jt{async _fetch(t){return Vt(t)}}:Bt;function Xe(t={}){"string"==typeof t||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new Qe,{docId:n}=e,i=t.url?function(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(a&&"string"==typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(t.url):null,r=t.data?function(t){if(a&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return N(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"==typeof t&&!isNaN(t?.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(t.data):null,s=t.httpHeaders||null,o=!0===t.withCredentials,c=t.password??null,l=t.range instanceof Je?t.range:null,h=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:He;let u=t.worker instanceof nn?t.worker:null;const f=t.verbosity,d="string"!=typeof t.docBaseUrl||X(t.docBaseUrl)?null:t.docBaseUrl,p="string"==typeof t.cMapUrl?t.cMapUrl:null,g=!1!==t.cMapPacked,m=t.CMapReaderFactory||Ge,v="string"==typeof t.standardFontDataUrl?t.standardFontDataUrl:null,b=t.StandardFontDataFactory||Ke,w=!0!==t.stopAtErrors,_=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,A=!1!==t.isEvalSupported,x="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!a,E="boolean"==typeof t.isImageDecoderSupported?t.isImageDecoderSupported:!a&&(F.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,S="boolean"==typeof t.disableFontFace?t.disableFontFace:a,C=!0===t.fontExtraProperties,k=!0===t.enableXfa,I=t.ownerDocument||globalThis.document,R=!0===t.disableRange,M=!0===t.disableStream,P=!0===t.disableAutoFetch,D=!0===t.pdfBug,O=t.CanvasFactory||$e,L=t.FilterFactory||We,U=!0===t.enableHWA,j=l?l.length:t.length??NaN,B="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!a&&!S,V="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:m===Ft&&b===Bt&&p&&v&&tt(p,document.baseURI)&&tt(v,document.baseURI);y(f);const z={canvasFactory:new O({ownerDocument:I,enableHWA:U}),filterFactory:new L({docId:n,ownerDocument:I}),cMapReaderFactory:V?null:new m({baseUrl:p,isCompressed:g}),standardFontDataFactory:V?null:new b({baseUrl:v})};if(!u){const t={verbosity:f,port:pe.workerPort};u=t.port?nn.fromPort(t):new nn(t),e._worker=u}const q={docId:n,apiVersion:"4.10.38",data:r,password:c,disableAutoFetch:P,rangeChunkSize:h,length:j,docBaseUrl:d,enableXfa:k,evaluatorOptions:{maxImageSize:_,disableFontFace:S,ignoreErrors:w,isEvalSupported:A,isOffscreenCanvasSupported:x,isImageDecoderSupported:E,canvasMaxAreaInBytes:T,fontExtraProperties:C,useSystemFonts:B,cMapUrl:V?p:null,standardFontDataUrl:V?v:null}},H={disableFontFace:S,fontExtraProperties:C,ownerDocument:I,pdfBug:D,styleElement:null,loadingParams:{disableAutoFetch:P,enableXfa:k}};return u.promise.then((function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const t=u.messageHandler.sendWithPromise("GetDocRequest",q,r?[r.buffer]:null);let c;if(l)c=new be(l,{disableRange:R,disableStream:M});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let t;if(a)if(tt(i)){if("undefined"==typeof fetch||"undefined"==typeof Response||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");t=Re}else t=Ue;else t=tt(i)?Re:Oe;c=new t({url:i,length:j,httpHeaders:s,withCredentials:o,rangeChunkSize:h,disableRange:R,disableStream:M})}return t.then((t=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const i=new Ot(n,t,u.port),r=new rn(i,e,c,H,z);e._transport=r,i.send("Ready",null)}))})).catch(e._capability.reject),e}function Ye(t){return"object"==typeof t&&Number.isInteger(t?.num)&&t.num>=0&&Number.isInteger(t?.gen)&&t.gen>=0}class Qe{static#ii=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+Qe.#ii++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}}class Je{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then((()=>{for(const n of this._progressListeners)n(t,e)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const e of this._progressiveReadListeners)e(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){A("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Ze{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return T(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class tn{#vi=null;#yi=!1;constructor(t,e,n,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new Z:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new sn,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}={}){return new W({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return T(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=l.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:s=null,annotationCanvasMap:o=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:u=!1}){this._stats?.time("Overall");const f=this._transport.getRenderingIntent(n,i,h,u),{renderingIntent:d,cacheKey:p}=f;this.#yi=!1,this.#bi(),s||=this._transport.getOptionalContentConfig(d);let g=this._intentStates.get(p);g||(g=Object.create(null),this._intentStates.set(p,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const m=!!(4&d);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));const v=t=>{g.renderTasks.delete(y),(this._maybeCleanupAfterRender||m)&&(this.#yi=!0),this.#wi(!m),t?(y.capability.reject(t),this._abortOperatorList({intentState:g,reason:t instanceof Error?t:new Error(t)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new cn({callback:v,params:{canvasContext:t,viewport:e,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:c});(g.renderTasks||=new Set).add(y);const b=y.task;return Promise.all([g.displayReadyCapability.promise,s]).then((([t,e])=>{if(this.destroyed)v();else{if(this._stats?.time("Rendering"),!(e.renderingIntent&d))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:t,optionalContentConfig:e}),y.operatorListChanged()}})).catch(v),b}getOperatorList({intent:t="display",annotationMode:e=l.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){const r=this._transport.getRenderingIntent(t,e,n,i,!0);let a,s=this._intentStates.get(r.cacheKey);return s||(s=Object.create(null),this._intentStates.set(r.cacheKey,s)),s.opListReadCapability||(a=Object.create(null),a.operatorListChanged=function(){s.operatorList.lastChunk&&(s.opListReadCapability.resolve(s.operatorList),s.renderTasks.delete(a))},s.opListReadCapability=Promise.withResolvers(),(s.renderTasks||=new Set).add(a),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(r)),s.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>qe.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,n){const i=e.getReader(),r={items:[],styles:Object.create(null),lang:null};!function e(){i.read().then((function({value:n,done:i}){i?t(r):(r.lang??=n.lang,Object.assign(r.styles,n.styles),r.items.push(...n.items),e())}),n)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#yi=!1,this.#bi(),Promise.all(t)}cleanup(t=!1){this.#yi=!0;const e=this.#wi(!1);return t&&e&&(this._stats&&=new Z),e}#wi(t=!1){if(this.#bi(),!this.#yi||this.destroyed)return!1;if(t)return this.#vi=setTimeout((()=>{this.#vi=null,this.#wi(!1)}),5e3),!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#yi=!1,!0}#bi(){this.#vi&&(clearTimeout(this.#vi),this.#vi=null)}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const t of e.renderTasks)t.operatorListChanged();t.lastChunk&&this.#wi(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:r,transfer:a}=n,s=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:i},a).getReader(),o=this._intentStates.get(e);o.streamReader=s;const c=()=>{s.read().then((({value:t,done:e})=>{e?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),c())}),(t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();this.#wi(!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}}))};c()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof K){let n=100;return e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})}),n))}}if(t.streamReader.cancel(new D(e.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class en{#_i=new Map;#Ai=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#Ai.then((()=>{for(const[t]of this.#_i)t.call(this,n)}))}addEventListener(t,e,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:r}=n;if(r.aborted)return void _("LoopbackPort - cannot use an `aborted` signal.");const a=()=>this.removeEventListener(t,e);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}this.#_i.set(e,i)}removeEventListener(t,e){const n=this.#_i.get(e);n?.(),this.#_i.delete(e)}terminate(){for(const[,t]of this.#_i)t?.();this.#_i.clear()}}class nn{static#xi=0;static#Ei=!1;static#Ti;static{a&&(this.#Ei=!0,pe.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||"null"===n.origin)return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},this._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}}constructor({name:t=null,port:e=null,verbosity:n=b()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(nn.#Ti?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return(nn.#Ti||=new WeakMap).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return this._readyCapability.promise}#Si(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Ot("main","worker",t),this._messageHandler.on("ready",(function(){})),this.#Si()}_initialize(){if(nn.#Ei||nn.#Ci)return void this._setupFakeWorker();let{workerSrc:t}=nn;try{nn._isSameOrigin(window.location.href,t)||(t=nn._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Ot("main","worker",e),i=()=>{r.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",(()=>{this._webWorker||i()}),{signal:r.signal}),n.on("test",(t=>{r.abort(),!this.destroyed&&t?(this._messageHandler=n,this._port=e,this._webWorker=e,this.#Si()):i()})),n.on("ready",(t=>{if(r.abort(),this.destroyed)i();else try{a()}catch{this._setupFakeWorker()}}));const a=()=>{const t=new Uint8Array;n.send("test",t,[t.buffer])};return void a()}catch{w("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){nn.#Ei||(_("Setting up fake worker."),nn.#Ei=!0),nn._setupFakeWorkerGlobal.then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new en;this._port=e;const n="fake"+nn.#xi++,i=new Ot(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new Ot(n,n+"_worker",e),this.#Si()})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,nn.#Ti?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#Ti?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new nn(t)}static get workerSrc(){if(pe.workerSrc)return pe.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#Ci(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return T(this,"_setupFakeWorkerGlobal",(async()=>this.#Ci?this.#Ci:(await import(this.workerSrc)).WorkerMessageHandler)())}}class rn{#ki=new Map;#Ii=new Map;#Ri=new Map;#Mi=new Map;#Pi=null;constructor(t,e,n,i,r){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new sn,this.fontLoader=new Rt({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#Di(t,e=null){const n=this.#ki.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return this.#ki.set(t,i),i}get annotationStorage(){return T(this,"annotationStorage",new kt)}getRenderingIntent(t,e=l.ENABLE,n=null,i=!1,r=!1){let a=2,s=Ct;switch(t){case"any":a=1;break;case"display":break;case"print":a=4;break;default:_(`getRenderingIntent - invalid intent: ${t}`)}const o=4&a&&n instanceof It?n:this.annotationStorage;switch(e){case l.DISABLE:a+=64;break;case l.ENABLE:break;case l.ENABLE_FORMS:a+=16;break;case l.ENABLE_STORAGE:a+=32,s=o.serializable;break;default:_(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(a+=128),r&&(a+=256);const{ids:c,hash:h}=o.modifiedIds;return{renderingIntent:a,cacheKey:[a,s.hash,h].join("_"),annotationStorageSerializable:s,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#Pi?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const e of this.#Ii.values())t.push(e._destroy());this.#Ii.clear(),this.#Ri.clear(),this.#Mi.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#ki.clear(),this.filterFactory.destroy(),ze.cleanup(),this._networkStream?.cancelAllRequests(new D("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{x(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then((function({value:t,done:n}){n?e.close():(x(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(async t=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:r}=this._fullReader;return n&&i||(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:r}})),t.on("GetRangeReader",((t,e)=>{x(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(t.begin,t.end);n?(e.onPull=()=>{n.read().then((function({value:t,done:n}){n?e.close():(x(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{n.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}):e.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new Ze(t,this))})),t.on("DocException",(t=>{e._capability.reject(Dt(t))})),t.on("PasswordRequest",(t=>{this.#Pi=Promise.withResolvers();try{if(!e.onPassword)throw Dt(t);const n=t=>{t instanceof Error?this.#Pi.reject(t):this.#Pi.resolve({password:t})};e.onPassword(n,t.code)}catch(t){this.#Pi.reject(t)}return this.#Pi.promise})),t.on("DataLoaded",(t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{this.destroyed||this.#Ii.get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(([e,n,i])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(n){case"Font":const{disableFontFace:r,fontExtraProperties:a,pdfBug:s}=this._params;if("error"in i){const t=i.error;_(`Error during font loading: ${t}`),this.commonObjs.resolve(e,t);break}const o=s&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,c=new Mt(i,{disableFontFace:r,fontExtraProperties:a,inspectFont:o});this.fontLoader.bind(c).catch((()=>t.sendWithPromise("FontFallback",{id:e}))).finally((()=>{!a&&c.data&&(c.data=null),this.commonObjs.resolve(e,c)}));break;case"CopyLocalImage":const{imageRef:l}=i;x(l,"The imageRef must be defined.");for(const t of this.#Ii.values())for(const[,n]of t.objs)if(n?.ref===l)return n.dataLen?(this.commonObjs.resolve(e,structuredClone(n)),n.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null})),t.on("obj",(([t,e,n,i])=>{if(this.destroyed)return;const r=this.#Ii.get(e);if(!r.objs.has(t))if(0!==r._intentStates.size)switch(n){case"Image":r.objs.resolve(t,i),i?.dataLen>1e7&&(r._maybeCleanupAfterRender=!0);break;case"Pattern":r.objs.resolve(t,i);break;default:throw new Error(`Got unknown object type ${n}`)}else i?.bitmap?.close()})),t.on("DocProgress",(t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})})),t.on("FetchBuiltInCMap",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(t)})),t.on("FetchStandardFontData",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(t)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&_("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#Ri.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&this.#Mi.set(n.refStr,t);const i=new tn(e,n,this,this._params.pdfBug);return this.#Ii.set(e,i),i}));return this.#Ri.set(e,i),i}getPageIndex(t){return Ye(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#Di("GetFieldObjects")}hasJSActions(){return this.#Di("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#Di("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#Di("GetOptionalContentConfig").then((e=>new ye(e,t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#ki.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then((t=>({info:t[0],metadata:t[1]?new ge(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#ki.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#Ii.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#ki.clear(),this.filterFactory.destroy(!0),ze.cleanup()}}cachedPageNumber(t){if(!Ye(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this.#Mi.get(e)??null}}const an=Symbol("INITIAL_DATA");class sn{#Oi=Object.create(null);#Ni(t){return this.#Oi[t]||={...Promise.withResolvers(),data:an}}get(t,e=null){if(e){const n=this.#Ni(t);return n.promise.then((()=>e(n.data))),null}const n=this.#Oi[t];if(!n||n.data===an)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#Oi[t];return!!e&&e.data!==an}delete(t){const e=this.#Oi[t];return!(!e||e.data===an||(delete this.#Oi[t],0))}resolve(t,e=null){const n=this.#Ni(t);n.data=e,n.resolve()}clear(){for(const t in this.#Oi){const{data:e}=this.#Oi[t];e?.bitmap?.close()}this.#Oi=Object.create(null)}*[Symbol.iterator](){for(const t in this.#Oi){const{data:e}=this.#Oi[t];e!==an&&(yield[t,e])}}}class on{#Li=null;constructor(t){this.#Li=t,this.onContinue=null}get promise(){return this.#Li.capability.promise}cancel(t=0){this.#Li.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#Li.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#Li;return t.form||t.canvas&&e?.size>0}}class cn{#Fi=null;static#Ui=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:s,canvasFactory:o,filterFactory:c,useRequestAnimationFrame:l=!1,pdfBug:h=!1,pageColors:u=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=s,this.canvasFactory=o,this.filterFactory=c,this._pdfBug=h,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===l&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new on(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(cn.#Ui.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");cn.#Ui.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:r,background:a}=this.params;this.gfx=new de(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#Fi&&(window.cancelAnimationFrame(this.#Fi),this.#Fi=null),cn.#Ui.delete(this._canvas),this.callback(t||new K(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#Fi=window.requestAnimationFrame((()=>{this.#Fi=null,this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),cn.#Ui.delete(this._canvas),this.callback())))}}const ln="4.10.38",hn="f9bea397f";function un(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function fn(t){return Math.max(0,Math.min(255,255*t))}class dn{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=fn(t),t,t]}static G_HTML([t]){const e=un(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(fn)}static RGB_HTML(t){return`#${t.map(un).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[fn(1-Math.min(1,t+i)),fn(1-Math.min(1,n+i)),fn(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,r=1-e,a=1-n;return["CMYK",i,r,a,Math.min(i,r,a)]}}class pn{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){A("Abstract method `_createSVG` called.")}}class gn extends pn{_createSVG(t){return document.createElementNS(H,t)}}class mn{static setupStorage(t,e,n,i,r){const a=i.getValue(e,{value:null});switch(n.name){case"textarea":if(null!==a.value&&(t.textContent=a.value),"print"===r)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(a.value===n.attributes.xfaOn?t.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&t.removeAttribute("checked"),"print"===r)break;t.addEventListener("change",(t=>{i.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==a.value&&t.setAttribute("value",a.value),"print"===r)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==a.value){t.setAttribute("value",a.value);for(const t of n.children)t.attributes.value===a.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",(t=>{const n=t.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(e,{value:r})}))}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:r}){const{attributes:a}=e,s=t instanceof HTMLAnchorElement;"radio"===a.type&&(a.name=`${a.name}-${i}`);for(const[e,n]of Object.entries(a))if(null!=n)switch(e){case"class":n.length&&t.setAttribute(e,n.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",n);break;case"style":Object.assign(t.style,n);break;case"textContent":t.textContent=n;break;default:(!s||"href"!==e&&"newWindow"!==e)&&t.setAttribute(e,n)}s&&r.addLinkAttributes(t,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(t,a.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,r=t.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:n});const s="richText"!==r,o=t.div;if(o.append(a),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;o.style.transform=e}s&&o.setAttribute("class","xfaLayer xfaFont");const c=[];if(0===i.children.length){if(i.value){const t=document.createTextNode(i.value);a.append(t),s&&qe.shouldBuildText(i.name)&&c.push(t)}return{textDivs:c}}const l=[[i,-1,a]];for(;l.length>0;){const[t,i,a]=l.at(-1);if(i+1===t.children.length){l.pop();continue}const o=t.children[++l.at(-1)[1]];if(null===o)continue;const{name:h}=o;if("#text"===h){const t=document.createTextNode(o.value);c.push(t),a.append(t);continue}const u=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,h):document.createElement(h);if(a.append(u),o.attributes&&this.setAttributes({html:u,element:o,storage:e,intent:r,linkService:n}),o.children?.length>0)l.push([o,-1,u]);else if(o.value){const t=document.createTextNode(o.value);s&&qe.shouldBuildText(h)&&c.push(t),u.append(t)}}for(const t of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const vn=1e3,yn=new WeakSet;function bn(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class wn{static create(t){switch(t.data.annotationType){case 2:return new An(t);case 1:return new xn(t);case 20:switch(t.data.fieldType){case"Tx":return new Tn(t);case"Btn":return t.data.radioButton?new kn(t):t.data.checkBox?new Cn(t):new In(t);case"Ch":return new Rn(t);case"Sig":return new Sn(t)}return new En(t);case 16:return new Mn(t);case 3:return new Dn(t);case 4:return new On(t);case 5:return new Nn(t);case 6:return new Ln(t);case 8:return new Fn(t);case 14:return new jn(t);case 15:return new Bn(t);case 7:return new Un(t);case 9:return new Vn(t);case 10:return new zn(t);case 11:return new qn(t);case 12:return new Hn(t);case 13:return new $n(t);case 17:return new Gn(t);default:return new _n(t)}}}class _n{#ji=null;#Bi=!1;#Vi=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t?.str||e?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return _n._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#ji||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#zi(e),this.#Vi?.popup.updateEdited(t)}resetEdited(){this.#ji&&(this.#zi(this.#ji.rect),this.#Vi?.popup.resetEdited(),this.#ji=null)}#zi(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:s,pageY:o}}}}=this;n?.splice(0,4,...t);const{width:c,height:l}=bn(t);e.left=100*(t[0]-s)/r+"%",e.top=100*(a-t[3]+o)/a+"%",0===i?(e.width=100*c/r+"%",e.height=100*l/a+"%"):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof En||(r.tabIndex=vn);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Mn){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,r),r}const{width:s,height:o}=bn(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,n=e.borderStyle.verticalCornerRadius;if(t>0||n>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${n}px * var(--scale-factor))`;a.borderRadius=e}else if(this instanceof kn){const t=`calc(${s}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;a.borderRadius=t}switch(e.borderStyle.style){case 1:a.borderStyle="solid";break;case 2:a.borderStyle="dashed";break;case 3:_("Unimplemented border style: beveled");break;case 4:_("Unimplemented border style: inset");break;case 5:a.borderBottomStyle="solid"}const i=e.borderColor||null;i?(this.#Bi=!0,a.borderColor=j.makeHexColor(0|i[0],0|i[1],0|i[2])):a.borderWidth=0}const c=j.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:l,pageHeight:h,pageX:u,pageY:f}=i.rawDims;a.left=100*(c[0]-u)/l+"%",a.top=100*(c[1]-f)/h+"%";const{rotation:d}=e;return e.hasOwnCanvas||0===d?(a.width=100*s/l+"%",a.height=100*o/h+"%"):this.setRotation(d,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=bn(this.data.rect);let s,o;t%180==0?(s=100*r/n,o=100*a/i):(s=100*a/n,o=100*r/i),e.style.width=`${s}%`,e.style.height=`${o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,n)=>{const i=n.detail[t],r=i[0],a=i.slice(1);n.target.style[e]=dn[`${r}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[e]:dn[`${r}_rgb`](a)})};return T(this,"_commonActions",{display:t=>{const{display:e}=t.detail,n=e%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const r=t[i]||n[i];r?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,r]of Object.entries(e)){const a=n[i];a&&(a({detail:{[i]:r},target:t}),delete e[i])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,r]=this.data.rect.map((t=>Math.fround(t)));if(8===t.length){const[a,s,o,c]=t.subarray(2,6);if(i===a&&r===s&&e===o&&n===c)return}const{style:a}=this.container;let s;if(this.#Bi){const{borderColor:t,borderWidth:e}=a;a.borderWidth=0,s=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=i-e,c=r-n,{svgFactory:l}=this,h=l.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const u=l.createElement("defs");h.append(u);const f=l.createElement("clipPath"),d=`clippath_${this.data.id}`;f.setAttribute("id",d),f.setAttribute("clipPathUnits","objectBoundingBox"),u.append(f);for(let n=2,i=t.length;n<i;n+=8){const i=t[n],a=t[n+1],h=t[n+2],u=t[n+3],d=l.createElement("rect"),p=(h-e)/o,g=(r-a)/c,m=(i-h)/o,v=(a-u)/c;d.setAttribute("x",p),d.setAttribute("y",g),d.setAttribute("width",m),d.setAttribute("height",v),f.append(d),s?.push(`<rect vector-effect="non-scaling-stroke" x="${p}" y="${g}" width="${m}" height="${v}"/>`)}this.#Bi&&(s.push("</g></svg>')"),a.backgroundImage=s.join("")),this.container.append(h),this.container.style.clipPath=`url(#${d})`}_createPopup(){const{data:t}=this,e=this.#Vi=new Mn({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){A("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:t,id:r,exportValues:a}of i){if(-1===t)continue;if(r===e)continue;const i="string"==typeof a?a:null,s=document.querySelector(`[data-element-id="${r}"]`);!s||yn.has(s)?n.push({id:r,exportValue:i,domElement:s}):_(`_getElementsByName - element not allowed: ${r}`)}return n}for(const i of document.getElementsByName(t)){const{exportValue:t}=i,r=i.getAttribute("data-element-id");r!==e&&yn.has(i)&&n.push({id:r,exportValue:t,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})}))}}class An extends _n{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action),i=!0):t.attachment?(this.#qi(n,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(this.#Hi(n,t.setOCGState),i=!0):t.dest?(this._bindLink(n,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#$i(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&this.#$i()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#$i()}#qi(t,e,n=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#$i()}#Hi(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#$i()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const r=n.get(i);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}t.onclick||(t.onclick=()=>!1),this.#$i()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#$i(),!this._fieldObjects)return _('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(t.onclick=()=>!1));t.onclick=()=>{n?.();const{fields:t,refs:i,include:r}=e,a=[];if(0!==t.length||0!==i.length){const e=new Set(i);for(const n of t){const t=this._fieldObjects[n]||[];for(const{id:n}of t)e.add(n)}for(const t of Object.values(this._fieldObjects))for(const n of t)e.has(n.id)===r&&a.push(n)}else for(const t of Object.values(this._fieldObjects))a.push(...t);const s=this.annotationStorage,o=[];for(const t of a){const{id:e}=t;switch(o.push(e),t.type){case"text":{const n=t.defaultValue||"";s.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;s.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";s.setValue(e,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${e}"]`);n&&(yn.has(n)?n.dispatchEvent(new Event("resetform")):_(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class xn extends _n{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class En extends _n{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return F.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,r){n.includes("mouse")?t.addEventListener(n,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(n,(t=>{if("blur"===n){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===n){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(t)}})}))}_setEventListeners(t,e,n,i){for(const[r,a]of n)("Action"===a||this.data.actions?.[a])&&("Focus"!==a&&"Blur"!==a||(e||={focused:!1}),this._setEventListener(t,e,r,a,i),"Focus"!==a||this.data.actions?.Blur?"Blur"!==a||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":j.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const{fontColor:e}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,i=t.style;let r;const a=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(c*n))||1);r=Math.min(n,a(e/c))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(n,a(t/c))}i.fontSize=`calc(${r}px * var(--scale-factor))`,i.color=j.makeHexColor(e[0],e[1],e[2]),null!==this.data.textAlignment&&(i.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Tn extends En{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,n,i){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=n),r.setValue(a.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let r=i.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&r.length>a&&(r=r.slice(0,a));let s=i.formattedValue||this.data.textContent?.join("\n")||null;s&&this.data.comb&&(s=s.replaceAll(/\s+/g,""));const o={userValue:r,formattedValue:s,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=s??r,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",s??r),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),yn.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=vn,this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener("input",(i=>{t.setValue(e,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),o.formattedValue=null})),n.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue??"";n.value=o.userValue=e,o.formattedValue=null}));let c=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",(t=>{if(o.focused)return;const{target:e}=t;o.userValue&&(e.value=o.userValue),o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),n.addEventListener("updatefromsandbox",(n=>{this.showElementAndHideCanvas(n.target);const i={value(n){o.userValue=n.detail.value??"",t.setValue(e,{value:o.userValue.toString()}),n.target.value=o.userValue},formattedValue(n){const{formattedValue:i}=n.detail;o.formattedValue=i,null!=i&&n.target!==document.activeElement&&(n.target.value=i),t.setValue(e,{formattedValue:i})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:n=>{const{charLimit:i}=n.detail,{target:r}=n;if(0===i)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",i);let a=o.userValue;!a||a.length<=i||(a=a.slice(0,i),r.value=o.userValue=a,t.setValue(e,{value:a}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:a,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)})),n.addEventListener("keydown",(t=>{o.commitKey=1;let n=-1;if("Escape"===t.key?n=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):n=2,-1===n)return;const{value:i}=t.target;o.lastCommittedValue!==i&&(o.lastCommittedValue=i,o.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,willCommit:!0,commitKey:n,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const i=c;c=null,n.addEventListener("blur",(t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:n}=t.target;o.userValue=n,o.lastCommittedValue!==n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),i(t)})),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",(t=>{o.lastCommittedValue=null;const{data:n,target:i}=t,{value:r,selectionStart:a,selectionEnd:s}=i;let c=a,l=s;switch(t.inputType){case"deleteWordBackward":{const t=r.substring(0,a).match(/\w*[^\w]*$/);t&&(c-=t[0].length);break}case"deleteWordForward":{const t=r.substring(a).match(/^[^\w]*\w*/);t&&(l+=t[0].length);break}case"deleteContentBackward":a===s&&(c-=1);break;case"deleteContentForward":a===s&&(l+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,change:n||"",willCommit:!1,selStart:c,selEnd:l}})})),this._setEventListeners(n,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(c&&n.addEventListener("blur",c),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add("comb"),n.style.letterSpacing=`calc(${t}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Sn extends En{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Cn extends En{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return yn.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=vn,r.addEventListener("change",(i=>{const{name:r,checked:a}=i.target;for(const i of this._getElementsByName(r,n)){const n=a&&i.exportValue===e.exportValue;i.domElement&&(i.domElement.checked=n),t.setValue(i.id,{value:n})}t.setValue(n,{value:a})})),r.addEventListener("resetform",(t=>{const n=e.defaultFieldValue||"Off";t.target.checked=n===e.exportValue})),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",(e=>{const i={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(n,{value:e.target.checked})}};this._dispatchEventFromSandbox(i,e)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class kn extends En{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof i&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const i of this._getElementsByName(e.fieldName,n))t.setValue(i.id,{value:!1});const r=document.createElement("input");if(yn.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=vn,r.addEventListener("change",(e=>{const{name:i,checked:r}=e.target;for(const e of this._getElementsByName(i,n))t.setValue(e.id,{value:!1});t.setValue(n,{value:r})})),r.addEventListener("resetform",(t=>{const n=e.defaultFieldValue;t.target.checked=null!=n&&n===e.buttonValue})),this.enableScripting&&this.hasJSActions){const i=e.buttonValue;r.addEventListener("updatefromsandbox",(e=>{const r={value:e=>{const r=i===e.detail.value;for(const i of this._getElementsByName(e.target.name)){const e=r&&i.id===n;i.domElement&&(i.domElement.checked=e),t.setValue(i.id,{value:e})}}};this._dispatchEventFromSandbox(r,e)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class In extends An{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))),t}}class Rn extends En{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");yn.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=vn;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const t of i.options)t.selected=t.value===e}));for(const t of this.data.options){const e=document.createElement("option");e.textContent=t.displayValue,e.value=t.exportValue,n.value.includes(t.exportValue)&&(e.setAttribute("selected",!0),r=!1),i.append(e)}let a=null;if(r){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),i.prepend(t),a=()=>{t.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const s=t=>{const e=t?"value":"textContent",{options:n,multiple:r}=i;return r?Array.prototype.filter.call(n,(t=>t.selected)).map((t=>t[e])):-1===n.selectedIndex?null:n[n.selectedIndex][e]};let o=s(!1);const c=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(n=>{const r={value(n){a?.();const r=n.detail.value,c=new Set(Array.isArray(r)?r:[r]);for(const t of i.options)t.selected=c.has(t.value);t.setValue(e,{value:s(!0)}),o=s(!1)},multipleSelection(t){i.multiple=!0},remove(n){const r=i.options,a=n.detail.remove;r[a].selected=!1,i.remove(a),r.length>0&&-1===Array.prototype.findIndex.call(r,(t=>t.selected))&&(r[0].selected=!0),t.setValue(e,{value:s(!0),items:c(n)}),o=s(!1)},clear(n){for(;0!==i.length;)i.remove(0);t.setValue(e,{value:null,items:[]}),o=s(!1)},insert(n){const{index:r,displayValue:a,exportValue:l}=n.detail.insert,h=i.children[r],u=document.createElement("option");u.textContent=a,u.value=l,h?h.before(u):i.append(u),t.setValue(e,{value:s(!0),items:c(n)}),o=s(!1)},items(n){const{items:r}=n.detail;for(;0!==i.length;)i.remove(0);for(const t of r){const{displayValue:e,exportValue:n}=t,r=document.createElement("option");r.textContent=e,r.value=n,i.append(r)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:s(!0),items:c(n)}),o=s(!1)},indices(n){const i=new Set(n.detail.indices);for(const t of n.target.options)t.selected=i.has(t.index);t.setValue(e,{value:s(!0)}),o=s(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(r,n)})),i.addEventListener("input",(n=>{const i=s(!0),r=s(!1);t.setValue(e,{value:i}),n.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:r,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))):i.addEventListener("input",(function(n){t.setValue(e,{value:s(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Mn extends _n{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:_n._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Pn({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map((t=>`${q}${t}`)).join(",")),this.container}}class Pn{#Gi=this.#Wi.bind(this);#Ki=this.#Xi.bind(this);#Yi=this.#Qi.bind(this);#Ji=this.#Zi.bind(this);#tr=null;#dt=null;#er=null;#nr=null;#ir=null;#rr=null;#ar=null;#sr=!1;#or=null;#S=null;#cr=null;#lr=null;#hr=null;#ji=null;#ur=!1;constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:r,contentsObj:a,richText:s,parent:o,rect:c,parentRect:l,open:h}){this.#dt=t,this.#hr=i,this.#er=a,this.#lr=s,this.#rr=o,this.#tr=e,this.#cr=c,this.#ar=l,this.#ir=n,this.#nr=it.toDateObject(r),this.trigger=n.flatMap((t=>t.getElementsToTriggerPopup()));for(const t of this.trigger)t.addEventListener("click",this.#Ji),t.addEventListener("mouseenter",this.#Yi),t.addEventListener("mouseleave",this.#Ki),t.classList.add("popupTriggerArea");for(const t of n)t.container?.addEventListener("keydown",this.#Gi);this.#dt.hidden=!0,h&&this.#Zi()}render(){if(this.#or)return;const t=this.#or=document.createElement("div");if(t.className="popup",this.#tr){const e=t.style.outlineColor=j.makeHexColor(...this.#tr);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))t.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;t.style.backgroundColor=j.makeHexColor(...this.#tr.map((t=>Math.floor(e*(255-t)+t))))}}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),({dir:n.dir,str:n.textContent}=this.#hr),t.append(e),this.#nr){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),t.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#nr.valueOf()})),e.append(t)}const i=this.#fr;if(i)mn.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(this.#er);t.append(e)}this.#dt.append(t)}get#fr(){const t=this.#lr,e=this.#er;return!t?.str||e?.str&&e.str!==t.str?null:this.#lr.html||null}get#dr(){return this.#fr?.attributes?.style?.fontSize||0}get#pr(){return this.#fr?.attributes?.style?.color||null}#gr(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#pr,fontSize:this.#dr?`calc(${this.#dr}px * var(--scale-factor))`:""}};for(const n of t.split("\n"))e.push({name:"span",value:n,attributes:i});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let t=0,e=i.length;t<e;++t){const r=i[t];n.append(document.createTextNode(r)),t<e-1&&n.append(document.createElement("br"))}return n}#Wi(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&this.#sr)&&this.#Zi()}updateEdited({rect:t,popupContent:e}){this.#ji||={contentsObj:this.#er,richText:this.#lr},t&&(this.#S=null),e&&(this.#lr=this.#gr(e),this.#er=null),this.#or?.remove(),this.#or=null}resetEdited(){this.#ji&&(({contentsObj:this.#er,richText:this.#lr}=this.#ji),this.#ji=null,this.#or?.remove(),this.#or=null,this.#S=null)}#mr(){if(null!==this.#S)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:r}}}=this.#rr;let a=!!this.#ar,s=a?this.#ar:this.#cr;for(const t of this.#ir)if(!s||null!==j.intersect(t.data.rect,s)){s=t.data.rect,a=!0;break}const o=j.normalizeRect([s[0],t[3]-s[1]+t[1],s[2],t[3]-s[3]+t[1]]),c=a?s[2]-s[0]+5:0,l=o[0]+c,h=o[1];this.#S=[100*(l-i)/e,100*(h-r)/n];const{style:u}=this.#dt;u.left=`${this.#S[0]}%`,u.top=`${this.#S[1]}%`}#Zi(){this.#sr=!this.#sr,this.#sr?(this.#Qi(),this.#dt.addEventListener("click",this.#Ji),this.#dt.addEventListener("keydown",this.#Gi)):(this.#Xi(),this.#dt.removeEventListener("click",this.#Ji),this.#dt.removeEventListener("keydown",this.#Gi))}#Qi(){this.#or||this.render(),this.isVisible?this.#sr&&this.#dt.classList.add("focused"):(this.#mr(),this.#dt.hidden=!1,this.#dt.style.zIndex=parseInt(this.#dt.style.zIndex)+1e3)}#Xi(){this.#dt.classList.remove("focused"),!this.#sr&&this.isVisible&&(this.#dt.hidden=!0,this.#dt.style.zIndex=parseInt(this.#dt.style.zIndex)-1e3)}forceHide(){this.#ur=this.isVisible,this.#ur&&(this.#dt.hidden=!0)}maybeShow(){this.#ur&&(this.#or||this.#Qi(),this.#ur=!1,this.#dt.hidden=!1)}get isVisible(){return!1===this.#dt.hidden}}class Dn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=h.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class On extends _n{#vr=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:n}=bn(t.rect),i=this.svgFactory.create(e,n,!0),r=this.#vr=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#vr}addHighlightArea(){this.container.classList.add("highlightArea")}}class Nn extends _n{#yr=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:n}=bn(t.rect),i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,a=this.#yr=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",n-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#yr}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ln extends _n{#br=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:n}=bn(t.rect),i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,a=this.#br=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",n/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",n/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#br}addHighlightArea(){this.container.classList.add("highlightArea")}}class Fn extends _n{#wr=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i}}=this;if(!e)return this.container;const{width:r,height:a}=bn(t),s=this.svgFactory.create(r,a,!0);let o=[];for(let n=0,i=e.length;n<i;n+=2){const i=e[n]-t[0],r=t[3]-e[n+1];o.push(`${i},${r}`)}o=o.join(" ");const c=this.#wr=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",o),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#wr}addHighlightArea(){this.container.classList.add("highlightArea")}}class Un extends Fn{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class jn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Bn extends _n{#_r=null;#Ar=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?h.HIGHLIGHT:h.INK}#xr(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:i,popupRef:r}}=this,{transform:a,width:s,height:o}=this.#xr(e,t),c=this.svgFactory.create(s,o,!0),l=this.#_r=this.svgFactory.createElement("svg:g");c.append(l),l.setAttribute("stroke-width",i.width||1),l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-linejoin","round"),l.setAttribute("stroke-miterlimit",10),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),l.setAttribute("transform",a);for(let t=0,e=n.length;t<e;t++){const e=this.svgFactory.createElement(this.svgElementName);this.#Ar.push(e),e.setAttribute("points",n[t].join(",")),l.append(e)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:i}=t,r=this.#_r;if(e>=0&&r.setAttribute("stroke-width",e||1),n)for(let t=0,e=this.#Ar.length;t<e;t++)this.#Ar[t].setAttribute("points",n[t].join(","));if(i){const{transform:t,width:e,height:n}=this.#xr(this.data.rotation,i);r.parentElement.setAttribute("viewBox",`0 0 ${e} ${n}`),r.setAttribute("transform",t)}}getElementsToTriggerPopup(){return this.#Ar}addHighlightArea(){this.container.classList.add("highlightArea")}}class Vn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=h.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class zn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Hn extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class $n extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=h.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Gn extends _n{#Er=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||0===e.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),n.addEventListener("dblclick",this.#Tr.bind(this)),this.#Er=n;const{isMac:i}=F.platform;return t.addEventListener("keydown",(t=>{"Enter"===t.key&&(i?t.metaKey:t.ctrlKey)&&this.#Tr()})),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#Er}addHighlightArea(){this.container.classList.add("highlightArea")}#Tr(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Wn{#Sr=null;#Cr=null;#kr=new Map;#Ir=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:s}){this.div=t,this.#Sr=e,this.#Cr=n,this.#Ir=s||null,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#kr.size>0}async#Rr(t,e){const n=t.firstChild||t,i=n.id=`${q}${e}`,r=await(this.#Ir?.getAriaAttributes(i));if(r)for(const[t,e]of r)n.setAttribute(t,e);this.div.append(t),this.#Sr?.moveElementInDOM(this.div,t,n,!1)}async render(t){const{annotations:e}=t,n=this.div;ct(n,this.viewport);const i=new Map,r={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new gn,annotationStorage:t.annotationStorage||new kt,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const t of e){if(t.noHTML)continue;const e=16===t.annotationType;if(e){const e=i.get(t.id);if(!e)continue;r.elements=e}else{const{width:e,height:n}=bn(t.rect);if(e<=0||n<=0)continue}r.data=t;const n=wn.create(r);if(!n.isRenderable)continue;if(!e&&t.popupRef){const e=i.get(t.popupRef);e?e.push(n):i.set(t.popupRef,[n])}const a=n.render();t.hidden&&(a.style.visibility="hidden"),await this.#Rr(a,t.id),n._isEditable&&(this.#kr.set(n.data.id,n),this._annotationEditorUIManager?.renderAnnotationElement(n))}this.#Mr()}update({viewport:t}){const e=this.div;this.viewport=t,ct(e,{rotation:t.rotation}),this.#Mr(),e.hidden=!1}#Mr(){if(!this.#Cr)return;const t=this.div;for(const[e,n]of this.#Cr){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:r}=i;r?"CANVAS"===r.nodeName?r.replaceWith(n):r.classList.contains("annotationContent")?r.after(n):r.before(n):i.append(n)}this.#Cr.clear()}getEditableAnnotations(){return Array.from(this.#kr.values())}getEditableAnnotation(t){return this.#kr.get(t)}}const Kn=/\r\n?|\n/g;class Xn extends _t{#tr;#Pr="";#Dr=`${this.id}-editor`;#Or=null;#dr;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Xn.prototype,e=t=>t.isEmpty(),n=yt.TRANSLATE_SMALL,i=yt.TRANSLATE_BIG;return T(this,"_keyboardManager",new mt([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=h.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#tr=t.color||Xn._defaultColor||_t._defaultLineColor,this.#dr=t.fontSize||Xn._defaultFontSize}static initialize(t,e){_t.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case u.FREETEXT_SIZE:Xn._defaultFontSize=e;break;case u.FREETEXT_COLOR:Xn._defaultColor=e}}updateParams(t,e){switch(t){case u.FREETEXT_SIZE:this.#Nr(e);break;case u.FREETEXT_COLOR:this.#Lr(e)}}static get defaultPropertiesToUpdate(){return[[u.FREETEXT_SIZE,Xn._defaultFontSize],[u.FREETEXT_COLOR,Xn._defaultColor||_t._defaultLineColor]]}get propertiesToUpdate(){return[[u.FREETEXT_SIZE,this.#dr],[u.FREETEXT_COLOR,this.#tr]]}#Nr(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`,this.translate(0,-(t-this.#dr)*this.parentScale),this.#dr=t,this.#Fr()},n=this.#dr;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:u.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#Lr(t){const e=t=>{this.#tr=this.editorDiv.style.color=t},n=this.#tr;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:u.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Xn._internalPadding*t,-(Xn._internalPadding+this.#dr)*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(h.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#Or=new AbortController;const t=this._uiManager.combinedSignal(this.#Or);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#Dr),this._isDraggable=!0,this.#Or?.abort(),this.#Or=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#Ur(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&"BR"===n.nodeName||(t.push(Xn.#jr(n)),e=n);return t.join("\n")}#Fr(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,i=e.style.display,r=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),n=e.getBoundingClientRect(),e.remove(),e.style.display=i,e.classList.toggle("hidden",r)}this.rotation%180==this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#Pr,e=this.#Pr=this.#Ur().trimEnd();if(t===e)return;const n=t=>{this.#Pr=t,t?(this.#Br(),this._uiManager.rebuild(this),this.#Fr()):this.remove()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#Fr()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Xn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#Dr),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#dr}px * var(--scale-factor))`,n.color=this.#tr,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),ft(this,this.div,["dblclick","keydown"]),this.width){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[a,s]=this.getInitialTranslation();[a,s]=this.pageTranslationToScreen(a,s);const[o,c]=this.pageDimensions,[l,h]=this.pageTranslation;let u,f;switch(this.rotation){case 0:u=t+(r[0]-l)/o,f=e+this.height-(r[1]-h)/c;break;case 90:u=t+(r[0]-l)/o,f=e-(r[1]-h)/c,[a,s]=[s,-a];break;case 180:u=t-this.width+(r[0]-l)/o,f=e-(r[1]-h)/c,[a,s]=[-a,-s];break;case 270:u=t+(r[0]-l-this.height*c)/o,f=e+(r[1]-h-this.width*o)/c,[a,s]=[-s,a]}this.setAt(u*n,f*i,a,s)}else this.setAt(t*n,e*i,this.width*n,this.height*i);this.#Br(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#jr(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Kn,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(1===n.length&&"text/plain"===n[0])return;t.preventDefault();const i=Xn.#Vr(e.getData("text")||"").replaceAll(Kn,"\n");if(!i)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!i.includes("\n"))return a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void r.collapseToStart();const{startContainer:s,startOffset:o}=a,c=[],l=[];if(s.nodeType===Node.TEXT_NODE){const t=s.parentElement;if(l.push(s.nodeValue.slice(o).replaceAll(Kn,"")),t!==this.editorDiv){let e=c;for(const n of this.editorDiv.childNodes)n!==t?e.push(Xn.#jr(n)):e=l}c.push(s.nodeValue.slice(0,o).replaceAll(Kn,""))}else if(s===this.editorDiv){let t=c,e=0;for(const n of this.editorDiv.childNodes)e++===o&&(t=l),t.push(Xn.#jr(n))}this.#Pr=`${c.join("\n")}${i}${l.join("\n")}`,this.#Br();const h=new Range;let u=c.reduce(((t,e)=>t+e.length),0);for(const{firstChild:t}of this.editorDiv.childNodes)if(t.nodeType===Node.TEXT_NODE){const e=t.nodeValue.length;if(u<=e){h.setStart(t,u),h.setEnd(t,u);break}u-=e}r.removeAllRanges(),r.addRange(h)}#Br(){if(this.editorDiv.replaceChildren(),this.#Pr)for(const t of this.#Pr.split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#zr(){return this.#Pr.replaceAll(""," ")}static#Vr(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,n){let i=null;if(t instanceof Dn){const{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:r,rotation:a,id:s,popupRef:o},textContent:c,textPosition:l,parent:{page:{pageNumber:u}}}=t;if(!c||0===c.length)return null;i=t={annotationType:h.FREETEXT,color:Array.from(n),fontSize:e,value:c.join("\n"),position:l,pageIndex:u-1,rect:r.slice(0),rotation:a,id:s,deleted:!1,popupRef:o}}const r=await super.deserialize(t,e,n);return r.#dr=t.fontSize,r.#tr=j.makeHexColor(...t.color),r.#Pr=Xn.#Vr(t.value),r.annotationElementId=t.id||null,r._initialData=i,r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Xn._internalPadding*this.parentScale,n=this.getRect(e,e),i=_t._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#tr),r={annotationType:h.FREETEXT,color:i,fontSize:this.#dr,value:this.#zr(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!this.#qr(r)?null:(r.id=this.annotationElementId,r)}#qr(t){const{value:e,fontSize:n,color:i,pageIndex:r}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some(((t,e)=>t!==i[e]))||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:n}=e;n.fontSize=`calc(${this.#dr}px * var(--scale-factor))`,n.color=this.#tr,e.replaceChildren();for(const t of this.#Pr.split("\n")){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),e.append(n)}const i=Xn._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:this.#Pr}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Yn{static PRECISION=1e-4;toSVGPath(){A("Abstract method `toSVGPath` must be implemented.")}get box(){A("Abstract getter `box` must be implemented.")}serialize(t,e){A("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,r,a){a||=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s+=2)a[s]=e+t[s]*i,a[s+1]=n+t[s+1]*r;return a}static _rescaleAndSwap(t,e,n,i,r,a){a||=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s+=2)a[s]=e+t[s+1]*i,a[s+1]=n+t[s]*r;return a}static _translate(t,e,n,i){i||=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r+=2)i[r]=e+t[r],i[r+1]=n+t[r+1];return i}static svgRound(t){return Math.round(1e4*t)}static _normalizePoint(t,e,n,i,r){switch(r){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,r,a){return[(t+5*n)/6,(e+5*i)/6,(5*n+r)/6,(5*i+a)/6,(n+r)/2,(i+a)/2]}}class Qn{#Hr;#$r=[];#Gr;#Wr;#Kr=[];#Xr=new Float32Array(18);#Yr;#Qr;#Jr;#Zr;#ta;#ea;#na=[];static#ia=8;static#ra=2;static#aa=Qn.#ia+Qn.#ra;constructor({x:t,y:e},n,i,r,a,s=0){this.#Hr=n,this.#ea=r*i,this.#Wr=a,this.#Xr.set([NaN,NaN,NaN,NaN,t,e],6),this.#Gr=s,this.#Zr=Qn.#ia*i,this.#Jr=Qn.#aa*i,this.#ta=i,this.#na.push(t,e)}isEmpty(){return isNaN(this.#Xr[8])}#sa(){const t=this.#Xr.subarray(4,6),e=this.#Xr.subarray(16,18),[n,i,r,a]=this.#Hr;return[(this.#Yr+(t[0]-e[0])/2-n)/r,(this.#Qr+(t[1]-e[1])/2-i)/a,(this.#Yr+(e[0]-t[0])/2-n)/r,(this.#Qr+(e[1]-t[1])/2-i)/a]}add({x:t,y:e}){this.#Yr=t,this.#Qr=e;const[n,i,r,a]=this.#Hr;let[s,o,c,l]=this.#Xr.subarray(8,12);const h=t-c,u=e-l,f=Math.hypot(h,u);if(f<this.#Jr)return!1;const d=f-this.#Zr,p=d/f,g=p*h,m=p*u;let v=s,y=o;s=c,o=l,c+=g,l+=m,this.#na?.push(t,e);const b=g/d,w=-m/d*this.#ea,_=b*this.#ea;return this.#Xr.set(this.#Xr.subarray(2,8),0),this.#Xr.set([c+w,l+_],4),this.#Xr.set(this.#Xr.subarray(14,18),12),this.#Xr.set([c-w,l-_],16),isNaN(this.#Xr[6])?(0===this.#Kr.length&&(this.#Xr.set([s+w,o+_],2),this.#Kr.push(NaN,NaN,NaN,NaN,(s+w-n)/r,(o+_-i)/a),this.#Xr.set([s-w,o-_],14),this.#$r.push(NaN,NaN,NaN,NaN,(s-w-n)/r,(o-_-i)/a)),this.#Xr.set([v,y,s,o,c,l],6),!this.isEmpty()):(this.#Xr.set([v,y,s,o,c,l],6),Math.abs(Math.atan2(y-o,v-s)-Math.atan2(m,g))<Math.PI/2?([s,o,c,l]=this.#Xr.subarray(2,6),this.#Kr.push(NaN,NaN,NaN,NaN,((s+c)/2-n)/r,((o+l)/2-i)/a),[s,o,v,y]=this.#Xr.subarray(14,18),this.#$r.push(NaN,NaN,NaN,NaN,((v+s)/2-n)/r,((y+o)/2-i)/a),!0):([v,y,s,o,c,l]=this.#Xr.subarray(0,6),this.#Kr.push(((v+5*s)/6-n)/r,((y+5*o)/6-i)/a,((5*s+c)/6-n)/r,((5*o+l)/6-i)/a,((s+c)/2-n)/r,((o+l)/2-i)/a),[c,l,s,o,v,y]=this.#Xr.subarray(12,18),this.#$r.push(((v+5*s)/6-n)/r,((y+5*o)/6-i)/a,((5*s+c)/6-n)/r,((5*o+l)/6-i)/a,((s+c)/2-n)/r,((o+l)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#Kr,e=this.#$r;if(isNaN(this.#Xr[6])&&!this.isEmpty())return this.#oa();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let e=6;e<t.length;e+=6)isNaN(t[e])?n.push(`L${t[e+4]} ${t[e+5]}`):n.push(`C${t[e]} ${t[e+1]} ${t[e+2]} ${t[e+3]} ${t[e+4]} ${t[e+5]}`);this.#ca(n);for(let t=e.length-6;t>=6;t-=6)isNaN(e[t])?n.push(`L${e[t+4]} ${e[t+5]}`):n.push(`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`);return this.#la(n),n.join(" ")}#oa(){const[t,e,n,i]=this.#Hr,[r,a,s,o]=this.#sa();return`M${(this.#Xr[2]-t)/n} ${(this.#Xr[3]-e)/i} L${(this.#Xr[4]-t)/n} ${(this.#Xr[5]-e)/i} L${r} ${a} L${s} ${o} L${(this.#Xr[16]-t)/n} ${(this.#Xr[17]-e)/i} L${(this.#Xr[14]-t)/n} ${(this.#Xr[15]-e)/i} Z`}#la(t){const e=this.#$r;t.push(`L${e[4]} ${e[5]} Z`)}#ca(t){const[e,n,i,r]=this.#Hr,a=this.#Xr.subarray(4,6),s=this.#Xr.subarray(16,18),[o,c,l,h]=this.#sa();t.push(`L${(a[0]-e)/i} ${(a[1]-n)/r} L${o} ${c} L${l} ${h} L${(s[0]-e)/i} ${(s[1]-n)/r}`)}newFreeDrawOutline(t,e,n,i,r,a){return new Jn(t,e,n,i,r,a)}getOutlines(){const t=this.#Kr,e=this.#$r,n=this.#Xr,[i,r,a,s]=this.#Hr,o=new Float32Array((this.#na?.length??0)+2);for(let t=0,e=o.length-2;t<e;t+=2)o[t]=(this.#na[t]-i)/a,o[t+1]=(this.#na[t+1]-r)/s;if(o[o.length-2]=(this.#Yr-i)/a,o[o.length-1]=(this.#Qr-r)/s,isNaN(n[6])&&!this.isEmpty())return this.#ha(o);const c=new Float32Array(this.#Kr.length+24+this.#$r.length);let l=t.length;for(let e=0;e<l;e+=2)isNaN(t[e])?c[e]=c[e+1]=NaN:(c[e]=t[e],c[e+1]=t[e+1]);l=this.#ua(c,l);for(let t=e.length-6;t>=6;t-=6)for(let n=0;n<6;n+=2)isNaN(e[t+n])?(c[l]=c[l+1]=NaN,l+=2):(c[l]=e[t+n],c[l+1]=e[t+n+1],l+=2);return this.#fa(c,l),this.newFreeDrawOutline(c,o,this.#Hr,this.#ta,this.#Gr,this.#Wr)}#ha(t){const e=this.#Xr,[n,i,r,a]=this.#Hr,[s,o,c,l]=this.#sa(),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(e[2]-n)/r,(e[3]-i)/a,NaN,NaN,NaN,NaN,(e[4]-n)/r,(e[5]-i)/a,NaN,NaN,NaN,NaN,s,o,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,(e[16]-n)/r,(e[17]-i)/a,NaN,NaN,NaN,NaN,(e[14]-n)/r,(e[15]-i)/a],0),this.newFreeDrawOutline(h,t,this.#Hr,this.#ta,this.#Gr,this.#Wr)}#fa(t,e){const n=this.#$r;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+6}#ua(t,e){const n=this.#Xr.subarray(4,6),i=this.#Xr.subarray(16,18),[r,a,s,o]=this.#Hr,[c,l,h,u]=this.#sa();return t.set([NaN,NaN,NaN,NaN,(n[0]-r)/s,(n[1]-a)/o,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,h,u,NaN,NaN,NaN,NaN,(i[0]-r)/s,(i[1]-a)/o],e),e+24}}class Jn extends Yn{#Hr;#da=new Float32Array(4);#Gr;#Wr;#na;#ta;#pa;constructor(t,e,n,i,r,a){super(),this.#pa=t,this.#na=e,this.#Hr=n,this.#ta=i,this.#Gr=r,this.#Wr=a,this.lastPoint=[NaN,NaN],this.#ga(a);const[s,o,c,l]=this.#da;for(let e=0,n=t.length;e<n;e+=2)t[e]=(t[e]-s)/c,t[e+1]=(t[e+1]-o)/l;for(let t=0,n=e.length;t<n;t+=2)e[t]=(e[t]-s)/c,e[t+1]=(e[t+1]-o)/l}toSVGPath(){const t=[`M${this.#pa[4]} ${this.#pa[5]}`];for(let e=6,n=this.#pa.length;e<n;e+=6)isNaN(this.#pa[e])?t.push(`L${this.#pa[e+4]} ${this.#pa[e+5]}`):t.push(`C${this.#pa[e]} ${this.#pa[e+1]} ${this.#pa[e+2]} ${this.#pa[e+3]} ${this.#pa[e+4]} ${this.#pa[e+5]}`);return t.push("Z"),t.join(" ")}serialize([t,e,n,i],r){const a=n-t,s=i-e;let o,c;switch(r){case 0:o=Yn._rescale(this.#pa,t,i,a,-s),c=Yn._rescale(this.#na,t,i,a,-s);break;case 90:o=Yn._rescaleAndSwap(this.#pa,t,e,a,s),c=Yn._rescaleAndSwap(this.#na,t,e,a,s);break;case 180:o=Yn._rescale(this.#pa,n,e,-a,s),c=Yn._rescale(this.#na,n,e,-a,s);break;case 270:o=Yn._rescaleAndSwap(this.#pa,n,i,-a,-s),c=Yn._rescaleAndSwap(this.#na,n,i,-a,-s)}return{outline:Array.from(o),points:[Array.from(c)]}}#ga(t){const e=this.#pa;let n=e[4],i=e[5],r=n,a=i,s=n,o=i,c=n,l=i;const h=t?Math.max:Math.min;for(let t=6,u=e.length;t<u;t+=6){if(isNaN(e[t]))r=Math.min(r,e[t+4]),a=Math.min(a,e[t+5]),s=Math.max(s,e[t+4]),o=Math.max(o,e[t+5]),l<e[t+5]?(c=e[t+4],l=e[t+5]):l===e[t+5]&&(c=h(c,e[t+4]));else{const u=j.bezierBoundingBox(n,i,...e.slice(t,t+6));r=Math.min(r,u[0]),a=Math.min(a,u[1]),s=Math.max(s,u[2]),o=Math.max(o,u[3]),l<u[3]?(c=u[2],l=u[3]):l===u[3]&&(c=h(c,u[2]))}n=e[t+4],i=e[t+5]}const u=this.#da;u[0]=r-this.#Gr,u[1]=a-this.#Gr,u[2]=s-r+2*this.#Gr,u[3]=o-a+2*this.#Gr,this.lastPoint=[c,l]}get box(){return this.#da}newOutliner(t,e,n,i,r,a=0){return new Qn(t,e,n,i,r,a)}getNewOutline(t,e){const[n,i,r,a]=this.#da,[s,o,c,l]=this.#Hr,h=r*c,u=a*l,f=n*c+s,d=i*l+o,p=this.newOutliner({x:this.#na[0]*h+f,y:this.#na[1]*u+d},this.#Hr,this.#ta,t,this.#Wr,e??this.#Gr);for(let t=2;t<this.#na.length;t+=2)p.add({x:this.#na[t]*h+f,y:this.#na[t+1]*u+d});return p.getOutlines()}}class Zn{#Hr;#ma;#va=[];#ya=[];constructor(t,e=0,n=0,i=!0){let r=1/0,a=-1/0,s=1/0,o=-1/0;const c=10**-4;for(const{x:n,y:i,width:l,height:h}of t){const t=Math.floor((n-e)/c)*c,u=Math.ceil((n+l+e)/c)*c,f=Math.floor((i-e)/c)*c,d=Math.ceil((i+h+e)/c)*c,p=[t,f,d,!0],g=[u,f,d,!1];this.#va.push(p,g),r=Math.min(r,t),a=Math.max(a,u),s=Math.min(s,f),o=Math.max(o,d)}const l=a-r+2*n,h=o-s+2*n,u=r-n,f=s-n,d=this.#va.at(i?-1:-2),p=[d[0],d[2]];for(const t of this.#va){const[e,n,i]=t;t[0]=(e-u)/l,t[1]=(n-f)/h,t[2]=(i-f)/h}this.#Hr=new Float32Array([u,f,l,h]),this.#ma=p}getOutlines(){this.#va.sort(((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]));const t=[];for(const e of this.#va)e[3]?(t.push(...this.#ba(e)),this.#wa(e)):(this.#_a(e),t.push(...this.#ba(e)));return this.#Aa(t)}#Aa(t){const e=[],n=new Set;for(const n of t){const[t,i,r]=n;e.push([t,i,n],[t,r,n])}e.sort(((t,e)=>t[1]-e[1]||t[0]-e[0]));for(let t=0,i=e.length;t<i;t+=2){const i=e[t][2],r=e[t+1][2];i.push(r),r.push(i),n.add(i),n.add(r)}const i=[];let r;for(;n.size>0;){const t=n.values().next().value;let[e,a,s,o,c]=t;n.delete(t);let l=e,h=a;for(r=[e,s],i.push(r);;){let t;if(n.has(o))t=o;else{if(!n.has(c))break;t=c}n.delete(t),[e,a,s,o,c]=t,l!==e&&(r.push(l,h,e,h===a?a:s),l=e),h=h===a?s:a}r.push(l,h)}return new ti(i,this.#Hr,this.#ma)}#xa(t){const e=this.#ya;let n=0,i=e.length-1;for(;n<=i;){const r=n+i>>1,a=e[r][0];if(a===t)return r;a<t?n=r+1:i=r-1}return i+1}#wa([,t,e]){const n=this.#xa(t);this.#ya.splice(n,0,[t,e])}#_a([,t,e]){const n=this.#xa(t);for(let i=n;i<this.#ya.length;i++){const[n,r]=this.#ya[i];if(n!==t)break;if(n===t&&r===e)return void this.#ya.splice(i,1)}for(let i=n-1;i>=0;i--){const[n,r]=this.#ya[i];if(n!==t)break;if(n===t&&r===e)return void this.#ya.splice(i,1)}}#ba(t){const[e,n,i]=t,r=[[e,n,i]],a=this.#xa(i);for(let t=0;t<a;t++){const[n,i]=this.#ya[t];for(let t=0,a=r.length;t<a;t++){const[,s,o]=r[t];if(!(i<=s||o<=n))if(s>=n)if(o>i)r[t][1]=i;else{if(1===a)return[];r.splice(t,1),t--,a--}else r[t][2]=n,o>i&&r.push([e,i,o])}}return r}}class ti extends Yn{#Hr;#Ea;constructor(t,e,n){super(),this.#Ea=t,this.#Hr=e,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#Ea){let[n,i]=e;t.push(`M${n} ${i}`);for(let r=2;r<e.length;r+=2){const a=e[r],s=e[r+1];a===n?(t.push(`V${s}`),i=s):s===i&&(t.push(`H${a}`),n=a)}t.push("Z")}return t.join(" ")}serialize([t,e,n,i],r){const a=[],s=n-t,o=i-e;for(const e of this.#Ea){const n=new Array(e.length);for(let r=0;r<e.length;r+=2)n[r]=t+e[r]*s,n[r+1]=i-e[r+1]*o;a.push(n)}return a}get box(){return this.#Hr}get classNamesForOutlining(){return["highlightOutline"]}}class ei extends Qn{newFreeDrawOutline(t,e,n,i,r,a){return new ni(t,e,n,i,r,a)}}class ni extends Jn{newOutliner(t,e,n,i,r,a=0){return new ei(t,e,n,i,r,a)}}class ii{#Ta=null;#Sa=null;#Ca;#ka=null;#Ia=!1;#Ra=!1;#a=null;#Ma;#Pa=null;#g=null;#Da;static#Oa=null;static get _keyboardManager(){return T(this,"_keyboardManager",new mt([[["Escape","mac+Escape"],ii.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ii.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ii.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ii.prototype._moveToPrevious],[["Home","mac+Home"],ii.prototype._moveToBeginning],[["End","mac+End"],ii.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#Ra=!1,this.#Da=u.HIGHLIGHT_COLOR,this.#a=t):(this.#Ra=!0,this.#Da=u.HIGHLIGHT_DEFAULT_COLOR),this.#g=t?._uiManager||e,this.#Ma=this.#g._eventBus,this.#Ca=t?.color||this.#g?.highlightColors.values().next().value||"#FFFF98",ii.#Oa||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#Ta=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#g._signal;t.addEventListener("click",this.#Na.bind(this),{signal:e}),t.addEventListener("keydown",this.#Wi.bind(this),{signal:e});const n=this.#Sa=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#Ca,t.append(n),t}renderMainDropdown(){const t=this.#ka=this.#La();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#La(){const t=document.createElement("div"),e=this.#g._signal;t.addEventListener("contextmenu",et,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of this.#g.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=n,r.setAttribute("data-l10n-id",ii.#Oa[n]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===this.#Ca),r.addEventListener("click",this.#Fa.bind(this,i),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#Wi.bind(this),{signal:e}),t}#Fa(t,e){e.stopPropagation(),this.#Ma.dispatch("switchannotationeditorparams",{source:this,type:this.#Da,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#Ta)return void this.#Na(t);const e=t.target.getAttribute("data-color");e&&this.#Fa(e,t)}_moveToNext(t){this.#Ua?t.target!==this.#Ta?t.target.nextSibling?.focus():this.#ka.firstChild?.focus():this.#Na(t)}_moveToPrevious(t){t.target!==this.#ka?.firstChild&&t.target!==this.#Ta?(this.#Ua||this.#Na(t),t.target.previousSibling?.focus()):this.#Ua&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){this.#Ua?this.#ka.firstChild?.focus():this.#Na(t)}_moveToEnd(t){this.#Ua?this.#ka.lastChild?.focus():this.#Na(t)}#Wi(t){ii._keyboardManager.exec(this,t)}#Na(t){if(this.#Ua)return void this.hideDropdown();if(this.#Ia=0===t.detail,this.#Pa||(this.#Pa=new AbortController,window.addEventListener("pointerdown",this.#l.bind(this),{signal:this.#g.combinedSignal(this.#Pa)})),this.#ka)return void this.#ka.classList.remove("hidden");const e=this.#ka=this.#La();this.#Ta.append(e)}#l(t){this.#ka?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#ka?.classList.add("hidden"),this.#Pa?.abort(),this.#Pa=null}get#Ua(){return this.#ka&&!this.#ka.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#Ra||(this.#Ua?(this.hideDropdown(),this.#Ta.focus({preventScroll:!0,focusVisible:this.#Ia})):this.#a?.unselect())}updateColor(t){if(this.#Sa&&(this.#Sa.style.backgroundColor=t),!this.#ka)return;const e=this.#g.highlightColors.values();for(const n of this.#ka.children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#Ta?.remove(),this.#Ta=null,this.#Sa=null,this.#ka?.remove(),this.#ka=null}}class ri extends _t{#ja=null;#Ba=0;#Va;#za=null;#r=null;#qa=null;#Ha=null;#$a=0;#Ga=null;#Wa=null;#b=null;#Ka=!1;#ma=null;#Xa;#Ya=null;#Qa="";#ea;#Ja="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=h.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ri.prototype;return T(this,"_keyboardManager",new mt([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ri._defaultColor,this.#ea=t.thickness||ri._defaultThickness,this.#Xa=t.opacity||ri._defaultOpacity,this.#Va=t.boxes||null,this.#Ja=t.methodOfCreation||"",this.#Qa=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#Ka=!0,this.#Za(t),this.#ts()):this.#Va&&(this.#ja=t.anchorNode,this.#Ba=t.anchorOffset,this.#Ha=t.focusNode,this.#$a=t.focusOffset,this.#es(),this.#ts(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#Ka?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#ea,methodOfCreation:this.#Ja}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#es(){const t=new Zn(this.#Va,.001);this.#Wa=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#Wa.box;const e=new Zn(this.#Va,.0025,.001,"ltr"===this._uiManager.direction);this.#qa=e.getOutlines();const{lastPoint:n}=this.#qa;this.#ma=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#Za({highlightOutlines:t,highlightId:e,clipPathId:n}){if(this.#Wa=t,this.#qa=t.getNewOutline(this.#ea/2+1.5,.0025),e>=0)this.#b=e,this.#za=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#Ya=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#qa.box,path:{d:this.#qa.toSVGPath()}},!0);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#b,{bbox:ri.#ns(this.#Wa.box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#Ya,{bbox:ri.#ns(this.#qa.box,e),path:{d:this.#qa.toSVGPath()}})}const[i,r,a,s]=t.box;switch(this.rotation){case 0:this.x=i,this.y=r,this.width=a,this.height=s;break;case 90:{const[t,e]=this.parentDimensions;this.x=r,this.y=1-i,this.width=a*e/t,this.height=s*t/e;break}case 180:this.x=1-i,this.y=1-r,this.width=a,this.height=s;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-r,this.y=i,this.width=a*e/t,this.height=s*t/e;break}}const{lastPoint:o}=this.#qa;this.#ma=[(o[0]-i)/a,(o[1]-r)/s]}static initialize(t,e){_t.initialize(t,e),ri._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case u.HIGHLIGHT_DEFAULT_COLOR:ri._defaultColor=e;break;case u.HIGHLIGHT_THICKNESS:ri._defaultThickness=e}}translateInPage(t,e){}get toolbarPosition(){return this.#ma}updateParams(t,e){switch(t){case u.HIGHLIGHT_COLOR:this.#Lr(e);break;case u.HIGHLIGHT_THICKNESS:this.#is(e)}}static get defaultPropertiesToUpdate(){return[[u.HIGHLIGHT_DEFAULT_COLOR,ri._defaultColor],[u.HIGHLIGHT_THICKNESS,ri._defaultThickness]]}get propertiesToUpdate(){return[[u.HIGHLIGHT_COLOR,this.color||ri._defaultColor],[u.HIGHLIGHT_THICKNESS,this.#ea||ri._defaultThickness],[u.HIGHLIGHT_FREE,this.#Ka]]}#Lr(t){const e=(t,e)=>{this.color=t,this.#Xa=e,this.parent?.drawLayer.updateProperties(this.#b,{root:{fill:t,"fill-opacity":e}}),this.#r?.updateColor(t)},n=this.color,i=this.#Xa;this.addCommands({cmd:e.bind(this,t,ri._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:u.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#is(t){const e=this.#ea,n=t=>{this.#ea=t,this.#rs(t)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:u.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#r=new ii({editor:this}),t.addColorPicker(this.#r)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#as())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#as())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#ss(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#ts(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#ss():t&&(this.#ts(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#rs(t){if(!this.#Ka)return;this.#Za({highlightOutlines:this.#Wa.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#ss(){null!==this.#b&&this.parent&&(this.parent.drawLayer.remove(this.#b),this.#b=null,this.parent.drawLayer.remove(this.#Ya),this.#Ya=null)}#ts(t=this.parent){null===this.#b&&(({id:this.#b,clipPathId:this.#za}=t.drawLayer.draw({bbox:this.#Wa.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#Xa},rootClass:{highlight:!0,free:this.#Ka},path:{d:this.#Wa.toSVGPath()}},!1,!0)),this.#Ya=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#Ka},bbox:this.#qa.box,path:{d:this.#qa.toSVGPath()}},this.#Ka),this.#Ga&&(this.#Ga.style.clipPath=this.#za))}static#ns([t,e,n,i],r){switch(r){case 90:return[1-e-i,t,i,n];case 180:return[1-t-n,1-e-i,n,i];case 270:return[e,1-t-n,i,n]}return[t,e,n,i]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#Ka?(t=(t-this.rotation+360)%360,n=ri.#ns(this.#Wa.box,t)):n=ri.#ns([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#b,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#Ya,{bbox:ri.#ns(this.#qa.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#Qa&&(t.setAttribute("aria-label",this.#Qa),t.setAttribute("role","mark")),this.#Ka?t.classList.add("free"):this.div.addEventListener("keydown",this.#os.bind(this),{signal:this._uiManager._signal});const e=this.#Ga=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#za;const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),ft(this,this.#Ga,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Ya,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Ya,{rootClass:{hovered:!1}})}#os(t){ri._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#cs(!0);break;case 1:case 3:this.#cs(!1)}}#cs(t){if(!this.#ja)return;const e=window.getSelection();t?e.setPosition(this.#ja,this.#Ba):e.setPosition(this.#Ha,this.#$a)}select(){super.select(),this.#Ya&&this.parent?.drawLayer.updateProperties(this.#Ya,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#Ya&&(this.parent?.drawLayer.updateProperties(this.#Ya,{rootClass:{selected:!1}}),this.#Ka||this.#cs(!1))}get _mustFixPosition(){return!this.#Ka}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#b,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#Ya,{rootClass:{hidden:!t}}))}#as(){return this.#Ka?this.rotation:0}#ls(){if(this.#Ka)return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,r=this.#Va,a=new Float32Array(8*r.length);let s=0;for(const{x:o,y:c,width:l,height:h}of r){const r=o*t+n,u=(1-c)*e+i;a[s]=a[s+4]=r,a[s+1]=a[s+3]=u,a[s+2]=a[s+6]=r+l*t,a[s+5]=a[s+7]=u-h*e,s+=8}return a}#hs(t){return this.#Wa.serialize(t,this.#as())}static startHighlighting(t,e,{target:n,x:i,y:r}){const{x:a,y:s,width:o,height:c}=n.getBoundingClientRect(),l=new AbortController,h=t.combinedSignal(l),u=e=>{l.abort(),this.#us(t,e)};window.addEventListener("blur",u,{signal:h}),window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("pointerdown",nt,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",et,{signal:h}),n.addEventListener("pointermove",this.#fs.bind(this,t),{signal:h}),this._freeHighlight=new ei({x:i,y:r},[a,s,o,c],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static#fs(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#us(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let i=null;if(t instanceof Vn){const{data:{quadPoints:e,rect:n,rotation:r,id:a,color:s,opacity:o,popupRef:c},parent:{page:{pageNumber:l}}}=t;i=t={annotationType:h.HIGHLIGHT,color:Array.from(s),opacity:o,quadPoints:e,boxes:null,pageIndex:l-1,rect:n.slice(0),rotation:r,id:a,deleted:!1,popupRef:c}}else if(t instanceof Bn){const{data:{inkLists:e,rect:n,rotation:r,id:a,color:s,borderStyle:{rawWidth:o},popupRef:c},parent:{page:{pageNumber:l}}}=t;i=t={annotationType:h.HIGHLIGHT,color:Array.from(s),thickness:o,inkLists:e,boxes:null,pageIndex:l-1,rect:n.slice(0),rotation:r,id:a,deleted:!1,popupRef:c}}const{color:r,quadPoints:a,inkLists:s,opacity:o}=t,c=await super.deserialize(t,e,n);c.color=j.makeHexColor(...r),c.#Xa=o||1,s&&(c.#ea=t.thickness),c.annotationElementId=t.id||null,c._initialData=i;const[l,u]=c.pageDimensions,[f,d]=c.pageTranslation;if(a){const t=c.#Va=[];for(let e=0;e<a.length;e+=8)t.push({x:(a[e]-f)/l,y:1-(a[e+1]-d)/u,width:(a[e+2]-a[e])/l,height:(a[e+1]-a[e+5])/u});c.#es(),c.#ts(),c.rotate(c.rotation)}else if(s){c.#Ka=!0;const t=s[0],n={x:t[0]-f,y:u-(t[1]-d)},i=new ei(n,[0,0,l,u],1,c.#ea/2,!0,.001);for(let e=0,r=t.length;e<r;e+=2)n.x=t[e]-f,n.y=u-(t[e+1]-d),i.add(n);const{id:r,clipPathId:a}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);c.#Za({highlightOutlines:i.getOutlines(),highlightId:r,clipPathId:a}),c.#ts()}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),n=_t._colorManager.convert(this.color),i={annotationType:h.HIGHLIGHT,color:n,opacity:this.#Xa,thickness:this.#ea,quadPoints:this.#ls(),outlines:this.#hs(e),pageIndex:this.pageIndex,rect:e,rotation:this.#as(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#qr(i)?null:(i.id=this.annotationElementId,i)}#qr(t){const{color:e}=this._initialData;return t.color.some(((t,n)=>t!==e[n]))}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class ai{#ds=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))this.updateProperty(e,n)}updateSVGProperty(t,e){this.#ds[t]=e}toSVGProperties(){const t=this.#ds;return this.#ds=Object.create(null),{root:t}}reset(){this.#ds=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){A("Not implemented")}}class si extends _t{#ps=null;#gs;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#ms=null;static#vs=null;static#ys=null;static#bs=NaN;static#ws=null;static#_s=null;static#As=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#gs=t.mustBeCommitted||!1,t.drawOutlines&&(this.#xs(t),this.#ts())}#xs({drawOutlines:t,drawId:e,drawingOptions:n}){this.#ps=t,this._drawingOptions||=n,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#Es(t,this.parent),this.#Ts(t.box)}#Es(t,e){const{id:n}=e.drawLayer.draw(si._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[i,r]of Object.entries(e))n.has(i)?Object.assign(t[i],r):t[i]=r;return t}static getDefaultDrawingOptions(t){A("Not implemented")}static get typesMap(){A("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(si.#ms.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,e[i]]);return t}_updateProperty(t,e,n){const i=this._drawingOptions,r=i[e],a=t=>{i.updateProperty(e,t);const n=this.#ps.updateProperty(e,t);n&&this.#Ts(n),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,si._mergeSVGProperties(this.#ps.getPathResizingSVGProperties(this.#Ss()),{bbox:this.#Cs()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,si._mergeSVGProperties(this.#ps.getPathResizedSVGProperties(this.#Ss()),{bbox:this.#Cs()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#Cs(t,e)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,si._mergeSVGProperties(this.#ps.getPathTranslatedSVGProperties(this.#Ss(),this.parentDimensions),{bbox:this.#Cs()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#gs&&(this.#gs=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#ss(),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#ts(),this.#Ts(this.#ps.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#ss()):t&&(this._uiManager.addShouldRescale(this),this.#ts(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#ss(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#ts(t=this.parent){null!==this._drawId&&this.parent===t||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=this.#Es(this.#ps,t)):this.parent.drawLayer.updateParent(this._drawId,t.drawLayer))}#ks([t,e,n,i]){const{parentDimensions:[r,a],rotation:s}=this;switch(s){case 90:return[e,1-t,n*(a/r),i*(r/a)];case 180:return[1-t,1-e,n,i];case 270:return[1-e,t,n*(a/r),i*(r/a)];default:return[t,e,n,i]}}#Ss(){const{x:t,y:e,width:n,height:i,parentDimensions:[r,a],rotation:s}=this;switch(s){case 90:return[1-e,t,n*(r/a),i*(a/r)];case 180:return[1-t,1-e,n,i];case 270:return[e,1-t,n*(r/a),i*(a/r)];default:return[t,e,n,i]}}#Ts(t){if([this.x,this.y,this.width,this.height]=this.#ks(t),this.div){this.fixAndSetPosition();const[t,e]=this.parentDimensions;this.setDims(this.width*t,this.height*e)}this._onResized()}#Cs(){const{x:t,y:e,width:n,height:i,rotation:r,parentRotation:a,parentDimensions:[s,o]}=this;switch((4*r+a)/90){case 1:return[1-e-i,t,i,n];case 2:return[1-t-n,1-e-i,n,i];case 3:return[e,1-t-n,i,n];case 4:return[t,e-n*(s/o),i*(o/s),n*(s/o)];case 5:return[1-e,t,n*(s/o),i*(o/s)];case 6:return[1-t-i*(o/s),1-e,i*(o/s),n*(s/o)];case 7:return[e-n*(s/o),1-t-i*(o/s),n*(s/o),i*(o/s)];case 8:return[t-n,e-i,n,i];case 9:return[1-e,t-n,i,n];case 10:return[1-t,1-e,n,i];case 11:return[e-i,1-t,i,n];case 12:return[t-i*(o/s),e,i*(o/s),n*(s/o)];case 13:return[1-e-n*(s/o),t-i*(o/s),n*(s/o),i*(o/s)];case 14:return[1-t,1-e-n*(s/o),i*(o/s),n*(s/o)];case 15:return[e,1-t,n*(s/o),i*(o/s)];default:return[t,e,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,si._mergeSVGProperties({bbox:this.#Cs()},this.#ps.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#Ts(this.#ps.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const e=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal";const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,e,n,i,r){A("Not implemented")}static startDrawing(t,e,n,i){const{target:r,offsetX:a,offsetY:s,pointerId:o,pointerType:c}=i;if(si.#ws&&si.#ws!==c)return;const{viewport:{rotation:l}}=t,{width:h,height:u}=r.getBoundingClientRect(),f=si.#vs=new AbortController,d=t.combinedSignal(f);si.#bs||=o,si.#ws??=c,window.addEventListener("pointerup",(t=>{si.#bs===t.pointerId?this._endDraw(t):si.#_s?.delete(t.pointerId)}),{signal:d}),window.addEventListener("pointercancel",(t=>{si.#bs===t.pointerId?this._currentParent.endDrawingSession():si.#_s?.delete(t.pointerId)}),{signal:d}),window.addEventListener("pointerdown",(t=>{si.#ws===t.pointerType&&((si.#_s||=new Set).add(t.pointerId),si.#ms.isCancellable()&&(si.#ms.removeLastElement(),si.#ms.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))}),{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",et,{signal:d}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:d}),r.addEventListener("touchmove",(t=>{t.timeStamp===si.#As&&nt(t)}),{signal:d}),t.toggleDrawing(),e._editorUndoBar?.hide(),si.#ms?t.drawLayer.updateProperties(this._currentDrawId,si.#ms.startNew(a,s,h,u,l)):(e.updateUIForDefaultProperties(this),si.#ms=this.createDrawerInstance(a,s,h,u,l),si.#ys=this.getDefaultDrawingOptions(),this._currentParent=t,({id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(si.#ys.toSVGProperties(),si.#ms.defaultSVGProperties),!0,!1)))}static _drawMove(t){if(si.#As=-1,!si.#ms)return;const{offsetX:e,offsetY:n,pointerId:i}=t;si.#bs===i&&(si.#_s?.size>=1?this._endDraw(t):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,si.#ms.add(e,n)),si.#As=t.timeStamp,nt(t)))}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,si.#ms=null,si.#ys=null,si.#ws=null,si.#As=NaN),si.#vs&&(si.#vs.abort(),si.#vs=null,si.#bs=NaN,si.#_s=null)}static _endDraw(t){const e=this._currentParent;if(e)if(e.toggleDrawing(!0),this._cleanup(!1),t&&e.drawLayer.updateProperties(this._currentDrawId,si.#ms.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const t=si.#ms,n=this._currentDrawId,i=t.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,t.setLastElement(i))},undo:()=>{e.drawLayer.updateProperties(n,t.removeLastElement())},mustExec:!1,type:u.DRAW_STEP})}else this.endDrawing(!1)}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(u.DRAW_STEP),!si.#ms.isEmpty()){const{pageDimensions:[n,i],scale:r}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:si.#ms.getOutlines(n*r,i*r,r,this._INNER_MARGIN),drawingOptions:si.#ys,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,i,r,a){A("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:s}}=e.viewport,o=this.deserializeDraw(a,s,i,r,this._INNER_MARGIN,t),c=await super.deserialize(t,e,n);return c.createDrawingOptions(t),c.#xs({drawOutlines:o}),c.#ts(),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[e,n]=this.pageTranslation,[i,r]=this.pageDimensions;return this.#ps.serialize([e,n,i,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class oi{#Xr=new Float64Array(6);#vr;#Is;#On;#ea;#na;#Rs="";#Ms=0;#Ea=new ci;#Ps;#Ds;constructor(t,e,n,i,r,a){this.#Ps=n,this.#Ds=i,this.#On=r,this.#ea=a,[t,e]=this.#Os(t,e);const s=this.#vr=[NaN,NaN,NaN,NaN,t,e];this.#na=[t,e],this.#Is=[{line:s,points:this.#na}],this.#Xr.set(s,0)}updateProperty(t,e){"stroke-width"===t&&(this.#ea=e)}#Os(t,e){return Yn._normalizePoint(t,e,this.#Ps,this.#Ds,this.#On)}isEmpty(){return!this.#Is||0===this.#Is.length}isCancellable(){return this.#na.length<=10}add(t,e){[t,e]=this.#Os(t,e);const[n,i,r,a]=this.#Xr.subarray(2,6),s=t-r,o=e-a;return Math.hypot(this.#Ps*s,this.#Ds*o)<=2?null:(this.#na.push(t,e),isNaN(n)?(this.#Xr.set([r,a,t,e],2),this.#vr.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#Xr[0])&&this.#vr.splice(6,6),this.#Xr.set([n,i,r,a,t,e],0),this.#vr.push(...Yn.createBezierPoints(n,i,r,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){return this.add(t,e)||(2===this.#na.length?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,r){this.#Ps=n,this.#Ds=i,this.#On=r,[t,e]=this.#Os(t,e);const a=this.#vr=[NaN,NaN,NaN,NaN,t,e];this.#na=[t,e];const s=this.#Is.at(-1);return s&&(s.line=new Float32Array(s.line),s.points=new Float32Array(s.points)),this.#Is.push({line:a,points:this.#na}),this.#Xr.set(a,0),this.#Ms=0,this.toSVGPath(),null}getLastElement(){return this.#Is.at(-1)}setLastElement(t){return this.#Is?(this.#Is.push(t),this.#vr=t.line,this.#na=t.points,this.#Ms=0,{path:{d:this.toSVGPath()}}):this.#Ea.setLastElement(t)}removeLastElement(){if(!this.#Is)return this.#Ea.removeLastElement();this.#Is.pop(),this.#Rs="";for(let t=0,e=this.#Is.length;t<e;t++){const{line:e,points:n}=this.#Is[t];this.#vr=e,this.#na=n,this.#Ms=0,this.toSVGPath()}return{path:{d:this.#Rs}}}toSVGPath(){const t=Yn.svgRound(this.#vr[4]),e=Yn.svgRound(this.#vr[5]);if(2===this.#na.length)return this.#Rs=`${this.#Rs} M ${t} ${e} Z`,this.#Rs;if(this.#na.length<=6){const n=this.#Rs.lastIndexOf("M");this.#Rs=`${this.#Rs.slice(0,n)} M ${t} ${e}`,this.#Ms=6}if(4===this.#na.length){const t=Yn.svgRound(this.#vr[10]),e=Yn.svgRound(this.#vr[11]);return this.#Rs=`${this.#Rs} L ${t} ${e}`,this.#Ms=12,this.#Rs}const n=[];0===this.#Ms&&(n.push(`M ${t} ${e}`),this.#Ms=6);for(let t=this.#Ms,e=this.#vr.length;t<e;t+=6){const[e,i,r,a,s,o]=this.#vr.slice(t,t+6).map(Yn.svgRound);n.push(`C${e} ${i} ${r} ${a} ${s} ${o}`)}return this.#Rs+=n.join(" "),this.#Ms=this.#vr.length,this.#Rs}getOutlines(t,e,n,i){const r=this.#Is.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#Ea.build(this.#Is,t,e,n,this.#On,this.#ea,i),this.#Xr=null,this.#vr=null,this.#Is=null,this.#Rs=null,this.#Ea}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class ci extends Yn{#da;#Ns=0;#Gr;#Is;#Ps;#Ds;#Ls;#On;#ea;build(t,e,n,i,r,a,s){this.#Ps=e,this.#Ds=n,this.#Ls=i,this.#On=r,this.#ea=a,this.#Gr=s??0,this.#Is=t,this.#Fs()}setLastElement(t){return this.#Is.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#Is.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#Is)if(t.push(`M${Yn.svgRound(e[4])} ${Yn.svgRound(e[5])}`),6!==e.length)if(12!==e.length)for(let n=6,i=e.length;n<i;n+=6){const[i,r,a,s,o,c]=e.subarray(n,n+6).map(Yn.svgRound);t.push(`C${i} ${r} ${a} ${s} ${o} ${c}`)}else t.push(`L${Yn.svgRound(e[10])} ${Yn.svgRound(e[11])}`);else t.push("Z");return t.join("")}serialize([t,e,n,i],r){const a=[],s=[],[o,c,l,h]=this.#Us();let u,f,d,p,g,m,v,y,b;switch(this.#On){case 0:b=Yn._rescale,u=t,f=e+i,d=n,p=-i,g=t+o*n,m=e+(1-c-h)*i,v=t+(o+l)*n,y=e+(1-c)*i;break;case 90:b=Yn._rescaleAndSwap,u=t,f=e,d=n,p=i,g=t+c*n,m=e+o*i,v=t+(c+h)*n,y=e+(o+l)*i;break;case 180:b=Yn._rescale,u=t+n,f=e,d=-n,p=i,g=t+(1-o-l)*n,m=e+c*i,v=t+(1-o)*n,y=e+(c+h)*i;break;case 270:b=Yn._rescaleAndSwap,u=t+n,f=e+i,d=-n,p=-i,g=t+(1-c-h)*n,m=e+(1-o-l)*i,v=t+(1-c)*n,y=e+(1-o)*i}for(const{line:t,points:e}of this.#Is)a.push(b(t,u,f,d,p,r?new Array(t.length):null)),s.push(b(e,u,f,d,p,r?new Array(e.length):null));return{lines:a,points:s,rect:[g,m,v,y]}}static deserialize(t,e,n,i,r,{paths:{lines:a,points:s},rotation:o,thickness:c}){const l=[];let h,u,f,d,p;switch(o){case 0:p=Yn._rescale,h=-t/n,u=e/i+1,f=1/n,d=-1/i;break;case 90:p=Yn._rescaleAndSwap,h=-e/i,u=-t/n,f=1/i,d=1/n;break;case 180:p=Yn._rescale,h=t/n+1,u=-e/i,f=-1/n,d=1/i;break;case 270:p=Yn._rescaleAndSwap,h=e/i+1,u=t/n+1,f=-1/i,d=-1/n}if(!a){a=[];for(const t of s){const e=t.length;if(2===e){a.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1]]));continue}if(4===e){a.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1],NaN,NaN,NaN,NaN,t[2],t[3]]));continue}const n=new Float32Array(3*(e-2));a.push(n);let[i,r,s,o]=t.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,r],0);for(let a=4;a<e;a+=2){const e=t[a],c=t[a+1];n.set(Yn.createBezierPoints(i,r,s,o,e,c),3*(a-2)),[i,r,s,o]=[s,o,e,c]}}}for(let t=0,e=a.length;t<e;t++)l.push({line:p(a[t].map((t=>t??NaN)),h,u,f,d),points:p(s[t].map((t=>t??NaN)),h,u,f,d)});const g=new ci;return g.build(l,n,i,1,o,c,r),g}#js(t=this.#ea){const e=this.#Gr+t/2*this.#Ls;return this.#On%180==0?[e/this.#Ps,e/this.#Ds]:[e/this.#Ds,e/this.#Ps]}#Us(){const[t,e,n,i]=this.#da,[r,a]=this.#js(0);return[t+r,e+a,n-2*r,i-2*a]}#Fs(){const t=this.#da=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:e}of this.#Is){if(e.length<=12){for(let n=4,i=e.length;n<i;n+=6){const[i,r]=e.subarray(n,n+2);t[0]=Math.min(t[0],i),t[1]=Math.min(t[1],r),t[2]=Math.max(t[2],i),t[3]=Math.max(t[3],r)}continue}let n=e[4],i=e[5];for(let r=6,a=e.length;r<a;r+=6){const[a,s,o,c,l,h]=e.subarray(r,r+6);j.bezierBoundingBox(n,i,a,s,o,c,l,h,t),n=l,i=h}}const[e,n]=this.#js();t[0]=Math.min(1,Math.max(0,t[0]-e)),t[1]=Math.min(1,Math.max(0,t[1]-n)),t[2]=Math.min(1,Math.max(0,t[2]+e)),t[3]=Math.min(1,Math.max(0,t[3]+n)),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#da}updateProperty(t,e){return"stroke-width"===t?this.#is(e):null}#is(t){const[e,n]=this.#js();this.#ea=t;const[i,r]=this.#js(),[a,s]=[i-e,r-n],o=this.#da;return o[0]-=a,o[1]-=s,o[2]+=2*a,o[3]+=2*s,o}updateParentDimensions([t,e],n){const[i,r]=this.#js();this.#Ps=t,this.#Ds=e,this.#Ls=n;const[a,s]=this.#js(),o=a-i,c=s-r,l=this.#da;return l[0]-=o,l[1]-=c,l[2]+=2*o,l[3]+=2*c,l}updateRotation(t){return this.#Ns=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#da.map(Yn.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#da;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Yn.svgRound(t)} ${Yn.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#da;let n=0,i=0,r=0,a=0,s=0,o=0;switch(this.#Ns){case 90:i=e/t,r=-t/e,s=t;break;case 180:n=-1,a=-1,s=t,o=e;break;case 270:i=-e/t,r=t/e,o=e;break;default:return""}return`matrix(${n} ${i} ${r} ${a} ${Yn.svgRound(s)} ${Yn.svgRound(o)})`}getPathResizingSVGProperties([t,e,n,i]){const[r,a]=this.#js(),[s,o,c,l]=this.#da;if(Math.abs(c-r)<=Yn.PRECISION||Math.abs(l-a)<=Yn.PRECISION){const r=t+n/2-(s+c/2),a=e+i/2-(o+l/2);return{path:{"transform-origin":`${Yn.svgRound(t)} ${Yn.svgRound(e)}`,transform:`${this.rotationTransform} translate(${r} ${a})`}}}const h=(n-2*r)/(c-2*r),u=(i-2*a)/(l-2*a),f=c/n,d=l/i;return{path:{"transform-origin":`${Yn.svgRound(s)} ${Yn.svgRound(o)}`,transform:`${this.rotationTransform} scale(${f} ${d}) translate(${Yn.svgRound(r)} ${Yn.svgRound(a)}) scale(${h} ${u}) translate(${Yn.svgRound(-r)} ${Yn.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,n,i]){const[r,a]=this.#js(),s=this.#da,[o,c,l,h]=s;if(s[0]=t,s[1]=e,s[2]=n,s[3]=i,Math.abs(l-r)<=Yn.PRECISION||Math.abs(h-a)<=Yn.PRECISION){const r=t+n/2-(o+l/2),a=e+i/2-(c+h/2);for(const{line:t,points:e}of this.#Is)Yn._translate(t,r,a,t),Yn._translate(e,r,a,e);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Yn.svgRound(t)} ${Yn.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const u=(n-2*r)/(l-2*r),f=(i-2*a)/(h-2*a),d=-u*(o+r)+t+r,p=-f*(c+a)+e+a;if(1!==u||1!==f||0!==d||0!==p)for(const{line:t,points:e}of this.#Is)Yn._rescale(t,d,p,u,f,t),Yn._rescale(e,d,p,u,f,e);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Yn.svgRound(t)} ${Yn.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[i,r]=n,a=this.#da,s=t-a[0],o=e-a[1];if(this.#Ps===i&&this.#Ds===r)for(const{line:t,points:e}of this.#Is)Yn._translate(t,s,o,t),Yn._translate(e,s,o,e);else{const t=this.#Ps/i,e=this.#Ds/r;this.#Ps=i,this.#Ds=r;for(const{line:n,points:i}of this.#Is)Yn._rescale(n,s,o,t,e,n),Yn._rescale(i,s,o,t,e,i);a[2]*=t,a[3]*=e}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Yn.svgRound(t)} ${Yn.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#da;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Yn.svgRound(t[0])} ${Yn.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class li extends ai{#Bs;constructor(t){super(),this.#Bs=t,super.updateProperties({fill:"none",stroke:_t._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){"stroke-width"===t&&(e??=this["stroke-width"],e*=this.#Bs.realScale),super.updateSVGProperty(t,e)}clone(){const t=new li(this.#Bs);return t.updateAll(this),t}}class hi extends si{static _type="ink";static _editorType=h.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(t,e){_t.initialize(t,e),this._defaultDrawingOptions=new li(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return T(this,"typesMap",new Map([[u.INK_THICKNESS,"stroke-width"],[u.INK_COLOR,"stroke"],[u.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,i,r){return new oi(t,e,n,i,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,i,r,a){return ci.deserialize(t,e,n,i,r,a)}static async deserialize(t,e,n){let i=null;if(t instanceof Bn){const{data:{inkLists:e,rect:n,rotation:r,id:a,color:s,opacity:o,borderStyle:{rawWidth:c},popupRef:l},parent:{page:{pageNumber:u}}}=t;i=t={annotationType:h.INK,color:Array.from(s),thickness:c,opacity:o,paths:{points:e},boxes:null,pageIndex:u-1,rect:n.slice(0),rotation:r,id:a,deleted:!1,popupRef:l}}const r=await super.deserialize(t,e,n);return r.annotationElementId=t.id||null,r._initialData=i,r}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=hi.getDefaultDrawingOptions({stroke:j.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":s}}=this,o={annotationType:h.INK,color:_t._colorManager.convert(r),opacity:a,thickness:s,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!this.#qr(o)?null:(o.id=this.annotationElementId,o)}#qr(t){const{color:e,thickness:n,opacity:i,pageIndex:r}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some(((t,n)=>t!==e[n]))||t.thickness!==n||t.opacity!==i||t.pageIndex!==r}renderAnnotationElement(t){const{points:e,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class ui extends _t{#Vs=null;#zs=null;#qs=null;#Hs=null;#$s=null;#Gs="";#Ws=null;#Ks=null;#Xs=!1;#Ys=!1;static _type="stamp";static _editorType=h.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#Hs=t.bitmapUrl,this.#$s=t.bitmapFile}static initialize(t,e){_t.initialize(t,e)}static get supportedTypes(){return T(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((t=>`image/${t}`)))}static get supportedTypesStr(){return T(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(h.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#Qs(t,e=!1){t?(this.#Vs=t.bitmap,e||(this.#zs=t.id,this.#Xs=t.isSvg),t.file&&(this.#Gs=t.file.name),this.#Js()):this.remove()}#Zs(){if(this.#qs=null,this._uiManager.enableWaiting(!1),this.#Ws){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Vs)return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Vs){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:r,height:a}=t||this.copyCanvas(null,null,!0).imageData,s=await n.guess({name:"altText",request:{data:i,width:r,height:a,channels:i.length/(r*a)}});if(!s)throw new Error("No response from the AI service.");if(s.error)throw new Error("Error from the AI service.");if(s.cancel)return null;if(!s.output)throw new Error("No valid response from the AI service.");const o=s.output;return await this.setGuessedAltText(o),e&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}#to(){if(this.#zs)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#zs).then((t=>this.#Qs(t,!0))).finally((()=>this.#Zs()));if(this.#Hs){const t=this.#Hs;return this.#Hs=null,this._uiManager.enableWaiting(!0),void(this.#qs=this._uiManager.imageManager.getFromUrl(t).then((t=>this.#Qs(t))).finally((()=>this.#Zs())))}if(this.#$s){const t=this.#$s;return this.#$s=null,this._uiManager.enableWaiting(!0),void(this.#qs=this._uiManager.imageManager.getFromFile(t).then((t=>this.#Qs(t))).finally((()=>this.#Zs())))}const t=document.createElement("input");t.type="file",t.accept=ui.supportedTypesStr;const e=this._uiManager._signal;this.#qs=new Promise((n=>{t.addEventListener("change",(async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#Qs(e)}else this.remove();n()}),{signal:e}),t.addEventListener("cancel",(()=>{this.remove(),n()}),{signal:e})})).finally((()=>this.#Zs())),t.click()}remove(){this.#zs&&(this.#Vs=null,this._uiManager.imageManager.deleteId(this.#zs),this.#Ws?.remove(),this.#Ws=null,this.#Ks&&(clearTimeout(this.#Ks),this.#Ks=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#zs&&null===this.#Ws&&this.#to(),this.isAttachedToDOM||this.parent.add(this))):this.#zs&&this.#to()}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#qs||this.#Vs||this.#Hs||this.#$s||this.#zs)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#Vs?this.#Js():this.#to(),this.width&&!this.annotationElementId){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(null!==this.#Ks&&clearTimeout(this.#Ks),this.#Ks=setTimeout((()=>{this.#Ks=null,this.#eo()}),200))}#Js(){const{div:t}=this;let{width:e,height:n}=this.#Vs;const[i,r]=this.pageDimensions,a=.75;if(this.width)e=this.width*i,n=this.height*r;else if(e>a*i||n>a*r){const t=Math.min(a*i/e,a*r/n);e*=t,n*=t}const[s,o]=this.parentDimensions;this.setDims(e*s/i,n*o/r),this._uiManager.enableWaiting(!1);const c=this.#Ws=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=e/i,this.height=n/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),this.#eo(),this.#Ys||(this.parent.addUndoableEditor(this),this.#Ys=!0),this._reportTelemetry({action:"inserted_image"}),this.#Gs&&c.setAttribute("aria-label",this.#Gs)}copyCanvas(t,e,n=!1){t||(t=224);const{width:i,height:r}=this.#Vs,a=new lt;let s=this.#Vs,o=i,c=r,l=null;if(e){if(i>e||r>e){const t=Math.min(e/i,e/r);o=Math.floor(i*t),c=Math.floor(r*t)}l=document.createElement("canvas");const t=l.width=Math.ceil(o*a.sx),n=l.height=Math.ceil(c*a.sy);this.#Xs||(s=this.#no(t,n));const h=l.getContext("2d");h.filter=this._uiManager.hcmFilter;let u="white",f="#cfcfd8";"none"!==this._uiManager.hcmFilter?f="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(u="#8f8f9d",f="#42414d");const d=15,p=d*a.sx,g=d*a.sy,m=new OffscreenCanvas(2*p,2*g),v=m.getContext("2d");v.fillStyle=u,v.fillRect(0,0,2*p,2*g),v.fillStyle=f,v.fillRect(0,0,p,g),v.fillRect(p,g,p,g),h.fillStyle=h.createPattern(m,"repeat"),h.fillRect(0,0,t,n),h.drawImage(s,0,0,s.width,s.height,0,0,t,n)}let h=null;if(n){let e,n;if(a.symmetric&&s.width<t&&s.height<t)e=s.width,n=s.height;else if(s=this.#Vs,i>t||r>t){const a=Math.min(t/i,t/r);e=Math.floor(i*a),n=Math.floor(r*a),this.#Xs||(s=this.#no(e,n))}const o=new OffscreenCanvas(e,n).getContext("2d",{willReadFrequently:!0});o.drawImage(s,0,0,s.width,s.height,0,0,e,n),h={width:e,height:n,data:o.getImageData(0,0,e,n).data}}return{canvas:l,width:o,height:c,imageData:h}}#no(t,e){const{width:n,height:i}=this.#Vs;let r=n,a=i,s=this.#Vs;for(;r>2*t||a>2*e;){const n=r,i=a;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const o=new OffscreenCanvas(r,a);o.getContext("2d").drawImage(s,0,0,n,i,0,0,r,a),s=o.transferToImageBitmap()}return s}#eo(){const[t,e]=this.parentDimensions,{width:n,height:i}=this,r=new lt,a=Math.ceil(n*t*r.sx),s=Math.ceil(i*e*r.sy),o=this.#Ws;if(!o||o.width===a&&o.height===s)return;o.width=a,o.height=s;const c=this.#Xs?this.#Vs:this.#no(a,s),l=o.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(c,0,0,c.width,c.height,0,0,a,s)}getImageForAltText(){return this.#Ws}#io(t){if(t){if(this.#Xs){const t=this._uiManager.imageManager.getSvgUrl(this.#zs);if(t)return t}const t=document.createElement("canvas");return({width:t.width,height:t.height}=this.#Vs),t.getContext("2d").drawImage(this.#Vs,0,0),t.toDataURL()}if(this.#Xs){const[t,e]=this.pageDimensions,n=Math.round(this.width*t*$.PDF_TO_CSS_UNITS),i=Math.round(this.height*e*$.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(n,i);return r.getContext("2d").drawImage(this.#Vs,0,0,this.#Vs.width,this.#Vs.height,0,0,n,i),r.transferToImageBitmap()}return structuredClone(this.#Vs)}static async deserialize(t,e,n){let i=null;if(t instanceof $n){const{data:{rect:r,rotation:a,id:s,structParent:o,popupRef:c},container:l,parent:{page:{pageNumber:u}}}=t,f=l.querySelector("canvas"),d=n.imageManager.getFromCanvas(l.id,f);f.remove();const p=(await e._structTree.getAriaAttributes(`${q}${s}`))?.get("aria-label")||"";i=t={annotationType:h.STAMP,bitmapId:d.id,bitmap:d.bitmap,pageIndex:u-1,rect:r.slice(0),rotation:a,id:s,deleted:!1,accessibilityData:{decorative:!1,altText:p},isSvg:!1,structParent:o,popupRef:c}}const r=await super.deserialize(t,e,n),{rect:a,bitmap:s,bitmapUrl:o,bitmapId:c,isSvg:l,accessibilityData:u}=t;c&&n.imageManager.isValidId(c)?(r.#zs=c,s&&(r.#Vs=s)):r.#Hs=o,r.#Xs=l;const[f,d]=r.pageDimensions;return r.width=(a[2]-a[0])/f,r.height=(a[3]-a[1])/d,r.annotationElementId=t.id||null,u&&(r.altTextData=u),r._initialData=i,r.#Ys=!!i,r}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:h.STAMP,bitmapId:this.#zs,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Xs,structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=this.#io(!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:i,altText:r}=this.serializeAltText(!1);if(!i&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const t=this.#qr(n);if(t.isSame)return null;t.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,null===e)return n;e.stamps||=new Map;const a=this.#Xs?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(e.stamps.has(this.#zs)){if(this.#Xs){const t=e.stamps.get(this.#zs);a>t.area&&(t.area=a,t.serialized.bitmap.close(),t.serialized.bitmap=this.#io(!1))}}else e.stamps.set(this.#zs,{area:a,serialized:n}),n.bitmap=this.#io(!1);return n}#qr(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,i=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&r,isSameAltText:r}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class fi{#Sr;#ro=!1;#ao=null;#so=null;#oo=null;#co=new Map;#lo=!1;#ho=!1;#uo=!1;#fo=null;#do=null;#po=null;#go=null;#g;static _initialized=!1;static#V=new Map([Xn,hi,ui,ri].map((t=>[t._editorType,t])));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:s,textLayer:o,viewport:c,l10n:l}){const h=[...fi.#V.values()];if(!fi._initialized){fi._initialized=!0;for(const e of h)e.initialize(l,t)}t.registerEditorTypes(h),this.#g=t,this.pageIndex=e,this.div=n,this.#Sr=r,this.#ao=a,this.viewport=c,this.#po=o,this.drawLayer=s,this._structTree=i,this.#g.addLayer(this)}get isEmpty(){return 0===this.#co.size}get isInvisible(){return this.isEmpty&&this.#g.getMode()===h.NONE}updateToolbar(t){this.#g.updateToolbar(t)}updateMode(t=this.#g.getMode()){switch(this.#mo(),t){case h.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case h.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case h.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of fi.#V.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#po?.div}setEditingState(t){this.#g.setEditingState(t)}addCommands(t){this.#g.addCommands(t)}cleanUndoStack(t){this.#g.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#ao?.div.classList.toggle("disabled",!t)}async enable(){this.#uo=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const e of this.#co.values())e.enableEditing(),e.show(!0),e.annotationElementId&&(this.#g.removeChangedExistingAnnotation(e),t.add(e.annotationElementId));if(!this.#ao)return void(this.#uo=!1);const e=this.#ao.getEditableAnnotations();for(const n of e){if(n.hide(),this.#g.isDeletedAnnotationElement(n.data.id))continue;if(t.has(n.data.id))continue;const e=await this.deserialize(n);e&&(this.addOrRebuild(e),e.enableEditing())}this.#uo=!1}disable(){this.#ho=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#co.values())n.disableEditing(),n.annotationElementId&&(null===n.serialize()?(e.set(n.annotationElementId,n),this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()):t.set(n.annotationElementId,n));if(this.#ao){const n=this.#ao.getEditableAnnotations();for(const i of n){const{id:n}=i.data;if(this.#g.isDeletedAnnotationElement(n))continue;let r=e.get(n);r?(r.resetAnnotationElement(i),r.show(!1),i.show()):(r=t.get(n),r&&(this.#g.addChangedExistingAnnotation(r),r.renderAnnotationElement(i)&&r.show(!1)),i.show())}}this.#mo(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const t of fi.#V.values())n.remove(`${t._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#ho=!1}getEditableAnnotation(t){return this.#ao?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#g.getActive()!==t&&this.#g.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#po?.div&&!this.#go){this.#go=new AbortController;const t=this.#g.combinedSignal(this.#go);this.#po.div.addEventListener("pointerdown",this.#vo.bind(this),{signal:t}),this.#po.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#po?.div&&this.#go&&(this.#go.abort(),this.#go=null,this.#po.div.classList.remove("highlighting"))}#vo(t){this.#g.unselectAll();const{target:e}=t;if(e===this.#po.div||("img"===e.getAttribute("role")||e.classList.contains("endOfContent"))&&this.#po.div.contains(e)){const{isMac:e}=F.platform;if(0!==t.button||t.ctrlKey&&e)return;this.#g.showAllEditors("highlight",!0,!0),this.#po.div.classList.add("free"),this.toggleDrawing(),ri.startHighlighting(this,"ltr"===this.#g.direction,{target:this.#po.div,x:t.x,y:t.y}),this.#po.div.addEventListener("pointerup",(()=>{this.#po.div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:this.#g._signal}),t.preventDefault()}}enableClick(){if(this.#so)return;this.#so=new AbortController;const t=this.#g.combinedSignal(this.#so);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#so?.abort(),this.#so=null}attach(t){this.#co.set(t.id,t);const{annotationElementId:e}=t;e&&this.#g.isDeletedAnnotationElement(e)&&this.#g.removeDeletedAnnotationElement(t)}detach(t){this.#co.delete(t.id),this.#Sr?.removePointerInTextLayer(t.contentDiv),!this.#ho&&t.annotationElementId&&this.#g.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#g.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#g.addDeletedAnnotationElement(t.annotationElementId),_t.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),this.#g.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#uo),this.#g.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#oo&&(t._focusEventsAllowed=!1,this.#oo=setTimeout((()=>{this.#oo=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this.#g._signal}),e.focus())}),0)),t._structTreeParentId=this.#Sr?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return this.#g.getId()}get#yo(){return fi.#V.get(this.#g.getMode())}combinedSignal(t){return this.#g.combinedSignal(t)}#bo(t){const e=this.#yo;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#yo?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#g.updateToolbar(t),this.#g.updateMode(t);const{offsetX:n,offsetY:i}=this.#wo(),r=this.getNextId(),a=this.#bo({parent:this,id:r,x:n,y:i,uiManager:this.#g,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await(fi.#V.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#g))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),r=this.#bo({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#g,isCentered:e,...n});return r&&this.add(r),r}#wo(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,t),a=Math.max(0,e),s=(r+Math.min(window.innerWidth,t+n))/2-t,o=(a+Math.min(window.innerHeight,e+i))/2-e,[c,l]=this.viewport.rotation%180==0?[s,o]:[o,s];return{offsetX:c,offsetY:l}}addNewEditor(){this.createAndAddNewEditor(this.#wo(),!0)}setSelected(t){this.#g.setSelected(t)}toggleSelected(t){this.#g.toggleSelected(t)}unselect(t){this.#g.unselect(t)}pointerup(t){const{isMac:e}=F.platform;0!==t.button||t.ctrlKey&&e||t.target===this.div&&this.#lo&&(this.#lo=!1,this.#yo?.isDrawer&&this.#yo.supportMultipleDrawings||(this.#ro?this.#g.getMode()!==h.STAMP?this.createAndAddNewEditor(t,!1):this.#g.unselectAll():this.#ro=!0))}pointerdown(t){if(this.#g.getMode()===h.HIGHLIGHT&&this.enableTextSelection(),this.#lo)return void(this.#lo=!1);const{isMac:e}=F.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;if(this.#lo=!0,this.#yo?.isDrawer)return void this.startDrawingSession(t);const n=this.#g.getActive();this.#ro=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#fo)return void this.#yo.startDrawing(this,this.#g,!1,t);this.#g.setCurrentDrawingSession(this),this.#fo=new AbortController;const e=this.#g.combinedSignal(this.#fo);this.div.addEventListener("blur",(({relatedTarget:t})=>{t&&!this.div.contains(t)&&(this.#do=null,this.commitOrRemove())}),{signal:e}),this.#yo.startDrawing(this,this.#g,!1,t)}pause(t){if(t){const{activeElement:t}=document;this.div.contains(t)&&(this.#do=t)}else this.#do&&setTimeout((()=>{this.#do?.focus(),this.#do=null}),0)}endDrawingSession(t=!1){return this.#fo?(this.#g.setCurrentDrawingSession(null),this.#fo.abort(),this.#fo=null,this.#do=null,this.#yo.endDrawing(t)):null}findNewParent(t,e,n){const i=this.#g.findParent(e,n);return null!==i&&i!==this&&(i.changeParent(t),!0)}commitOrRemove(){return!!this.#fo&&(this.endDrawingSession(),!0)}onScaleChanging(){this.#fo&&this.#yo.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#g.getActive()?.parent===this&&(this.#g.commitOrRemove(),this.#g.setActiveEditor(null)),this.#oo&&(clearTimeout(this.#oo),this.#oo=null);for(const t of this.#co.values())this.#Sr?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#co.clear(),this.#g.removeLayer(this)}#mo(){for(const t of this.#co.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ct(this.div,t);for(const t of this.#g.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:t}){this.#g.commitOrRemove(),this.#mo();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,ct(this.div,{rotation:n}),e!==n)for(const t of this.#co.values())t.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#g.viewParameters.realScale}}class di{#rr=null;#b=0;#_o=new Map;#Ao=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(this.#rr){if(this.#rr!==t){if(this.#_o.size>0)for(const e of this.#_o.values())e.remove(),t.append(e);this.#rr=t}}else this.#rr=t}static get _svgFactory(){return T(this,"_svgFactory",new gn)}static#xo(t,[e,n,i,r]){const{style:a}=t;a.top=100*n+"%",a.left=100*e+"%",a.width=100*i+"%",a.height=100*r+"%"}#Eo(){const t=di._svgFactory.create(1,1,!0);return this.#rr.append(t),t.setAttribute("aria-hidden",!0),t}#To(t,e){const n=di._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const r=di._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),i}#So(t,e){for(const[n,i]of Object.entries(e))null===i?t.removeAttribute(n):t.setAttribute(n,i)}draw(t,e=!1,n=!1){const i=this.#b++,r=this.#Eo(),a=di._svgFactory.createElement("defs");r.append(a);const s=di._svgFactory.createElement("path");a.append(s);const o=`path_p${this.pageIndex}_${i}`;s.setAttribute("id",o),s.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#Ao.set(i,s);const c=n?this.#To(a,o):null,l=di._svgFactory.createElement("use");return r.append(l),l.setAttribute("href",`#${o}`),this.updateProperties(r,t),this.#_o.set(i,r),{id:i,clipPathId:`url(#${c})`}}drawOutline(t,e){const n=this.#b++,i=this.#Eo(),r=di._svgFactory.createElement("defs");i.append(r);const a=di._svgFactory.createElement("path");r.append(a);const s=`path_p${this.pageIndex}_${n}`;let o;if(a.setAttribute("id",s),a.setAttribute("vector-effect","non-scaling-stroke"),e){const t=di._svgFactory.createElement("mask");r.append(t),o=`mask_p${this.pageIndex}_${n}`,t.setAttribute("id",o),t.setAttribute("maskUnits","objectBoundingBox");const e=di._svgFactory.createElement("rect");t.append(e),e.setAttribute("width","1"),e.setAttribute("height","1"),e.setAttribute("fill","white");const i=di._svgFactory.createElement("use");t.append(i),i.setAttribute("href",`#${s}`),i.setAttribute("stroke","none"),i.setAttribute("fill","black"),i.setAttribute("fill-rule","nonzero"),i.classList.add("mask")}const c=di._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${s}`),o&&c.setAttribute("mask",`url(#${o})`);const l=c.cloneNode();return i.append(l),c.classList.add("mainOutline"),l.classList.add("secondaryOutline"),this.updateProperties(i,t),this.#_o.set(n,i),n}finalizeDraw(t,e){this.#Ao.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:i,rootClass:r,path:a}=e,s="number"==typeof t?this.#_o.get(t):t;if(s){if(n&&this.#So(s,n),i&&di.#xo(s,i),r){const{classList:t}=s;for(const[e,n]of Object.entries(r))t.toggle(e,n)}if(a){const t=s.firstChild.firstChild;this.#So(t,a)}}}updateParent(t,e){if(e===this)return;const n=this.#_o.get(t);n&&(e.#rr.append(n),this.#_o.delete(t),e.#_o.set(t,n))}remove(t){this.#Ao.delete(t),null!==this.#rr&&(this.#_o.get(t).remove(),this.#_o.delete(t))}destroy(){this.#rr=null;for(const t of this.#_o.values())t.remove();this.#_o.clear(),this.#Ao.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Zn};var pi=r.GlobalWorkerOptions,gi=r.getDocument}}]);